hive.strict.checks.no.partition.filter=false
create database if not exists sgmisitetl LOCATION '/sit/sgmi/hdata/sgmisitetl';
use sgmisitetl;
CREATE EXTERNAL TABLE `jbs_additional_reporting_period`(
  `reporting_period` string, 
  `updated_ts` timestamp)
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/jbs_additional_reporting_period'
;
CREATE EXTERNAL TABLE `jbs_batch`(
  `batch_id` string COMMENT '', 
  `ctry_cd` string COMMENT '', 
  `src_sys_nm` string COMMENT '', 
  `reporting_dt` string COMMENT '', 
  `prev_reporting_dt` string COMMENT '', 
  `daily_monthly_flag` string COMMENT '', 
  `regime` string COMMENT '', 
  `status` string COMMENT '', 
  `pstg_status` string COMMENT '', 
  `stg_status` string COMMENT '', 
  `fnd_status` string COMMENT '', 
  `plp_status` string COMMENT '', 
  `out_status` string COMMENT '', 
  `outbound_status` string COMMENT '', 
  `start_ts` timestamp COMMENT '', 
  `end_ts` timestamp COMMENT '', 
  `pstg_start_ts` timestamp COMMENT '', 
  `pstg_end_ts` timestamp COMMENT '', 
  `stg_start_ts` timestamp COMMENT '', 
  `stg_end_ts` timestamp COMMENT '', 
  `fnd_start_ts` timestamp COMMENT '', 
  `fnd_end_ts` timestamp COMMENT '', 
  `plp_start_ts` timestamp COMMENT '', 
  `plp_end_ts` timestamp COMMENT '', 
  `out_start_ts` timestamp COMMENT '', 
  `out_end_ts` timestamp COMMENT '', 
  `outbound_start_ts` timestamp COMMENT '', 
  `outbound_end_ts` timestamp COMMENT '', 
  `message` string COMMENT '')
  'org.apache.hadoop.hive.hbase.HBaseSerDe' 
STORED BY 
  'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ( 
  'hbase.columns.mapping'=':key,batch_details:ctry_cd,batch_details:src_sys_nm,batch_details:reporting_dt,batch_details:prev_reporting_dt,batch_details:daily_monthly_flag,batch_details:regime,batch_details:status,batch_details:pstg_status,batch_details:stg_status,batch_details:fnd_status,batch_details:plp_status,batch_details:out_status,batch_details:outbound_status,batch_details:start_ts,batch_details:end_ts,batch_details:pstg_start_ts,batch_details:pstg_end_ts,batch_details:stg_start_ts,batch_details:stg_end_ts,batch_details:fnd_start_ts,batch_details:fnd_end_ts,batch_details:plp_start_ts,batch_details:plp_end_ts,batch_details:out_start_ts,batch_details:out_end_ts,batch_details:outbound_start_ts,batch_details:outbound_end_ts,batch_details:message', 
  'serialization.format'='1')
;
CREATE EXTERNAL TABLE `jbs_current_reporting_period`(
  `key` int COMMENT '', 
  `curr_rpt_month` string COMMENT '', 
  `prev_rpt_month` string COMMENT '', 
  `next_rpt_month` string COMMENT '', 
  `updated_ts` timestamp COMMENT '')
  'org.apache.hadoop.hive.hbase.HBaseSerDe' 
STORED BY 
  'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ( 
  'hbase.columns.mapping'=':key,details:curr_rpt_month,details:prev_rpt_month,details:next_rpt_month,details:updated_ts', 
  'serialization.format'='1')
;
CREATE EXTERNAL TABLE `jbs_data_load_util_config`(
  `job_grp_sequence` bigint, 
  `data_source` string, 
  `source_sql` string, 
  `source_view` string, 
  `source_table` string, 
  `source_filter` string, 
  `target_table` string, 
  `target_filter` string, 
  `insert_mode` string, 
  `partition_cols` string, 
  `id_cols` string, 
  `index_flag` string, 
  `gather_stats_flag` string, 
  `daily_monthly_flag` string, 
  `execution_engine` string, 
  `status` string, 
  `truncate_partition` string, 
  `excluded_context_cols` string, 
  `partial_merge_cols` string)
PARTITIONED BY ( 
  `data_load_id` string)
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/jbs_data_load_util_config'
;
CREATE EXTERNAL TABLE `jbs_data_load_util_config_bak`(
  `job_grp_sequence` bigint, 
  `data_source` string, 
  `source_sql` string, 
  `source_view` string, 
  `source_table` string, 
  `source_filter` string, 
  `target_table` string, 
  `target_filter` string, 
  `insert_mode` string, 
  `partition_cols` string, 
  `id_cols` string, 
  `index_flag` string, 
  `gather_stats_flag` string, 
  `daily_monthly_flag` string, 
  `execution_engine` string, 
  `status` string, 
  `truncate_partition` string, 
  `excluded_context_cols` string, 
  `partial_merge_cols` string, 
  `data_load_id` string)
  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' 
  'org.apache.hadoop.mapred.TextInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/jbs_data_load_util_config_bak'
;
CREATE EXTERNAL TABLE `jbs_data_trace_util_config`(
  `job_grp_sequence` int, 
  `source_table` string, 
  `source_sql` string, 
  `source_filter` string, 
  `target_table` string, 
  `target_sql` string, 
  `target_filter` string, 
  `metric_cols` string, 
  `context_cols` string, 
  `label` string, 
  `status` string, 
  `data_source` string)
PARTITIONED BY ( 
  `data_load_id` string)
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/jbs_data_trace_util_config'
;
CREATE EXTERNAL TABLE `jbs_date_param`(
  `param_id` string COMMENT '', 
  `ctry_cd` string COMMENT '', 
  `src_sys_nm` string COMMENT '', 
  `from_date` string COMMENT '', 
  `to_date` string COMMENT '')
  'org.apache.hadoop.hive.hbase.HBaseSerDe' 
STORED BY 
  'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ( 
  'hbase.columns.mapping'=':key,details:ctry_cd,details:src_sys_nm,details:from_date,details:to_date', 
  'serialization.format'='1')
;
CREATE EXTERNAL TABLE `jbs_job_group_config`(
  `data_load_id` string)
PARTITIONED BY ( 
  `job_group` string)
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/jbs_job_group_config'
;
CREATE EXTERNAL TABLE `jbs_job_group_config_bak`(
  `data_load_id` string, 
  `job_group` string)
  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' 
  'org.apache.hadoop.mapred.TextInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/jbs_job_group_config_bak'
;
CREATE EXTERNAL TABLE `jbs_job_group_trace_config`(
  `data_load_id` string)
PARTITIONED BY ( 
  `job_group` string)
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/jbs_job_group_trace_config'
;
CREATE EXTERNAL TABLE `jbs_job_instance`(
  `job_instance_id` string COMMENT '', 
  `job_group` string COMMENT '', 
  `batch_id` bigint COMMENT '', 
  `src_sys_nm` string COMMENT '', 
  `ctry_cd` string COMMENT '', 
  `data_load_config_id` string COMMENT '', 
  `status` string COMMENT '', 
  `start_ts` timestamp COMMENT '', 
  `end_ts` timestamp COMMENT '', 
  `message` string COMMENT '', 
  `custom1` string COMMENT '', 
  `custom2` string COMMENT '', 
  `custom3` string COMMENT '')
  'org.apache.hadoop.hive.hbase.HBaseSerDe' 
STORED BY 
  'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ( 
  'hbase.columns.mapping'=':key,batch_details:job_group,batch_details:batch_id,batch_details:src_sys_nm,batch_details:ctry_cd,batch_details:data_load_config_id,batch_details:status,batch_details:start_ts,batch_details:end_ts,batch_details:message,batch_details:custom1,batch_details:custom2,batch_details:custom3', 
  'serialization.format'='1')
;
CREATE EXTERNAL TABLE `jbs_job_instance_23nov2018`(
  `job_instance_id` string, 
  `job_group` string, 
  `batch_id` bigint, 
  `src_sys_nm` string, 
  `ctry_cd` string, 
  `data_load_config_id` string, 
  `status` string, 
  `start_ts` timestamp, 
  `end_ts` timestamp, 
  `message` string)
  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' 
  'org.apache.hadoop.mapred.TextInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/jbs_job_instance_23nov2018'
;
CREATE EXTERNAL TABLE `jbs_trace`(
  `id` bigint COMMENT 'from deserializer', 
  `job_id` bigint COMMENT 'from deserializer', 
  `data_load_id` string COMMENT 'from deserializer', 
  `tbl_name` string COMMENT 'from deserializer', 
  `stage` string COMMENT 'from deserializer', 
  `type` string COMMENT 'from deserializer', 
  `val` map<string,string> COMMENT 'from deserializer')
  'org.apache.hadoop.hive.hbase.HBaseSerDe' 
STORED BY 
  'org.apache.hadoop.hive.hbase.HBaseStorageHandler' 
WITH SERDEPROPERTIES ( 
  'colelction.delim'=',', 
  'hbase.columns.mapping'=':key,trace_details:parent_id,trace_details:data_load_id,trace_details:table_name,trace_details:stage,trace_details:table,trace_details:val', 
  'mapkey.delim'=':', 
  'serialization.format'='1')
;
CREATE VIEW `jbs_trace_result` AS select `b`.`job_id`, `b`.`data_load_id`, `b`.`stage`, `b`.`tbl_name`, `b`.`tgt_tbl`, `b`.`regime`, `b`.`system`, `b`.`w_batch_id`, `b`.`w_current_record_flag`, `b`.`w_snapshot_dt`, `b`.`w_country_cd`, `b`.`w_datasource_id`, `b`.`metric`, `b`.`src`, `b`.`tgt` from (
select `a`.`job_id`, `a`.`data_load_id`, `a`.`stage`, `a`.`item` as `tbl_name`,
split(`b`.`target_table`,'\\.')[1] as `tgt_tbl`,
 `a`.`regime`, `a`.`system`,
        case when collect_set(`a`.`m`["SRC"]["W_BATCH_ID"])[0] != '--' then collect_set(`a`.`m`["SRC"]["W_BATCH_ID"])[0] else collect_set(`a`.`m`["TGT"]["W_BATCH_ID"])[0] end `w_batch_id`,
        case when collect_set(`a`.`m`["SRC"]["W_CURRENT_RECORD_FLAG"])[0] != '--' then collect_set(`a`.`m`["SRC"]["W_CURRENT_RECORD_FLAG"])[0] else collect_set(`a`.`m`["TGT"]["W_CURRENT_RECORD_FLAG"])[0] end `w_current_record_flag`,
        case when collect_set(`a`.`m`["SRC"]["W_SNAPSHOT_DT"])[0] != '--' then NVL(collect_set(`a`.`m`["SRC"]["W_SNAPSHOT_DT"])[0],collect_set(`a`.`m`["SRC"]["BUSINESS_DT"])[0]) else NVL(collect_set(`a`.`m`["TGT"]["W_SNAPSHOT_DT"])[0],collect_set(`a`.`m`["TGT"]["BUSINESS_DT"])[0]) end `w_snapshot_dt`,
        case when collect_set(`a`.`m`["SRC"]["W_COUNTRY_CD"])[0] != '--' then collect_set(`a`.`m`["SRC"]["W_COUNTRY_CD"])[0] else NVL(collect_set(`a`.`m`["TGT"]["W_COUNTRY_CD"])[0],'ALL') end `w_country_cd`,
        case when collect_set(`a`.`m`["SRC"]["W_DATASOURCE_ID"])[0] != '--' then collect_set(`a`.`m`["SRC"]["W_DATASOURCE_ID"])[0] else collect_set(`a`.`m`["TGT"]["W_DATASOURCE_ID"])[0] end `w_datasource_id`,
        `a`.`key_val` `metric`,
        case when `a`.`key_val`='CNT' then collect_set(`a`.`m`["SRC"]["CNT"])[0] 
             when `a`.`key_val`='DISTINCT_CNT' then collect_set(`a`.`m`["SRC"]["DISTINCT_CNT"])[0]
             when split(`a`.`key_val`,'_')[0]='HASH' then collect_set(`a`.`m`["SRC"][`a`.`key_val`])[0]
             when split(`a`.`key_val`,'_')[0]='SUM' then collect_set(`a`.`m`["SRC"][`a`.`key_val`])[0]
             else null end as `src`,
        case when `a`.`key_val`='CNT' then collect_set(`a`.`m`["TGT"]["CNT"])[0] 
             when `a`.`key_val`='DISTINCT_CNT' then collect_set(`a`.`m`["TGT"]["DISTINCT_CNT"])[0]
             when split(`a`.`key_val`,'_')[0]='HASH' then collect_set(`a`.`m`["TGT"][`a`.`key_val`])[0]
             when split(`a`.`key_val`,'_')[0]='SUM' then collect_set(`a`.`m`["TGT"][`a`.`key_val`])[0]
             else null end as `tgt`
from (
  select `a`.`id`, `a`.`job_id`, `a`.`data_load_id`, `a`.`tbl_name`, `a`.`stage`, `a`.`type`, `a`.`val`, `a`.`key_val`, `a`.`m`, `a`.`cmbo`, `a`.`country_cd`, `a`.`regime`, `a`.`system`, `t1`.`item` from (select `a`.`id`, `a`.`job_id`, `a`.`data_load_id`, `a`.`tbl_name`, `a`.`stage`, `a`.`type`, `a`.`val`, `b`.`key_val`, map(`a`.`type`, `a`.`val`) `m`, concat(`a`.`type`,'-',`a`.`val`["W_CURRENT_RECORD_FLAG"]) `cmbo`, `a`.`val`["W_COUNTRY_CD"] `country_cd`, `a`.`val`["W_WORKSPACE"] `regime`,  `a`.`val`["W_DATASOURCE_ID"] `system`
  from `sgmisitetl`.`jbs_trace` `a` join 
  (select distinct `tmp`.`key_val` from (select explode(map_keys(`jbs_trace`.`val`)) `key_val` from `sgmisitetl`.`jbs_trace`) `tmp` where `tmp`.`key_val` not in('W_SNAPSHOT_DT','W_DATASOURCE_ID','W_CURRENT_RECORD_FLAG','W_COUNTRY_CD','W_BATCH_ID','W_WORKSPACE')) `b`
  where (`a`.`val`["W_CURRENT_RECORD_FLAG"] = 'Y' or `a`.`val`["W_CURRENT_RECORD_FLAG"] = '--') or `a`.`type` = 'SRC') `a` lateral view explode(split(`a`.`tbl_name`,',')) `t1` as `item`
) `a` 
 left join `sgmisitetl`.`jbs_data_trace_util_config` `b`
 on `a`.`data_load_id` = `b`.`data_load_id`
group by `a`.`job_id`, `a`.`data_load_id`,`a`.`stage`, `a`.`item`, `a`.`key_val`, `a`.`country_cd`, `a`.`regime`, `a`.`system`,`b`.`target_table`
) `b` where `b`.`src` is not null and `b`.`tgt` is not null
CREATE VIEW `jbs_trace_result_format` AS select `c`.`w_batch_id`,`c`.`w_current_record_flag`,CAST(`c`.`w_snapshot_dt` as DATE) `w_snapshot_dt`,`c`.`w_country_cd`,`c`.`w_datasource_id`,`c`.`regime`,`c`.`tbl_name`,
max(`c`.`tgt_tbl`) as `tgt_tbl`, `c`.`metric`,
CAST(max(case when `c`.`stage` = 'PSTG-STG' then `c`.`src` end) as BIGINT) `pstg`,
CAST(max(case when `c`.`stage` = 'PSTG-STG' then `c`.`tgt` end) as BIGINT) `stg`,
CAST(max(case when `c`.`stage` = 'STG-FND' then `c`.`src` end) as BIGINT) `stg_derived`,
CAST(max(case when `c`.`stage` = 'STG-FND' then `c`.`tgt` end) as BIGINT) `fnd`,
CAST(max(case when `c`.`stage` = 'FND-PLP' then `c`.`src` end) as BIGINT) `fnd_derived`,
CAST(max(case when `c`.`stage` = 'FND-PLP' then `c`.`tgt` end) as BIGINT) `plp`
 from (select `b`.`job_id`, `b`.`data_load_id`, `b`.`stage`, `b`.`tbl_name`, `b`.`tgt_tbl`, `b`.`regime`, `b`.`system`, `b`.`w_batch_id`, `b`.`w_current_record_flag`, `b`.`w_snapshot_dt`, `b`.`w_country_cd`, `b`.`w_datasource_id`, `b`.`metric`, `b`.`src`, `b`.`tgt`, `b`.`row_num` from (
select `a`.`job_id`, `a`.`data_load_id`, `a`.`stage`, `a`.`tbl_name`, `a`.`tgt_tbl`, `a`.`regime`, `a`.`system`, `a`.`w_batch_id`, `a`.`w_current_record_flag`, `a`.`w_snapshot_dt`, `a`.`w_country_cd`, `a`.`w_datasource_id`, `a`.`metric`, `a`.`src`, `a`.`tgt` ,
row_number() over (partition by `a`.`data_load_id`,`a`.`w_snapshot_dt`,`a`.`w_country_cd`,`a`.`w_datasource_id`,`a`.`metric`,`a`.`tbl_name`,`a`.`regime` order by `a`.`job_id` desc) `row_num`
from `sgmisitetl`.`jbs_trace_result` `a` where `a`.`stage`!="OUT-OUTBOUND"
) `b` where `b`.`row_num`=1) `c`
 group by `c`.`w_batch_id`,`c`.`w_current_record_flag`,`c`.`w_snapshot_dt`,`c`.`w_country_cd`,`c`.`w_datasource_id`,`c`.`tbl_name`,`c`.`metric`,`c`.`regime`
CREATE EXTERNAL TABLE `sgmi_process_status`(
  `report` string, 
  `country` string, 
  `status` string, 
  `batch_date` string, 
  `end_time` string)
PARTITIONED BY ( 
  `ods` string)
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/sgmi_process_status'
;
CREATE EXTERNAL TABLE `sgmi_sg_gm_mandate`(
  `gm_id` string, 
  `approved_date` string, 
  `cust_crid` string, 
  `cr_cust_le_id` string, 
  `lmp_long_nm` string, 
  `lmp_sub_sgmnt_cd_num` string, 
  `lmp_sgmnt_cd_num` string, 
  `rev_grp_id` string, 
  `rev_grp_name` string, 
  `grp_scb_cg` string, 
  `orig_cntry` string, 
  `credit_risk_cntry` string, 
  `prop_lmt_cat1_stlending` string, 
  `prop_lmt_cat1_ltlending` string, 
  `prop_lmt_cat1_trade` string, 
  `prop_lmt_cat1_others` string, 
  `prop_lmt_cat2_st` string, 
  `prop_lmt_cat2_lt` string, 
  `prop_lmt_cat3` string, 
  `prop_lmt_ctrllmt` string, 
  `prop_lmt_cat5` string, 
  `sap_limits` string, 
  `grp_prim_isic_cd` string, 
  `grp_sec_isic_cd` string, 
  `modified_date` string)
PARTITIONED BY ( 
  `ods` string)
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/sgmi_sg_gm_mandate'
;
CREATE EXTERNAL TABLE `sgmi_sg_sci`(
  `lmt_le_id` string, 
  `lmt_lsp_id` string, 
  `lmp_long_nm` string, 
  `lmp_sub_sgmnt_cd_val` string, 
  `lmp_sgmnt_cd_val` string, 
  `doc_crm_id` string, 
  `llp_bca_ref_num` string, 
  `llp_bca_ref_appr_dt` string, 
  `cntry_crd_risk_res` string, 
  `cntry_lmt_bkg_loctn_id` string, 
  `lmt_bkg_cd` string, 
  `bca_org_loc` string, 
  `bca_org_bkg_cd` string, 
  `bca_ccr` string, 
  `llp_extd_next_rvw_dt` string, 
  `llp_next_intrm_rvw_dt` string, 
  `llp_cntry_risk_appr_req_ind` string, 
  `lmt_sys_gen_id` string, 
  `facility_id` string, 
  `lmt_outer_lmt_id` string, 
  `lmt_tp_val` string, 
  `lmt_synd_loan_val` string, 
  `lmt_tenor` string, 
  `lmt_tenor_basis_val` string, 
  `lmt_bkg_loctn_id` string, 
  `lmt_prd_tp_val` string, 
  `lmt_amt` string, 
  `lmt_crrncy_iso_cd` string, 
  `lmt_share_ind` string, 
  `lmt_cmmtd_ind` string, 
  `lmt_advise_ind` string, 
  `lmt_sec_tp_val` string, 
  `lmt_expry_dt` string, 
  `lmt_rvlvg_flag_val` string, 
  `bca_gm_id` string, 
  `last_upd_dt` string, 
  `llp_client_lgd` string, 
  `llp_holdco_cd_val` string, 
  `llp_non_gam_cd_val` string)
PARTITIONED BY ( 
  `ods` string)
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/sgmi_sg_sci'
;
CREATE EXTERNAL TABLE `sgmi_sg_scorecard`(
  `cust_id` string, 
  `cust_le_id` string, 
  `cust_name` string, 
  `cust_sub_seg` string, 
  `cust_seg` string, 
  `cust_cmp_id` string, 
  `sales_rev` string, 
  `supply_chain_flag` string, 
  `is_large_corp` string, 
  `sugg_scorecard` string, 
  `override_flag` string, 
  `override_comments` string, 
  `scorecard_type` string, 
  `scorecard_id` string, 
  `rm_name` string, 
  `fin_stmt_date` string, 
  `appr_name` string, 
  `date_of_appr` string, 
  `parent_sup_applied` string, 
  `parent_cap_applied` string, 
  `parent_cap_crg` string, 
  `parent_sci_id` string, 
  `parent_cust_id` string, 
  `parent_rating` string, 
  `parent_pd` string, 
  `parent_crg_just` string, 
  `rating_aft_parent_sup` string, 
  `govt_sup_flag` string, 
  `crg_aft_govt_sup` string, 
  `govt_sup_comm` string, 
  `govt_crg_aft_ctry_ceiling` string, 
  `govt_ctry_ceiling` string, 
  `govt_sup_crg` string, 
  `govt_sup_ctry_code` string, 
  `govt_sup_ctry_flag` string, 
  `standalone_rating` string, 
  `standalone_rating_pd` string, 
  `ctry_lcy_ceiling` string, 
  `final_recommended_rating` string, 
  `final_scorecard_crg` string, 
  `final_approved_rating` string, 
  `final_approved_pd` string, 
  `scorecard_pd` string, 
  `recommended_pd` string, 
  `override_status_flag` string, 
  `reason_for_crg_override` string, 
  `justification_for_override` string, 
  `approval_override_comments` string, 
  `approval_comments` string, 
  `crg_of_domicile_country` string, 
  `crg_aft_sover_ceiling_factor` string, 
  `parent_regulatory_country` string, 
  `client_regulatory_country` string, 
  `status` string, 
  `gm_orig_cntry` string, 
  `gm_gam_loc` string, 
  `cob_bca_ref_no` string, 
  `cob_bca_ccr` string, 
  `cob_bca_loc` string, 
  `parent_incorp_country` string, 
  `origin_country` string, 
  `parent_domicile_country` string, 
  `parent_gov_supp_country` string, 
  `bor_bca_ref_no` string, 
  `bor_bca_ccr` string, 
  `bor_bca_loc` string, 
  `pledgor_bca_ref_no` string, 
  `pledgor_bca_ccr` string, 
  `pledgor_bca_loc` string, 
  `fila_bca_ref_no` string, 
  `fila_bca_loc` string, 
  `modified_date` string)
PARTITIONED BY ( 
  `ods` string)
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/sgmi_sg_scorecard'
;
CREATE EXTERNAL TABLE `sgmi_sg_sharholding`(
  `sci_id` string, 
  `shareholder_prcnt` string, 
  `shareholder_name` string, 
  `shareholder_id` string, 
  `bca_ref_no` string, 
  `approval_date` string, 
  `update_date` string)
PARTITIONED BY ( 
  `ods` string)
  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
LOCATION
  'hdfs://haasbatchreg.hbrscb.dev.net/sit/sgmi/hdata/sgmisitetl/sgmi_sg_sharholding'
;
CREATE VIEW `temp_src_query_1808061404270013933` AS SELECT distinct                      `t`.`partition_key`,     'SME' as `banking_type`,     `t`.`method_new`,     `t`.`method_original`,     `t`.`contract_reference`,     `t`.`tranche_collateral_type`,     `t`.`tranche_guarantee_type`,     `t`.`counterparty_original`,     `e`.`entity_desc` AS `counterparty_original_desc`,     `t`.`counterparty_new`,     `t`.`counterparty_new_desc`,     `t`.`table_name`,     `t`.`bis_past_due`,     `t`.`contract_type`,     `ct`.`ct_desc_user` AS `contract_desc`,     `e`.`cf_indicator`,     (         CASE             WHEN upper(`t`.`counterparty_original`) LIKE '%_CORPORATE%'                  OR upper(`t`.`counterparty_original`) LIKE '%_BANK%'                  OR `t`.`counterparty_original` = '9999999999-1'                  OR `t`.`counterparty_original` = '9999999998-1' THEN 'Y'             ELSE 'N'         END     ) AS `unmapped_ind`,     (         CASE             WHEN upper(`e`.`attribute_4`) = 'CN' THEN 'Y'             ELSE 'N'         END     ) AS `non_borrowing_ind`,     (         CASE  WHEN `contracttype`.`ct_code_user` is not null THEN 'PURCHASED_RECEIVABLE'             WHEN `t`.`contract_type` IN ( 'GMGMKTPTEQ' ) THEN 'PRIVATE_EQUITY'             WHEN `t`.`contract_type` IN ( 'GMGMKTAINV', 'GMGMKTANPL'  ) THEN 'ALT_INVST'             WHEN `e`.`et_code_user` IN (  'BSC23'  ) THEN 'DEV_ORG'    WHEN `e`.`et_code_user` IN (  'BSC16'  ) THEN 'MDB'             WHEN `e`.`et_code_user` IN (  'BSC24' ) THEN 'PERSONAL'             WHEN `e`.`scorecard_segment_code` IN (  'CFSC'   ) THEN 'SME'             WHEN `e`.`scorecard_segment_category` IN (  'F1'  ) THEN 'BANK'             WHEN `e`.`scorecard_segment_category` IN (  'F2', 'F3'  ) THEN 'NBFI'             WHEN `e`.`scorecard_segment_category` IN (  'S1' ) THEN 'SOV'    WHEN `e`.`scorecard_segment_category` IN (  'CRE', 'PF', 'SF' ) THEN 'SPECIALISED LENDING'             WHEN `e`.`scorecard_segment_category` IN (  'C1', 'C2', 'C3', 'C4', 'C5' ) THEN 'CORP'             ELSE 'CORP'         END     ) AS `segment_original`,     (         CASE             WHEN `t`.`table_name` IN (                 'DEAL_IMPORT',                 'CREDIT_DERIVATIVE'             ) THEN 'T'             ELSE 'F'         END     ) AS `derivative_ind`,     `t`.`incorporation_country_original`,     `c`.`country_name`,     `t`.`dealbook`,     `t`.`booking_company_desc`,     `e`.`attribute_1` AS `scorecard_original`,     `t`.`internal_rating_new`,     `t`.`pd_new`,     `t`.`internal_rating_original`,     `t`.`pd_original`,     (         CASE             WHEN nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`method_new` = 'ADV'                  AND `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED' THEN 0.45             WHEN `t`.`import_source` like 'NONTP-%'                  AND `t`.`method_new` = 'ADV' THEN `t`.`exposure_attribute_7`              WHEN (                 ( `t`.`tranche_collateral_type` = 'COLLATERALIZED' )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') <> 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`lgd`             WHEN (                 (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'GUARANTEED'                 )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') = 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`exposure_attribute_7`              ELSE 0         END     ) AS `lgd`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY',   'RETAIL_EXPOSURE'                  ) THEN `t`.`outstanding`             ELSE 0         END     ) AS `outstanding`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY',     'RETAIL_EXPOSURE'             ) THEN `t`.`accrued_interest`             ELSE 0         END     ) AS `accrued_interest`,     (         CASE             WHEN `t`.`table_name` IN (                 'FACILITY'             )                  AND `t`.`bs_type` = 'OFB' THEN `t`.`outstanding`             ELSE 0         END     ) AS `headroom`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN `t`.`fair_value`             ELSE 0         END     ) AS `mtm`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN (                         CASE                             WHEN `t`.`fair_value` > 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                     ELSE (                         CASE                             WHEN `t`.`fair_value` < 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                 END             )             ELSE 0         END     ) AS `replacement_cost`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`t`.`nominal`) *-1                     ELSE abs(`t`.`nominal`)                 END             )             ELSE 0         END     ) AS `notional`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN `t`.`add_on`             ELSE 0         END     ) AS `add_on`,     `t`.`ead`,     `t`.`rwa`,     `t`.`rwa_pre_crm`,     `t`.`el`,     `t`.`rgc`,     `t`.`ead_original`,     `t`.`tier1_deduction`,     `t`.`tier2_deduction`,     `t`.`ead_pre_ccf`,     `t`.`nominal`,     `t`.`fair_value`,     `t`.`ead_pro`,     `t`.`ead_pro_gen`,     nvl(`prrsr`.`prr`,0) `prr`,     ( `t`.`ead` * `t`.`pd_original` ) AS `wt_pd_original`,     ( `t`.`ead` * `t`.`pd_new` ) AS `wt_pd_new`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45 * `t`.`ead`             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd` * `t`.`ead`             ELSE 0         END     ) AS `wt_lgd`,     ( `t`.`ead` * `t`.`k_maturity` ) AS `wt_k_maturity`,     ( `t`.`ead` * `t`.`residual_maturity` ) AS `wt_residual_maturity`,     `t`.`total_annual_sales`,     `t`.`hfx`,     `t`.`hc`,     `t`.`he`,     `t`.`k_maturity`,     `t`.`facility_reference`,     `t`.`performing_status`,     `t`.`securitization_reference`,     `t`.`days_after_contractual_date`,     `t`.`risk_bucket`,     `t`.`delivery_type`,     `t`.`funding_ccy`,     coalesce( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr`.`currency`             ELSE `t`.`currency`         END     ),`t`.`currency`) AS `currency`,     `t`.`residual_maturity`,     `t`.`original_maturity`,     `t`.`ead_method`,     `t`.`ccf`,     `t`.`inter_company`,     `t`.`trading_book_type`,     `e`.`attribute_7` AS `customer_segment_code`,     `e`.`customer_segment_desc`,     `e`.`attribute_8` AS `customer_subsegment_code`,     `e`.`customer_subsegment_desc`,     `t`.`id`,     `t`.`import_source`,     `t`.`product_gl_criteria`,     `t`.`bs_type`,     `t`.`securitized`,     `t`.`risk_type`,     `t`.`bis_product`,     `t`.`bis_product_category`,     `t`.`bis_entity_type_new`,     `t`.`bis_entity_type_original`,     `t`.`asset_class_new`,     `t`.`asset_class_original`,     `t`.`netting_agreement_reference`,     `t`.`collateral_reference`,     `t`.`collateral_contract_type`,     `t`.`collateral_bis_product`,     `t`.`collateral_product_category`,     `t`.`guarantee_reference`,     `t`.`guarantee_contract_type`,     `t`.`guarantee_bis_product`,     `t`.`counterparty_type_new`,     `t`.`sub_method_new`,     `t`.`rw_scaling_factor`,     `t`.`rwa_scaling_factor`,     `t`.`exposure_attribute_7`,     `t`.`exposure_attribute_8`,     `t`.`exposure_attribute_9`,     `t`.`rw_original`,     `t`.`rw_new`,     `t`.`securitization_n`,     `t`.`crm_method`,     `t`.`division_code`,     `t`.`secu_ea_controlled`,     `t`.`secu_company_weight`,     `t`.`secu_bank_role`,     `t`.`obligor_grade_new`,     `t`.`standard_rw_original`,     `t`.`standard_rw_new`,     `t`.`cpty_group`,     `t`.`cpty_group_original`,     `t`.`bis_industry_sector_new`,     `t`.`bis_industry_sector_original`,     `t`.`bis_risk_area_new`,     `t`.`bis_risk_area_original`,     `t`.`incorporation_country_new`,     `t`.`int_rating_agency_new`,     `t`.`risk_country`,     `t`.`used_amount_facility`,     `t`.`beel`,     `t`.`uncommited`,          case when `csr`.`start_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0) - nvl(`t`.`original_maturity`,0)) * 365.25) as INT)) as date)     else `csr`.`start_date` end as `start_date`,       case when `csr`.`maturity_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0)) * 365.25) as INT)) as date)      else `csr`.`maturity_date` end as `maturity_date`,          `t`.`value_date`,     (         CASE             WHEN nvl(`t`.`residual_maturity`,0) <= 1               THEN '<=1yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 3 and nvl(`t`.`residual_maturity`,0) > 1  THEN '1-3yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 5 and nvl(`t`.`residual_maturity`,0) > 3  THEN '3-5yrs'             ELSE '>5yrs'         END     ) AS `maturity_range`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd`             ELSE 0         END     ) AS `tranche_lgd`,         CASE WHEN (`complink`.`mother_code` = '999C' or `complink`.`mother_code` = '976C') and `complink`.`child_code` is not null then 'SOLO'          ELSE 'SUBS' END `company_type`,     nvl(`mru_bus`.`mru_desc`,'UNMAPPED') AS `business`,     `inst`.`psgl_operating_unit` AS `psgl_operating_unit`,     `psgl`.`psgl_cust_class`,     (         CASE             WHEN `t`.`table_name` = 'TRANCHE'                  AND `t`.`bs_type` IN(                 'VIF','VIR'             ) THEN 'TRANCHE_FILTER'             WHEN `t`.`inter_company` = 'T' THEN 'INTERCOMPANY_FILTER'             ELSE 'BCRS'         END     )   AS `filter_type`,     (         CASE             WHEN `t`.`securitized` = 'T'   THEN 'SECURITIZED'             WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'             WHEN `t`.`trading_book_type` = 'T'                  AND `t`.`bis_product_category` IN(                 'REPO','DERIVATIVE','DERIVATIVE_OTC','CREDIT_DERIVATIVE'             ) THEN 'CCR'             WHEN `t`.`tranche_collateral_type` = 'COLLATERALIZED'                  AND `t`.`collateral_bis_product` IN(                 'REP_NET_COL','OTC_NET_COL'             ) THEN 'NETTING_BENEFIT'             ELSE 'FSA'         END     )  AS `fsa_exclusion_type`,     (         CASE             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_past_due` = 'T' THEN 'PAST_DUE_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`asset_class_new` = 'CLAIM_OTH_150'                 OR (                     (                         (                             `t`.`rw_original` >= 1.5                             OR `t`.`standard_rw_original` >= 1.5                         )                         AND NOT (                             (                                 `t`.`tranche_collateral_type` = 'COLLATERALIZED'                                 AND `t`.`crm_method` = 'SIM'                                 AND `t`.`collateral_product_category` = 'FINANCIAL_COL'                             )                             OR `t`.`tranche_guarantee_type` = 'GUARANTEED'                         )                     )                     OR `t`.`rw_new` >= 1.5                 )             ) THEN 'HIGH_RISK_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 ( `t`.`asset_class_new` LIKE '%EQT' )                 OR (                     `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                     AND `t`.`sub_reference` = 'MULTI NAME'                 )                 OR ( `t`.`risk_type` = 'RVR' )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` IN (                 'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE',                 'CLAIM_SEC_CRE',                 'CLAIM_FULL_SEC_RRE'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`collateral_bis_product` IN (                 'RRE_COL',                 'LEASING_CRE_COL',                 'CRE_COL',                 'LEASING_RRE_COL'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_COVERED_BOND' THEN 'COVERED_BONDS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_CIU' THEN 'COLLECTIVE_INV_UNDERTAKINGS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF',                 'CORP',                 'INSURANCE',                 'CORP_CF',                 'CORP_HVCRE',                 'CORP_IPRE',                 'CORP_OF',                 'CORP_PF',                 'EX_RETAIL',                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'SPE',                 'CORP_INT_GRP'             )                  AND (                 `t`.`risk_bucket` IN (                     30,                     31,                     32,                     33,                     34                 )                 OR `t`.`risk_bucket_original` IN (                     30,                     31,                     32,                     33,                     34                 )             ) THEN 'SHORT_TERM_CLAIMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SOV'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'RGLA',                 'RGLA_SOV',                 'RGLA_SOV_EU'             ) THEN 'REGIONAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'PSE',                 'PSE_BANK',                 'PSE_SOV'             ) THEN 'ADMIN_BODIES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'MDB',                 'MDB_PREF_0',                 'MDB_PREF_20'             ) THEN 'MULTILATERAL_DEVT_BANKS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SUPRA',                 'EIF',                 'SUPRA_100'             ) THEN 'INTL_ORGANIZATIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`bis_entity_type_new` IN (                     'SME',                     'SME_CF',                     'SME_HVCRE',                     'SME_IPRE',                     'SME_OF',                     'SME_PF',                     'CORP',                     'INSURANCE',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'CORP_INT_GRP'                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'INDIV',                 'SME_RETAIL'             )                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL'             WHEN `t`.`method_new` = 'STD' THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`bis_entity_type_new` NOT IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` = 'CLAIM_OTH_100'                 )                 AND (                     `t`.`bis_product_category` NOT IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 ( `t`.`asset_class_new` = 'CLAIM%EQT' )                 OR ( `t`.`asset_class_new` = 'CLAIM_CIU' )             ) THEN 'EQUITY_CLAIMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`asset_class_new` IN (                         'CLAIM_FULL_SEC_RRE',                         'CLAIM_SEC_RRE_LEASE',                         'CRE_COL',                         'CLAIM_SEC_CRE',                         'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE'                     )                     OR `t`.`collateral_bis_product` IN (                         'RRE_COL',                         'LEASING_RRE_COL',                         'LEASING_CRE_COL',                         'CRE_COL'                     )                 )                 AND `t`.`bis_entity_type_new` IN (                     'INDIV',                     'SME_RETAIL'                 )             ) THEN 'RETAIL_MORTGAGES'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_RETAIL_QUALIFYING_REVOLVING' THEN 'RETAIL_QRRE'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'INDIV'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_OTHER'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'SME_RETAIL'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_SME'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'FOU'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'ADV'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             ELSE 'OTHER_ITEMS'         END     ) AS `fsa004_asset_class`,     `t`.`secu_mode`,     `t`.`risk_bucket_original`,     `t`.`waterfall_seniority`,     `e`.`origination_country` AS `ccr_original`,     `enew`.`origination_country` AS `ccr_new`,     `t`.`stress_testing_scenario_id`,     `t`.`collateral_attribute_1`,     `t`.`collateral_attribute_9`,     `t`.`exposure_attribute_1`,     `t`.`exposure_attribute_6`,     `t`.`counterparty_new_attribute_1`,     `t`.`sub_reference`,     `t`.`sub_method_original`,     `t`.`int_rating_agency_original`,     `t`.`ead_formula`,     `t`.`booking_company`,     `t`.`obligor_grade_inf_new`,     `t`.`obligor_grade_sup_new`,     `t`.`incorporation_ccy_original`,     `t`.`incorporation_ccy_new`,     nvl(`t`.`management_product`,'UNMAPPED') AS `management_product`,     `bus_ind`.`business_identifier_desc` AS `business_identifier`,       CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_w_filter_type`,              CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_filter_type`,          `ct`.`attribute_2` AS `balance_category`,     nvl( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr_exch`.`exch_rate`             ELSE `cer`.`exch_rate`         END     ),`cer`.`exch_rate`) AS `exchange_rate`,     `fac`.`holdco_ind` AS `holding_company_ind`,     `fac`.`non_gam_ind` AS `non_gam_ind`,     `egroup_orig`.`group_cust_segment_code`,     `egroup_orig`.`group_cust_segment_desc`,     `t`.`original_cost`,     `t`.`premium_current`,     `t`.`security_positions_ref`,     `t`.`pd_pre_floor_new`,     `t`.`exposure_attribute_3`,     `t`.`exposure_attribute_4`,     `t`.`exposure_attribute_5`,     `t`.`counterparty_new_attribute_3`,     `t`.`counterparty_new_attribute_4`,     `t`.`collateral_attribute_7`,     `t`.`collateral_attribute_8`,     `e`.`long_term_rating_local_ccy` AS `internal_rating_local_ccy_orig`,     `t`.`past_due_int`,     `t`.`ead_pro_discount`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`ltv`             ELSE 0         END     ) AS `ltv`,     (         CASE             WHEN `bf`.`domicile_country_code` IS NOT NULL                  AND nvl(`e`.`bf_link_type`,'z') = 'BUYER_FINANCE' THEN 'Y'             ELSE 'N'         END     ) AS `buyer_finance_ind`,     `t`.`counterparty_ext_rat_code`,     `t`.`counterparty_ext_rat_agency`,     `t`.`counterparty_int_rat_code`,     `t`.`counterparty_int_rat_agency`,     `t`.`maturity_eff`,     `psgl`.`psgl_department` AS `psgl_department_id`,     `psgl`.`psgl_product` AS `psgl_product_code`    , `net`.`netting_type` AS `netting_agreement_type`,     `sub`.`contract_reference` AS `sub_limit_fac_reference`,     `sub`.`limit_amount` AS `limit_amount`,     `sub`.`limit_attribute` AS `limit_attribute`,      CASE WHEN `tcva`.`cva_rwa`  <= 0 THEN nvl(`tcva`.`cva_rwa`,0) / nvl(`tcva`.`count_contract_ref`,0)          ELSE round(nvl(`t`.`rwa`,0),2) / (`t2`.`sum_rwa` * round(nvl(`tcva`.`cva_rwa`,0),2))     END `cva_rwa`,          `t`.`qualifying_ccp`,     `t`.`k_function_used`,     `t`.`k_function_used_original`,     `t`.`product_gl_criteria_2`,     `t`.`bis_past_due_original`,     `t`.`risk_country_new`,     `t`.`risk_country_original`,     `t`.`booking_company_incorp_country`,     `t`.`ccf_std`,     `t`.`past_due_days`,     `t`.`guarantee_method`,     `t`.`fde_alternative_method`,     `t`.`rwa_pre_cap`,     `t`.`asset_class_category_new`,     `t`.`asset_class_category_original`        FROM ( SELECT `stg_bcrs_t_cdr`.`partition_key`, `stg_bcrs_t_cdr`.`stress_testing_scenario_id`, `stg_bcrs_t_cdr`.`tranche_collateral_type`, `stg_bcrs_t_cdr`.`tranche_guarantee_type`, `stg_bcrs_t_cdr`.`bs_type`, `stg_bcrs_t_cdr`.`contract_reference`, `stg_bcrs_t_cdr`.`contract_type`, `stg_bcrs_t_cdr`.`bis_product`, `stg_bcrs_t_cdr`.`bis_product_category`, `stg_bcrs_t_cdr`.`unconditionnaly_cancelable`, `stg_bcrs_t_cdr`.`ead_original`, `stg_bcrs_t_cdr`.`ead_pre_ccf`, `stg_bcrs_t_cdr`.`ead`, `stg_bcrs_t_cdr`.`ead_pro`, `stg_bcrs_t_cdr`.`facility_reference`, `stg_bcrs_t_cdr`.`collateral_reference`, `stg_bcrs_t_cdr`.`collateral_contract_type`, `stg_bcrs_t_cdr`.`collateral_bis_product`, `stg_bcrs_t_cdr`.`guarantee_reference`, `stg_bcrs_t_cdr`.`guarantee_contract_type`, `stg_bcrs_t_cdr`.`guarantee_bis_product`, `stg_bcrs_t_cdr`.`netting_agreement_reference`, `stg_bcrs_t_cdr`.`netting_agreement_type`, `stg_bcrs_t_cdr`.`counterparty_original`, `stg_bcrs_t_cdr`.`counterparty_type_original`, `stg_bcrs_t_cdr`.`counterparty_new`, `stg_bcrs_t_cdr`.`counterparty_type_new`, `stg_bcrs_t_cdr`.`total_annual_sales`, `stg_bcrs_t_cdr`.`total_annual_assets`, `stg_bcrs_t_cdr`.`bis_entity_type_original`, `stg_bcrs_t_cdr`.`bis_entity_type_new`, `stg_bcrs_t_cdr`.`asset_class_original`, `stg_bcrs_t_cdr`.`asset_class_new`, `stg_bcrs_t_cdr`.`method_original`, `stg_bcrs_t_cdr`.`sub_method_original`, `stg_bcrs_t_cdr`.`method_new`, `stg_bcrs_t_cdr`.`sub_method_new`, `stg_bcrs_t_cdr`.`guarantee_method`, `stg_bcrs_t_cdr`.`he`, `stg_bcrs_t_cdr`.`maturity_eff`, `stg_bcrs_t_cdr`.`k_maturity`, `stg_bcrs_t_cdr`.`pd_original`, `stg_bcrs_t_cdr`.`internal_rating_original`, `stg_bcrs_t_cdr`.`pd_new`, `stg_bcrs_t_cdr`.`internal_rating_new`, `stg_bcrs_t_cdr`.`lgd`, `stg_bcrs_t_cdr`.`lgd_grade_agency`, `stg_bcrs_t_cdr`.`ccf`, `stg_bcrs_t_cdr`.`hfx`, `stg_bcrs_t_cdr`.`hc`, `stg_bcrs_t_cdr`.`mm`, `stg_bcrs_t_cdr`.`floor1`, `stg_bcrs_t_cdr`.`floor2`, `stg_bcrs_t_cdr`.`rwa`, `stg_bcrs_t_cdr`.`rgc`, `stg_bcrs_t_cdr`.`rwa_pre_crm`, `stg_bcrs_t_cdr`.`el`, `stg_bcrs_t_cdr`.`beel`, `stg_bcrs_t_cdr`.`bis_past_due`, `stg_bcrs_t_cdr`.`performing_status`, `stg_bcrs_t_cdr`.`rw_scaling_factor`, `stg_bcrs_t_cdr`.`rwa_scaling_factor`, `stg_bcrs_t_cdr`.`equity_scaling_factor`, `stg_bcrs_t_cdr`.`exemption_maturity_floor`, `stg_bcrs_t_cdr`.`grand_fathering_applied`, `stg_bcrs_t_cdr`.`legislated_program_applied`, `stg_bcrs_t_cdr`.`non_material_equity`, `stg_bcrs_t_cdr`.`zero_rw_for_equity`, `stg_bcrs_t_cdr`.`zero_haircut_for_repo`, `stg_bcrs_t_cdr`.`k_function_used`, `stg_bcrs_t_cdr`.`ead_formula`, `stg_bcrs_t_cdr`.`risk_type`, `stg_bcrs_t_cdr`.`trading_book_type`, `stg_bcrs_t_cdr`.`table_name`, `stg_bcrs_t_cdr`.`exposure_attribute_1`, `stg_bcrs_t_cdr`.`exposure_attribute_2`, `stg_bcrs_t_cdr`.`exposure_attribute_3`, `stg_bcrs_t_cdr`.`exposure_attribute_4`, `stg_bcrs_t_cdr`.`exposure_attribute_5`, `stg_bcrs_t_cdr`.`exposure_attribute_6`, `stg_bcrs_t_cdr`.`exposure_attribute_7`, `stg_bcrs_t_cdr`.`exposure_attribute_8`, `stg_bcrs_t_cdr`.`exposure_attribute_9`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_1`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_2`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_3`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_4`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_5`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_6`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_7`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_8`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_9`, `stg_bcrs_t_cdr`.`collateral_attribute_1`, `stg_bcrs_t_cdr`.`collateral_attribute_2`, `stg_bcrs_t_cdr`.`collateral_attribute_3`, `stg_bcrs_t_cdr`.`collateral_attribute_4`, `stg_bcrs_t_cdr`.`collateral_attribute_5`, `stg_bcrs_t_cdr`.`collateral_attribute_6`, `stg_bcrs_t_cdr`.`collateral_attribute_7`, `stg_bcrs_t_cdr`.`collateral_attribute_8`, `stg_bcrs_t_cdr`.`collateral_attribute_9`, `stg_bcrs_t_cdr`.`guarantee_attribute_1`, `stg_bcrs_t_cdr`.`guarantee_attribute_2`, `stg_bcrs_t_cdr`.`guarantee_attribute_3`, `stg_bcrs_t_cdr`.`guarantee_attribute_4`, `stg_bcrs_t_cdr`.`guarantee_attribute_5`, `stg_bcrs_t_cdr`.`guarantee_attribute_6`, `stg_bcrs_t_cdr`.`guarantee_attribute_7`, `stg_bcrs_t_cdr`.`guarantee_attribute_8`, `stg_bcrs_t_cdr`.`guarantee_attribute_9`, `stg_bcrs_t_cdr`.`inter_company`, `stg_bcrs_t_cdr`.`rwa_pre_cap`, `stg_bcrs_t_cdr`.`rw_original`, `stg_bcrs_t_cdr`.`rw_new`, `stg_bcrs_t_cdr`.`tier1_deduction`, `stg_bcrs_t_cdr`.`tier2_deduction`, `stg_bcrs_t_cdr`.`securitized`, `stg_bcrs_t_cdr`.`seniority_original`, `stg_bcrs_t_cdr`.`seniority_new`, `stg_bcrs_t_cdr`.`collateral_product_category`, `stg_bcrs_t_cdr`.`dealbook`, `stg_bcrs_t_cdr`.`deal_status`, `stg_bcrs_t_cdr`.`sub_reference`, `stg_bcrs_t_cdr`.`securitization_reference`, `stg_bcrs_t_cdr`.`securitization_n`, `stg_bcrs_t_cdr`.`waterfall_seniority`, `stg_bcrs_t_cdr`.`risk_country`, `stg_bcrs_t_cdr`.`zone_a_original`, `stg_bcrs_t_cdr`.`zone_a_new`, `stg_bcrs_t_cdr`.`lgd_mitigation`, `stg_bcrs_t_cdr`.`crm_method`, `stg_bcrs_t_cdr`.`look_through_treatment`, `stg_bcrs_t_cdr`.`second_loss_treatment`, `stg_bcrs_t_cdr`.`risk_bucket`, `stg_bcrs_t_cdr`.`pool_code`, `stg_bcrs_t_cdr`.`incorporation_country`, `stg_bcrs_t_cdr`.`division_code`, `stg_bcrs_t_cdr`.`secu_loss_position`, `stg_bcrs_t_cdr`.`secu_issue_date`, `stg_bcrs_t_cdr`.`secu_ea_controlled`, `stg_bcrs_t_cdr`.`secu_company_weight`, `stg_bcrs_t_cdr`.`secu_bank_role`, `stg_bcrs_t_cdr`.`secu_mode`, `stg_bcrs_t_cdr`.`import_source`, `stg_bcrs_t_cdr`.`company_code`, `stg_bcrs_t_cdr`.`supervisor_code`, `stg_bcrs_t_cdr`.`ccy_code`, `stg_bcrs_t_cdr`.`settlement_price`, `stg_bcrs_t_cdr`.`days_after_contractual_date`, `stg_bcrs_t_cdr`.`delivery_type`, `stg_bcrs_t_cdr`.`mortgage_alternative`, `stg_bcrs_t_cdr`.`booking_company`, `stg_bcrs_t_cdr`.`booking_company_desc`, `stg_bcrs_t_cdr`.`gaap_code`, `stg_bcrs_t_cdr`.`number_of_obligor`, `stg_bcrs_t_cdr`.`security_positions_ref`, `stg_bcrs_t_cdr`.`guar_sub_reference`, `stg_bcrs_t_cdr`.`flag_adjustment`, `stg_bcrs_t_cdr`.`internal_maturity_class`, `stg_bcrs_t_cdr`.`equity_floor_applied`, `stg_bcrs_t_cdr`.`equity_preferential_treatment`, `stg_bcrs_t_cdr`.`fde_alternative_method`, `stg_bcrs_t_cdr`.`collateral_table_name`, `stg_bcrs_t_cdr`.`collateral_mode`, `stg_bcrs_t_cdr`.`funding_ccy`, `stg_bcrs_t_cdr`.`currency`, `stg_bcrs_t_cdr`.`incorporation_ccy_original`, `stg_bcrs_t_cdr`.`incorporation_ccy_new`, `stg_bcrs_t_cdr`.`credit_substitute`, `stg_bcrs_t_cdr`.`value_date`, `stg_bcrs_t_cdr`.`original_maturity`, `stg_bcrs_t_cdr`.`residual_maturity`, `stg_bcrs_t_cdr`.`booking_company_incorp_country`, `stg_bcrs_t_cdr`.`business_line_code`, `stg_bcrs_t_cdr`.`family`, `stg_bcrs_t_cdr`.`standard_rw_new`, `stg_bcrs_t_cdr`.`standard_rw_original`, `stg_bcrs_t_cdr`.`risk_bucket_original`, `stg_bcrs_t_cdr`.`collateral_assigned_amount`, `stg_bcrs_t_cdr`.`used_amount_facility`, `stg_bcrs_t_cdr`.`rwa_pre_floor_equity`, `stg_bcrs_t_cdr`.`bis_past_due_original`, `stg_bcrs_t_cdr`.`ltv`, `stg_bcrs_t_cdr`.`ltv_current`, `stg_bcrs_t_cdr`.`hr`, `stg_bcrs_t_cdr`.`hcr`, `stg_bcrs_t_cdr`.`und_pool_ref`, `stg_bcrs_t_cdr`.`asset_class_category_original`, `stg_bcrs_t_cdr`.`asset_class_category_new`, `stg_bcrs_t_cdr`.`netting_agreement_amount_1`, `stg_bcrs_t_cdr`.`netting_agreement_amount_2`, `stg_bcrs_t_cdr`.`netting_agreement_amount_3`, `stg_bcrs_t_cdr`.`netting_agreement_amount_4`, `stg_bcrs_t_cdr`.`netting_agreement_amount_5`, `stg_bcrs_t_cdr`.`netting_agreement_amount_6`, `stg_bcrs_t_cdr`.`netting_agreement_amount_7`, `stg_bcrs_t_cdr`.`entity_type_category_original`, `stg_bcrs_t_cdr`.`entity_type_category_new`, `stg_bcrs_t_cdr`.`ead_pro_write_off`, `stg_bcrs_t_cdr`.`ead_pro_discount`, `stg_bcrs_t_cdr`.`cpty_group`, `stg_bcrs_t_cdr`.`counterparty_new_desc`, `stg_bcrs_t_cdr`.`internal_rating_new_rank`, `stg_bcrs_t_cdr`.`uncommited`, `stg_bcrs_t_cdr`.`capital_item`, `stg_bcrs_t_cdr`.`product_gl_criteria`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_ori`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_new`, `stg_bcrs_t_cdr`.`secu_retail_line_fg`, `stg_bcrs_t_cdr`.`secu_uncommited_retail_fg`, `stg_bcrs_t_cdr`.`secu_spread_trapping_ratio`, `stg_bcrs_t_cdr`.`collateral_issuer`, `stg_bcrs_t_cdr`.`coll_issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`collateral_haircut_risk_bucket`, `stg_bcrs_t_cdr`.`guarantor`, `stg_bcrs_t_cdr`.`guarantor_bis_entity_type`, `stg_bcrs_t_cdr`.`ead_pro_gen`, `stg_bcrs_t_cdr`.`pd_pre_floor_original`, `stg_bcrs_t_cdr`.`pd_pre_floor_new`, `stg_bcrs_t_cdr`.`lgd_pre_floor_original`, `stg_bcrs_t_cdr`.`lgd_pre_floor_new`, `stg_bcrs_t_cdr`.`int_rating_agency_original`, `stg_bcrs_t_cdr`.`int_rating_agency_new`, `stg_bcrs_t_cdr`.`cpty_group_original`, `stg_bcrs_t_cdr`.`nominal`, `stg_bcrs_t_cdr`.`add_on`, `stg_bcrs_t_cdr`.`fair_value`, `stg_bcrs_t_cdr`.`amortized_cost`, `stg_bcrs_t_cdr`.`accrued_interest`, `stg_bcrs_t_cdr`.`amortized_cost_no_ias`, `stg_bcrs_t_cdr`.`adjustment_amount`, `stg_bcrs_t_cdr`.`outstanding`, `stg_bcrs_t_cdr`.`original_cost`, `stg_bcrs_t_cdr`.`accrued_fees`, `stg_bcrs_t_cdr`.`past_due_ppal`, `stg_bcrs_t_cdr`.`past_due_int`, `stg_bcrs_t_cdr`.`premium_current`, `stg_bcrs_t_cdr`.`cpty_new_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`cpty_orig_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`effective_epe`, `stg_bcrs_t_cdr`.`ead_method`, `stg_bcrs_t_cdr`.`netting_class`, `stg_bcrs_t_cdr`.`bis_industry_sector_new`, `stg_bcrs_t_cdr`.`bis_industry_sector_original`, `stg_bcrs_t_cdr`.`bis_risk_area_new`, `stg_bcrs_t_cdr`.`bis_risk_area_original`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_new`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_original`, `stg_bcrs_t_cdr`.`risk_country_new`, `stg_bcrs_t_cdr`.`risk_country_original`, `stg_bcrs_t_cdr`.`incorporation_country_new`, `stg_bcrs_t_cdr`.`incorporation_country_original`, `stg_bcrs_t_cdr`.`bis_performing_status`, `stg_bcrs_t_cdr`.`rwa_cap_ratio`, `stg_bcrs_t_cdr`.`exposure_amount_1`, `stg_bcrs_t_cdr`.`exposure_amount_2`, `stg_bcrs_t_cdr`.`final_beneficiary`, `stg_bcrs_t_cdr`.`collateral_valuation_date`, `stg_bcrs_t_cdr`.`unrestricted_psia_pct`, `stg_bcrs_t_cdr`.`restricted_psia_pct`, `stg_bcrs_t_cdr`.`collateral_issued_by_the_bank`, `stg_bcrs_t_cdr`.`guarantee_issued_by_the_bank`, `stg_bcrs_t_cdr`.`rated_borrower`, `stg_bcrs_t_cdr`.`long_short`, `stg_bcrs_t_cdr`.`external_rating_new`, `stg_bcrs_t_cdr`.`external_rating_original`, `stg_bcrs_t_cdr`.`external_rating_agency_new`, `stg_bcrs_t_cdr`.`external_rating_agency_orig`, `stg_bcrs_t_cdr`.`collateral_country`, `stg_bcrs_t_cdr`.`issuer`, `stg_bcrs_t_cdr`.`issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`issuer_country`, `stg_bcrs_t_cdr`.`product_gl_criteria_2`, `stg_bcrs_t_cdr`.`positions_type`, `stg_bcrs_t_cdr`.`eligibility_risk_bucket`, `stg_bcrs_t_cdr`.`retail_purpose`, `stg_bcrs_t_cdr`.`color_id`, `stg_bcrs_t_cdr`.`past_due_days`, `stg_bcrs_t_cdr`.`collateral_asset_class`, `stg_bcrs_t_cdr`.`collateral_standard_rw`, `stg_bcrs_t_cdr`.`collateral_asset_class_cat`, `stg_bcrs_t_cdr`.`collateral_risk_bucket`, `stg_bcrs_t_cdr`.`coll_issuer_incorporation_ccy`, `stg_bcrs_t_cdr`.`fund_composition_ref`, `stg_bcrs_t_cdr`.`secu_retention_percentage`, `stg_bcrs_t_cdr`.`secu_retention_calc_method`, `stg_bcrs_t_cdr`.`rw_add_on`, `stg_bcrs_t_cdr`.`lgd_non_performing`, `stg_bcrs_t_cdr`.`ccf_std`, `stg_bcrs_t_cdr`.`concentration_ratio`, `stg_bcrs_t_cdr`.`ttc_lgd`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_code`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_agency`, `stg_bcrs_t_cdr`.`counterparty_int_rat_code`, `stg_bcrs_t_cdr`.`counterparty_int_rat_agency`, `stg_bcrs_t_cdr`.`gl_strategy_code`, `stg_bcrs_t_cdr`.`k_function_used_original`, `stg_bcrs_t_cdr`.`long_gross_position`, `stg_bcrs_t_cdr`.`short_gross_position`, `stg_bcrs_t_cdr`.`correlation_trading`, `stg_bcrs_t_cdr`.`ead_pro_pre_ccf`, `stg_bcrs_t_cdr`.`ead_pro_write_off_pre_ccf`, `stg_bcrs_t_cdr`.`sup_reg_vers_code`, `stg_bcrs_t_cdr`.`dataset_version`, `stg_bcrs_t_cdr`.`clearing_house_code`, `stg_bcrs_t_cdr`.`contract_maturity_eff`, `stg_bcrs_t_cdr`.`counterparty_code_2`, `stg_bcrs_t_cdr`.`qualifying_transaction`, `stg_bcrs_t_cdr`.`qualifying_ccp`, `stg_bcrs_t_cdr`.`sov_rating_used`, `stg_bcrs_t_cdr`.`sov_rating_used_ori`, `stg_bcrs_t_cdr`.`current_ead_imm`, `stg_bcrs_t_cdr`.`current_maturity_eff_imm`, `stg_bcrs_t_cdr`.`obligor_grade_original`, `stg_bcrs_t_cdr`.`obligor_grade_new`, `stg_bcrs_t_cdr`.`deduction_step`, `stg_bcrs_t_cdr`.`significant_investment`, `stg_bcrs_t_cdr`.`el_std`, `stg_bcrs_t_cdr`.`deduction_pct`, `stg_bcrs_t_cdr`.`indirect_position`, `stg_bcrs_t_cdr`.`std_risk_bucket_ori`, `stg_bcrs_t_cdr`.`std_risk_bucket_new`, `stg_bcrs_t_cdr`.`ccp_dfund_method`, `stg_bcrs_t_cdr`.`secu_underlying_asset_type`, `stg_bcrs_t_cdr`.`margin_period`, `stg_bcrs_t_cdr`.`ead_scalar`, `stg_bcrs_t_cdr`.`crm_first_lien`, `stg_bcrs_t_cdr`.`available_amount`, `stg_bcrs_t_cdr`.`accounting_adjustment_type`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_1`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_2`, `stg_bcrs_t_cdr`.`adjusted_value`, `stg_bcrs_t_cdr`.`ead_before_acc_adj`, `stg_bcrs_t_cdr`.`lgd_before_acc_adj`, `stg_bcrs_t_cdr`.`subset_code`, `stg_bcrs_t_cdr`.`el_rwa_part`, `stg_bcrs_t_cdr`.`industry_sector_original`, `stg_bcrs_t_cdr`.`cds_qualifying`, `stg_bcrs_t_cdr`.`default_date`, `stg_bcrs_t_cdr`.`credit_bureau_name_original`, `stg_bcrs_t_cdr`.`credit_bureau_name_refreshed`, `stg_bcrs_t_cdr`.`fico_original`, `stg_bcrs_t_cdr`.`fico_refreshed`, `stg_bcrs_t_cdr`.`pool_ead_formula`, `stg_bcrs_t_cdr`.`clearing_member`, `stg_bcrs_t_cdr`.`securitization_depth`, `stg_bcrs_t_cdr`.`securitization_loop`, `stg_bcrs_t_cdr`.`bankruptcy_remote`, `stg_bcrs_t_cdr`.`margin_type`, `stg_bcrs_t_cdr`.`collateral_bankruptcy_remote`, `stg_bcrs_t_cdr`.`collateral_margin_type`, `stg_bcrs_t_cdr`.`remargining_frequency`, `stg_bcrs_t_cdr`.`settlement_ccy`, `stg_bcrs_t_cdr`.`vm_extinguishes_mtm`, `stg_bcrs_t_cdr`.`margin_agreement`, `stg_bcrs_t_cdr`.`rw_pre_floor_new`, `stg_bcrs_t_cdr`.`rwa_pre_floor`, `stg_bcrs_t_cdr`.`ccp_exposure_type`, `stg_bcrs_t_cdr`.`carrying_amount`, `stg_bcrs_t_cdr`.`exchange_rate`, `stg_bcrs_t_cdr`.`policy_update`, `stg_bcrs_t_cdr`.`methodology_update`, `stg_bcrs_t_cdr`.`model_update`, `stg_bcrs_t_cdr`.`pd_model_update`, `stg_bcrs_t_cdr`.`lgd_model_update`, `stg_bcrs_t_cdr`.`ccf_model_update`, `stg_bcrs_t_cdr`.`ead_model_update`, `stg_bcrs_t_cdr`.`covered_ead`, `stg_bcrs_t_cdr`.`fi_type`, `stg_bcrs_t_cdr`.`maturity_date`, `stg_bcrs_t_cdr`.`policy_name`, `stg_bcrs_t_cdr`.`methodology_name`, `stg_bcrs_t_cdr`.`model_name`, `stg_bcrs_t_cdr`.`fund_reference`, `stg_bcrs_t_cdr`.`fund_method`, `stg_bcrs_t_cdr`.`fund_depth`, `stg_bcrs_t_cdr`.`fund_initial`, `stg_bcrs_t_cdr`.`rwa_pre_lvr`, `stg_bcrs_t_cdr`.`leverage`, `stg_bcrs_t_cdr`.`rw_el`, `stg_bcrs_t_cdr`.`use_beel`, `stg_bcrs_t_cdr`.`k_ratio`, `stg_bcrs_t_cdr`.`trade_date`, `stg_bcrs_t_cdr`.`sme_ceiling`, `stg_bcrs_t_cdr`.`sme_floor`, `stg_bcrs_t_cdr`.`sme_ceiling_indicator`, `stg_bcrs_t_cdr`.`fund_assets`, `stg_bcrs_t_cdr`.`obligor_grade_rank_original`, `stg_bcrs_t_cdr`.`obligor_grade_sup_original`, `stg_bcrs_t_cdr`.`obligor_grade_inf_original`, `stg_bcrs_t_cdr`.`obligor_grade_rank_new`, `stg_bcrs_t_cdr`.`obligor_grade_sup_new`, `stg_bcrs_t_cdr`.`obligor_grade_inf_new`, `stg_bcrs_t_cdr`.`lgd_grade_inf`, `stg_bcrs_t_cdr`.`lgd_grade_sup`, `stg_bcrs_t_cdr`.`lgd_grade_rank`, `stg_bcrs_t_cdr`.`lgd_grade`, `stg_bcrs_t_cdr`.`conservation_buffer`, `stg_bcrs_t_cdr`.`conservation_rgc`, `stg_bcrs_t_cdr`.`ctcycal_buffer`, `stg_bcrs_t_cdr`.`ctcycal_rgc`, `stg_bcrs_t_cdr`.`sifi_buffer`, `stg_bcrs_t_cdr`.`sifi_rgc`, `stg_bcrs_t_cdr`.`leverage_ead`, `stg_bcrs_t_cdr`.`at1_deduction`, `stg_bcrs_t_cdr`.`cet1_deduction`, `stg_bcrs_t_cdr`.`adjustment_tag`, `stg_bcrs_t_cdr`.`rw_new_grouping`, `stg_bcrs_t_cdr`.`nominal_at_rw_new`, `stg_bcrs_t_cdr`.`ead_at_rw_new`, `stg_bcrs_t_cdr`.`collateral_completed`, `stg_bcrs_t_cdr`.`rep_product`, `stg_bcrs_t_cdr`.`rep_collateral_product`, `stg_bcrs_t_cdr`.`ltv_indexed`, `stg_bcrs_t_cdr`.`origination_date`, `stg_bcrs_t_cdr`.`is_le`, `stg_bcrs_t_cdr`.`rep_industry_sector`, `stg_bcrs_t_cdr`.`scenario_process_step`, `stg_bcrs_t_cdr`.`period_id`, `stg_bcrs_t_cdr`.`period_start_date`, `stg_bcrs_t_cdr`.`period_end_date`, `stg_bcrs_t_cdr`.`scenario_process_name`, `stg_bcrs_t_cdr`.`scenario_process_id`, `stg_bcrs_t_cdr`.`regulatory_scenario_name`, `stg_bcrs_t_cdr`.`rep_asset_class`, `stg_bcrs_t_cdr`.`rep_sub_product`, `stg_bcrs_t_cdr`.`rep_arrears_band_mia`, `stg_bcrs_t_cdr`.`rep_arrears_band_pia`, `stg_bcrs_t_cdr`.`rep_payment_type`, `stg_bcrs_t_cdr`.`weighted_avg_rate`, `stg_bcrs_t_cdr`.`customer_field11`, `stg_bcrs_t_cdr`.`customer_field12`, `stg_bcrs_t_cdr`.`customer_field13`, `stg_bcrs_t_cdr`.`customer_field14`, `stg_bcrs_t_cdr`.`customer_field15`, `stg_bcrs_t_cdr`.`customer_field16`, `stg_bcrs_t_cdr`.`customer_field17`, `stg_bcrs_t_cdr`.`customer_field18`, `stg_bcrs_t_cdr`.`customer_field19`, `stg_bcrs_t_cdr`.`customer_field20`, `stg_bcrs_t_cdr`.`customer_field21`, `stg_bcrs_t_cdr`.`customer_number11`, `stg_bcrs_t_cdr`.`customer_number12`, `stg_bcrs_t_cdr`.`customer_number13`, `stg_bcrs_t_cdr`.`customer_number14`, `stg_bcrs_t_cdr`.`customer_number15`, `stg_bcrs_t_cdr`.`customer_number16`, `stg_bcrs_t_cdr`.`customer_number17`, `stg_bcrs_t_cdr`.`customer_number18`, `stg_bcrs_t_cdr`.`customer_date1`, `stg_bcrs_t_cdr`.`customer_date2`, `stg_bcrs_t_cdr`.`customer_date3`, `stg_bcrs_t_cdr`.`rep_major_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_major_asset_class_new`, `stg_bcrs_t_cdr`.`rep_asset_class_new`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_new`, `stg_bcrs_t_cdr`.`rep_maturity_band`, `stg_bcrs_t_cdr`.`rep_segmentation`, `stg_bcrs_t_cdr`.`src_reporting_date`, `stg_bcrs_t_cdr`.`src_wks_name`, `stg_bcrs_t_cdr`.`src_position`, `stg_bcrs_t_cdr`.`generic_reporting_date`, `stg_bcrs_t_cdr`.`generic_wks_name`, `stg_bcrs_t_cdr`.`generic_position`, `stg_bcrs_t_cdr`.`securitization_mm`, `stg_bcrs_t_cdr`.`securitization_mm_factor`, `stg_bcrs_t_cdr`.`is_eligible_cva`, `stg_bcrs_t_cdr`.`audit_cva_eligibility`, `stg_bcrs_t_cdr`.`ead_pro_cva`, `stg_bcrs_t_cdr`.`generic_field1`, `stg_bcrs_t_cdr`.`generic_field2`, `stg_bcrs_t_cdr`.`generic_field3`, `stg_bcrs_t_cdr`.`generic_field4`, `stg_bcrs_t_cdr`.`generic_field5`, `stg_bcrs_t_cdr`.`generic_field6`, `stg_bcrs_t_cdr`.`generic_field7`, `stg_bcrs_t_cdr`.`generic_field8`, `stg_bcrs_t_cdr`.`generic_field9`, `stg_bcrs_t_cdr`.`generic_field10`, `stg_bcrs_t_cdr`.`generic_number1`, `stg_bcrs_t_cdr`.`generic_number2`, `stg_bcrs_t_cdr`.`generic_number3`, `stg_bcrs_t_cdr`.`generic_number4`, `stg_bcrs_t_cdr`.`generic_number5`, `stg_bcrs_t_cdr`.`generic_number6`, `stg_bcrs_t_cdr`.`generic_number7`, `stg_bcrs_t_cdr`.`generic_number8`, `stg_bcrs_t_cdr`.`generic_number9`, `stg_bcrs_t_cdr`.`generic_number10`, `stg_bcrs_t_cdr`.`customer_field1`, `stg_bcrs_t_cdr`.`customer_field2`, `stg_bcrs_t_cdr`.`customer_field3`, `stg_bcrs_t_cdr`.`customer_field4`, `stg_bcrs_t_cdr`.`customer_field5`, `stg_bcrs_t_cdr`.`customer_field6`, `stg_bcrs_t_cdr`.`customer_field7`, `stg_bcrs_t_cdr`.`customer_field8`, `stg_bcrs_t_cdr`.`customer_field9`, `stg_bcrs_t_cdr`.`customer_field10`, `stg_bcrs_t_cdr`.`customer_number1`, `stg_bcrs_t_cdr`.`customer_number2`, `stg_bcrs_t_cdr`.`customer_number3`, `stg_bcrs_t_cdr`.`customer_number4`, `stg_bcrs_t_cdr`.`customer_number5`, `stg_bcrs_t_cdr`.`customer_number6`, `stg_bcrs_t_cdr`.`customer_number7`, `stg_bcrs_t_cdr`.`customer_number8`, `stg_bcrs_t_cdr`.`customer_number9`, `stg_bcrs_t_cdr`.`customer_number10`, `stg_bcrs_t_cdr`.`run_date`, `stg_bcrs_t_cdr`.`process_profile_sr_id`, `stg_bcrs_t_cdr`.`conso_perimeter`, `stg_bcrs_t_cdr`.`interco`, `stg_bcrs_t_cdr`.`interco_type`, `stg_bcrs_t_cdr`.`valid_cpy_perimeter`, `stg_bcrs_t_cdr`.`issuer_id`, `stg_bcrs_t_cdr`.`approver_id`, `stg_bcrs_t_cdr`.`upload_date`, `stg_bcrs_t_cdr`.`approval_date`, `stg_bcrs_t_cdr`.`adj_batch_date`, `stg_bcrs_t_cdr`.`source_file_name`, `stg_bcrs_t_cdr`.`adj_seq`, `stg_bcrs_t_cdr`.`dp_rule_log`, `stg_bcrs_t_cdr`.`staging_source`, `stg_bcrs_t_cdr`.`id`, `stg_bcrs_t_cdr`.`parent_id`, `stg_bcrs_t_cdr`.`child_id`, `stg_bcrs_t_cdr`.`multipurpose_audit`, `stg_bcrs_t_cdr`.`saccr_pfe`, `stg_bcrs_t_cdr`.`saccr_rc`, `stg_bcrs_t_cdr`.`flag_deduction`, `stg_bcrs_t_cdr`.`w_snapshot_dt`, `stg_bcrs_t_cdr`.`w_datasource_id`, `stg_bcrs_t_cdr`.`w_country_cd`, `stg_bcrs_t_cdr`.`w_batch_id`,          (                 CASE                     WHEN nvl(`stg_bcrs_t_cdr`.`table_name`,'z') IN (                         'BOND',                         'EQUITY',                         'TRANCHE',                         'CONVERTIBLE',                         'FUND'                     ) THEN 'SECURITY_POSITIONS'                     ELSE nvl(`stg_bcrs_t_cdr`.`table_name`,'z')                 END             ) AS `sec_table_name`,             substr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'/') + 1,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'-') - (instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'/') + 1) ) `management_product`,             substr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'-') + 1,2) `business_indentifier`         FROM             `sgmisitstg`.`stg_bcrs_t_cdr`   ) `t`   left join `sgmisitstg`.`stg_bcrs_companies_links` `complink` on `t`.`booking_company` = `complink`.`child_code` AND CASE WHEN 'WS29' like '%ADJ%' THEN `complink`.`w_batch_id` = '2018071116473300773' ELSE `complink`.`w_batch_id` = '2018071116473300773' END  left join (          SELECT `stg_bcrs_t_cdr`.`contract_reference`, SUM(`stg_bcrs_t_cdr`.`rwa`) AS `SUM_RWA`         FROM `sgmisitstg`.`stg_bcrs_t_cdr`         WHERE `stg_bcrs_t_cdr`.`w_batch_id` = '2018071116473300773'         GROUP BY `stg_bcrs_t_cdr`.`contract_reference`         ) `t2` on `t`.`contract_reference` = `t2`.`contract_reference`          left join `sgmisitstg`.`stg_bcrs_scb_gpr_default_indicator` `grpdfind` on `t`.`contract_type` = `grpdfind`.`indicator_value` AND CASE WHEN 'WS29' like '%ADJ%' THEN `grpdfind`.`w_batch_id` = '2018071116473300773' ELSE `grpdfind`.`w_batch_id` = '2018071116473300773' END  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_csr`.`contract_reference`,             `stg_bcrs_csr`.`start_date`,             `stg_bcrs_csr`.`maturity_date`,             `stg_bcrs_csr`.`value_date`         FROM `sgmisitstg`.`stg_bcrs_csr`         WHERE `stg_bcrs_csr`.`import_source` NOT LIKE '%WB%'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `stg_bcrs_csr`.`w_batch_id` = '2018071116473300773' ELSE `stg_bcrs_csr`.`w_batch_id` = '2018071116473300773' END ) `csr` ON `t`.`contract_reference` = `csr`.`contract_reference`  LEFT JOIN ( SELECT DISTINCT             `e`.`entity_code`,             `e`.`entity_desc`,             `e`.`attribute_4`,             `e`.`attribute_1`,             `e`.`incorporation_country`,             `e`.`origination_country`,             `cfi`.`scorecard_segment_code`,             `cfi`.`scorecard_segment_category`,             `cfi`.`cf_indicator`,             `e`.`attribute_7`,             `cd1`.`code_desc` AS `customer_segment_desc`,             `e`.`attribute_8`,             `cd2`.`code_desc` AS `customer_subsegment_desc`,             `e`.`et_code_user`,             `icr`.`long_term_rating`,             `icr`.`long_term_rating_local_ccy`,             `e`.`country_code`             , `el`.`bf_link_type`             , `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`  `e`                   LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON `e`.`entity_code` = `icr`.`entity_code`                                                    AND nvl(`icr`.`agency_code`,'z') = 'INTERNAL'                                                    AND `icr`.`w_batch_id` = '2018071116473300773'           LEFT JOIN ( SELECT DISTINCT  `links`.`child_code`,                          case when `linktype`.`link_type` is not null then 'BUYER_FINANCE' else null end `bf_link_type`                         FROM `sgmisitstg`.`stg_bcrs_entity_links` `links` left join (SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                 FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`) `linktype`                                  WHERE `links`.`link_type` IN ( SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                         FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`   ))  `el`              ON `e`.`entity_code` = `el`.`child_code`                      LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_co_fi` `cfi` ON `e`.`attribute_1` = `cfi`.`scorecard_segment`         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cfi`.`w_batch_id` = '2018071116473300773' ELSE `cfi`.`w_batch_id` = '2018071116473300773' END                  LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')         AND `cd1`.`code_type` = 'CUST_SEG'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd1`.`w_batch_id` = '2018071116473300773' ELSE `cd1`.`w_batch_id` = '2018071116473300773' END                  LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd2` ON nvl(`cd2`.`code`,'zz') = nvl(`e`.`attribute_8`,'zz')         AND `cd2`.`code_type` = 'CUST_SUB_SEG'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd2`.`w_batch_id` = '2018071116473300773' ELSE `cd2`.`w_batch_id` = '2018071116473300773' END          ) `e` ON `t`.`counterparty_original` = `e`.`entity_code` AND `e`.`w_batch_id` = '2018071116473300773'  LEFT JOIN (         SELECT DISTINCT             `e`.`entity_code`,             `e`.`attribute_7` AS `group_cust_segment_code`,             `cd1`.`code_desc` AS `group_cust_segment_desc`,             `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity` `e`                           LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')                    AND `cd1`.`code_type` = 'CUST_SEG'                    AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd1`.`w_batch_id` = '2018071116473300773' ELSE `cd1`.`w_batch_id` = '2018071116473300773' END ) `egroup_orig` ON `t`.`cpty_group_original` = `egroup_orig`.`entity_code`  and `e`.`w_batch_id` = '2018071116473300773'  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_entity`.`entity_code`,             `stg_bcrs_entity`.`attribute_1`,             `stg_bcrs_entity`.`origination_country`,             `stg_bcrs_entity`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`         where `stg_bcrs_entity`.`w_batch_id` = '2018071116473300773' ) `enew` ON `t`.`counterparty_new` = `enew`.`entity_code`   LEFT JOIN ( SELECT             `stg_bcrs_companies`.`company_code`,             `stg_bcrs_companies`.`country_code`,             `stg_bcrs_companies`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_companies`         where `stg_bcrs_companies`.`w_batch_id` = '2018071116473300773' ) `cpies` ON `t`.`booking_company` = `cpies`.`company_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_scb_wb_bf_uns_recoveries`.`domicile_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`booking_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`contract_type`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`cf_ind`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`prr`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`         where CASE WHEN 'WS29' like '%ADJ%' THEN `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2018071116473300773' ELSE `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2018071116473300773' END     ) `bf` ON `bf`.`domicile_country_code` = `e`.`country_code`             AND `bf`.`booking_country_code` = `cpies`.`country_code`             AND `bf`.`contract_type` = `t`.`contract_type`             AND `bf`.`cf_ind` = `e`.`cf_indicator`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_contract_types`.`ct_code_user`,             `stg_bcrs_contract_types`.`ct_desc_user`,             `stg_bcrs_contract_types`.`attribute_2`,             `stg_bcrs_contract_types`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_contract_types`             where              `stg_bcrs_contract_types`.`w_batch_id` = '2018071116473300773'      ) `ct` ON `t`.`contract_type` = `ct`.`ct_code_user`  Left Join ( select distinct  `stg_bcrs_contract_types`.`ct_code_user`, `stg_bcrs_contract_types`.`contract_category`, `stg_bcrs_contract_types`.`w_batch_id` from  `sgmisitstg`.`stg_bcrs_contract_types` where   `stg_bcrs_contract_types`.`w_batch_id` = '2018071116473300773' and `stg_bcrs_contract_types`.`contract_category` = 'RECEIVABLE' ) `contracttype` on `t`.`contract_type` = `contracttype`.`ct_code_user`           LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`attribute_7` AS `non_gam_ind`,             `stg_bcrs_facility`.`attribute_8` AS `holdco_ind`,             `stg_bcrs_facility`.`trade_date`,             `stg_bcrs_facility`.`maturity_date`         FROM             `sgmisitstg`.`stg_bcrs_facility`         WHERE              `stg_bcrs_facility`.`w_batch_id` = '2018071116473300773'      ) `fac` ON `t`.`contract_reference` = `fac`.`contract_reference`      LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_mkt_fx_input`.`booking_company_code`,             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL'             AND `stg_bcrs_mkt_fx_input`.`w_batch_id` = '2018071116473300773'      ) `cer` ON `t`.`booking_company` = `cer`.`booking_company_code`              AND `t`.`currency` = `cer`.`ccy_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_country`.`country_code`,             `stg_bcrs_country`.`country_name`         FROM             `sgmisitstg`.`stg_bcrs_country`         WHERE              `stg_bcrs_country`.`w_batch_id` = '2018071116473300773'      ) `c` ON `t`.`incorporation_country_original` = `c`.`country_code`      LEFT JOIN (     select `prrsrtmp`.`contract_reference`, `prrsrtmp`.`bs_type`, `prrsrtmp`.`prr`, `prrsrtmp`.`w_batch_id`, `prrsrtmp`.`rnk` from (         SELECT DISTINCT             `stg_bcrs_scb_sme_prr_sr`.`contract_reference`,              `stg_bcrs_scb_sme_prr_sr`.`bs_type`,              `stg_bcrs_scb_sme_prr_sr`.`prr`,              `stg_bcrs_scb_sme_prr_sr`.`w_batch_id`,             ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_sme_prr_sr`.`contract_reference` ORDER BY `stg_bcrs_scb_sme_prr_sr`.`contract_reference`) AS `rnk`         FROM             `sgmisitstg`.`stg_bcrs_scb_sme_prr_sr` ) `prrsrtmp`         where             `prrsrtmp`.`rnk` = 1     ) `prrsr` ON `t`.`contract_reference` = `prrsr`.`contract_reference`              AND `t`.`bs_type` = `prrsr`.`bs_type` and `prrsr`.`w_batch_id` = '2018071116473300773'                      LEFT JOIN (             select `addtinst`.`contract_reference`, `addtinst`.`table_name`, `addtinst`.`tp_portfolio_name`, `addtinst`.`psgl_department_id`, `addtinst`.`psgl_product_code`, `addtinst`.`psgl_operating_unit`, `addtinst`.`psgl_customer_class`, `addtinst`.`rnk` from (                 SELECT                     `stg_bcrs_scb_wb_addt_inst`.`contract_reference`,                     `stg_bcrs_scb_wb_addt_inst`.`table_name`,                     `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`,                     ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ORDER BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`) AS `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2018071116473300773') `addtinst`                              WHERE                         `addtinst`.`rnk` = 1     ) `inst` ON `inst`.`contract_reference` = `t`.`contract_reference`               AND `inst`.`table_name` = `t`.`sec_table_name`                               LEFT JOIN (         SELECT             nvl(`split_ref`.`contract_reference`,`a`.`contract_reference`) `contract_reference`,             `a`.`psgl_cust_class`,             `a`.`psgl_product`,             TRIM(`a`.`psgl_department`) `psgl_department`,             `a`.`fermat_table_name`         FROM             (                 SELECT DISTINCT                     `b`.`contract_reference`,                     `b`.`fermat_table_name`,                     `b`.`psgl_cust_class`,                     `b`.`psgl_product`,                     `b`.`psgl_department`,                     `c`.`priority`,                     ROW_NUMBER() OVER(PARTITION BY `b`.`contract_reference`, `b`.`fermat_table_name` ORDER BY `c`.`priority`) `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_sme_psgl` `b`                     left join `sgmisitstg`.`stg_bcrs_scb_wb_amt_cat_priority` `c`                                         on `b`.`fermat_table_name` = `c`.`table_name`                      and `b`.`amount_category_dw_sorsa` = `c`.`amount_category_dw_sorsa`                     and `b`.`psgl_product` <> 'ZZZ'                     and `b`.`w_batch_id`='2018071116473300773'                      and `b`.`w_batch_id` = `c`.`w_batch_id`                                     ) `a`             left join             (                 SELECT DISTINCT                     `stg_bcrs_facility_links`.`contract_reference`,                     `stg_bcrs_facility_links`.`attribute_1` AS `orig_cont_ref`                 FROM                     `sgmisitstg`.`stg_bcrs_facility_links`                 WHERE                     `stg_bcrs_facility_links`.`attribute_1` IS NOT NULL and `stg_bcrs_facility_links`.`w_batch_id`='2018071116473300773'             ) `split_ref`         on             `a`.`contract_reference` = `split_ref`.`orig_cont_ref`             where   `a`.`rnk` = 1     ) `psgl` ON `t`.`contract_reference` = `psgl`.`contract_reference`               AND `t`.`sec_table_name` = `psgl`.`fermat_table_name`                                                 LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_mpdt_mru_map`.`mru_desc`,             `stg_bcrs_scb_wb_mpdt_mru_map`.`mpdt_code`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_mpdt_mru_map` where `stg_bcrs_scb_wb_mpdt_mru_map`.`w_batch_id`='2018071116473300773'     ) `mru_bus` ON `mru_bus`.`mpdt_code` = `t`.`management_product`                        LEFT JOIN `sgmisitstg`.`stg_bcrs_fdw_netting_agreement` `net` ON `net`.`agreement_reference` = `t`.`netting_agreement_reference`     and `net`.`w_batch_id`='2018071116473300773'          LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_fac_sub_limits`.`id`,             `stg_bcrs_scb_wb_fac_sub_limits`.`contract_reference`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_attribute`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_amount`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_fac_sub_limits` where `stg_bcrs_scb_wb_fac_sub_limits`.`w_batch_id`='2018071116473300773'     ) `sub` ON `t`.`id` = `sub`.`id`          LEFT JOIN (         SELECT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`book_code`,             `stg_bcrs_facility`.`currency`         FROM             `sgmisitstg`.`stg_bcrs_facility` where `stg_bcrs_facility`.`w_batch_id`='2018071116473300773'     ) `fac_curr` ON `sub`.`contract_reference` = `fac_curr`.`contract_reference`       LEFT JOIN (         SELECT             `stg_bcrs_deal_book`.`booking_company`,             `stg_bcrs_deal_book`.`book_code`         FROM             `sgmisitstg`.`stg_bcrs_deal_book` where `stg_bcrs_deal_book`.`w_batch_id`='2018071116473300773'     ) `dealbook` ON `dealbook`.`book_code` = `fac_curr`.`book_code`          LEFT JOIN (         SELECT             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`,             `stg_bcrs_mkt_fx_input`.`booking_company_code`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL' and `stg_bcrs_mkt_fx_input`.`w_batch_id`='2018071116473300773'     ) `fac_curr_exch` ON `fac_curr_exch`.`ccy_code` = `fac_curr`.`currency`                        AND `fac_curr_exch`.`booking_company_code` = `dealbook`.`booking_company`                               LEFT JOIN (         SELECT             `stg_bcrs_t_cva`.`contract_reference`,             count(`stg_bcrs_t_cva`.`contract_reference`) as `count_contract_ref`,             SUM(nvl(`stg_bcrs_t_cva`.`cva_rwa`,0) ) `cva_rwa`         FROM             `sgmisitstg`.`stg_bcrs_t_cva` where `stg_bcrs_t_cva`.`w_batch_id`='2018071116473300773'         GROUP BY             `stg_bcrs_t_cva`.`contract_reference`     ) `tcva` ON `tcva`.`contract_reference` = `t`.`contract_reference`              LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_mru_business_idntfr_map` `bus_ind`      ON `bus_ind`.`business_identifier` = `t`.`business_indentifier` and `bus_ind`.`w_batch_id`='2018071116473300773'      where `t`.`w_batch_id` = '2018071116473300773'      and `t`.`import_source` NOT LIKE '%WB%'         and `t`.`w_snapshot_dt` = '2018-04-30'     and `t`.`w_datasource_id` = 'BCRS_ND'     and `t`.`w_country_cd`='SG'       union all  SELECT distinct                      `t`.`partition_key`,     'WB' as `banking_type`,     `t`.`method_new`,     `t`.`method_original`,     `t`.`contract_reference`,     `t`.`tranche_collateral_type`,     `t`.`tranche_guarantee_type`,     `t`.`counterparty_original`,     `e`.`entity_desc` AS `counterparty_original_desc`,     `t`.`counterparty_new`,     `t`.`counterparty_new_desc`,     `t`.`table_name`,     `t`.`bis_past_due`,     `t`.`contract_type`,     `ct`.`ct_desc_user` AS `contract_desc`,     `e`.`cf_indicator`,     (         CASE             WHEN upper(`t`.`counterparty_original`) LIKE '%_CORPORATE%'                  OR upper(`t`.`counterparty_original`) LIKE '%_BANK%'                  OR `t`.`counterparty_original` = '9999999999-1'                  OR `t`.`counterparty_original` = '9999999998-1' THEN 'Y'             ELSE 'N'         END     ) AS `unmapped_ind`,     (         CASE             WHEN upper(`e`.`attribute_4`) = 'CN' THEN 'Y'             ELSE 'N'         END     ) AS `non_borrowing_ind`,     (         CASE  WHEN `contracttype`.`ct_code_user` is not null THEN 'PURCHASED_RECEIVABLE'             WHEN `t`.`contract_type` IN ( 'GMGMKTPTEQ' ) THEN 'PRIVATE_EQUITY'             WHEN `t`.`contract_type` IN ( 'GMGMKTAINV', 'GMGMKTANPL'  ) THEN 'ALT_INVST'             WHEN `e`.`et_code_user` IN (  'BSC16',  'BSC23'  ) THEN 'DEV_ORG'             WHEN `e`.`et_code_user` IN (  'BSC24' ) THEN 'PERSONAL'             WHEN `e`.`scorecard_segment_code` IN (  'CFSC'   ) THEN 'SME'             WHEN `e`.`scorecard_segment_category` IN (  'F1'  ) THEN 'BANK'             WHEN `e`.`scorecard_segment_category` IN (  'F2', 'F3'  ) THEN 'NBFI'             WHEN `e`.`scorecard_segment_category` IN (  'S1' ) THEN 'SOV'             WHEN `e`.`scorecard_segment_category` IN (  'C1', 'C2', 'C3', 'C4' ) THEN 'CORP'             ELSE 'CORP'         END     ) AS `segment_original`,     (         CASE             WHEN `t`.`table_name` IN (                 'DEAL_IMPORT',                 'CREDIT_DERIVATIVE'             ) THEN 'T'             ELSE 'F'         END     ) AS `derivative_ind`,     `t`.`incorporation_country_original`,     `c`.`country_name`,     `t`.`dealbook`,     `t`.`booking_company_desc`,     `e`.`attribute_1` AS `scorecard_original`,     `t`.`internal_rating_new`,     `t`.`pd_new`,     `t`.`internal_rating_original`,     `t`.`pd_original`,     (         CASE             WHEN nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`method_new` = 'ADV'                  AND `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED' THEN 0.45             WHEN `t`.`import_source` = 'NONTP-WBAJ'                  AND `t`.`method_new` = 'ADV' THEN `t`.`exposure_attribute_7`              WHEN (                 ( `t`.`tranche_collateral_type` = 'COLLATERALIZED' )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') <> 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`lgd`             WHEN (                 (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'GUARANTEED'                 )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') = 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`exposure_attribute_7`              ELSE 0         END     ) AS `lgd`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY'             ) THEN `t`.`outstanding`             ELSE 0         END     ) AS `outstanding`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY'             ) THEN `t`.`accrued_interest`             ELSE 0         END     ) AS `accrued_interest`,     (         CASE             WHEN `t`.`table_name` IN (                 'FACILITY'             )                  AND `t`.`bs_type` = 'OFB' THEN `t`.`outstanding`             ELSE 0         END     ) AS `headroom`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN `t`.`fair_value`             ELSE 0         END     ) AS `mtm`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN (                         CASE                             WHEN `t`.`fair_value` > 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                     ELSE (                         CASE                             WHEN `t`.`fair_value` < 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                 END             )             ELSE 0         END     ) AS `replacement_cost`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`t`.`nominal`) *-1                     ELSE abs(`t`.`nominal`)                 END             )             ELSE 0         END     ) AS `notional`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN `t`.`add_on`             ELSE 0         END     ) AS `add_on`,     `t`.`ead`,     `t`.`rwa`,     `t`.`rwa_pre_crm`,     `t`.`el`,     `t`.`rgc`,     `t`.`ead_original`,     `t`.`tier1_deduction`,     `t`.`tier2_deduction`,     `t`.`ead_pre_ccf`,     `t`.`nominal`,     `t`.`fair_value`,     `t`.`ead_pro`,     `t`.`ead_pro_gen`,     nvl(`prrsr`.`prr`,0) `prr`,     ( `t`.`ead` * `t`.`pd_original` ) AS `wt_pd_original`,     ( `t`.`ead` * `t`.`pd_new` ) AS `wt_pd_new`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45 * `t`.`ead`             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd` * `t`.`ead`             ELSE 0         END     ) AS `wt_lgd`,     ( `t`.`ead` * `t`.`k_maturity` ) AS `wt_k_maturity`,     ( `t`.`ead` * `t`.`residual_maturity` ) AS `wt_residual_maturity`,     `t`.`total_annual_sales`,     `t`.`hfx`,     `t`.`hc`,     `t`.`he`,     `t`.`k_maturity`,     `t`.`facility_reference`,     `t`.`performing_status`,     `t`.`securitization_reference`,     `t`.`days_after_contractual_date`,     `t`.`risk_bucket`,     `t`.`delivery_type`,     `t`.`funding_ccy`,     coalesce( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr`.`currency`             ELSE `t`.`currency`         END     ),`t`.`currency`) AS `currency`,     `t`.`residual_maturity`,     `t`.`original_maturity`,     `t`.`ead_method`,     `t`.`ccf`,     `t`.`inter_company`,     `t`.`trading_book_type`,     `e`.`attribute_7` AS `customer_segment_code`,     `e`.`customer_segment_desc`,     `e`.`attribute_8` AS `customer_subsegment_code`,     `e`.`customer_subsegment_desc`,     `t`.`id`,     `t`.`import_source`,     `t`.`product_gl_criteria`,     `t`.`bs_type`,     `t`.`securitized`,     `t`.`risk_type`,     `t`.`bis_product`,     `t`.`bis_product_category`,     `t`.`bis_entity_type_new`,     `t`.`bis_entity_type_original`,     `t`.`asset_class_new`,     `t`.`asset_class_original`,     `t`.`netting_agreement_reference`,     `t`.`collateral_reference`,     `t`.`collateral_contract_type`,     `t`.`collateral_bis_product`,     `t`.`collateral_product_category`,     `t`.`guarantee_reference`,     `t`.`guarantee_contract_type`,     `t`.`guarantee_bis_product`,     `t`.`counterparty_type_new`,     `t`.`sub_method_new`,     `t`.`rw_scaling_factor`,     `t`.`rwa_scaling_factor`,     `t`.`exposure_attribute_7`,     `t`.`exposure_attribute_8`,     `t`.`exposure_attribute_9`,     `t`.`rw_original`,     `t`.`rw_new`,     `t`.`securitization_n`,     `t`.`crm_method`,     `t`.`division_code`,     `t`.`secu_ea_controlled`,     `t`.`secu_company_weight`,     `t`.`secu_bank_role`,     `t`.`obligor_grade_new`,     `t`.`standard_rw_original`,     `t`.`standard_rw_new`,     `t`.`cpty_group`,     `t`.`cpty_group_original`,     `t`.`bis_industry_sector_new`,     `t`.`bis_industry_sector_original`,     `t`.`bis_risk_area_new`,     `t`.`bis_risk_area_original`,     `t`.`incorporation_country_new`,     `t`.`int_rating_agency_new`,     `t`.`risk_country`,     `t`.`used_amount_facility`,     `t`.`beel`,     `t`.`uncommited`,          case when `csr`.`start_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0) - nvl(`t`.`original_maturity`,0)) * 365.25) as INT)) as date)     else `csr`.`start_date` end as `start_date`,       case when `csr`.`maturity_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0)) * 365.25) as INT)) as date)      else `csr`.`maturity_date` end as `maturity_date`,          `t`.`value_date`,     (         CASE             WHEN nvl(`t`.`residual_maturity`,0) <= 1               THEN '<=1yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 3 and nvl(`t`.`residual_maturity`,0) > 1  THEN '1-3yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 5 and nvl(`t`.`residual_maturity`,0) > 3  THEN '3-5yrs'             ELSE '>5yrs'         END     ) AS `maturity_range`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd`             ELSE 0         END     ) AS `tranche_lgd`,         CASE WHEN (`complink`.`mother_code` = '999C' or `complink`.`mother_code` = '976C') and `complink`.`child_code` is not null then 'SOLO'          ELSE 'SUBS' END `company_type`,     nvl(`mru_bus`.`mru_desc`,'UNMAPPED') AS `business`,     `inst`.`psgl_operating_unit` AS `psgl_operating_unit`,     `psgl`.`psgl_cust_class`,     (         CASE             WHEN `t`.`table_name` = 'TRANCHE'                  AND `t`.`bs_type` IN(                 'VIF','VIR'             ) THEN 'TRANCHE_FILTER'             WHEN `t`.`inter_company` = 'T' THEN 'INTERCOMPANY_FILTER'             ELSE 'BCRS'         END     )   AS `filter_type`,     (         CASE             WHEN `t`.`securitized` = 'T'   THEN 'SECURITIZED'             WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'             WHEN `t`.`trading_book_type` = 'T'                  AND `t`.`bis_product_category` IN(                 'REPO','DERIVATIVE','DERIVATIVE_OTC','CREDIT_DERIVATIVE'             ) THEN 'CCR'             WHEN `t`.`tranche_collateral_type` = 'COLLATERALIZED'                  AND `t`.`collateral_bis_product` IN(                 'REP_NET_COL','OTC_NET_COL'             ) THEN 'NETTING_BENEFIT'             ELSE 'FSA'         END     )  AS `fsa_exclusion_type`,     (         CASE             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_past_due` = 'T' THEN 'PAST_DUE_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`asset_class_new` = 'CLAIM_OTH_150'                 OR (                     (                         (                             `t`.`rw_original` >= 1.5                             OR `t`.`standard_rw_original` >= 1.5                         )                         AND NOT (                             (                                 `t`.`tranche_collateral_type` = 'COLLATERALIZED'                                 AND `t`.`crm_method` = 'SIM'                                 AND `t`.`collateral_product_category` = 'FINANCIAL_COL'                             )                             OR `t`.`tranche_guarantee_type` = 'GUARANTEED'                         )                     )                     OR `t`.`rw_new` >= 1.5                 )             ) THEN 'HIGH_RISK_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 ( `t`.`asset_class_new` LIKE '%EQT' )                 OR (                     `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                     AND `t`.`sub_reference` = 'MULTI NAME'                 )                 OR ( `t`.`risk_type` = 'RVR' )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` IN (                 'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE',                 'CLAIM_SEC_CRE',                 'CLAIM_FULL_SEC_RRE'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`collateral_bis_product` IN (                 'RRE_COL',                 'LEASING_CRE_COL',                 'CRE_COL',                 'LEASING_RRE_COL'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_COVERED_BOND' THEN 'COVERED_BONDS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_CIU' THEN 'COLLECTIVE_INV_UNDERTAKINGS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF',                 'CORP',                 'INSURANCE',                 'CORP_CF',                 'CORP_HVCRE',                 'CORP_IPRE',                 'CORP_OF',                 'CORP_PF',                 'EX_RETAIL',                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'SPE',                 'CORP_INT_GRP'             )                  AND (                 `t`.`risk_bucket` IN (                     30,                     31,                     32,                     33,                     34                 )                 OR `t`.`risk_bucket_original` IN (                     30,                     31,                     32,                     33,                     34                 )             ) THEN 'SHORT_TERM_CLAIMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SOV'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'RGLA',                 'RGLA_SOV',                 'RGLA_SOV_EU'             ) THEN 'REGIONAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'PSE',                 'PSE_BANK',                 'PSE_SOV'             ) THEN 'ADMIN_BODIES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'MDB',                 'MDB_PREF_0',                 'MDB_PREF_20'             ) THEN 'MULTILATERAL_DEVT_BANKS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SUPRA',                 'EIF',                 'SUPRA_100'             ) THEN 'INTL_ORGANIZATIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`bis_entity_type_new` IN (                     'SME',                     'SME_CF',                     'SME_HVCRE',                     'SME_IPRE',                     'SME_OF',                     'SME_PF',                     'CORP',                     'INSURANCE',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'CORP_INT_GRP'                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'INDIV',                 'SME_RETAIL'             )                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL'             WHEN `t`.`method_new` = 'STD' THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`bis_entity_type_new` NOT IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` = 'CLAIM_OTH_100'                 )                 AND (                     `t`.`bis_product_category` NOT IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 ( `t`.`asset_class_new` = 'CLAIM%EQT' )                 OR ( `t`.`asset_class_new` = 'CLAIM_CIU' )             ) THEN 'EQUITY_CLAIMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`asset_class_new` IN (                         'CLAIM_FULL_SEC_RRE',                         'CLAIM_SEC_RRE_LEASE',                         'CRE_COL',                         'CLAIM_SEC_CRE',                         'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE'                     )                     OR `t`.`collateral_bis_product` IN (                         'RRE_COL',                         'LEASING_RRE_COL',                         'LEASING_CRE_COL',                         'CRE_COL'                     )                 )                 AND `t`.`bis_entity_type_new` IN (                     'INDIV',                     'SME_RETAIL'                 )             ) THEN 'RETAIL_MORTGAGES'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_RETAIL_QUALIFYING_REVOLVING' THEN 'RETAIL_QRRE'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'INDIV'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_OTHER'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'SME_RETAIL'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_SME'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'FOU'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'ADV'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             ELSE 'OTHER_ITEMS'         END     ) AS `fsa004_asset_class`,     `t`.`secu_mode`,     `t`.`risk_bucket_original`,     `t`.`waterfall_seniority`,     `e`.`origination_country` AS `ccr_original`,     `enew`.`origination_country` AS `ccr_new`,     `t`.`stress_testing_scenario_id`,     `t`.`collateral_attribute_1`,     `t`.`collateral_attribute_9`,     `t`.`exposure_attribute_1`,     `t`.`exposure_attribute_6`,     `t`.`counterparty_new_attribute_1`,     `t`.`sub_reference`,     `t`.`sub_method_original`,     `t`.`int_rating_agency_original`,     `t`.`ead_formula`,     `t`.`booking_company`,     `t`.`obligor_grade_inf_new`,     `t`.`obligor_grade_sup_new`,     `t`.`incorporation_ccy_original`,     `t`.`incorporation_ccy_new`,     nvl(`t`.`management_product`,'UNMAPPED') AS `management_product`,     `bus_ind`.`business_identifier_desc` AS `business_identifier`,       CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_w_filter_type`,              CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_filter_type`,          `ct`.`attribute_2` AS `balance_category`,     nvl( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr_exch`.`exch_rate`             ELSE `cer`.`exch_rate`         END     ),`cer`.`exch_rate`) AS `exchange_rate`,     `fac`.`holdco_ind` AS `holding_company_ind`,     `fac`.`non_gam_ind` AS `non_gam_ind`,     `egroup_orig`.`group_cust_segment_code`,     `egroup_orig`.`group_cust_segment_desc`,     `t`.`original_cost`,     `t`.`premium_current`,     `t`.`security_positions_ref`,     `t`.`pd_pre_floor_new`,     `t`.`exposure_attribute_3`,     `t`.`exposure_attribute_4`,     `t`.`exposure_attribute_5`,     `t`.`counterparty_new_attribute_3`,     `t`.`counterparty_new_attribute_4`,     `t`.`collateral_attribute_7`,     `t`.`collateral_attribute_8`,     `e`.`long_term_rating_local_ccy` AS `internal_rating_local_ccy_orig`,     `t`.`past_due_int`,     `t`.`ead_pro_discount`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`ltv`             ELSE 0         END     ) AS `ltv`,     (         CASE             WHEN `bf`.`domicile_country_code` IS NOT NULL                  AND nvl(`e`.`bf_link_type`,'z') = 'BUYER_FINANCE' THEN 'Y'             ELSE 'N'         END     ) AS `buyer_finance_ind`,     `t`.`counterparty_ext_rat_code`,     `t`.`counterparty_ext_rat_agency`,     `t`.`counterparty_int_rat_code`,     `t`.`counterparty_int_rat_agency`,     `t`.`maturity_eff`,     `psgl`.`psgl_department` AS `psgl_department_id`,     `psgl`.`psgl_product` AS `psgl_product_code`    , `net`.`netting_type` AS `netting_agreement_type`,     `sub`.`contract_reference` AS `sub_limit_fac_reference`,     `sub`.`limit_amount` AS `limit_amount`,     `sub`.`limit_attribute` AS `limit_attribute`,      CASE WHEN `tcva`.`cva_rwa`  <= 0 THEN nvl(`tcva`.`cva_rwa`,0) / nvl(`tcva`.`count_contract_ref`,0)          ELSE round(nvl(`t`.`rwa`,0),2) / (`t2`.`sum_rwa` * round(nvl(`tcva`.`cva_rwa`,0),2))     END `cva_rwa`,          `t`.`qualifying_ccp`,     `t`.`k_function_used`,     `t`.`k_function_used_original`,     `t`.`product_gl_criteria_2`,     `t`.`bis_past_due_original`,     `t`.`risk_country_new`,     `t`.`risk_country_original`,     `t`.`booking_company_incorp_country`,     `t`.`ccf_std`,     `t`.`past_due_days`,     `t`.`guarantee_method`,     `t`.`fde_alternative_method`,     `t`.`rwa_pre_cap`,     `t`.`asset_class_category_new`,     `t`.`asset_class_category_original`      FROM ( SELECT `stg_bcrs_t_cdr`.`partition_key`, `stg_bcrs_t_cdr`.`stress_testing_scenario_id`, `stg_bcrs_t_cdr`.`tranche_collateral_type`, `stg_bcrs_t_cdr`.`tranche_guarantee_type`, `stg_bcrs_t_cdr`.`bs_type`, `stg_bcrs_t_cdr`.`contract_reference`, `stg_bcrs_t_cdr`.`contract_type`, `stg_bcrs_t_cdr`.`bis_product`, `stg_bcrs_t_cdr`.`bis_product_category`, `stg_bcrs_t_cdr`.`unconditionnaly_cancelable`, `stg_bcrs_t_cdr`.`ead_original`, `stg_bcrs_t_cdr`.`ead_pre_ccf`, `stg_bcrs_t_cdr`.`ead`, `stg_bcrs_t_cdr`.`ead_pro`, `stg_bcrs_t_cdr`.`facility_reference`, `stg_bcrs_t_cdr`.`collateral_reference`, `stg_bcrs_t_cdr`.`collateral_contract_type`, `stg_bcrs_t_cdr`.`collateral_bis_product`, `stg_bcrs_t_cdr`.`guarantee_reference`, `stg_bcrs_t_cdr`.`guarantee_contract_type`, `stg_bcrs_t_cdr`.`guarantee_bis_product`, `stg_bcrs_t_cdr`.`netting_agreement_reference`, `stg_bcrs_t_cdr`.`netting_agreement_type`, `stg_bcrs_t_cdr`.`counterparty_original`, `stg_bcrs_t_cdr`.`counterparty_type_original`, `stg_bcrs_t_cdr`.`counterparty_new`, `stg_bcrs_t_cdr`.`counterparty_type_new`, `stg_bcrs_t_cdr`.`total_annual_sales`, `stg_bcrs_t_cdr`.`total_annual_assets`, `stg_bcrs_t_cdr`.`bis_entity_type_original`, `stg_bcrs_t_cdr`.`bis_entity_type_new`, `stg_bcrs_t_cdr`.`asset_class_original`, `stg_bcrs_t_cdr`.`asset_class_new`, `stg_bcrs_t_cdr`.`method_original`, `stg_bcrs_t_cdr`.`sub_method_original`, `stg_bcrs_t_cdr`.`method_new`, `stg_bcrs_t_cdr`.`sub_method_new`, `stg_bcrs_t_cdr`.`guarantee_method`, `stg_bcrs_t_cdr`.`he`, `stg_bcrs_t_cdr`.`maturity_eff`, `stg_bcrs_t_cdr`.`k_maturity`, `stg_bcrs_t_cdr`.`pd_original`, `stg_bcrs_t_cdr`.`internal_rating_original`, `stg_bcrs_t_cdr`.`pd_new`, `stg_bcrs_t_cdr`.`internal_rating_new`, `stg_bcrs_t_cdr`.`lgd`, `stg_bcrs_t_cdr`.`lgd_grade_agency`, `stg_bcrs_t_cdr`.`ccf`, `stg_bcrs_t_cdr`.`hfx`, `stg_bcrs_t_cdr`.`hc`, `stg_bcrs_t_cdr`.`mm`, `stg_bcrs_t_cdr`.`floor1`, `stg_bcrs_t_cdr`.`floor2`, `stg_bcrs_t_cdr`.`rwa`, `stg_bcrs_t_cdr`.`rgc`, `stg_bcrs_t_cdr`.`rwa_pre_crm`, `stg_bcrs_t_cdr`.`el`, `stg_bcrs_t_cdr`.`beel`, `stg_bcrs_t_cdr`.`bis_past_due`, `stg_bcrs_t_cdr`.`performing_status`, `stg_bcrs_t_cdr`.`rw_scaling_factor`, `stg_bcrs_t_cdr`.`rwa_scaling_factor`, `stg_bcrs_t_cdr`.`equity_scaling_factor`, `stg_bcrs_t_cdr`.`exemption_maturity_floor`, `stg_bcrs_t_cdr`.`grand_fathering_applied`, `stg_bcrs_t_cdr`.`legislated_program_applied`, `stg_bcrs_t_cdr`.`non_material_equity`, `stg_bcrs_t_cdr`.`zero_rw_for_equity`, `stg_bcrs_t_cdr`.`zero_haircut_for_repo`, `stg_bcrs_t_cdr`.`k_function_used`, `stg_bcrs_t_cdr`.`ead_formula`, `stg_bcrs_t_cdr`.`risk_type`, `stg_bcrs_t_cdr`.`trading_book_type`, `stg_bcrs_t_cdr`.`table_name`, `stg_bcrs_t_cdr`.`exposure_attribute_1`, `stg_bcrs_t_cdr`.`exposure_attribute_2`, `stg_bcrs_t_cdr`.`exposure_attribute_3`, `stg_bcrs_t_cdr`.`exposure_attribute_4`, `stg_bcrs_t_cdr`.`exposure_attribute_5`, `stg_bcrs_t_cdr`.`exposure_attribute_6`, `stg_bcrs_t_cdr`.`exposure_attribute_7`, `stg_bcrs_t_cdr`.`exposure_attribute_8`, `stg_bcrs_t_cdr`.`exposure_attribute_9`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_1`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_2`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_3`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_4`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_5`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_6`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_7`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_8`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_9`, `stg_bcrs_t_cdr`.`collateral_attribute_1`, `stg_bcrs_t_cdr`.`collateral_attribute_2`, `stg_bcrs_t_cdr`.`collateral_attribute_3`, `stg_bcrs_t_cdr`.`collateral_attribute_4`, `stg_bcrs_t_cdr`.`collateral_attribute_5`, `stg_bcrs_t_cdr`.`collateral_attribute_6`, `stg_bcrs_t_cdr`.`collateral_attribute_7`, `stg_bcrs_t_cdr`.`collateral_attribute_8`, `stg_bcrs_t_cdr`.`collateral_attribute_9`, `stg_bcrs_t_cdr`.`guarantee_attribute_1`, `stg_bcrs_t_cdr`.`guarantee_attribute_2`, `stg_bcrs_t_cdr`.`guarantee_attribute_3`, `stg_bcrs_t_cdr`.`guarantee_attribute_4`, `stg_bcrs_t_cdr`.`guarantee_attribute_5`, `stg_bcrs_t_cdr`.`guarantee_attribute_6`, `stg_bcrs_t_cdr`.`guarantee_attribute_7`, `stg_bcrs_t_cdr`.`guarantee_attribute_8`, `stg_bcrs_t_cdr`.`guarantee_attribute_9`, `stg_bcrs_t_cdr`.`inter_company`, `stg_bcrs_t_cdr`.`rwa_pre_cap`, `stg_bcrs_t_cdr`.`rw_original`, `stg_bcrs_t_cdr`.`rw_new`, `stg_bcrs_t_cdr`.`tier1_deduction`, `stg_bcrs_t_cdr`.`tier2_deduction`, `stg_bcrs_t_cdr`.`securitized`, `stg_bcrs_t_cdr`.`seniority_original`, `stg_bcrs_t_cdr`.`seniority_new`, `stg_bcrs_t_cdr`.`collateral_product_category`, `stg_bcrs_t_cdr`.`dealbook`, `stg_bcrs_t_cdr`.`deal_status`, `stg_bcrs_t_cdr`.`sub_reference`, `stg_bcrs_t_cdr`.`securitization_reference`, `stg_bcrs_t_cdr`.`securitization_n`, `stg_bcrs_t_cdr`.`waterfall_seniority`, `stg_bcrs_t_cdr`.`risk_country`, `stg_bcrs_t_cdr`.`zone_a_original`, `stg_bcrs_t_cdr`.`zone_a_new`, `stg_bcrs_t_cdr`.`lgd_mitigation`, `stg_bcrs_t_cdr`.`crm_method`, `stg_bcrs_t_cdr`.`look_through_treatment`, `stg_bcrs_t_cdr`.`second_loss_treatment`, `stg_bcrs_t_cdr`.`risk_bucket`, `stg_bcrs_t_cdr`.`pool_code`, `stg_bcrs_t_cdr`.`incorporation_country`, `stg_bcrs_t_cdr`.`division_code`, `stg_bcrs_t_cdr`.`secu_loss_position`, `stg_bcrs_t_cdr`.`secu_issue_date`, `stg_bcrs_t_cdr`.`secu_ea_controlled`, `stg_bcrs_t_cdr`.`secu_company_weight`, `stg_bcrs_t_cdr`.`secu_bank_role`, `stg_bcrs_t_cdr`.`secu_mode`, `stg_bcrs_t_cdr`.`import_source`, `stg_bcrs_t_cdr`.`company_code`, `stg_bcrs_t_cdr`.`supervisor_code`, `stg_bcrs_t_cdr`.`ccy_code`, `stg_bcrs_t_cdr`.`settlement_price`, `stg_bcrs_t_cdr`.`days_after_contractual_date`, `stg_bcrs_t_cdr`.`delivery_type`, `stg_bcrs_t_cdr`.`mortgage_alternative`, `stg_bcrs_t_cdr`.`booking_company`, `stg_bcrs_t_cdr`.`booking_company_desc`, `stg_bcrs_t_cdr`.`gaap_code`, `stg_bcrs_t_cdr`.`number_of_obligor`, `stg_bcrs_t_cdr`.`security_positions_ref`, `stg_bcrs_t_cdr`.`guar_sub_reference`, `stg_bcrs_t_cdr`.`flag_adjustment`, `stg_bcrs_t_cdr`.`internal_maturity_class`, `stg_bcrs_t_cdr`.`equity_floor_applied`, `stg_bcrs_t_cdr`.`equity_preferential_treatment`, `stg_bcrs_t_cdr`.`fde_alternative_method`, `stg_bcrs_t_cdr`.`collateral_table_name`, `stg_bcrs_t_cdr`.`collateral_mode`, `stg_bcrs_t_cdr`.`funding_ccy`, `stg_bcrs_t_cdr`.`currency`, `stg_bcrs_t_cdr`.`incorporation_ccy_original`, `stg_bcrs_t_cdr`.`incorporation_ccy_new`, `stg_bcrs_t_cdr`.`credit_substitute`, `stg_bcrs_t_cdr`.`value_date`, `stg_bcrs_t_cdr`.`original_maturity`, `stg_bcrs_t_cdr`.`residual_maturity`, `stg_bcrs_t_cdr`.`booking_company_incorp_country`, `stg_bcrs_t_cdr`.`business_line_code`, `stg_bcrs_t_cdr`.`family`, `stg_bcrs_t_cdr`.`standard_rw_new`, `stg_bcrs_t_cdr`.`standard_rw_original`, `stg_bcrs_t_cdr`.`risk_bucket_original`, `stg_bcrs_t_cdr`.`collateral_assigned_amount`, `stg_bcrs_t_cdr`.`used_amount_facility`, `stg_bcrs_t_cdr`.`rwa_pre_floor_equity`, `stg_bcrs_t_cdr`.`bis_past_due_original`, `stg_bcrs_t_cdr`.`ltv`, `stg_bcrs_t_cdr`.`ltv_current`, `stg_bcrs_t_cdr`.`hr`, `stg_bcrs_t_cdr`.`hcr`, `stg_bcrs_t_cdr`.`und_pool_ref`, `stg_bcrs_t_cdr`.`asset_class_category_original`, `stg_bcrs_t_cdr`.`asset_class_category_new`, `stg_bcrs_t_cdr`.`netting_agreement_amount_1`, `stg_bcrs_t_cdr`.`netting_agreement_amount_2`, `stg_bcrs_t_cdr`.`netting_agreement_amount_3`, `stg_bcrs_t_cdr`.`netting_agreement_amount_4`, `stg_bcrs_t_cdr`.`netting_agreement_amount_5`, `stg_bcrs_t_cdr`.`netting_agreement_amount_6`, `stg_bcrs_t_cdr`.`netting_agreement_amount_7`, `stg_bcrs_t_cdr`.`entity_type_category_original`, `stg_bcrs_t_cdr`.`entity_type_category_new`, `stg_bcrs_t_cdr`.`ead_pro_write_off`, `stg_bcrs_t_cdr`.`ead_pro_discount`, `stg_bcrs_t_cdr`.`cpty_group`, `stg_bcrs_t_cdr`.`counterparty_new_desc`, `stg_bcrs_t_cdr`.`internal_rating_new_rank`, `stg_bcrs_t_cdr`.`uncommited`, `stg_bcrs_t_cdr`.`capital_item`, `stg_bcrs_t_cdr`.`product_gl_criteria`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_ori`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_new`, `stg_bcrs_t_cdr`.`secu_retail_line_fg`, `stg_bcrs_t_cdr`.`secu_uncommited_retail_fg`, `stg_bcrs_t_cdr`.`secu_spread_trapping_ratio`, `stg_bcrs_t_cdr`.`collateral_issuer`, `stg_bcrs_t_cdr`.`coll_issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`collateral_haircut_risk_bucket`, `stg_bcrs_t_cdr`.`guarantor`, `stg_bcrs_t_cdr`.`guarantor_bis_entity_type`, `stg_bcrs_t_cdr`.`ead_pro_gen`, `stg_bcrs_t_cdr`.`pd_pre_floor_original`, `stg_bcrs_t_cdr`.`pd_pre_floor_new`, `stg_bcrs_t_cdr`.`lgd_pre_floor_original`, `stg_bcrs_t_cdr`.`lgd_pre_floor_new`, `stg_bcrs_t_cdr`.`int_rating_agency_original`, `stg_bcrs_t_cdr`.`int_rating_agency_new`, `stg_bcrs_t_cdr`.`cpty_group_original`, `stg_bcrs_t_cdr`.`nominal`, `stg_bcrs_t_cdr`.`add_on`, `stg_bcrs_t_cdr`.`fair_value`, `stg_bcrs_t_cdr`.`amortized_cost`, `stg_bcrs_t_cdr`.`accrued_interest`, `stg_bcrs_t_cdr`.`amortized_cost_no_ias`, `stg_bcrs_t_cdr`.`adjustment_amount`, `stg_bcrs_t_cdr`.`outstanding`, `stg_bcrs_t_cdr`.`original_cost`, `stg_bcrs_t_cdr`.`accrued_fees`, `stg_bcrs_t_cdr`.`past_due_ppal`, `stg_bcrs_t_cdr`.`past_due_int`, `stg_bcrs_t_cdr`.`premium_current`, `stg_bcrs_t_cdr`.`cpty_new_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`cpty_orig_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`effective_epe`, `stg_bcrs_t_cdr`.`ead_method`, `stg_bcrs_t_cdr`.`netting_class`, `stg_bcrs_t_cdr`.`bis_industry_sector_new`, `stg_bcrs_t_cdr`.`bis_industry_sector_original`, `stg_bcrs_t_cdr`.`bis_risk_area_new`, `stg_bcrs_t_cdr`.`bis_risk_area_original`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_new`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_original`, `stg_bcrs_t_cdr`.`risk_country_new`, `stg_bcrs_t_cdr`.`risk_country_original`, `stg_bcrs_t_cdr`.`incorporation_country_new`, `stg_bcrs_t_cdr`.`incorporation_country_original`, `stg_bcrs_t_cdr`.`bis_performing_status`, `stg_bcrs_t_cdr`.`rwa_cap_ratio`, `stg_bcrs_t_cdr`.`exposure_amount_1`, `stg_bcrs_t_cdr`.`exposure_amount_2`, `stg_bcrs_t_cdr`.`final_beneficiary`, `stg_bcrs_t_cdr`.`collateral_valuation_date`, `stg_bcrs_t_cdr`.`unrestricted_psia_pct`, `stg_bcrs_t_cdr`.`restricted_psia_pct`, `stg_bcrs_t_cdr`.`collateral_issued_by_the_bank`, `stg_bcrs_t_cdr`.`guarantee_issued_by_the_bank`, `stg_bcrs_t_cdr`.`rated_borrower`, `stg_bcrs_t_cdr`.`long_short`, `stg_bcrs_t_cdr`.`external_rating_new`, `stg_bcrs_t_cdr`.`external_rating_original`, `stg_bcrs_t_cdr`.`external_rating_agency_new`, `stg_bcrs_t_cdr`.`external_rating_agency_orig`, `stg_bcrs_t_cdr`.`collateral_country`, `stg_bcrs_t_cdr`.`issuer`, `stg_bcrs_t_cdr`.`issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`issuer_country`, `stg_bcrs_t_cdr`.`product_gl_criteria_2`, `stg_bcrs_t_cdr`.`positions_type`, `stg_bcrs_t_cdr`.`eligibility_risk_bucket`, `stg_bcrs_t_cdr`.`retail_purpose`, `stg_bcrs_t_cdr`.`color_id`, `stg_bcrs_t_cdr`.`past_due_days`, `stg_bcrs_t_cdr`.`collateral_asset_class`, `stg_bcrs_t_cdr`.`collateral_standard_rw`, `stg_bcrs_t_cdr`.`collateral_asset_class_cat`, `stg_bcrs_t_cdr`.`collateral_risk_bucket`, `stg_bcrs_t_cdr`.`coll_issuer_incorporation_ccy`, `stg_bcrs_t_cdr`.`fund_composition_ref`, `stg_bcrs_t_cdr`.`secu_retention_percentage`, `stg_bcrs_t_cdr`.`secu_retention_calc_method`, `stg_bcrs_t_cdr`.`rw_add_on`, `stg_bcrs_t_cdr`.`lgd_non_performing`, `stg_bcrs_t_cdr`.`ccf_std`, `stg_bcrs_t_cdr`.`concentration_ratio`, `stg_bcrs_t_cdr`.`ttc_lgd`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_code`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_agency`, `stg_bcrs_t_cdr`.`counterparty_int_rat_code`, `stg_bcrs_t_cdr`.`counterparty_int_rat_agency`, `stg_bcrs_t_cdr`.`gl_strategy_code`, `stg_bcrs_t_cdr`.`k_function_used_original`, `stg_bcrs_t_cdr`.`long_gross_position`, `stg_bcrs_t_cdr`.`short_gross_position`, `stg_bcrs_t_cdr`.`correlation_trading`, `stg_bcrs_t_cdr`.`ead_pro_pre_ccf`, `stg_bcrs_t_cdr`.`ead_pro_write_off_pre_ccf`, `stg_bcrs_t_cdr`.`sup_reg_vers_code`, `stg_bcrs_t_cdr`.`dataset_version`, `stg_bcrs_t_cdr`.`clearing_house_code`, `stg_bcrs_t_cdr`.`contract_maturity_eff`, `stg_bcrs_t_cdr`.`counterparty_code_2`, `stg_bcrs_t_cdr`.`qualifying_transaction`, `stg_bcrs_t_cdr`.`qualifying_ccp`, `stg_bcrs_t_cdr`.`sov_rating_used`, `stg_bcrs_t_cdr`.`sov_rating_used_ori`, `stg_bcrs_t_cdr`.`current_ead_imm`, `stg_bcrs_t_cdr`.`current_maturity_eff_imm`, `stg_bcrs_t_cdr`.`obligor_grade_original`, `stg_bcrs_t_cdr`.`obligor_grade_new`, `stg_bcrs_t_cdr`.`deduction_step`, `stg_bcrs_t_cdr`.`significant_investment`, `stg_bcrs_t_cdr`.`el_std`, `stg_bcrs_t_cdr`.`deduction_pct`, `stg_bcrs_t_cdr`.`indirect_position`, `stg_bcrs_t_cdr`.`std_risk_bucket_ori`, `stg_bcrs_t_cdr`.`std_risk_bucket_new`, `stg_bcrs_t_cdr`.`ccp_dfund_method`, `stg_bcrs_t_cdr`.`secu_underlying_asset_type`, `stg_bcrs_t_cdr`.`margin_period`, `stg_bcrs_t_cdr`.`ead_scalar`, `stg_bcrs_t_cdr`.`crm_first_lien`, `stg_bcrs_t_cdr`.`available_amount`, `stg_bcrs_t_cdr`.`accounting_adjustment_type`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_1`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_2`, `stg_bcrs_t_cdr`.`adjusted_value`, `stg_bcrs_t_cdr`.`ead_before_acc_adj`, `stg_bcrs_t_cdr`.`lgd_before_acc_adj`, `stg_bcrs_t_cdr`.`subset_code`, `stg_bcrs_t_cdr`.`el_rwa_part`, `stg_bcrs_t_cdr`.`industry_sector_original`, `stg_bcrs_t_cdr`.`cds_qualifying`, `stg_bcrs_t_cdr`.`default_date`, `stg_bcrs_t_cdr`.`credit_bureau_name_original`, `stg_bcrs_t_cdr`.`credit_bureau_name_refreshed`, `stg_bcrs_t_cdr`.`fico_original`, `stg_bcrs_t_cdr`.`fico_refreshed`, `stg_bcrs_t_cdr`.`pool_ead_formula`, `stg_bcrs_t_cdr`.`clearing_member`, `stg_bcrs_t_cdr`.`securitization_depth`, `stg_bcrs_t_cdr`.`securitization_loop`, `stg_bcrs_t_cdr`.`bankruptcy_remote`, `stg_bcrs_t_cdr`.`margin_type`, `stg_bcrs_t_cdr`.`collateral_bankruptcy_remote`, `stg_bcrs_t_cdr`.`collateral_margin_type`, `stg_bcrs_t_cdr`.`remargining_frequency`, `stg_bcrs_t_cdr`.`settlement_ccy`, `stg_bcrs_t_cdr`.`vm_extinguishes_mtm`, `stg_bcrs_t_cdr`.`margin_agreement`, `stg_bcrs_t_cdr`.`rw_pre_floor_new`, `stg_bcrs_t_cdr`.`rwa_pre_floor`, `stg_bcrs_t_cdr`.`ccp_exposure_type`, `stg_bcrs_t_cdr`.`carrying_amount`, `stg_bcrs_t_cdr`.`exchange_rate`, `stg_bcrs_t_cdr`.`policy_update`, `stg_bcrs_t_cdr`.`methodology_update`, `stg_bcrs_t_cdr`.`model_update`, `stg_bcrs_t_cdr`.`pd_model_update`, `stg_bcrs_t_cdr`.`lgd_model_update`, `stg_bcrs_t_cdr`.`ccf_model_update`, `stg_bcrs_t_cdr`.`ead_model_update`, `stg_bcrs_t_cdr`.`covered_ead`, `stg_bcrs_t_cdr`.`fi_type`, `stg_bcrs_t_cdr`.`maturity_date`, `stg_bcrs_t_cdr`.`policy_name`, `stg_bcrs_t_cdr`.`methodology_name`, `stg_bcrs_t_cdr`.`model_name`, `stg_bcrs_t_cdr`.`fund_reference`, `stg_bcrs_t_cdr`.`fund_method`, `stg_bcrs_t_cdr`.`fund_depth`, `stg_bcrs_t_cdr`.`fund_initial`, `stg_bcrs_t_cdr`.`rwa_pre_lvr`, `stg_bcrs_t_cdr`.`leverage`, `stg_bcrs_t_cdr`.`rw_el`, `stg_bcrs_t_cdr`.`use_beel`, `stg_bcrs_t_cdr`.`k_ratio`, `stg_bcrs_t_cdr`.`trade_date`, `stg_bcrs_t_cdr`.`sme_ceiling`, `stg_bcrs_t_cdr`.`sme_floor`, `stg_bcrs_t_cdr`.`sme_ceiling_indicator`, `stg_bcrs_t_cdr`.`fund_assets`, `stg_bcrs_t_cdr`.`obligor_grade_rank_original`, `stg_bcrs_t_cdr`.`obligor_grade_sup_original`, `stg_bcrs_t_cdr`.`obligor_grade_inf_original`, `stg_bcrs_t_cdr`.`obligor_grade_rank_new`, `stg_bcrs_t_cdr`.`obligor_grade_sup_new`, `stg_bcrs_t_cdr`.`obligor_grade_inf_new`, `stg_bcrs_t_cdr`.`lgd_grade_inf`, `stg_bcrs_t_cdr`.`lgd_grade_sup`, `stg_bcrs_t_cdr`.`lgd_grade_rank`, `stg_bcrs_t_cdr`.`lgd_grade`, `stg_bcrs_t_cdr`.`conservation_buffer`, `stg_bcrs_t_cdr`.`conservation_rgc`, `stg_bcrs_t_cdr`.`ctcycal_buffer`, `stg_bcrs_t_cdr`.`ctcycal_rgc`, `stg_bcrs_t_cdr`.`sifi_buffer`, `stg_bcrs_t_cdr`.`sifi_rgc`, `stg_bcrs_t_cdr`.`leverage_ead`, `stg_bcrs_t_cdr`.`at1_deduction`, `stg_bcrs_t_cdr`.`cet1_deduction`, `stg_bcrs_t_cdr`.`adjustment_tag`, `stg_bcrs_t_cdr`.`rw_new_grouping`, `stg_bcrs_t_cdr`.`nominal_at_rw_new`, `stg_bcrs_t_cdr`.`ead_at_rw_new`, `stg_bcrs_t_cdr`.`collateral_completed`, `stg_bcrs_t_cdr`.`rep_product`, `stg_bcrs_t_cdr`.`rep_collateral_product`, `stg_bcrs_t_cdr`.`ltv_indexed`, `stg_bcrs_t_cdr`.`origination_date`, `stg_bcrs_t_cdr`.`is_le`, `stg_bcrs_t_cdr`.`rep_industry_sector`, `stg_bcrs_t_cdr`.`scenario_process_step`, `stg_bcrs_t_cdr`.`period_id`, `stg_bcrs_t_cdr`.`period_start_date`, `stg_bcrs_t_cdr`.`period_end_date`, `stg_bcrs_t_cdr`.`scenario_process_name`, `stg_bcrs_t_cdr`.`scenario_process_id`, `stg_bcrs_t_cdr`.`regulatory_scenario_name`, `stg_bcrs_t_cdr`.`rep_asset_class`, `stg_bcrs_t_cdr`.`rep_sub_product`, `stg_bcrs_t_cdr`.`rep_arrears_band_mia`, `stg_bcrs_t_cdr`.`rep_arrears_band_pia`, `stg_bcrs_t_cdr`.`rep_payment_type`, `stg_bcrs_t_cdr`.`weighted_avg_rate`, `stg_bcrs_t_cdr`.`customer_field11`, `stg_bcrs_t_cdr`.`customer_field12`, `stg_bcrs_t_cdr`.`customer_field13`, `stg_bcrs_t_cdr`.`customer_field14`, `stg_bcrs_t_cdr`.`customer_field15`, `stg_bcrs_t_cdr`.`customer_field16`, `stg_bcrs_t_cdr`.`customer_field17`, `stg_bcrs_t_cdr`.`customer_field18`, `stg_bcrs_t_cdr`.`customer_field19`, `stg_bcrs_t_cdr`.`customer_field20`, `stg_bcrs_t_cdr`.`customer_field21`, `stg_bcrs_t_cdr`.`customer_number11`, `stg_bcrs_t_cdr`.`customer_number12`, `stg_bcrs_t_cdr`.`customer_number13`, `stg_bcrs_t_cdr`.`customer_number14`, `stg_bcrs_t_cdr`.`customer_number15`, `stg_bcrs_t_cdr`.`customer_number16`, `stg_bcrs_t_cdr`.`customer_number17`, `stg_bcrs_t_cdr`.`customer_number18`, `stg_bcrs_t_cdr`.`customer_date1`, `stg_bcrs_t_cdr`.`customer_date2`, `stg_bcrs_t_cdr`.`customer_date3`, `stg_bcrs_t_cdr`.`rep_major_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_major_asset_class_new`, `stg_bcrs_t_cdr`.`rep_asset_class_new`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_new`, `stg_bcrs_t_cdr`.`rep_maturity_band`, `stg_bcrs_t_cdr`.`rep_segmentation`, `stg_bcrs_t_cdr`.`src_reporting_date`, `stg_bcrs_t_cdr`.`src_wks_name`, `stg_bcrs_t_cdr`.`src_position`, `stg_bcrs_t_cdr`.`generic_reporting_date`, `stg_bcrs_t_cdr`.`generic_wks_name`, `stg_bcrs_t_cdr`.`generic_position`, `stg_bcrs_t_cdr`.`securitization_mm`, `stg_bcrs_t_cdr`.`securitization_mm_factor`, `stg_bcrs_t_cdr`.`is_eligible_cva`, `stg_bcrs_t_cdr`.`audit_cva_eligibility`, `stg_bcrs_t_cdr`.`ead_pro_cva`, `stg_bcrs_t_cdr`.`generic_field1`, `stg_bcrs_t_cdr`.`generic_field2`, `stg_bcrs_t_cdr`.`generic_field3`, `stg_bcrs_t_cdr`.`generic_field4`, `stg_bcrs_t_cdr`.`generic_field5`, `stg_bcrs_t_cdr`.`generic_field6`, `stg_bcrs_t_cdr`.`generic_field7`, `stg_bcrs_t_cdr`.`generic_field8`, `stg_bcrs_t_cdr`.`generic_field9`, `stg_bcrs_t_cdr`.`generic_field10`, `stg_bcrs_t_cdr`.`generic_number1`, `stg_bcrs_t_cdr`.`generic_number2`, `stg_bcrs_t_cdr`.`generic_number3`, `stg_bcrs_t_cdr`.`generic_number4`, `stg_bcrs_t_cdr`.`generic_number5`, `stg_bcrs_t_cdr`.`generic_number6`, `stg_bcrs_t_cdr`.`generic_number7`, `stg_bcrs_t_cdr`.`generic_number8`, `stg_bcrs_t_cdr`.`generic_number9`, `stg_bcrs_t_cdr`.`generic_number10`, `stg_bcrs_t_cdr`.`customer_field1`, `stg_bcrs_t_cdr`.`customer_field2`, `stg_bcrs_t_cdr`.`customer_field3`, `stg_bcrs_t_cdr`.`customer_field4`, `stg_bcrs_t_cdr`.`customer_field5`, `stg_bcrs_t_cdr`.`customer_field6`, `stg_bcrs_t_cdr`.`customer_field7`, `stg_bcrs_t_cdr`.`customer_field8`, `stg_bcrs_t_cdr`.`customer_field9`, `stg_bcrs_t_cdr`.`customer_field10`, `stg_bcrs_t_cdr`.`customer_number1`, `stg_bcrs_t_cdr`.`customer_number2`, `stg_bcrs_t_cdr`.`customer_number3`, `stg_bcrs_t_cdr`.`customer_number4`, `stg_bcrs_t_cdr`.`customer_number5`, `stg_bcrs_t_cdr`.`customer_number6`, `stg_bcrs_t_cdr`.`customer_number7`, `stg_bcrs_t_cdr`.`customer_number8`, `stg_bcrs_t_cdr`.`customer_number9`, `stg_bcrs_t_cdr`.`customer_number10`, `stg_bcrs_t_cdr`.`run_date`, `stg_bcrs_t_cdr`.`process_profile_sr_id`, `stg_bcrs_t_cdr`.`conso_perimeter`, `stg_bcrs_t_cdr`.`interco`, `stg_bcrs_t_cdr`.`interco_type`, `stg_bcrs_t_cdr`.`valid_cpy_perimeter`, `stg_bcrs_t_cdr`.`issuer_id`, `stg_bcrs_t_cdr`.`approver_id`, `stg_bcrs_t_cdr`.`upload_date`, `stg_bcrs_t_cdr`.`approval_date`, `stg_bcrs_t_cdr`.`adj_batch_date`, `stg_bcrs_t_cdr`.`source_file_name`, `stg_bcrs_t_cdr`.`adj_seq`, `stg_bcrs_t_cdr`.`dp_rule_log`, `stg_bcrs_t_cdr`.`staging_source`, `stg_bcrs_t_cdr`.`id`, `stg_bcrs_t_cdr`.`parent_id`, `stg_bcrs_t_cdr`.`child_id`, `stg_bcrs_t_cdr`.`multipurpose_audit`, `stg_bcrs_t_cdr`.`saccr_pfe`, `stg_bcrs_t_cdr`.`saccr_rc`, `stg_bcrs_t_cdr`.`flag_deduction`, `stg_bcrs_t_cdr`.`w_snapshot_dt`, `stg_bcrs_t_cdr`.`w_datasource_id`, `stg_bcrs_t_cdr`.`w_country_cd`, `stg_bcrs_t_cdr`.`w_batch_id`,          (                 CASE                     WHEN nvl(`stg_bcrs_t_cdr`.`table_name`,'z') IN (                         'BOND',                         'EQUITY',                         'TRANCHE',                         'CONVERTIBLE',                         'FUND'                     ) THEN 'SECURITY_POSITIONS'                     ELSE nvl(`stg_bcrs_t_cdr`.`table_name`,'z')                 END             ) AS `sec_table_name`,             substr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'/') + 1,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'-') - (instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'/') + 1) ) `management_product`,             substr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'-') + 1,2) `business_indentifier`         FROM             `sgmisitstg`.`stg_bcrs_t_cdr`   ) `t`   left join `sgmisitstg`.`stg_bcrs_companies_links` `complink` on `t`.`booking_company` = `complink`.`child_code` AND CASE WHEN 'WS29' like '%ADJ%' THEN `complink`.`w_batch_id` = '2018071116473300773' ELSE `complink`.`w_batch_id` = '2018071116473300773' END  left join (          SELECT `stg_bcrs_t_cdr`.`contract_reference`, SUM(`stg_bcrs_t_cdr`.`rwa`) AS `SUM_RWA`         FROM `sgmisitstg`.`stg_bcrs_t_cdr`         WHERE `stg_bcrs_t_cdr`.`w_batch_id` = '2018071116473300773'         GROUP BY `stg_bcrs_t_cdr`.`contract_reference`         ) `t2` on `t`.`contract_reference` = `t2`.`contract_reference`          left join `sgmisitstg`.`stg_bcrs_scb_gpr_default_indicator` `grpdfind` on `t`.`contract_type` = `grpdfind`.`indicator_value` AND CASE WHEN 'WS29' like '%ADJ%' THEN `grpdfind`.`w_batch_id` = '2018071116473300773' ELSE `grpdfind`.`w_batch_id` = '2018071116473300773' END  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_csr`.`contract_reference`,             `stg_bcrs_csr`.`start_date`,             `stg_bcrs_csr`.`maturity_date`,             `stg_bcrs_csr`.`value_date`         FROM `sgmisitstg`.`stg_bcrs_csr`         WHERE `stg_bcrs_csr`.`import_source` NOT LIKE '%WB%'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `stg_bcrs_csr`.`w_batch_id` = '2018071116473300773' ELSE `stg_bcrs_csr`.`w_batch_id` = '2018071116473300773' END ) `csr` ON `t`.`contract_reference` = `csr`.`contract_reference`  LEFT JOIN ( SELECT DISTINCT             `e`.`entity_code`,             `e`.`entity_desc`,             `e`.`attribute_4`,             `e`.`attribute_1`,             `e`.`incorporation_country`,             `e`.`origination_country`,             `cfi`.`scorecard_segment_code`,             `cfi`.`scorecard_segment_category`,             `cfi`.`cf_indicator`,             `e`.`attribute_7`,             `cd1`.`code_desc` AS `customer_segment_desc`,             `e`.`attribute_8`,             `cd2`.`code_desc` AS `customer_subsegment_desc`,             `e`.`et_code_user`,             `icr`.`long_term_rating`,             `icr`.`long_term_rating_local_ccy`,             `e`.`country_code`             , `el`.`bf_link_type`             , `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`  `e`                   LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON `e`.`entity_code` = `icr`.`entity_code`                                                    AND nvl(`icr`.`agency_code`,'z') = 'INTERNAL'                                                    AND `icr`.`w_batch_id` = '2018071116473300773'           LEFT JOIN ( SELECT DISTINCT  `links`.`child_code`,                          case when `linktype`.`link_type` is not null then 'BUYER_FINANCE' else null end `bf_link_type`                         FROM `sgmisitstg`.`stg_bcrs_entity_links` `links` left join (SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                 FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`) `linktype`                                  WHERE `links`.`link_type` IN ( SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                         FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`   ))  `el`              ON `e`.`entity_code` = `el`.`child_code`                      LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_co_fi` `cfi` ON `e`.`attribute_1` = `cfi`.`scorecard_segment`         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cfi`.`w_batch_id` = '2018071116473300773' ELSE `cfi`.`w_batch_id` = '2018071116473300773' END                  LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')         AND `cd1`.`code_type` = 'CUST_SEG'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd1`.`w_batch_id` = '2018071116473300773' ELSE `cd1`.`w_batch_id` = '2018071116473300773' END                  LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd2` ON nvl(`cd2`.`code`,'zz') = nvl(`e`.`attribute_8`,'zz')         AND `cd2`.`code_type` = 'CUST_SUB_SEG'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd2`.`w_batch_id` = '2018071116473300773' ELSE `cd2`.`w_batch_id` = '2018071116473300773' END          ) `e` ON `t`.`counterparty_original` = `e`.`entity_code` AND `e`.`w_batch_id` = '2018071116473300773'  LEFT JOIN (         SELECT DISTINCT             `e`.`entity_code`,             `e`.`attribute_7` AS `group_cust_segment_code`,             `cd1`.`code_desc` AS `group_cust_segment_desc`,             `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity` `e`                           LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')                    AND `cd1`.`code_type` = 'CUST_SEG'                    AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd1`.`w_batch_id` = '2018071116473300773' ELSE `cd1`.`w_batch_id` = '2018071116473300773' END ) `egroup_orig` ON `t`.`cpty_group_original` = `egroup_orig`.`entity_code`  and `e`.`w_batch_id` = '2018071116473300773'  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_entity`.`entity_code`,             `stg_bcrs_entity`.`attribute_1`,             `stg_bcrs_entity`.`origination_country`,             `stg_bcrs_entity`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`         where `stg_bcrs_entity`.`w_batch_id` = '2018071116473300773' ) `enew` ON `t`.`counterparty_new` = `enew`.`entity_code`   LEFT JOIN ( SELECT             `stg_bcrs_companies`.`company_code`,             `stg_bcrs_companies`.`country_code`,             `stg_bcrs_companies`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_companies`         where `stg_bcrs_companies`.`w_batch_id` = '2018071116473300773' ) `cpies` ON `t`.`booking_company` = `cpies`.`company_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_scb_wb_bf_uns_recoveries`.`domicile_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`booking_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`contract_type`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`cf_ind`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`prr`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`         where CASE WHEN 'WS29' like '%ADJ%' THEN `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2018071116473300773' ELSE `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2018071116473300773' END     ) `bf` ON `bf`.`domicile_country_code` = `e`.`country_code`             AND `bf`.`booking_country_code` = `cpies`.`country_code`             AND `bf`.`contract_type` = `t`.`contract_type`             AND `bf`.`cf_ind` = `e`.`cf_indicator`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_contract_types`.`ct_code_user`,             `stg_bcrs_contract_types`.`ct_desc_user`,             `stg_bcrs_contract_types`.`attribute_2`,             `stg_bcrs_contract_types`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_contract_types`             where              `stg_bcrs_contract_types`.`w_batch_id` = '2018071116473300773'      ) `ct` ON `t`.`contract_type` = `ct`.`ct_code_user`  Left Join ( select distinct  `stg_bcrs_contract_types`.`ct_code_user`, `stg_bcrs_contract_types`.`contract_category`, `stg_bcrs_contract_types`.`w_batch_id` from  `sgmisitstg`.`stg_bcrs_contract_types` where   `stg_bcrs_contract_types`.`w_batch_id` = '2018071116473300773' and `stg_bcrs_contract_types`.`contract_category` = 'RECEIVABLE' ) `contracttype` on `t`.`contract_type` = `contracttype`.`ct_code_user`           LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`attribute_7` AS `non_gam_ind`,             `stg_bcrs_facility`.`attribute_8` AS `holdco_ind`,             `stg_bcrs_facility`.`trade_date`,             `stg_bcrs_facility`.`maturity_date`         FROM             `sgmisitstg`.`stg_bcrs_facility`         WHERE              `stg_bcrs_facility`.`w_batch_id` = '2018071116473300773'      ) `fac` ON `t`.`contract_reference` = `fac`.`contract_reference`      LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_mkt_fx_input`.`booking_company_code`,             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL'             AND `stg_bcrs_mkt_fx_input`.`w_batch_id` = '2018071116473300773'      ) `cer` ON `t`.`booking_company` = `cer`.`booking_company_code`              AND `t`.`currency` = `cer`.`ccy_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_country`.`country_code`,             `stg_bcrs_country`.`country_name`         FROM             `sgmisitstg`.`stg_bcrs_country`         WHERE              `stg_bcrs_country`.`w_batch_id` = '2018071116473300773'      ) `c` ON `t`.`incorporation_country_original` = `c`.`country_code`      LEFT JOIN (     select `prrsrtmp`.`contract_reference`, `prrsrtmp`.`bs_type`, `prrsrtmp`.`prr`, `prrsrtmp`.`w_batch_id`, `prrsrtmp`.`rnk` from (         SELECT DISTINCT             `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,              `stg_bcrs_scb_wb_prr_sr`.`bs_type`,              `stg_bcrs_scb_wb_prr_sr`.`prr`,              `stg_bcrs_scb_wb_prr_sr`.`w_batch_id`,             ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_wb_prr_sr`.`contract_reference` ORDER BY `stg_bcrs_scb_wb_prr_sr`.`contract_reference`) AS `rnk`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_prr_sr` ) `prrsrtmp`         where             `prrsrtmp`.`rnk` = 1     ) `prrsr` ON `t`.`contract_reference` = `prrsr`.`contract_reference`              AND `t`.`bs_type` = `prrsr`.`bs_type` and `prrsr`.`w_batch_id` = '2018071116473300773'                      LEFT JOIN (             select `addtinst`.`contract_reference`, `addtinst`.`table_name`, `addtinst`.`tp_portfolio_name`, `addtinst`.`psgl_department_id`, `addtinst`.`psgl_product_code`, `addtinst`.`psgl_operating_unit`, `addtinst`.`psgl_customer_class`, `addtinst`.`rnk` from (                 SELECT                     `stg_bcrs_scb_wb_addt_inst`.`contract_reference`,                     `stg_bcrs_scb_wb_addt_inst`.`table_name`,                     `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`,                     ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ORDER BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`) AS `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2018071116473300773') `addtinst`                              WHERE                         `addtinst`.`rnk` = 1     ) `inst` ON `inst`.`contract_reference` = `t`.`contract_reference`               AND `inst`.`table_name` = `t`.`sec_table_name`                               LEFT JOIN (         SELECT             nvl(`split_ref`.`contract_reference`,`a`.`contract_reference`) `contract_reference`,             `a`.`psgl_cust_class`,             `a`.`psgl_product`,             TRIM(`a`.`psgl_department`) `psgl_department`,             `a`.`fermat_table_name`         FROM             (                 SELECT DISTINCT                     `b`.`contract_reference`,                     `b`.`fermat_table_name`,                     `b`.`psgl_cust_class`,                     `b`.`psgl_product`,                     `b`.`psgl_department`,                     `c`.`priority`,                     ROW_NUMBER() OVER(PARTITION BY `b`.`contract_reference`, `b`.`fermat_table_name` ORDER BY `c`.`priority`) `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_psgl` `b`                     left join `sgmisitstg`.`stg_bcrs_scb_wb_amt_cat_priority` `c`                                         on `b`.`fermat_table_name` = `c`.`table_name`                      and `b`.`amount_category_dw_sorsa` = `c`.`amount_category_dw_sorsa`                     and `b`.`psgl_product` <> 'ZZZ'                     and `b`.`w_batch_id`='2018071116473300773'                      and `b`.`w_batch_id` = `c`.`w_batch_id`                                     ) `a`             left join             (                 SELECT DISTINCT                     `stg_bcrs_scb_wb_facility_links`.`contract_reference`,                     `stg_bcrs_scb_wb_facility_links`.`attribute_1` AS `orig_cont_ref`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_facility_links`                 WHERE                     `stg_bcrs_scb_wb_facility_links`.`attribute_1` IS NOT NULL and `stg_bcrs_scb_wb_facility_links`.`w_batch_id`='2018071116473300773'             ) `split_ref`         on             `a`.`contract_reference` = `split_ref`.`orig_cont_ref`             where   `a`.`rnk` = 1     ) `psgl` ON `t`.`contract_reference` = `psgl`.`contract_reference`               AND `t`.`sec_table_name` = `psgl`.`fermat_table_name`                                                 LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_mpdt_mru_map`.`mru_desc`,             `stg_bcrs_scb_wb_mpdt_mru_map`.`mpdt_code`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_mpdt_mru_map` where `stg_bcrs_scb_wb_mpdt_mru_map`.`w_batch_id`='2018071116473300773'     ) `mru_bus` ON `mru_bus`.`mpdt_code` = `t`.`management_product`                        LEFT JOIN `sgmisitstg`.`stg_bcrs_fdw_netting_agreement` `net` ON `net`.`agreement_reference` = `t`.`netting_agreement_reference`     and `net`.`w_batch_id`='2018071116473300773'          LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_fac_sub_limits`.`id`,             `stg_bcrs_scb_wb_fac_sub_limits`.`contract_reference`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_attribute`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_amount`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_fac_sub_limits` where `stg_bcrs_scb_wb_fac_sub_limits`.`w_batch_id`='2018071116473300773'     ) `sub` ON `t`.`id` = `sub`.`id`          LEFT JOIN (         SELECT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`book_code`,             `stg_bcrs_facility`.`currency`         FROM             `sgmisitstg`.`stg_bcrs_facility` where `stg_bcrs_facility`.`w_batch_id`='2018071116473300773'     ) `fac_curr` ON `sub`.`contract_reference` = `fac_curr`.`contract_reference`       LEFT JOIN (         SELECT             `stg_bcrs_deal_book`.`booking_company`,             `stg_bcrs_deal_book`.`book_code`         FROM             `sgmisitstg`.`stg_bcrs_deal_book` where `stg_bcrs_deal_book`.`w_batch_id`='2018071116473300773'     ) `dealbook` ON `dealbook`.`book_code` = `fac_curr`.`book_code`          LEFT JOIN (         SELECT             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`,             `stg_bcrs_mkt_fx_input`.`booking_company_code`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL' and `stg_bcrs_mkt_fx_input`.`w_batch_id`='2018071116473300773'     ) `fac_curr_exch` ON `fac_curr_exch`.`ccy_code` = `fac_curr`.`currency`                        AND `fac_curr_exch`.`booking_company_code` = `dealbook`.`booking_company`                               LEFT JOIN (         SELECT             `stg_bcrs_t_cva`.`contract_reference`,             count(`stg_bcrs_t_cva`.`contract_reference`) as `count_contract_ref`,             SUM(nvl(`stg_bcrs_t_cva`.`cva_rwa`,0) ) `cva_rwa`         FROM             `sgmisitstg`.`stg_bcrs_t_cva` where `stg_bcrs_t_cva`.`w_batch_id`='2018071116473300773'         GROUP BY             `stg_bcrs_t_cva`.`contract_reference`     ) `tcva` ON `tcva`.`contract_reference` = `t`.`contract_reference`              LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_mru_business_idntfr_map` `bus_ind`      ON `bus_ind`.`business_identifier` = `t`.`business_indentifier` and `bus_ind`.`w_batch_id`='2018071116473300773'      where `t`.`w_batch_id` = '2018071116473300773'      and `t`.`import_source` LIKE '%WB%'     and `t`.`w_snapshot_dt` = '2018-04-30'     and `t`.`w_datasource_id` = 'BCRS_ND'     and `t`.`w_country_cd`='SG'
CREATE VIEW `temp_src_query_1808061739210091024` AS SELECT distinct                      `t`.`partition_key`,     'SME' as `banking_type`,     `t`.`method_new`,     `t`.`method_original`,     `t`.`contract_reference`,     `t`.`tranche_collateral_type`,     `t`.`tranche_guarantee_type`,     `t`.`counterparty_original`,     `e`.`entity_desc` AS `counterparty_original_desc`,     `t`.`counterparty_new`,     `t`.`counterparty_new_desc`,     `t`.`table_name`,     `t`.`bis_past_due`,     `t`.`contract_type`,     `ct`.`ct_desc_user` AS `contract_desc`,     `e`.`cf_indicator`,     (         CASE             WHEN upper(`t`.`counterparty_original`) LIKE '%_CORPORATE%'                  OR upper(`t`.`counterparty_original`) LIKE '%_BANK%'                  OR `t`.`counterparty_original` = '9999999999-1'                  OR `t`.`counterparty_original` = '9999999998-1' THEN 'Y'             ELSE 'N'         END     ) AS `unmapped_ind`,     (         CASE             WHEN upper(`e`.`attribute_4`) = 'CN' THEN 'Y'             ELSE 'N'         END     ) AS `non_borrowing_ind`,     (         CASE  WHEN `contracttype`.`ct_code_user` is not null THEN 'PURCHASED_RECEIVABLE'             WHEN `t`.`contract_type` IN ( 'GMGMKTPTEQ' ) THEN 'PRIVATE_EQUITY'             WHEN `t`.`contract_type` IN ( 'GMGMKTAINV', 'GMGMKTANPL'  ) THEN 'ALT_INVST'             WHEN `e`.`et_code_user` IN (  'BSC23'  ) THEN 'DEV_ORG'    WHEN `e`.`et_code_user` IN (  'BSC16'  ) THEN 'MDB'             WHEN `e`.`et_code_user` IN (  'BSC24' ) THEN 'PERSONAL'             WHEN `e`.`scorecard_segment_code` IN (  'CFSC'   ) THEN 'SME'             WHEN `e`.`scorecard_segment_category` IN (  'F1'  ) THEN 'BANK'             WHEN `e`.`scorecard_segment_category` IN (  'F2', 'F3'  ) THEN 'NBFI'             WHEN `e`.`scorecard_segment_category` IN (  'S1' ) THEN 'SOV'    WHEN `e`.`scorecard_segment_category` IN (  'CRE', 'PF', 'SF' ) THEN 'SPECIALISED LENDING'             WHEN `e`.`scorecard_segment_category` IN (  'C1', 'C2', 'C3', 'C4', 'C5' ) THEN 'CORP'             ELSE 'CORP'         END     ) AS `segment_original`,     (         CASE             WHEN `t`.`table_name` IN (                 'DEAL_IMPORT',                 'CREDIT_DERIVATIVE'             ) THEN 'T'             ELSE 'F'         END     ) AS `derivative_ind`,     `t`.`incorporation_country_original`,     `c`.`country_name`,     `t`.`dealbook`,     `t`.`booking_company_desc`,     `e`.`attribute_1` AS `scorecard_original`,     `t`.`internal_rating_new`,     `t`.`pd_new`,     `t`.`internal_rating_original`,     `t`.`pd_original`,     (         CASE             WHEN nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`method_new` = 'ADV'                  AND `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED' THEN 0.45             WHEN `t`.`import_source` like 'NONTP-%'                  AND `t`.`method_new` = 'ADV' THEN `t`.`exposure_attribute_7`              WHEN (                 ( `t`.`tranche_collateral_type` = 'COLLATERALIZED' )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') <> 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`lgd`             WHEN (                 (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'GUARANTEED'                 )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') = 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`exposure_attribute_7`              ELSE 0         END     ) AS `lgd`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY',   'RETAIL_EXPOSURE'                  ) THEN `t`.`outstanding`             ELSE 0         END     ) AS `outstanding`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY',     'RETAIL_EXPOSURE'             ) THEN `t`.`accrued_interest`             ELSE 0         END     ) AS `accrued_interest`,     (         CASE             WHEN `t`.`table_name` IN (                 'FACILITY'             )                  AND `t`.`bs_type` = 'OFB' THEN `t`.`outstanding`             ELSE 0         END     ) AS `headroom`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN `t`.`fair_value`             ELSE 0         END     ) AS `mtm`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN (                         CASE                             WHEN `t`.`fair_value` > 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                     ELSE (                         CASE                             WHEN `t`.`fair_value` < 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                 END             )             ELSE 0         END     ) AS `replacement_cost`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`t`.`nominal`) *-1                     ELSE abs(`t`.`nominal`)                 END             )             ELSE 0         END     ) AS `notional`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN `t`.`add_on`             ELSE 0         END     ) AS `add_on`,     `t`.`ead`,     `t`.`rwa`,     `t`.`rwa_pre_crm`,     `t`.`el`,     `t`.`rgc`,     `t`.`ead_original`,     `t`.`tier1_deduction`,     `t`.`tier2_deduction`,     `t`.`ead_pre_ccf`,     `t`.`nominal`,     `t`.`fair_value`,     `t`.`ead_pro`,     `t`.`ead_pro_gen`,     nvl(`prrsr`.`prr`,0) `prr`,     ( `t`.`ead` * `t`.`pd_original` ) AS `wt_pd_original`,     ( `t`.`ead` * `t`.`pd_new` ) AS `wt_pd_new`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45 * `t`.`ead`             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd` * `t`.`ead`             ELSE 0         END     ) AS `wt_lgd`,     ( `t`.`ead` * `t`.`k_maturity` ) AS `wt_k_maturity`,     ( `t`.`ead` * `t`.`residual_maturity` ) AS `wt_residual_maturity`,     `t`.`total_annual_sales`,     `t`.`hfx`,     `t`.`hc`,     `t`.`he`,     `t`.`k_maturity`,     `t`.`facility_reference`,     `t`.`performing_status`,     `t`.`securitization_reference`,     `t`.`days_after_contractual_date`,     `t`.`risk_bucket`,     `t`.`delivery_type`,     `t`.`funding_ccy`,     coalesce( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr`.`currency`             ELSE `t`.`currency`         END     ),`t`.`currency`) AS `currency`,     `t`.`residual_maturity`,     `t`.`original_maturity`,     `t`.`ead_method`,     `t`.`ccf`,     `t`.`inter_company`,     `t`.`trading_book_type`,     `e`.`attribute_7` AS `customer_segment_code`,     `e`.`customer_segment_desc`,     `e`.`attribute_8` AS `customer_subsegment_code`,     `e`.`customer_subsegment_desc`,     `t`.`id`,     `t`.`import_source`,     `t`.`product_gl_criteria`,     `t`.`bs_type`,     `t`.`securitized`,     `t`.`risk_type`,     `t`.`bis_product`,     `t`.`bis_product_category`,     `t`.`bis_entity_type_new`,     `t`.`bis_entity_type_original`,     `t`.`asset_class_new`,     `t`.`asset_class_original`,     `t`.`netting_agreement_reference`,     `t`.`collateral_reference`,     `t`.`collateral_contract_type`,     `t`.`collateral_bis_product`,     `t`.`collateral_product_category`,     `t`.`guarantee_reference`,     `t`.`guarantee_contract_type`,     `t`.`guarantee_bis_product`,     `t`.`counterparty_type_new`,     `t`.`sub_method_new`,     `t`.`rw_scaling_factor`,     `t`.`rwa_scaling_factor`,     `t`.`exposure_attribute_7`,     `t`.`exposure_attribute_8`,     `t`.`exposure_attribute_9`,     `t`.`rw_original`,     `t`.`rw_new`,     `t`.`securitization_n`,     `t`.`crm_method`,     `t`.`division_code`,     `t`.`secu_ea_controlled`,     `t`.`secu_company_weight`,     `t`.`secu_bank_role`,     `t`.`obligor_grade_new`,     `t`.`standard_rw_original`,     `t`.`standard_rw_new`,     `t`.`cpty_group`,     `t`.`cpty_group_original`,     `t`.`bis_industry_sector_new`,     `t`.`bis_industry_sector_original`,     `t`.`bis_risk_area_new`,     `t`.`bis_risk_area_original`,     `t`.`incorporation_country_new`,     `t`.`int_rating_agency_new`,     `t`.`risk_country`,     `t`.`used_amount_facility`,     `t`.`beel`,     `t`.`uncommited`,          case when `csr`.`start_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0) - nvl(`t`.`original_maturity`,0)) * 365.25) as INT)) as date)     else `csr`.`start_date` end as `start_date`,       case when `csr`.`maturity_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0)) * 365.25) as INT)) as date)      else `csr`.`maturity_date` end as `maturity_date`,          `t`.`value_date`,     (         CASE             WHEN nvl(`t`.`residual_maturity`,0) <= 1               THEN '<=1yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 3 and nvl(`t`.`residual_maturity`,0) > 1  THEN '1-3yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 5 and nvl(`t`.`residual_maturity`,0) > 3  THEN '3-5yrs'             ELSE '>5yrs'         END     ) AS `maturity_range`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd`             ELSE 0         END     ) AS `tranche_lgd`,         CASE WHEN (`complink`.`mother_code` = '999C' or `complink`.`mother_code` = '976C') and `complink`.`child_code` is not null then 'SOLO'          ELSE 'SUBS' END `company_type`,     nvl(`mru_bus`.`mru_desc`,'UNMAPPED') AS `business`,     `inst`.`psgl_operating_unit` AS `psgl_operating_unit`,     `psgl`.`psgl_cust_class`,     (         CASE             WHEN `t`.`table_name` = 'TRANCHE'                  AND `t`.`bs_type` IN(                 'VIF','VIR'             ) THEN 'TRANCHE_FILTER'             WHEN `t`.`inter_company` = 'T' THEN 'INTERCOMPANY_FILTER'             ELSE 'BCRS'         END     )   AS `filter_type`,     (         CASE             WHEN `t`.`securitized` = 'T'   THEN 'SECURITIZED'             WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'             WHEN `t`.`trading_book_type` = 'T'                  AND `t`.`bis_product_category` IN(                 'REPO','DERIVATIVE','DERIVATIVE_OTC','CREDIT_DERIVATIVE'             ) THEN 'CCR'             WHEN `t`.`tranche_collateral_type` = 'COLLATERALIZED'                  AND `t`.`collateral_bis_product` IN(                 'REP_NET_COL','OTC_NET_COL'             ) THEN 'NETTING_BENEFIT'             ELSE 'FSA'         END     )  AS `fsa_exclusion_type`,     (         CASE             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_past_due` = 'T' THEN 'PAST_DUE_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`asset_class_new` = 'CLAIM_OTH_150'                 OR (                     (                         (                             `t`.`rw_original` >= 1.5                             OR `t`.`standard_rw_original` >= 1.5                         )                         AND NOT (                             (                                 `t`.`tranche_collateral_type` = 'COLLATERALIZED'                                 AND `t`.`crm_method` = 'SIM'                                 AND `t`.`collateral_product_category` = 'FINANCIAL_COL'                             )                             OR `t`.`tranche_guarantee_type` = 'GUARANTEED'                         )                     )                     OR `t`.`rw_new` >= 1.5                 )             ) THEN 'HIGH_RISK_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 ( `t`.`asset_class_new` LIKE '%EQT' )                 OR (                     `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                     AND `t`.`sub_reference` = 'MULTI NAME'                 )                 OR ( `t`.`risk_type` = 'RVR' )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` IN (                 'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE',                 'CLAIM_SEC_CRE',                 'CLAIM_FULL_SEC_RRE'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`collateral_bis_product` IN (                 'RRE_COL',                 'LEASING_CRE_COL',                 'CRE_COL',                 'LEASING_RRE_COL'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_COVERED_BOND' THEN 'COVERED_BONDS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_CIU' THEN 'COLLECTIVE_INV_UNDERTAKINGS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF',                 'CORP',                 'INSURANCE',                 'CORP_CF',                 'CORP_HVCRE',                 'CORP_IPRE',                 'CORP_OF',                 'CORP_PF',                 'EX_RETAIL',                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'SPE',                 'CORP_INT_GRP'             )                  AND (                 `t`.`risk_bucket` IN (                     30,                     31,                     32,                     33,                     34                 )                 OR `t`.`risk_bucket_original` IN (                     30,                     31,                     32,                     33,                     34                 )             ) THEN 'SHORT_TERM_CLAIMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SOV'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'RGLA',                 'RGLA_SOV',                 'RGLA_SOV_EU'             ) THEN 'REGIONAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'PSE',                 'PSE_BANK',                 'PSE_SOV'             ) THEN 'ADMIN_BODIES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'MDB',                 'MDB_PREF_0',                 'MDB_PREF_20'             ) THEN 'MULTILATERAL_DEVT_BANKS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SUPRA',                 'EIF',                 'SUPRA_100'             ) THEN 'INTL_ORGANIZATIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`bis_entity_type_new` IN (                     'SME',                     'SME_CF',                     'SME_HVCRE',                     'SME_IPRE',                     'SME_OF',                     'SME_PF',                     'CORP',                     'INSURANCE',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'CORP_INT_GRP'                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'INDIV',                 'SME_RETAIL'             )                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL'             WHEN `t`.`method_new` = 'STD' THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`bis_entity_type_new` NOT IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` = 'CLAIM_OTH_100'                 )                 AND (                     `t`.`bis_product_category` NOT IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 ( `t`.`asset_class_new` = 'CLAIM%EQT' )                 OR ( `t`.`asset_class_new` = 'CLAIM_CIU' )             ) THEN 'EQUITY_CLAIMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`asset_class_new` IN (                         'CLAIM_FULL_SEC_RRE',                         'CLAIM_SEC_RRE_LEASE',                         'CRE_COL',                         'CLAIM_SEC_CRE',                         'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE'                     )                     OR `t`.`collateral_bis_product` IN (                         'RRE_COL',                         'LEASING_RRE_COL',                         'LEASING_CRE_COL',                         'CRE_COL'                     )                 )                 AND `t`.`bis_entity_type_new` IN (                     'INDIV',                     'SME_RETAIL'                 )             ) THEN 'RETAIL_MORTGAGES'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_RETAIL_QUALIFYING_REVOLVING' THEN 'RETAIL_QRRE'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'INDIV'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_OTHER'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'SME_RETAIL'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_SME'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'FOU'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'ADV'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             ELSE 'OTHER_ITEMS'         END     ) AS `fsa004_asset_class`,     `t`.`secu_mode`,     `t`.`risk_bucket_original`,     `t`.`waterfall_seniority`,     `e`.`origination_country` AS `ccr_original`,     `enew`.`origination_country` AS `ccr_new`,     `t`.`stress_testing_scenario_id`,     `t`.`collateral_attribute_1`,     `t`.`collateral_attribute_9`,     `t`.`exposure_attribute_1`,     `t`.`exposure_attribute_6`,     `t`.`counterparty_new_attribute_1`,     `t`.`sub_reference`,     `t`.`sub_method_original`,     `t`.`int_rating_agency_original`,     `t`.`ead_formula`,     `t`.`booking_company`,     `t`.`obligor_grade_inf_new`,     `t`.`obligor_grade_sup_new`,     `t`.`incorporation_ccy_original`,     `t`.`incorporation_ccy_new`,     nvl(`t`.`management_product`,'UNMAPPED') AS `management_product`,     `bus_ind`.`business_identifier_desc` AS `business_identifier`,       CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_w_filter_type`,              CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_filter_type`,          `ct`.`attribute_2` AS `balance_category`,     nvl( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr_exch`.`exch_rate`             ELSE `cer`.`exch_rate`         END     ),`cer`.`exch_rate`) AS `exchange_rate`,     `fac`.`holdco_ind` AS `holding_company_ind`,     `fac`.`non_gam_ind` AS `non_gam_ind`,     `egroup_orig`.`group_cust_segment_code`,     `egroup_orig`.`group_cust_segment_desc`,     `t`.`original_cost`,     `t`.`premium_current`,     `t`.`security_positions_ref`,     `t`.`pd_pre_floor_new`,     `t`.`exposure_attribute_3`,     `t`.`exposure_attribute_4`,     `t`.`exposure_attribute_5`,     `t`.`counterparty_new_attribute_3`,     `t`.`counterparty_new_attribute_4`,     `t`.`collateral_attribute_7`,     `t`.`collateral_attribute_8`,     `e`.`long_term_rating_local_ccy` AS `internal_rating_local_ccy_orig`,     `t`.`past_due_int`,     `t`.`ead_pro_discount`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`ltv`             ELSE 0         END     ) AS `ltv`,     (         CASE             WHEN `bf`.`domicile_country_code` IS NOT NULL                  AND nvl(`e`.`bf_link_type`,'z') = 'BUYER_FINANCE' THEN 'Y'             ELSE 'N'         END     ) AS `buyer_finance_ind`,     `t`.`counterparty_ext_rat_code`,     `t`.`counterparty_ext_rat_agency`,     `t`.`counterparty_int_rat_code`,     `t`.`counterparty_int_rat_agency`,     `t`.`maturity_eff`,     `psgl`.`psgl_department` AS `psgl_department_id`,     `psgl`.`psgl_product` AS `psgl_product_code`    , `net`.`netting_type` AS `netting_agreement_type`,     `sub`.`contract_reference` AS `sub_limit_fac_reference`,     `sub`.`limit_amount` AS `limit_amount`,     `sub`.`limit_attribute` AS `limit_attribute`,      CASE WHEN `tcva`.`cva_rwa`  <= 0 THEN nvl(`tcva`.`cva_rwa`,0) / nvl(`tcva`.`count_contract_ref`,0)          ELSE round(nvl(`t`.`rwa`,0),2) / (`t2`.`sum_rwa` * round(nvl(`tcva`.`cva_rwa`,0),2))     END `cva_rwa`,          `t`.`qualifying_ccp`,     `t`.`k_function_used`,     `t`.`k_function_used_original`,     `t`.`product_gl_criteria_2`,     `t`.`bis_past_due_original`,     `t`.`risk_country_new`,     `t`.`risk_country_original`,     `t`.`booking_company_incorp_country`,     `t`.`ccf_std`,     `t`.`past_due_days`,     `t`.`guarantee_method`,     `t`.`fde_alternative_method`,     `t`.`rwa_pre_cap`,     `t`.`asset_class_category_new`,     `t`.`asset_class_category_original`        FROM ( SELECT `stg_bcrs_t_cdr`.`partition_key`, `stg_bcrs_t_cdr`.`stress_testing_scenario_id`, `stg_bcrs_t_cdr`.`tranche_collateral_type`, `stg_bcrs_t_cdr`.`tranche_guarantee_type`, `stg_bcrs_t_cdr`.`bs_type`, `stg_bcrs_t_cdr`.`contract_reference`, `stg_bcrs_t_cdr`.`contract_type`, `stg_bcrs_t_cdr`.`bis_product`, `stg_bcrs_t_cdr`.`bis_product_category`, `stg_bcrs_t_cdr`.`unconditionnaly_cancelable`, `stg_bcrs_t_cdr`.`ead_original`, `stg_bcrs_t_cdr`.`ead_pre_ccf`, `stg_bcrs_t_cdr`.`ead`, `stg_bcrs_t_cdr`.`ead_pro`, `stg_bcrs_t_cdr`.`facility_reference`, `stg_bcrs_t_cdr`.`collateral_reference`, `stg_bcrs_t_cdr`.`collateral_contract_type`, `stg_bcrs_t_cdr`.`collateral_bis_product`, `stg_bcrs_t_cdr`.`guarantee_reference`, `stg_bcrs_t_cdr`.`guarantee_contract_type`, `stg_bcrs_t_cdr`.`guarantee_bis_product`, `stg_bcrs_t_cdr`.`netting_agreement_reference`, `stg_bcrs_t_cdr`.`netting_agreement_type`, `stg_bcrs_t_cdr`.`counterparty_original`, `stg_bcrs_t_cdr`.`counterparty_type_original`, `stg_bcrs_t_cdr`.`counterparty_new`, `stg_bcrs_t_cdr`.`counterparty_type_new`, `stg_bcrs_t_cdr`.`total_annual_sales`, `stg_bcrs_t_cdr`.`total_annual_assets`, `stg_bcrs_t_cdr`.`bis_entity_type_original`, `stg_bcrs_t_cdr`.`bis_entity_type_new`, `stg_bcrs_t_cdr`.`asset_class_original`, `stg_bcrs_t_cdr`.`asset_class_new`, `stg_bcrs_t_cdr`.`method_original`, `stg_bcrs_t_cdr`.`sub_method_original`, `stg_bcrs_t_cdr`.`method_new`, `stg_bcrs_t_cdr`.`sub_method_new`, `stg_bcrs_t_cdr`.`guarantee_method`, `stg_bcrs_t_cdr`.`he`, `stg_bcrs_t_cdr`.`maturity_eff`, `stg_bcrs_t_cdr`.`k_maturity`, `stg_bcrs_t_cdr`.`pd_original`, `stg_bcrs_t_cdr`.`internal_rating_original`, `stg_bcrs_t_cdr`.`pd_new`, `stg_bcrs_t_cdr`.`internal_rating_new`, `stg_bcrs_t_cdr`.`lgd`, `stg_bcrs_t_cdr`.`lgd_grade_agency`, `stg_bcrs_t_cdr`.`ccf`, `stg_bcrs_t_cdr`.`hfx`, `stg_bcrs_t_cdr`.`hc`, `stg_bcrs_t_cdr`.`mm`, `stg_bcrs_t_cdr`.`floor1`, `stg_bcrs_t_cdr`.`floor2`, `stg_bcrs_t_cdr`.`rwa`, `stg_bcrs_t_cdr`.`rgc`, `stg_bcrs_t_cdr`.`rwa_pre_crm`, `stg_bcrs_t_cdr`.`el`, `stg_bcrs_t_cdr`.`beel`, `stg_bcrs_t_cdr`.`bis_past_due`, `stg_bcrs_t_cdr`.`performing_status`, `stg_bcrs_t_cdr`.`rw_scaling_factor`, `stg_bcrs_t_cdr`.`rwa_scaling_factor`, `stg_bcrs_t_cdr`.`equity_scaling_factor`, `stg_bcrs_t_cdr`.`exemption_maturity_floor`, `stg_bcrs_t_cdr`.`grand_fathering_applied`, `stg_bcrs_t_cdr`.`legislated_program_applied`, `stg_bcrs_t_cdr`.`non_material_equity`, `stg_bcrs_t_cdr`.`zero_rw_for_equity`, `stg_bcrs_t_cdr`.`zero_haircut_for_repo`, `stg_bcrs_t_cdr`.`k_function_used`, `stg_bcrs_t_cdr`.`ead_formula`, `stg_bcrs_t_cdr`.`risk_type`, `stg_bcrs_t_cdr`.`trading_book_type`, `stg_bcrs_t_cdr`.`table_name`, `stg_bcrs_t_cdr`.`exposure_attribute_1`, `stg_bcrs_t_cdr`.`exposure_attribute_2`, `stg_bcrs_t_cdr`.`exposure_attribute_3`, `stg_bcrs_t_cdr`.`exposure_attribute_4`, `stg_bcrs_t_cdr`.`exposure_attribute_5`, `stg_bcrs_t_cdr`.`exposure_attribute_6`, `stg_bcrs_t_cdr`.`exposure_attribute_7`, `stg_bcrs_t_cdr`.`exposure_attribute_8`, `stg_bcrs_t_cdr`.`exposure_attribute_9`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_1`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_2`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_3`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_4`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_5`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_6`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_7`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_8`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_9`, `stg_bcrs_t_cdr`.`collateral_attribute_1`, `stg_bcrs_t_cdr`.`collateral_attribute_2`, `stg_bcrs_t_cdr`.`collateral_attribute_3`, `stg_bcrs_t_cdr`.`collateral_attribute_4`, `stg_bcrs_t_cdr`.`collateral_attribute_5`, `stg_bcrs_t_cdr`.`collateral_attribute_6`, `stg_bcrs_t_cdr`.`collateral_attribute_7`, `stg_bcrs_t_cdr`.`collateral_attribute_8`, `stg_bcrs_t_cdr`.`collateral_attribute_9`, `stg_bcrs_t_cdr`.`guarantee_attribute_1`, `stg_bcrs_t_cdr`.`guarantee_attribute_2`, `stg_bcrs_t_cdr`.`guarantee_attribute_3`, `stg_bcrs_t_cdr`.`guarantee_attribute_4`, `stg_bcrs_t_cdr`.`guarantee_attribute_5`, `stg_bcrs_t_cdr`.`guarantee_attribute_6`, `stg_bcrs_t_cdr`.`guarantee_attribute_7`, `stg_bcrs_t_cdr`.`guarantee_attribute_8`, `stg_bcrs_t_cdr`.`guarantee_attribute_9`, `stg_bcrs_t_cdr`.`inter_company`, `stg_bcrs_t_cdr`.`rwa_pre_cap`, `stg_bcrs_t_cdr`.`rw_original`, `stg_bcrs_t_cdr`.`rw_new`, `stg_bcrs_t_cdr`.`tier1_deduction`, `stg_bcrs_t_cdr`.`tier2_deduction`, `stg_bcrs_t_cdr`.`securitized`, `stg_bcrs_t_cdr`.`seniority_original`, `stg_bcrs_t_cdr`.`seniority_new`, `stg_bcrs_t_cdr`.`collateral_product_category`, `stg_bcrs_t_cdr`.`dealbook`, `stg_bcrs_t_cdr`.`deal_status`, `stg_bcrs_t_cdr`.`sub_reference`, `stg_bcrs_t_cdr`.`securitization_reference`, `stg_bcrs_t_cdr`.`securitization_n`, `stg_bcrs_t_cdr`.`waterfall_seniority`, `stg_bcrs_t_cdr`.`risk_country`, `stg_bcrs_t_cdr`.`zone_a_original`, `stg_bcrs_t_cdr`.`zone_a_new`, `stg_bcrs_t_cdr`.`lgd_mitigation`, `stg_bcrs_t_cdr`.`crm_method`, `stg_bcrs_t_cdr`.`look_through_treatment`, `stg_bcrs_t_cdr`.`second_loss_treatment`, `stg_bcrs_t_cdr`.`risk_bucket`, `stg_bcrs_t_cdr`.`pool_code`, `stg_bcrs_t_cdr`.`incorporation_country`, `stg_bcrs_t_cdr`.`division_code`, `stg_bcrs_t_cdr`.`secu_loss_position`, `stg_bcrs_t_cdr`.`secu_issue_date`, `stg_bcrs_t_cdr`.`secu_ea_controlled`, `stg_bcrs_t_cdr`.`secu_company_weight`, `stg_bcrs_t_cdr`.`secu_bank_role`, `stg_bcrs_t_cdr`.`secu_mode`, `stg_bcrs_t_cdr`.`import_source`, `stg_bcrs_t_cdr`.`company_code`, `stg_bcrs_t_cdr`.`supervisor_code`, `stg_bcrs_t_cdr`.`ccy_code`, `stg_bcrs_t_cdr`.`settlement_price`, `stg_bcrs_t_cdr`.`days_after_contractual_date`, `stg_bcrs_t_cdr`.`delivery_type`, `stg_bcrs_t_cdr`.`mortgage_alternative`, `stg_bcrs_t_cdr`.`booking_company`, `stg_bcrs_t_cdr`.`booking_company_desc`, `stg_bcrs_t_cdr`.`gaap_code`, `stg_bcrs_t_cdr`.`number_of_obligor`, `stg_bcrs_t_cdr`.`security_positions_ref`, `stg_bcrs_t_cdr`.`guar_sub_reference`, `stg_bcrs_t_cdr`.`flag_adjustment`, `stg_bcrs_t_cdr`.`internal_maturity_class`, `stg_bcrs_t_cdr`.`equity_floor_applied`, `stg_bcrs_t_cdr`.`equity_preferential_treatment`, `stg_bcrs_t_cdr`.`fde_alternative_method`, `stg_bcrs_t_cdr`.`collateral_table_name`, `stg_bcrs_t_cdr`.`collateral_mode`, `stg_bcrs_t_cdr`.`funding_ccy`, `stg_bcrs_t_cdr`.`currency`, `stg_bcrs_t_cdr`.`incorporation_ccy_original`, `stg_bcrs_t_cdr`.`incorporation_ccy_new`, `stg_bcrs_t_cdr`.`credit_substitute`, `stg_bcrs_t_cdr`.`value_date`, `stg_bcrs_t_cdr`.`original_maturity`, `stg_bcrs_t_cdr`.`residual_maturity`, `stg_bcrs_t_cdr`.`booking_company_incorp_country`, `stg_bcrs_t_cdr`.`business_line_code`, `stg_bcrs_t_cdr`.`family`, `stg_bcrs_t_cdr`.`standard_rw_new`, `stg_bcrs_t_cdr`.`standard_rw_original`, `stg_bcrs_t_cdr`.`risk_bucket_original`, `stg_bcrs_t_cdr`.`collateral_assigned_amount`, `stg_bcrs_t_cdr`.`used_amount_facility`, `stg_bcrs_t_cdr`.`rwa_pre_floor_equity`, `stg_bcrs_t_cdr`.`bis_past_due_original`, `stg_bcrs_t_cdr`.`ltv`, `stg_bcrs_t_cdr`.`ltv_current`, `stg_bcrs_t_cdr`.`hr`, `stg_bcrs_t_cdr`.`hcr`, `stg_bcrs_t_cdr`.`und_pool_ref`, `stg_bcrs_t_cdr`.`asset_class_category_original`, `stg_bcrs_t_cdr`.`asset_class_category_new`, `stg_bcrs_t_cdr`.`netting_agreement_amount_1`, `stg_bcrs_t_cdr`.`netting_agreement_amount_2`, `stg_bcrs_t_cdr`.`netting_agreement_amount_3`, `stg_bcrs_t_cdr`.`netting_agreement_amount_4`, `stg_bcrs_t_cdr`.`netting_agreement_amount_5`, `stg_bcrs_t_cdr`.`netting_agreement_amount_6`, `stg_bcrs_t_cdr`.`netting_agreement_amount_7`, `stg_bcrs_t_cdr`.`entity_type_category_original`, `stg_bcrs_t_cdr`.`entity_type_category_new`, `stg_bcrs_t_cdr`.`ead_pro_write_off`, `stg_bcrs_t_cdr`.`ead_pro_discount`, `stg_bcrs_t_cdr`.`cpty_group`, `stg_bcrs_t_cdr`.`counterparty_new_desc`, `stg_bcrs_t_cdr`.`internal_rating_new_rank`, `stg_bcrs_t_cdr`.`uncommited`, `stg_bcrs_t_cdr`.`capital_item`, `stg_bcrs_t_cdr`.`product_gl_criteria`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_ori`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_new`, `stg_bcrs_t_cdr`.`secu_retail_line_fg`, `stg_bcrs_t_cdr`.`secu_uncommited_retail_fg`, `stg_bcrs_t_cdr`.`secu_spread_trapping_ratio`, `stg_bcrs_t_cdr`.`collateral_issuer`, `stg_bcrs_t_cdr`.`coll_issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`collateral_haircut_risk_bucket`, `stg_bcrs_t_cdr`.`guarantor`, `stg_bcrs_t_cdr`.`guarantor_bis_entity_type`, `stg_bcrs_t_cdr`.`ead_pro_gen`, `stg_bcrs_t_cdr`.`pd_pre_floor_original`, `stg_bcrs_t_cdr`.`pd_pre_floor_new`, `stg_bcrs_t_cdr`.`lgd_pre_floor_original`, `stg_bcrs_t_cdr`.`lgd_pre_floor_new`, `stg_bcrs_t_cdr`.`int_rating_agency_original`, `stg_bcrs_t_cdr`.`int_rating_agency_new`, `stg_bcrs_t_cdr`.`cpty_group_original`, `stg_bcrs_t_cdr`.`nominal`, `stg_bcrs_t_cdr`.`add_on`, `stg_bcrs_t_cdr`.`fair_value`, `stg_bcrs_t_cdr`.`amortized_cost`, `stg_bcrs_t_cdr`.`accrued_interest`, `stg_bcrs_t_cdr`.`amortized_cost_no_ias`, `stg_bcrs_t_cdr`.`adjustment_amount`, `stg_bcrs_t_cdr`.`outstanding`, `stg_bcrs_t_cdr`.`original_cost`, `stg_bcrs_t_cdr`.`accrued_fees`, `stg_bcrs_t_cdr`.`past_due_ppal`, `stg_bcrs_t_cdr`.`past_due_int`, `stg_bcrs_t_cdr`.`premium_current`, `stg_bcrs_t_cdr`.`cpty_new_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`cpty_orig_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`effective_epe`, `stg_bcrs_t_cdr`.`ead_method`, `stg_bcrs_t_cdr`.`netting_class`, `stg_bcrs_t_cdr`.`bis_industry_sector_new`, `stg_bcrs_t_cdr`.`bis_industry_sector_original`, `stg_bcrs_t_cdr`.`bis_risk_area_new`, `stg_bcrs_t_cdr`.`bis_risk_area_original`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_new`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_original`, `stg_bcrs_t_cdr`.`risk_country_new`, `stg_bcrs_t_cdr`.`risk_country_original`, `stg_bcrs_t_cdr`.`incorporation_country_new`, `stg_bcrs_t_cdr`.`incorporation_country_original`, `stg_bcrs_t_cdr`.`bis_performing_status`, `stg_bcrs_t_cdr`.`rwa_cap_ratio`, `stg_bcrs_t_cdr`.`exposure_amount_1`, `stg_bcrs_t_cdr`.`exposure_amount_2`, `stg_bcrs_t_cdr`.`final_beneficiary`, `stg_bcrs_t_cdr`.`collateral_valuation_date`, `stg_bcrs_t_cdr`.`unrestricted_psia_pct`, `stg_bcrs_t_cdr`.`restricted_psia_pct`, `stg_bcrs_t_cdr`.`collateral_issued_by_the_bank`, `stg_bcrs_t_cdr`.`guarantee_issued_by_the_bank`, `stg_bcrs_t_cdr`.`rated_borrower`, `stg_bcrs_t_cdr`.`long_short`, `stg_bcrs_t_cdr`.`external_rating_new`, `stg_bcrs_t_cdr`.`external_rating_original`, `stg_bcrs_t_cdr`.`external_rating_agency_new`, `stg_bcrs_t_cdr`.`external_rating_agency_orig`, `stg_bcrs_t_cdr`.`collateral_country`, `stg_bcrs_t_cdr`.`issuer`, `stg_bcrs_t_cdr`.`issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`issuer_country`, `stg_bcrs_t_cdr`.`product_gl_criteria_2`, `stg_bcrs_t_cdr`.`positions_type`, `stg_bcrs_t_cdr`.`eligibility_risk_bucket`, `stg_bcrs_t_cdr`.`retail_purpose`, `stg_bcrs_t_cdr`.`color_id`, `stg_bcrs_t_cdr`.`past_due_days`, `stg_bcrs_t_cdr`.`collateral_asset_class`, `stg_bcrs_t_cdr`.`collateral_standard_rw`, `stg_bcrs_t_cdr`.`collateral_asset_class_cat`, `stg_bcrs_t_cdr`.`collateral_risk_bucket`, `stg_bcrs_t_cdr`.`coll_issuer_incorporation_ccy`, `stg_bcrs_t_cdr`.`fund_composition_ref`, `stg_bcrs_t_cdr`.`secu_retention_percentage`, `stg_bcrs_t_cdr`.`secu_retention_calc_method`, `stg_bcrs_t_cdr`.`rw_add_on`, `stg_bcrs_t_cdr`.`lgd_non_performing`, `stg_bcrs_t_cdr`.`ccf_std`, `stg_bcrs_t_cdr`.`concentration_ratio`, `stg_bcrs_t_cdr`.`ttc_lgd`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_code`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_agency`, `stg_bcrs_t_cdr`.`counterparty_int_rat_code`, `stg_bcrs_t_cdr`.`counterparty_int_rat_agency`, `stg_bcrs_t_cdr`.`gl_strategy_code`, `stg_bcrs_t_cdr`.`k_function_used_original`, `stg_bcrs_t_cdr`.`long_gross_position`, `stg_bcrs_t_cdr`.`short_gross_position`, `stg_bcrs_t_cdr`.`correlation_trading`, `stg_bcrs_t_cdr`.`ead_pro_pre_ccf`, `stg_bcrs_t_cdr`.`ead_pro_write_off_pre_ccf`, `stg_bcrs_t_cdr`.`sup_reg_vers_code`, `stg_bcrs_t_cdr`.`dataset_version`, `stg_bcrs_t_cdr`.`clearing_house_code`, `stg_bcrs_t_cdr`.`contract_maturity_eff`, `stg_bcrs_t_cdr`.`counterparty_code_2`, `stg_bcrs_t_cdr`.`qualifying_transaction`, `stg_bcrs_t_cdr`.`qualifying_ccp`, `stg_bcrs_t_cdr`.`sov_rating_used`, `stg_bcrs_t_cdr`.`sov_rating_used_ori`, `stg_bcrs_t_cdr`.`current_ead_imm`, `stg_bcrs_t_cdr`.`current_maturity_eff_imm`, `stg_bcrs_t_cdr`.`obligor_grade_original`, `stg_bcrs_t_cdr`.`obligor_grade_new`, `stg_bcrs_t_cdr`.`deduction_step`, `stg_bcrs_t_cdr`.`significant_investment`, `stg_bcrs_t_cdr`.`el_std`, `stg_bcrs_t_cdr`.`deduction_pct`, `stg_bcrs_t_cdr`.`indirect_position`, `stg_bcrs_t_cdr`.`std_risk_bucket_ori`, `stg_bcrs_t_cdr`.`std_risk_bucket_new`, `stg_bcrs_t_cdr`.`ccp_dfund_method`, `stg_bcrs_t_cdr`.`secu_underlying_asset_type`, `stg_bcrs_t_cdr`.`margin_period`, `stg_bcrs_t_cdr`.`ead_scalar`, `stg_bcrs_t_cdr`.`crm_first_lien`, `stg_bcrs_t_cdr`.`available_amount`, `stg_bcrs_t_cdr`.`accounting_adjustment_type`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_1`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_2`, `stg_bcrs_t_cdr`.`adjusted_value`, `stg_bcrs_t_cdr`.`ead_before_acc_adj`, `stg_bcrs_t_cdr`.`lgd_before_acc_adj`, `stg_bcrs_t_cdr`.`subset_code`, `stg_bcrs_t_cdr`.`el_rwa_part`, `stg_bcrs_t_cdr`.`industry_sector_original`, `stg_bcrs_t_cdr`.`cds_qualifying`, `stg_bcrs_t_cdr`.`default_date`, `stg_bcrs_t_cdr`.`credit_bureau_name_original`, `stg_bcrs_t_cdr`.`credit_bureau_name_refreshed`, `stg_bcrs_t_cdr`.`fico_original`, `stg_bcrs_t_cdr`.`fico_refreshed`, `stg_bcrs_t_cdr`.`pool_ead_formula`, `stg_bcrs_t_cdr`.`clearing_member`, `stg_bcrs_t_cdr`.`securitization_depth`, `stg_bcrs_t_cdr`.`securitization_loop`, `stg_bcrs_t_cdr`.`bankruptcy_remote`, `stg_bcrs_t_cdr`.`margin_type`, `stg_bcrs_t_cdr`.`collateral_bankruptcy_remote`, `stg_bcrs_t_cdr`.`collateral_margin_type`, `stg_bcrs_t_cdr`.`remargining_frequency`, `stg_bcrs_t_cdr`.`settlement_ccy`, `stg_bcrs_t_cdr`.`vm_extinguishes_mtm`, `stg_bcrs_t_cdr`.`margin_agreement`, `stg_bcrs_t_cdr`.`rw_pre_floor_new`, `stg_bcrs_t_cdr`.`rwa_pre_floor`, `stg_bcrs_t_cdr`.`ccp_exposure_type`, `stg_bcrs_t_cdr`.`carrying_amount`, `stg_bcrs_t_cdr`.`exchange_rate`, `stg_bcrs_t_cdr`.`policy_update`, `stg_bcrs_t_cdr`.`methodology_update`, `stg_bcrs_t_cdr`.`model_update`, `stg_bcrs_t_cdr`.`pd_model_update`, `stg_bcrs_t_cdr`.`lgd_model_update`, `stg_bcrs_t_cdr`.`ccf_model_update`, `stg_bcrs_t_cdr`.`ead_model_update`, `stg_bcrs_t_cdr`.`covered_ead`, `stg_bcrs_t_cdr`.`fi_type`, `stg_bcrs_t_cdr`.`maturity_date`, `stg_bcrs_t_cdr`.`policy_name`, `stg_bcrs_t_cdr`.`methodology_name`, `stg_bcrs_t_cdr`.`model_name`, `stg_bcrs_t_cdr`.`fund_reference`, `stg_bcrs_t_cdr`.`fund_method`, `stg_bcrs_t_cdr`.`fund_depth`, `stg_bcrs_t_cdr`.`fund_initial`, `stg_bcrs_t_cdr`.`rwa_pre_lvr`, `stg_bcrs_t_cdr`.`leverage`, `stg_bcrs_t_cdr`.`rw_el`, `stg_bcrs_t_cdr`.`use_beel`, `stg_bcrs_t_cdr`.`k_ratio`, `stg_bcrs_t_cdr`.`trade_date`, `stg_bcrs_t_cdr`.`sme_ceiling`, `stg_bcrs_t_cdr`.`sme_floor`, `stg_bcrs_t_cdr`.`sme_ceiling_indicator`, `stg_bcrs_t_cdr`.`fund_assets`, `stg_bcrs_t_cdr`.`obligor_grade_rank_original`, `stg_bcrs_t_cdr`.`obligor_grade_sup_original`, `stg_bcrs_t_cdr`.`obligor_grade_inf_original`, `stg_bcrs_t_cdr`.`obligor_grade_rank_new`, `stg_bcrs_t_cdr`.`obligor_grade_sup_new`, `stg_bcrs_t_cdr`.`obligor_grade_inf_new`, `stg_bcrs_t_cdr`.`lgd_grade_inf`, `stg_bcrs_t_cdr`.`lgd_grade_sup`, `stg_bcrs_t_cdr`.`lgd_grade_rank`, `stg_bcrs_t_cdr`.`lgd_grade`, `stg_bcrs_t_cdr`.`conservation_buffer`, `stg_bcrs_t_cdr`.`conservation_rgc`, `stg_bcrs_t_cdr`.`ctcycal_buffer`, `stg_bcrs_t_cdr`.`ctcycal_rgc`, `stg_bcrs_t_cdr`.`sifi_buffer`, `stg_bcrs_t_cdr`.`sifi_rgc`, `stg_bcrs_t_cdr`.`leverage_ead`, `stg_bcrs_t_cdr`.`at1_deduction`, `stg_bcrs_t_cdr`.`cet1_deduction`, `stg_bcrs_t_cdr`.`adjustment_tag`, `stg_bcrs_t_cdr`.`rw_new_grouping`, `stg_bcrs_t_cdr`.`nominal_at_rw_new`, `stg_bcrs_t_cdr`.`ead_at_rw_new`, `stg_bcrs_t_cdr`.`collateral_completed`, `stg_bcrs_t_cdr`.`rep_product`, `stg_bcrs_t_cdr`.`rep_collateral_product`, `stg_bcrs_t_cdr`.`ltv_indexed`, `stg_bcrs_t_cdr`.`origination_date`, `stg_bcrs_t_cdr`.`is_le`, `stg_bcrs_t_cdr`.`rep_industry_sector`, `stg_bcrs_t_cdr`.`scenario_process_step`, `stg_bcrs_t_cdr`.`period_id`, `stg_bcrs_t_cdr`.`period_start_date`, `stg_bcrs_t_cdr`.`period_end_date`, `stg_bcrs_t_cdr`.`scenario_process_name`, `stg_bcrs_t_cdr`.`scenario_process_id`, `stg_bcrs_t_cdr`.`regulatory_scenario_name`, `stg_bcrs_t_cdr`.`rep_asset_class`, `stg_bcrs_t_cdr`.`rep_sub_product`, `stg_bcrs_t_cdr`.`rep_arrears_band_mia`, `stg_bcrs_t_cdr`.`rep_arrears_band_pia`, `stg_bcrs_t_cdr`.`rep_payment_type`, `stg_bcrs_t_cdr`.`weighted_avg_rate`, `stg_bcrs_t_cdr`.`customer_field11`, `stg_bcrs_t_cdr`.`customer_field12`, `stg_bcrs_t_cdr`.`customer_field13`, `stg_bcrs_t_cdr`.`customer_field14`, `stg_bcrs_t_cdr`.`customer_field15`, `stg_bcrs_t_cdr`.`customer_field16`, `stg_bcrs_t_cdr`.`customer_field17`, `stg_bcrs_t_cdr`.`customer_field18`, `stg_bcrs_t_cdr`.`customer_field19`, `stg_bcrs_t_cdr`.`customer_field20`, `stg_bcrs_t_cdr`.`customer_field21`, `stg_bcrs_t_cdr`.`customer_number11`, `stg_bcrs_t_cdr`.`customer_number12`, `stg_bcrs_t_cdr`.`customer_number13`, `stg_bcrs_t_cdr`.`customer_number14`, `stg_bcrs_t_cdr`.`customer_number15`, `stg_bcrs_t_cdr`.`customer_number16`, `stg_bcrs_t_cdr`.`customer_number17`, `stg_bcrs_t_cdr`.`customer_number18`, `stg_bcrs_t_cdr`.`customer_date1`, `stg_bcrs_t_cdr`.`customer_date2`, `stg_bcrs_t_cdr`.`customer_date3`, `stg_bcrs_t_cdr`.`rep_major_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_major_asset_class_new`, `stg_bcrs_t_cdr`.`rep_asset_class_new`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_new`, `stg_bcrs_t_cdr`.`rep_maturity_band`, `stg_bcrs_t_cdr`.`rep_segmentation`, `stg_bcrs_t_cdr`.`src_reporting_date`, `stg_bcrs_t_cdr`.`src_wks_name`, `stg_bcrs_t_cdr`.`src_position`, `stg_bcrs_t_cdr`.`generic_reporting_date`, `stg_bcrs_t_cdr`.`generic_wks_name`, `stg_bcrs_t_cdr`.`generic_position`, `stg_bcrs_t_cdr`.`securitization_mm`, `stg_bcrs_t_cdr`.`securitization_mm_factor`, `stg_bcrs_t_cdr`.`is_eligible_cva`, `stg_bcrs_t_cdr`.`audit_cva_eligibility`, `stg_bcrs_t_cdr`.`ead_pro_cva`, `stg_bcrs_t_cdr`.`generic_field1`, `stg_bcrs_t_cdr`.`generic_field2`, `stg_bcrs_t_cdr`.`generic_field3`, `stg_bcrs_t_cdr`.`generic_field4`, `stg_bcrs_t_cdr`.`generic_field5`, `stg_bcrs_t_cdr`.`generic_field6`, `stg_bcrs_t_cdr`.`generic_field7`, `stg_bcrs_t_cdr`.`generic_field8`, `stg_bcrs_t_cdr`.`generic_field9`, `stg_bcrs_t_cdr`.`generic_field10`, `stg_bcrs_t_cdr`.`generic_number1`, `stg_bcrs_t_cdr`.`generic_number2`, `stg_bcrs_t_cdr`.`generic_number3`, `stg_bcrs_t_cdr`.`generic_number4`, `stg_bcrs_t_cdr`.`generic_number5`, `stg_bcrs_t_cdr`.`generic_number6`, `stg_bcrs_t_cdr`.`generic_number7`, `stg_bcrs_t_cdr`.`generic_number8`, `stg_bcrs_t_cdr`.`generic_number9`, `stg_bcrs_t_cdr`.`generic_number10`, `stg_bcrs_t_cdr`.`customer_field1`, `stg_bcrs_t_cdr`.`customer_field2`, `stg_bcrs_t_cdr`.`customer_field3`, `stg_bcrs_t_cdr`.`customer_field4`, `stg_bcrs_t_cdr`.`customer_field5`, `stg_bcrs_t_cdr`.`customer_field6`, `stg_bcrs_t_cdr`.`customer_field7`, `stg_bcrs_t_cdr`.`customer_field8`, `stg_bcrs_t_cdr`.`customer_field9`, `stg_bcrs_t_cdr`.`customer_field10`, `stg_bcrs_t_cdr`.`customer_number1`, `stg_bcrs_t_cdr`.`customer_number2`, `stg_bcrs_t_cdr`.`customer_number3`, `stg_bcrs_t_cdr`.`customer_number4`, `stg_bcrs_t_cdr`.`customer_number5`, `stg_bcrs_t_cdr`.`customer_number6`, `stg_bcrs_t_cdr`.`customer_number7`, `stg_bcrs_t_cdr`.`customer_number8`, `stg_bcrs_t_cdr`.`customer_number9`, `stg_bcrs_t_cdr`.`customer_number10`, `stg_bcrs_t_cdr`.`run_date`, `stg_bcrs_t_cdr`.`process_profile_sr_id`, `stg_bcrs_t_cdr`.`conso_perimeter`, `stg_bcrs_t_cdr`.`interco`, `stg_bcrs_t_cdr`.`interco_type`, `stg_bcrs_t_cdr`.`valid_cpy_perimeter`, `stg_bcrs_t_cdr`.`issuer_id`, `stg_bcrs_t_cdr`.`approver_id`, `stg_bcrs_t_cdr`.`upload_date`, `stg_bcrs_t_cdr`.`approval_date`, `stg_bcrs_t_cdr`.`adj_batch_date`, `stg_bcrs_t_cdr`.`source_file_name`, `stg_bcrs_t_cdr`.`adj_seq`, `stg_bcrs_t_cdr`.`dp_rule_log`, `stg_bcrs_t_cdr`.`staging_source`, `stg_bcrs_t_cdr`.`id`, `stg_bcrs_t_cdr`.`parent_id`, `stg_bcrs_t_cdr`.`child_id`, `stg_bcrs_t_cdr`.`multipurpose_audit`, `stg_bcrs_t_cdr`.`saccr_pfe`, `stg_bcrs_t_cdr`.`saccr_rc`, `stg_bcrs_t_cdr`.`flag_deduction`, `stg_bcrs_t_cdr`.`w_snapshot_dt`, `stg_bcrs_t_cdr`.`w_datasource_id`, `stg_bcrs_t_cdr`.`w_country_cd`, `stg_bcrs_t_cdr`.`w_batch_id`,          (                 CASE                     WHEN nvl(`stg_bcrs_t_cdr`.`table_name`,'z') IN (                         'BOND',                         'EQUITY',                         'TRANCHE',                         'CONVERTIBLE',                         'FUND'                     ) THEN 'SECURITY_POSITIONS'                     ELSE nvl(`stg_bcrs_t_cdr`.`table_name`,'z')                 END             ) AS `sec_table_name`,             substr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'/') + 1,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'-') - (instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'/') + 1) ) `management_product`,             substr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'-') + 1,2) `business_indentifier`         FROM             `sgmisitstg`.`stg_bcrs_t_cdr`   ) `t`   left join `sgmisitstg`.`stg_bcrs_companies_links` `complink` on `t`.`booking_company` = `complink`.`child_code` AND CASE WHEN 'WS29' like '%ADJ%' THEN `complink`.`w_batch_id` = '2018071116473300773' ELSE `complink`.`w_batch_id` = '2018071116473300773' END  left join (          SELECT `stg_bcrs_t_cdr`.`contract_reference`, SUM(`stg_bcrs_t_cdr`.`rwa`) AS `SUM_RWA`         FROM `sgmisitstg`.`stg_bcrs_t_cdr`         WHERE `stg_bcrs_t_cdr`.`w_batch_id` = '2018071116473300773'         GROUP BY `stg_bcrs_t_cdr`.`contract_reference`         ) `t2` on `t`.`contract_reference` = `t2`.`contract_reference`          left join `sgmisitstg`.`stg_bcrs_scb_gpr_default_indicator` `grpdfind` on `t`.`contract_type` = `grpdfind`.`indicator_value` AND CASE WHEN 'WS29' like '%ADJ%' THEN `grpdfind`.`w_batch_id` = '2018071116473300773' ELSE `grpdfind`.`w_batch_id` = '2018071116473300773' END  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_csr`.`contract_reference`,             `stg_bcrs_csr`.`start_date`,             `stg_bcrs_csr`.`maturity_date`,             `stg_bcrs_csr`.`value_date`         FROM `sgmisitstg`.`stg_bcrs_csr`         WHERE `stg_bcrs_csr`.`import_source` NOT LIKE '%WB%'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `stg_bcrs_csr`.`w_batch_id` = '2018071116473300773' ELSE `stg_bcrs_csr`.`w_batch_id` = '2018071116473300773' END ) `csr` ON `t`.`contract_reference` = `csr`.`contract_reference`  LEFT JOIN ( SELECT DISTINCT             `e`.`entity_code`,             `e`.`entity_desc`,             `e`.`attribute_4`,             `e`.`attribute_1`,             `e`.`incorporation_country`,             `e`.`origination_country`,             `cfi`.`scorecard_segment_code`,             `cfi`.`scorecard_segment_category`,             `cfi`.`cf_indicator`,             `e`.`attribute_7`,             `cd1`.`code_desc` AS `customer_segment_desc`,             `e`.`attribute_8`,             `cd2`.`code_desc` AS `customer_subsegment_desc`,             `e`.`et_code_user`,             `icr`.`long_term_rating`,             `icr`.`long_term_rating_local_ccy`,             `e`.`country_code`             , `el`.`bf_link_type`             , `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`  `e`                   LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON `e`.`entity_code` = `icr`.`entity_code`                                                    AND nvl(`icr`.`agency_code`,'z') = 'INTERNAL'                                                    AND `icr`.`w_batch_id` = '2018071116473300773'           LEFT JOIN ( SELECT DISTINCT  `links`.`child_code`,                          case when `linktype`.`link_type` is not null then 'BUYER_FINANCE' else null end `bf_link_type`                         FROM `sgmisitstg`.`stg_bcrs_entity_links` `links` left join (SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                 FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`) `linktype`                                  WHERE `links`.`link_type` IN ( SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                         FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`   ))  `el`              ON `e`.`entity_code` = `el`.`child_code`                      LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_co_fi` `cfi` ON `e`.`attribute_1` = `cfi`.`scorecard_segment`         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cfi`.`w_batch_id` = '2018071116473300773' ELSE `cfi`.`w_batch_id` = '2018071116473300773' END                  LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')         AND `cd1`.`code_type` = 'CUST_SEG'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd1`.`w_batch_id` = '2018071116473300773' ELSE `cd1`.`w_batch_id` = '2018071116473300773' END                  LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd2` ON nvl(`cd2`.`code`,'zz') = nvl(`e`.`attribute_8`,'zz')         AND `cd2`.`code_type` = 'CUST_SUB_SEG'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd2`.`w_batch_id` = '2018071116473300773' ELSE `cd2`.`w_batch_id` = '2018071116473300773' END          ) `e` ON `t`.`counterparty_original` = `e`.`entity_code` AND `e`.`w_batch_id` = '2018071116473300773'  LEFT JOIN (         SELECT DISTINCT             `e`.`entity_code`,             `e`.`attribute_7` AS `group_cust_segment_code`,             `cd1`.`code_desc` AS `group_cust_segment_desc`,             `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity` `e`                           LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')                    AND `cd1`.`code_type` = 'CUST_SEG'                    AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd1`.`w_batch_id` = '2018071116473300773' ELSE `cd1`.`w_batch_id` = '2018071116473300773' END ) `egroup_orig` ON `t`.`cpty_group_original` = `egroup_orig`.`entity_code`  and `e`.`w_batch_id` = '2018071116473300773'  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_entity`.`entity_code`,             `stg_bcrs_entity`.`attribute_1`,             `stg_bcrs_entity`.`origination_country`,             `stg_bcrs_entity`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`         where `stg_bcrs_entity`.`w_batch_id` = '2018071116473300773' ) `enew` ON `t`.`counterparty_new` = `enew`.`entity_code`   LEFT JOIN ( SELECT             `stg_bcrs_companies`.`company_code`,             `stg_bcrs_companies`.`country_code`,             `stg_bcrs_companies`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_companies`         where `stg_bcrs_companies`.`w_batch_id` = '2018071116473300773' ) `cpies` ON `t`.`booking_company` = `cpies`.`company_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_scb_wb_bf_uns_recoveries`.`domicile_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`booking_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`contract_type`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`cf_ind`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`prr`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`         where CASE WHEN 'WS29' like '%ADJ%' THEN `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2018071116473300773' ELSE `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2018071116473300773' END     ) `bf` ON `bf`.`domicile_country_code` = `e`.`country_code`             AND `bf`.`booking_country_code` = `cpies`.`country_code`             AND `bf`.`contract_type` = `t`.`contract_type`             AND `bf`.`cf_ind` = `e`.`cf_indicator`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_contract_types`.`ct_code_user`,             `stg_bcrs_contract_types`.`ct_desc_user`,             `stg_bcrs_contract_types`.`attribute_2`,             `stg_bcrs_contract_types`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_contract_types`             where              `stg_bcrs_contract_types`.`w_batch_id` = '2018071116473300773'      ) `ct` ON `t`.`contract_type` = `ct`.`ct_code_user`  Left Join ( select distinct  `stg_bcrs_contract_types`.`ct_code_user`, `stg_bcrs_contract_types`.`contract_category`, `stg_bcrs_contract_types`.`w_batch_id` from  `sgmisitstg`.`stg_bcrs_contract_types` where   `stg_bcrs_contract_types`.`w_batch_id` = '2018071116473300773' and `stg_bcrs_contract_types`.`contract_category` = 'RECEIVABLE' ) `contracttype` on `t`.`contract_type` = `contracttype`.`ct_code_user`           LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`attribute_7` AS `non_gam_ind`,             `stg_bcrs_facility`.`attribute_8` AS `holdco_ind`,             `stg_bcrs_facility`.`trade_date`,             `stg_bcrs_facility`.`maturity_date`         FROM             `sgmisitstg`.`stg_bcrs_facility`         WHERE              `stg_bcrs_facility`.`w_batch_id` = '2018071116473300773'      ) `fac` ON `t`.`contract_reference` = `fac`.`contract_reference`      LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_mkt_fx_input`.`booking_company_code`,             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL'             AND `stg_bcrs_mkt_fx_input`.`w_batch_id` = '2018071116473300773'      ) `cer` ON `t`.`booking_company` = `cer`.`booking_company_code`              AND `t`.`currency` = `cer`.`ccy_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_country`.`country_code`,             `stg_bcrs_country`.`country_name`         FROM             `sgmisitstg`.`stg_bcrs_country`         WHERE              `stg_bcrs_country`.`w_batch_id` = '2018071116473300773'      ) `c` ON `t`.`incorporation_country_original` = `c`.`country_code`      LEFT JOIN (     select `prrsrtmp`.`contract_reference`, `prrsrtmp`.`bs_type`, `prrsrtmp`.`prr`, `prrsrtmp`.`w_batch_id`, `prrsrtmp`.`rnk` from (         SELECT DISTINCT             `stg_bcrs_scb_sme_prr_sr`.`contract_reference`,              `stg_bcrs_scb_sme_prr_sr`.`bs_type`,              `stg_bcrs_scb_sme_prr_sr`.`prr`,              `stg_bcrs_scb_sme_prr_sr`.`w_batch_id`,             ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_sme_prr_sr`.`contract_reference` ORDER BY `stg_bcrs_scb_sme_prr_sr`.`contract_reference`) AS `rnk`         FROM             `sgmisitstg`.`stg_bcrs_scb_sme_prr_sr` ) `prrsrtmp`         where             `prrsrtmp`.`rnk` = 1     ) `prrsr` ON `t`.`contract_reference` = `prrsr`.`contract_reference`              AND `t`.`bs_type` = `prrsr`.`bs_type` and `prrsr`.`w_batch_id` = '2018071116473300773'                      LEFT JOIN (             select `addtinst`.`contract_reference`, `addtinst`.`table_name`, `addtinst`.`tp_portfolio_name`, `addtinst`.`psgl_department_id`, `addtinst`.`psgl_product_code`, `addtinst`.`psgl_operating_unit`, `addtinst`.`psgl_customer_class`, `addtinst`.`rnk` from (                 SELECT                     `stg_bcrs_scb_wb_addt_inst`.`contract_reference`,                     `stg_bcrs_scb_wb_addt_inst`.`table_name`,                     `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`,                     ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ORDER BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`) AS `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2018071116473300773') `addtinst`                              WHERE                         `addtinst`.`rnk` = 1     ) `inst` ON `inst`.`contract_reference` = `t`.`contract_reference`               AND `inst`.`table_name` = `t`.`sec_table_name`                               LEFT JOIN (         SELECT             nvl(`split_ref`.`contract_reference`,`a`.`contract_reference`) `contract_reference`,             `a`.`psgl_cust_class`,             `a`.`psgl_product`,             TRIM(`a`.`psgl_department`) `psgl_department`,             `a`.`fermat_table_name`         FROM             (                 SELECT DISTINCT                     `b`.`contract_reference`,                     `b`.`fermat_table_name`,                     `b`.`psgl_cust_class`,                     `b`.`psgl_product`,                     `b`.`psgl_department`,                     `c`.`priority`,                     ROW_NUMBER() OVER(PARTITION BY `b`.`contract_reference`, `b`.`fermat_table_name` ORDER BY `c`.`priority`) `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_sme_psgl` `b`                     left join `sgmisitstg`.`stg_bcrs_scb_wb_amt_cat_priority` `c`                                         on `b`.`fermat_table_name` = `c`.`table_name`                      and `b`.`amount_category_dw_sorsa` = `c`.`amount_category_dw_sorsa`                     and `b`.`psgl_product` <> 'ZZZ'                     and `b`.`w_batch_id`='2018071116473300773'                      and `b`.`w_batch_id` = `c`.`w_batch_id`                                     ) `a`             left join             (                 SELECT DISTINCT                     `stg_bcrs_facility_links`.`contract_reference`,                     `stg_bcrs_facility_links`.`attribute_1` AS `orig_cont_ref`                 FROM                     `sgmisitstg`.`stg_bcrs_facility_links`                 WHERE                     `stg_bcrs_facility_links`.`attribute_1` IS NOT NULL and `stg_bcrs_facility_links`.`w_batch_id`='2018071116473300773'             ) `split_ref`         on             `a`.`contract_reference` = `split_ref`.`orig_cont_ref`             where   `a`.`rnk` = 1     ) `psgl` ON `t`.`contract_reference` = `psgl`.`contract_reference`               AND `t`.`sec_table_name` = `psgl`.`fermat_table_name`                                                 LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_mpdt_mru_map`.`mru_desc`,             `stg_bcrs_scb_wb_mpdt_mru_map`.`mpdt_code`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_mpdt_mru_map` where `stg_bcrs_scb_wb_mpdt_mru_map`.`w_batch_id`='2018071116473300773'     ) `mru_bus` ON `mru_bus`.`mpdt_code` = `t`.`management_product`                        LEFT JOIN `sgmisitstg`.`stg_bcrs_fdw_netting_agreement` `net` ON `net`.`agreement_reference` = `t`.`netting_agreement_reference`     and `net`.`w_batch_id`='2018071116473300773'          LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_fac_sub_limits`.`id`,             `stg_bcrs_scb_wb_fac_sub_limits`.`contract_reference`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_attribute`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_amount`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_fac_sub_limits` where `stg_bcrs_scb_wb_fac_sub_limits`.`w_batch_id`='2018071116473300773'     ) `sub` ON `t`.`id` = `sub`.`id`          LEFT JOIN (         SELECT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`book_code`,             `stg_bcrs_facility`.`currency`         FROM             `sgmisitstg`.`stg_bcrs_facility` where `stg_bcrs_facility`.`w_batch_id`='2018071116473300773'     ) `fac_curr` ON `sub`.`contract_reference` = `fac_curr`.`contract_reference`       LEFT JOIN (         SELECT             `stg_bcrs_deal_book`.`booking_company`,             `stg_bcrs_deal_book`.`book_code`         FROM             `sgmisitstg`.`stg_bcrs_deal_book` where `stg_bcrs_deal_book`.`w_batch_id`='2018071116473300773'     ) `dealbook` ON `dealbook`.`book_code` = `fac_curr`.`book_code`          LEFT JOIN (         SELECT             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`,             `stg_bcrs_mkt_fx_input`.`booking_company_code`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL' and `stg_bcrs_mkt_fx_input`.`w_batch_id`='2018071116473300773'     ) `fac_curr_exch` ON `fac_curr_exch`.`ccy_code` = `fac_curr`.`currency`                        AND `fac_curr_exch`.`booking_company_code` = `dealbook`.`booking_company`                               LEFT JOIN (         SELECT             `stg_bcrs_t_cva`.`contract_reference`,             count(`stg_bcrs_t_cva`.`contract_reference`) as `count_contract_ref`,             SUM(nvl(`stg_bcrs_t_cva`.`cva_rwa`,0) ) `cva_rwa`         FROM             `sgmisitstg`.`stg_bcrs_t_cva` where `stg_bcrs_t_cva`.`w_batch_id`='2018071116473300773'         GROUP BY             `stg_bcrs_t_cva`.`contract_reference`     ) `tcva` ON `tcva`.`contract_reference` = `t`.`contract_reference`              LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_mru_business_idntfr_map` `bus_ind`      ON `bus_ind`.`business_identifier` = `t`.`business_indentifier` and `bus_ind`.`w_batch_id`='2018071116473300773'      where `t`.`w_batch_id` = '2018071116473300773'      and `t`.`import_source` NOT LIKE '%WB%'         and `t`.`w_snapshot_dt` = '2018-04-30'     and `t`.`w_datasource_id` = 'BCRS_ND'     and `t`.`w_country_cd`='SG'       union all  SELECT distinct                      `t`.`partition_key`,     'WB' as `banking_type`,     `t`.`method_new`,     `t`.`method_original`,     `t`.`contract_reference`,     `t`.`tranche_collateral_type`,     `t`.`tranche_guarantee_type`,     `t`.`counterparty_original`,     `e`.`entity_desc` AS `counterparty_original_desc`,     `t`.`counterparty_new`,     `t`.`counterparty_new_desc`,     `t`.`table_name`,     `t`.`bis_past_due`,     `t`.`contract_type`,     `ct`.`ct_desc_user` AS `contract_desc`,     `e`.`cf_indicator`,     (         CASE             WHEN upper(`t`.`counterparty_original`) LIKE '%_CORPORATE%'                  OR upper(`t`.`counterparty_original`) LIKE '%_BANK%'                  OR `t`.`counterparty_original` = '9999999999-1'                  OR `t`.`counterparty_original` = '9999999998-1' THEN 'Y'             ELSE 'N'         END     ) AS `unmapped_ind`,     (         CASE             WHEN upper(`e`.`attribute_4`) = 'CN' THEN 'Y'             ELSE 'N'         END     ) AS `non_borrowing_ind`,     (         CASE  WHEN `contracttype`.`ct_code_user` is not null THEN 'PURCHASED_RECEIVABLE'             WHEN `t`.`contract_type` IN ( 'GMGMKTPTEQ' ) THEN 'PRIVATE_EQUITY'             WHEN `t`.`contract_type` IN ( 'GMGMKTAINV', 'GMGMKTANPL'  ) THEN 'ALT_INVST'             WHEN `e`.`et_code_user` IN (  'BSC16',  'BSC23'  ) THEN 'DEV_ORG'             WHEN `e`.`et_code_user` IN (  'BSC24' ) THEN 'PERSONAL'             WHEN `e`.`scorecard_segment_code` IN (  'CFSC'   ) THEN 'SME'             WHEN `e`.`scorecard_segment_category` IN (  'F1'  ) THEN 'BANK'             WHEN `e`.`scorecard_segment_category` IN (  'F2', 'F3'  ) THEN 'NBFI'             WHEN `e`.`scorecard_segment_category` IN (  'S1' ) THEN 'SOV'             WHEN `e`.`scorecard_segment_category` IN (  'C1', 'C2', 'C3', 'C4' ) THEN 'CORP'             ELSE 'CORP'         END     ) AS `segment_original`,     (         CASE             WHEN `t`.`table_name` IN (                 'DEAL_IMPORT',                 'CREDIT_DERIVATIVE'             ) THEN 'T'             ELSE 'F'         END     ) AS `derivative_ind`,     `t`.`incorporation_country_original`,     `c`.`country_name`,     `t`.`dealbook`,     `t`.`booking_company_desc`,     `e`.`attribute_1` AS `scorecard_original`,     `t`.`internal_rating_new`,     `t`.`pd_new`,     `t`.`internal_rating_original`,     `t`.`pd_original`,     (         CASE             WHEN nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`method_new` = 'ADV'                  AND `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED' THEN 0.45             WHEN `t`.`import_source` = 'NONTP-WBAJ'                  AND `t`.`method_new` = 'ADV' THEN `t`.`exposure_attribute_7`              WHEN (                 ( `t`.`tranche_collateral_type` = 'COLLATERALIZED' )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') <> 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`lgd`             WHEN (                 (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'GUARANTEED'                 )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') = 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`exposure_attribute_7`              ELSE 0         END     ) AS `lgd`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY'             ) THEN `t`.`outstanding`             ELSE 0         END     ) AS `outstanding`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY'             ) THEN `t`.`accrued_interest`             ELSE 0         END     ) AS `accrued_interest`,     (         CASE             WHEN `t`.`table_name` IN (                 'FACILITY'             )                  AND `t`.`bs_type` = 'OFB' THEN `t`.`outstanding`             ELSE 0         END     ) AS `headroom`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN `t`.`fair_value`             ELSE 0         END     ) AS `mtm`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN (                         CASE                             WHEN `t`.`fair_value` > 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                     ELSE (                         CASE                             WHEN `t`.`fair_value` < 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                 END             )             ELSE 0         END     ) AS `replacement_cost`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`t`.`nominal`) *-1                     ELSE abs(`t`.`nominal`)                 END             )             ELSE 0         END     ) AS `notional`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT'             ) THEN `t`.`add_on`             ELSE 0         END     ) AS `add_on`,     `t`.`ead`,     `t`.`rwa`,     `t`.`rwa_pre_crm`,     `t`.`el`,     `t`.`rgc`,     `t`.`ead_original`,     `t`.`tier1_deduction`,     `t`.`tier2_deduction`,     `t`.`ead_pre_ccf`,     `t`.`nominal`,     `t`.`fair_value`,     `t`.`ead_pro`,     `t`.`ead_pro_gen`,     nvl(`prrsr`.`prr`,0) `prr`,     ( `t`.`ead` * `t`.`pd_original` ) AS `wt_pd_original`,     ( `t`.`ead` * `t`.`pd_new` ) AS `wt_pd_new`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45 * `t`.`ead`             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd` * `t`.`ead`             ELSE 0         END     ) AS `wt_lgd`,     ( `t`.`ead` * `t`.`k_maturity` ) AS `wt_k_maturity`,     ( `t`.`ead` * `t`.`residual_maturity` ) AS `wt_residual_maturity`,     `t`.`total_annual_sales`,     `t`.`hfx`,     `t`.`hc`,     `t`.`he`,     `t`.`k_maturity`,     `t`.`facility_reference`,     `t`.`performing_status`,     `t`.`securitization_reference`,     `t`.`days_after_contractual_date`,     `t`.`risk_bucket`,     `t`.`delivery_type`,     `t`.`funding_ccy`,     coalesce( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr`.`currency`             ELSE `t`.`currency`         END     ),`t`.`currency`) AS `currency`,     `t`.`residual_maturity`,     `t`.`original_maturity`,     `t`.`ead_method`,     `t`.`ccf`,     `t`.`inter_company`,     `t`.`trading_book_type`,     `e`.`attribute_7` AS `customer_segment_code`,     `e`.`customer_segment_desc`,     `e`.`attribute_8` AS `customer_subsegment_code`,     `e`.`customer_subsegment_desc`,     `t`.`id`,     `t`.`import_source`,     `t`.`product_gl_criteria`,     `t`.`bs_type`,     `t`.`securitized`,     `t`.`risk_type`,     `t`.`bis_product`,     `t`.`bis_product_category`,     `t`.`bis_entity_type_new`,     `t`.`bis_entity_type_original`,     `t`.`asset_class_new`,     `t`.`asset_class_original`,     `t`.`netting_agreement_reference`,     `t`.`collateral_reference`,     `t`.`collateral_contract_type`,     `t`.`collateral_bis_product`,     `t`.`collateral_product_category`,     `t`.`guarantee_reference`,     `t`.`guarantee_contract_type`,     `t`.`guarantee_bis_product`,     `t`.`counterparty_type_new`,     `t`.`sub_method_new`,     `t`.`rw_scaling_factor`,     `t`.`rwa_scaling_factor`,     `t`.`exposure_attribute_7`,     `t`.`exposure_attribute_8`,     `t`.`exposure_attribute_9`,     `t`.`rw_original`,     `t`.`rw_new`,     `t`.`securitization_n`,     `t`.`crm_method`,     `t`.`division_code`,     `t`.`secu_ea_controlled`,     `t`.`secu_company_weight`,     `t`.`secu_bank_role`,     `t`.`obligor_grade_new`,     `t`.`standard_rw_original`,     `t`.`standard_rw_new`,     `t`.`cpty_group`,     `t`.`cpty_group_original`,     `t`.`bis_industry_sector_new`,     `t`.`bis_industry_sector_original`,     `t`.`bis_risk_area_new`,     `t`.`bis_risk_area_original`,     `t`.`incorporation_country_new`,     `t`.`int_rating_agency_new`,     `t`.`risk_country`,     `t`.`used_amount_facility`,     `t`.`beel`,     `t`.`uncommited`,          case when `csr`.`start_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0) - nvl(`t`.`original_maturity`,0)) * 365.25) as INT)) as date)     else `csr`.`start_date` end as `start_date`,       case when `csr`.`maturity_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0)) * 365.25) as INT)) as date)      else `csr`.`maturity_date` end as `maturity_date`,          `t`.`value_date`,     (         CASE             WHEN nvl(`t`.`residual_maturity`,0) <= 1               THEN '<=1yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 3 and nvl(`t`.`residual_maturity`,0) > 1  THEN '1-3yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 5 and nvl(`t`.`residual_maturity`,0) > 3  THEN '3-5yrs'             ELSE '>5yrs'         END     ) AS `maturity_range`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd`             ELSE 0         END     ) AS `tranche_lgd`,         CASE WHEN (`complink`.`mother_code` = '999C' or `complink`.`mother_code` = '976C') and `complink`.`child_code` is not null then 'SOLO'          ELSE 'SUBS' END `company_type`,     nvl(`mru_bus`.`mru_desc`,'UNMAPPED') AS `business`,     `inst`.`psgl_operating_unit` AS `psgl_operating_unit`,     `psgl`.`psgl_cust_class`,     (         CASE             WHEN `t`.`table_name` = 'TRANCHE'                  AND `t`.`bs_type` IN(                 'VIF','VIR'             ) THEN 'TRANCHE_FILTER'             WHEN `t`.`inter_company` = 'T' THEN 'INTERCOMPANY_FILTER'             ELSE 'BCRS'         END     )   AS `filter_type`,     (         CASE             WHEN `t`.`securitized` = 'T'   THEN 'SECURITIZED'             WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'             WHEN `t`.`trading_book_type` = 'T'                  AND `t`.`bis_product_category` IN(                 'REPO','DERIVATIVE','DERIVATIVE_OTC','CREDIT_DERIVATIVE'             ) THEN 'CCR'             WHEN `t`.`tranche_collateral_type` = 'COLLATERALIZED'                  AND `t`.`collateral_bis_product` IN(                 'REP_NET_COL','OTC_NET_COL'             ) THEN 'NETTING_BENEFIT'             ELSE 'FSA'         END     )  AS `fsa_exclusion_type`,     (         CASE             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_past_due` = 'T' THEN 'PAST_DUE_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`asset_class_new` = 'CLAIM_OTH_150'                 OR (                     (                         (                             `t`.`rw_original` >= 1.5                             OR `t`.`standard_rw_original` >= 1.5                         )                         AND NOT (                             (                                 `t`.`tranche_collateral_type` = 'COLLATERALIZED'                                 AND `t`.`crm_method` = 'SIM'                                 AND `t`.`collateral_product_category` = 'FINANCIAL_COL'                             )                             OR `t`.`tranche_guarantee_type` = 'GUARANTEED'                         )                     )                     OR `t`.`rw_new` >= 1.5                 )             ) THEN 'HIGH_RISK_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 ( `t`.`asset_class_new` LIKE '%EQT' )                 OR (                     `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                     AND `t`.`sub_reference` = 'MULTI NAME'                 )                 OR ( `t`.`risk_type` = 'RVR' )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` IN (                 'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE',                 'CLAIM_SEC_CRE',                 'CLAIM_FULL_SEC_RRE'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`collateral_bis_product` IN (                 'RRE_COL',                 'LEASING_CRE_COL',                 'CRE_COL',                 'LEASING_RRE_COL'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_COVERED_BOND' THEN 'COVERED_BONDS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_CIU' THEN 'COLLECTIVE_INV_UNDERTAKINGS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF',                 'CORP',                 'INSURANCE',                 'CORP_CF',                 'CORP_HVCRE',                 'CORP_IPRE',                 'CORP_OF',                 'CORP_PF',                 'EX_RETAIL',                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'SPE',                 'CORP_INT_GRP'             )                  AND (                 `t`.`risk_bucket` IN (                     30,                     31,                     32,                     33,                     34                 )                 OR `t`.`risk_bucket_original` IN (                     30,                     31,                     32,                     33,                     34                 )             ) THEN 'SHORT_TERM_CLAIMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SOV'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'RGLA',                 'RGLA_SOV',                 'RGLA_SOV_EU'             ) THEN 'REGIONAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'PSE',                 'PSE_BANK',                 'PSE_SOV'             ) THEN 'ADMIN_BODIES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'MDB',                 'MDB_PREF_0',                 'MDB_PREF_20'             ) THEN 'MULTILATERAL_DEVT_BANKS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SUPRA',                 'EIF',                 'SUPRA_100'             ) THEN 'INTL_ORGANIZATIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`bis_entity_type_new` IN (                     'SME',                     'SME_CF',                     'SME_HVCRE',                     'SME_IPRE',                     'SME_OF',                     'SME_PF',                     'CORP',                     'INSURANCE',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'CORP_INT_GRP'                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'INDIV',                 'SME_RETAIL'             )                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL'             WHEN `t`.`method_new` = 'STD' THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`bis_entity_type_new` NOT IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` = 'CLAIM_OTH_100'                 )                 AND (                     `t`.`bis_product_category` NOT IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 ( `t`.`asset_class_new` = 'CLAIM%EQT' )                 OR ( `t`.`asset_class_new` = 'CLAIM_CIU' )             ) THEN 'EQUITY_CLAIMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`asset_class_new` IN (                         'CLAIM_FULL_SEC_RRE',                         'CLAIM_SEC_RRE_LEASE',                         'CRE_COL',                         'CLAIM_SEC_CRE',                         'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE'                     )                     OR `t`.`collateral_bis_product` IN (                         'RRE_COL',                         'LEASING_RRE_COL',                         'LEASING_CRE_COL',                         'CRE_COL'                     )                 )                 AND `t`.`bis_entity_type_new` IN (                     'INDIV',                     'SME_RETAIL'                 )             ) THEN 'RETAIL_MORTGAGES'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_RETAIL_QUALIFYING_REVOLVING' THEN 'RETAIL_QRRE'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'INDIV'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_OTHER'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'SME_RETAIL'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_SME'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'FOU'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'ADV'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             ELSE 'OTHER_ITEMS'         END     ) AS `fsa004_asset_class`,     `t`.`secu_mode`,     `t`.`risk_bucket_original`,     `t`.`waterfall_seniority`,     `e`.`origination_country` AS `ccr_original`,     `enew`.`origination_country` AS `ccr_new`,     `t`.`stress_testing_scenario_id`,     `t`.`collateral_attribute_1`,     `t`.`collateral_attribute_9`,     `t`.`exposure_attribute_1`,     `t`.`exposure_attribute_6`,     `t`.`counterparty_new_attribute_1`,     `t`.`sub_reference`,     `t`.`sub_method_original`,     `t`.`int_rating_agency_original`,     `t`.`ead_formula`,     `t`.`booking_company`,     `t`.`obligor_grade_inf_new`,     `t`.`obligor_grade_sup_new`,     `t`.`incorporation_ccy_original`,     `t`.`incorporation_ccy_new`,     nvl(`t`.`management_product`,'UNMAPPED') AS `management_product`,     `bus_ind`.`business_identifier_desc` AS `business_identifier`,       CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_w_filter_type`,              CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_filter_type`,          `ct`.`attribute_2` AS `balance_category`,     nvl( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr_exch`.`exch_rate`             ELSE `cer`.`exch_rate`         END     ),`cer`.`exch_rate`) AS `exchange_rate`,     `fac`.`holdco_ind` AS `holding_company_ind`,     `fac`.`non_gam_ind` AS `non_gam_ind`,     `egroup_orig`.`group_cust_segment_code`,     `egroup_orig`.`group_cust_segment_desc`,     `t`.`original_cost`,     `t`.`premium_current`,     `t`.`security_positions_ref`,     `t`.`pd_pre_floor_new`,     `t`.`exposure_attribute_3`,     `t`.`exposure_attribute_4`,     `t`.`exposure_attribute_5`,     `t`.`counterparty_new_attribute_3`,     `t`.`counterparty_new_attribute_4`,     `t`.`collateral_attribute_7`,     `t`.`collateral_attribute_8`,     `e`.`long_term_rating_local_ccy` AS `internal_rating_local_ccy_orig`,     `t`.`past_due_int`,     `t`.`ead_pro_discount`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`ltv`             ELSE 0         END     ) AS `ltv`,     (         CASE             WHEN `bf`.`domicile_country_code` IS NOT NULL                  AND nvl(`e`.`bf_link_type`,'z') = 'BUYER_FINANCE' THEN 'Y'             ELSE 'N'         END     ) AS `buyer_finance_ind`,     `t`.`counterparty_ext_rat_code`,     `t`.`counterparty_ext_rat_agency`,     `t`.`counterparty_int_rat_code`,     `t`.`counterparty_int_rat_agency`,     `t`.`maturity_eff`,     `psgl`.`psgl_department` AS `psgl_department_id`,     `psgl`.`psgl_product` AS `psgl_product_code`    , `net`.`netting_type` AS `netting_agreement_type`,     `sub`.`contract_reference` AS `sub_limit_fac_reference`,     `sub`.`limit_amount` AS `limit_amount`,     `sub`.`limit_attribute` AS `limit_attribute`,      CASE WHEN `tcva`.`cva_rwa`  <= 0 THEN nvl(`tcva`.`cva_rwa`,0) / nvl(`tcva`.`count_contract_ref`,0)          ELSE round(nvl(`t`.`rwa`,0),2) / (`t2`.`sum_rwa` * round(nvl(`tcva`.`cva_rwa`,0),2))     END `cva_rwa`,          `t`.`qualifying_ccp`,     `t`.`k_function_used`,     `t`.`k_function_used_original`,     `t`.`product_gl_criteria_2`,     `t`.`bis_past_due_original`,     `t`.`risk_country_new`,     `t`.`risk_country_original`,     `t`.`booking_company_incorp_country`,     `t`.`ccf_std`,     `t`.`past_due_days`,     `t`.`guarantee_method`,     `t`.`fde_alternative_method`,     `t`.`rwa_pre_cap`,     `t`.`asset_class_category_new`,     `t`.`asset_class_category_original`      FROM ( SELECT `stg_bcrs_t_cdr`.`partition_key`, `stg_bcrs_t_cdr`.`stress_testing_scenario_id`, `stg_bcrs_t_cdr`.`tranche_collateral_type`, `stg_bcrs_t_cdr`.`tranche_guarantee_type`, `stg_bcrs_t_cdr`.`bs_type`, `stg_bcrs_t_cdr`.`contract_reference`, `stg_bcrs_t_cdr`.`contract_type`, `stg_bcrs_t_cdr`.`bis_product`, `stg_bcrs_t_cdr`.`bis_product_category`, `stg_bcrs_t_cdr`.`unconditionnaly_cancelable`, `stg_bcrs_t_cdr`.`ead_original`, `stg_bcrs_t_cdr`.`ead_pre_ccf`, `stg_bcrs_t_cdr`.`ead`, `stg_bcrs_t_cdr`.`ead_pro`, `stg_bcrs_t_cdr`.`facility_reference`, `stg_bcrs_t_cdr`.`collateral_reference`, `stg_bcrs_t_cdr`.`collateral_contract_type`, `stg_bcrs_t_cdr`.`collateral_bis_product`, `stg_bcrs_t_cdr`.`guarantee_reference`, `stg_bcrs_t_cdr`.`guarantee_contract_type`, `stg_bcrs_t_cdr`.`guarantee_bis_product`, `stg_bcrs_t_cdr`.`netting_agreement_reference`, `stg_bcrs_t_cdr`.`netting_agreement_type`, `stg_bcrs_t_cdr`.`counterparty_original`, `stg_bcrs_t_cdr`.`counterparty_type_original`, `stg_bcrs_t_cdr`.`counterparty_new`, `stg_bcrs_t_cdr`.`counterparty_type_new`, `stg_bcrs_t_cdr`.`total_annual_sales`, `stg_bcrs_t_cdr`.`total_annual_assets`, `stg_bcrs_t_cdr`.`bis_entity_type_original`, `stg_bcrs_t_cdr`.`bis_entity_type_new`, `stg_bcrs_t_cdr`.`asset_class_original`, `stg_bcrs_t_cdr`.`asset_class_new`, `stg_bcrs_t_cdr`.`method_original`, `stg_bcrs_t_cdr`.`sub_method_original`, `stg_bcrs_t_cdr`.`method_new`, `stg_bcrs_t_cdr`.`sub_method_new`, `stg_bcrs_t_cdr`.`guarantee_method`, `stg_bcrs_t_cdr`.`he`, `stg_bcrs_t_cdr`.`maturity_eff`, `stg_bcrs_t_cdr`.`k_maturity`, `stg_bcrs_t_cdr`.`pd_original`, `stg_bcrs_t_cdr`.`internal_rating_original`, `stg_bcrs_t_cdr`.`pd_new`, `stg_bcrs_t_cdr`.`internal_rating_new`, `stg_bcrs_t_cdr`.`lgd`, `stg_bcrs_t_cdr`.`lgd_grade_agency`, `stg_bcrs_t_cdr`.`ccf`, `stg_bcrs_t_cdr`.`hfx`, `stg_bcrs_t_cdr`.`hc`, `stg_bcrs_t_cdr`.`mm`, `stg_bcrs_t_cdr`.`floor1`, `stg_bcrs_t_cdr`.`floor2`, `stg_bcrs_t_cdr`.`rwa`, `stg_bcrs_t_cdr`.`rgc`, `stg_bcrs_t_cdr`.`rwa_pre_crm`, `stg_bcrs_t_cdr`.`el`, `stg_bcrs_t_cdr`.`beel`, `stg_bcrs_t_cdr`.`bis_past_due`, `stg_bcrs_t_cdr`.`performing_status`, `stg_bcrs_t_cdr`.`rw_scaling_factor`, `stg_bcrs_t_cdr`.`rwa_scaling_factor`, `stg_bcrs_t_cdr`.`equity_scaling_factor`, `stg_bcrs_t_cdr`.`exemption_maturity_floor`, `stg_bcrs_t_cdr`.`grand_fathering_applied`, `stg_bcrs_t_cdr`.`legislated_program_applied`, `stg_bcrs_t_cdr`.`non_material_equity`, `stg_bcrs_t_cdr`.`zero_rw_for_equity`, `stg_bcrs_t_cdr`.`zero_haircut_for_repo`, `stg_bcrs_t_cdr`.`k_function_used`, `stg_bcrs_t_cdr`.`ead_formula`, `stg_bcrs_t_cdr`.`risk_type`, `stg_bcrs_t_cdr`.`trading_book_type`, `stg_bcrs_t_cdr`.`table_name`, `stg_bcrs_t_cdr`.`exposure_attribute_1`, `stg_bcrs_t_cdr`.`exposure_attribute_2`, `stg_bcrs_t_cdr`.`exposure_attribute_3`, `stg_bcrs_t_cdr`.`exposure_attribute_4`, `stg_bcrs_t_cdr`.`exposure_attribute_5`, `stg_bcrs_t_cdr`.`exposure_attribute_6`, `stg_bcrs_t_cdr`.`exposure_attribute_7`, `stg_bcrs_t_cdr`.`exposure_attribute_8`, `stg_bcrs_t_cdr`.`exposure_attribute_9`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_1`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_2`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_3`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_4`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_5`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_6`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_7`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_8`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_9`, `stg_bcrs_t_cdr`.`collateral_attribute_1`, `stg_bcrs_t_cdr`.`collateral_attribute_2`, `stg_bcrs_t_cdr`.`collateral_attribute_3`, `stg_bcrs_t_cdr`.`collateral_attribute_4`, `stg_bcrs_t_cdr`.`collateral_attribute_5`, `stg_bcrs_t_cdr`.`collateral_attribute_6`, `stg_bcrs_t_cdr`.`collateral_attribute_7`, `stg_bcrs_t_cdr`.`collateral_attribute_8`, `stg_bcrs_t_cdr`.`collateral_attribute_9`, `stg_bcrs_t_cdr`.`guarantee_attribute_1`, `stg_bcrs_t_cdr`.`guarantee_attribute_2`, `stg_bcrs_t_cdr`.`guarantee_attribute_3`, `stg_bcrs_t_cdr`.`guarantee_attribute_4`, `stg_bcrs_t_cdr`.`guarantee_attribute_5`, `stg_bcrs_t_cdr`.`guarantee_attribute_6`, `stg_bcrs_t_cdr`.`guarantee_attribute_7`, `stg_bcrs_t_cdr`.`guarantee_attribute_8`, `stg_bcrs_t_cdr`.`guarantee_attribute_9`, `stg_bcrs_t_cdr`.`inter_company`, `stg_bcrs_t_cdr`.`rwa_pre_cap`, `stg_bcrs_t_cdr`.`rw_original`, `stg_bcrs_t_cdr`.`rw_new`, `stg_bcrs_t_cdr`.`tier1_deduction`, `stg_bcrs_t_cdr`.`tier2_deduction`, `stg_bcrs_t_cdr`.`securitized`, `stg_bcrs_t_cdr`.`seniority_original`, `stg_bcrs_t_cdr`.`seniority_new`, `stg_bcrs_t_cdr`.`collateral_product_category`, `stg_bcrs_t_cdr`.`dealbook`, `stg_bcrs_t_cdr`.`deal_status`, `stg_bcrs_t_cdr`.`sub_reference`, `stg_bcrs_t_cdr`.`securitization_reference`, `stg_bcrs_t_cdr`.`securitization_n`, `stg_bcrs_t_cdr`.`waterfall_seniority`, `stg_bcrs_t_cdr`.`risk_country`, `stg_bcrs_t_cdr`.`zone_a_original`, `stg_bcrs_t_cdr`.`zone_a_new`, `stg_bcrs_t_cdr`.`lgd_mitigation`, `stg_bcrs_t_cdr`.`crm_method`, `stg_bcrs_t_cdr`.`look_through_treatment`, `stg_bcrs_t_cdr`.`second_loss_treatment`, `stg_bcrs_t_cdr`.`risk_bucket`, `stg_bcrs_t_cdr`.`pool_code`, `stg_bcrs_t_cdr`.`incorporation_country`, `stg_bcrs_t_cdr`.`division_code`, `stg_bcrs_t_cdr`.`secu_loss_position`, `stg_bcrs_t_cdr`.`secu_issue_date`, `stg_bcrs_t_cdr`.`secu_ea_controlled`, `stg_bcrs_t_cdr`.`secu_company_weight`, `stg_bcrs_t_cdr`.`secu_bank_role`, `stg_bcrs_t_cdr`.`secu_mode`, `stg_bcrs_t_cdr`.`import_source`, `stg_bcrs_t_cdr`.`company_code`, `stg_bcrs_t_cdr`.`supervisor_code`, `stg_bcrs_t_cdr`.`ccy_code`, `stg_bcrs_t_cdr`.`settlement_price`, `stg_bcrs_t_cdr`.`days_after_contractual_date`, `stg_bcrs_t_cdr`.`delivery_type`, `stg_bcrs_t_cdr`.`mortgage_alternative`, `stg_bcrs_t_cdr`.`booking_company`, `stg_bcrs_t_cdr`.`booking_company_desc`, `stg_bcrs_t_cdr`.`gaap_code`, `stg_bcrs_t_cdr`.`number_of_obligor`, `stg_bcrs_t_cdr`.`security_positions_ref`, `stg_bcrs_t_cdr`.`guar_sub_reference`, `stg_bcrs_t_cdr`.`flag_adjustment`, `stg_bcrs_t_cdr`.`internal_maturity_class`, `stg_bcrs_t_cdr`.`equity_floor_applied`, `stg_bcrs_t_cdr`.`equity_preferential_treatment`, `stg_bcrs_t_cdr`.`fde_alternative_method`, `stg_bcrs_t_cdr`.`collateral_table_name`, `stg_bcrs_t_cdr`.`collateral_mode`, `stg_bcrs_t_cdr`.`funding_ccy`, `stg_bcrs_t_cdr`.`currency`, `stg_bcrs_t_cdr`.`incorporation_ccy_original`, `stg_bcrs_t_cdr`.`incorporation_ccy_new`, `stg_bcrs_t_cdr`.`credit_substitute`, `stg_bcrs_t_cdr`.`value_date`, `stg_bcrs_t_cdr`.`original_maturity`, `stg_bcrs_t_cdr`.`residual_maturity`, `stg_bcrs_t_cdr`.`booking_company_incorp_country`, `stg_bcrs_t_cdr`.`business_line_code`, `stg_bcrs_t_cdr`.`family`, `stg_bcrs_t_cdr`.`standard_rw_new`, `stg_bcrs_t_cdr`.`standard_rw_original`, `stg_bcrs_t_cdr`.`risk_bucket_original`, `stg_bcrs_t_cdr`.`collateral_assigned_amount`, `stg_bcrs_t_cdr`.`used_amount_facility`, `stg_bcrs_t_cdr`.`rwa_pre_floor_equity`, `stg_bcrs_t_cdr`.`bis_past_due_original`, `stg_bcrs_t_cdr`.`ltv`, `stg_bcrs_t_cdr`.`ltv_current`, `stg_bcrs_t_cdr`.`hr`, `stg_bcrs_t_cdr`.`hcr`, `stg_bcrs_t_cdr`.`und_pool_ref`, `stg_bcrs_t_cdr`.`asset_class_category_original`, `stg_bcrs_t_cdr`.`asset_class_category_new`, `stg_bcrs_t_cdr`.`netting_agreement_amount_1`, `stg_bcrs_t_cdr`.`netting_agreement_amount_2`, `stg_bcrs_t_cdr`.`netting_agreement_amount_3`, `stg_bcrs_t_cdr`.`netting_agreement_amount_4`, `stg_bcrs_t_cdr`.`netting_agreement_amount_5`, `stg_bcrs_t_cdr`.`netting_agreement_amount_6`, `stg_bcrs_t_cdr`.`netting_agreement_amount_7`, `stg_bcrs_t_cdr`.`entity_type_category_original`, `stg_bcrs_t_cdr`.`entity_type_category_new`, `stg_bcrs_t_cdr`.`ead_pro_write_off`, `stg_bcrs_t_cdr`.`ead_pro_discount`, `stg_bcrs_t_cdr`.`cpty_group`, `stg_bcrs_t_cdr`.`counterparty_new_desc`, `stg_bcrs_t_cdr`.`internal_rating_new_rank`, `stg_bcrs_t_cdr`.`uncommited`, `stg_bcrs_t_cdr`.`capital_item`, `stg_bcrs_t_cdr`.`product_gl_criteria`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_ori`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_new`, `stg_bcrs_t_cdr`.`secu_retail_line_fg`, `stg_bcrs_t_cdr`.`secu_uncommited_retail_fg`, `stg_bcrs_t_cdr`.`secu_spread_trapping_ratio`, `stg_bcrs_t_cdr`.`collateral_issuer`, `stg_bcrs_t_cdr`.`coll_issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`collateral_haircut_risk_bucket`, `stg_bcrs_t_cdr`.`guarantor`, `stg_bcrs_t_cdr`.`guarantor_bis_entity_type`, `stg_bcrs_t_cdr`.`ead_pro_gen`, `stg_bcrs_t_cdr`.`pd_pre_floor_original`, `stg_bcrs_t_cdr`.`pd_pre_floor_new`, `stg_bcrs_t_cdr`.`lgd_pre_floor_original`, `stg_bcrs_t_cdr`.`lgd_pre_floor_new`, `stg_bcrs_t_cdr`.`int_rating_agency_original`, `stg_bcrs_t_cdr`.`int_rating_agency_new`, `stg_bcrs_t_cdr`.`cpty_group_original`, `stg_bcrs_t_cdr`.`nominal`, `stg_bcrs_t_cdr`.`add_on`, `stg_bcrs_t_cdr`.`fair_value`, `stg_bcrs_t_cdr`.`amortized_cost`, `stg_bcrs_t_cdr`.`accrued_interest`, `stg_bcrs_t_cdr`.`amortized_cost_no_ias`, `stg_bcrs_t_cdr`.`adjustment_amount`, `stg_bcrs_t_cdr`.`outstanding`, `stg_bcrs_t_cdr`.`original_cost`, `stg_bcrs_t_cdr`.`accrued_fees`, `stg_bcrs_t_cdr`.`past_due_ppal`, `stg_bcrs_t_cdr`.`past_due_int`, `stg_bcrs_t_cdr`.`premium_current`, `stg_bcrs_t_cdr`.`cpty_new_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`cpty_orig_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`effective_epe`, `stg_bcrs_t_cdr`.`ead_method`, `stg_bcrs_t_cdr`.`netting_class`, `stg_bcrs_t_cdr`.`bis_industry_sector_new`, `stg_bcrs_t_cdr`.`bis_industry_sector_original`, `stg_bcrs_t_cdr`.`bis_risk_area_new`, `stg_bcrs_t_cdr`.`bis_risk_area_original`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_new`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_original`, `stg_bcrs_t_cdr`.`risk_country_new`, `stg_bcrs_t_cdr`.`risk_country_original`, `stg_bcrs_t_cdr`.`incorporation_country_new`, `stg_bcrs_t_cdr`.`incorporation_country_original`, `stg_bcrs_t_cdr`.`bis_performing_status`, `stg_bcrs_t_cdr`.`rwa_cap_ratio`, `stg_bcrs_t_cdr`.`exposure_amount_1`, `stg_bcrs_t_cdr`.`exposure_amount_2`, `stg_bcrs_t_cdr`.`final_beneficiary`, `stg_bcrs_t_cdr`.`collateral_valuation_date`, `stg_bcrs_t_cdr`.`unrestricted_psia_pct`, `stg_bcrs_t_cdr`.`restricted_psia_pct`, `stg_bcrs_t_cdr`.`collateral_issued_by_the_bank`, `stg_bcrs_t_cdr`.`guarantee_issued_by_the_bank`, `stg_bcrs_t_cdr`.`rated_borrower`, `stg_bcrs_t_cdr`.`long_short`, `stg_bcrs_t_cdr`.`external_rating_new`, `stg_bcrs_t_cdr`.`external_rating_original`, `stg_bcrs_t_cdr`.`external_rating_agency_new`, `stg_bcrs_t_cdr`.`external_rating_agency_orig`, `stg_bcrs_t_cdr`.`collateral_country`, `stg_bcrs_t_cdr`.`issuer`, `stg_bcrs_t_cdr`.`issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`issuer_country`, `stg_bcrs_t_cdr`.`product_gl_criteria_2`, `stg_bcrs_t_cdr`.`positions_type`, `stg_bcrs_t_cdr`.`eligibility_risk_bucket`, `stg_bcrs_t_cdr`.`retail_purpose`, `stg_bcrs_t_cdr`.`color_id`, `stg_bcrs_t_cdr`.`past_due_days`, `stg_bcrs_t_cdr`.`collateral_asset_class`, `stg_bcrs_t_cdr`.`collateral_standard_rw`, `stg_bcrs_t_cdr`.`collateral_asset_class_cat`, `stg_bcrs_t_cdr`.`collateral_risk_bucket`, `stg_bcrs_t_cdr`.`coll_issuer_incorporation_ccy`, `stg_bcrs_t_cdr`.`fund_composition_ref`, `stg_bcrs_t_cdr`.`secu_retention_percentage`, `stg_bcrs_t_cdr`.`secu_retention_calc_method`, `stg_bcrs_t_cdr`.`rw_add_on`, `stg_bcrs_t_cdr`.`lgd_non_performing`, `stg_bcrs_t_cdr`.`ccf_std`, `stg_bcrs_t_cdr`.`concentration_ratio`, `stg_bcrs_t_cdr`.`ttc_lgd`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_code`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_agency`, `stg_bcrs_t_cdr`.`counterparty_int_rat_code`, `stg_bcrs_t_cdr`.`counterparty_int_rat_agency`, `stg_bcrs_t_cdr`.`gl_strategy_code`, `stg_bcrs_t_cdr`.`k_function_used_original`, `stg_bcrs_t_cdr`.`long_gross_position`, `stg_bcrs_t_cdr`.`short_gross_position`, `stg_bcrs_t_cdr`.`correlation_trading`, `stg_bcrs_t_cdr`.`ead_pro_pre_ccf`, `stg_bcrs_t_cdr`.`ead_pro_write_off_pre_ccf`, `stg_bcrs_t_cdr`.`sup_reg_vers_code`, `stg_bcrs_t_cdr`.`dataset_version`, `stg_bcrs_t_cdr`.`clearing_house_code`, `stg_bcrs_t_cdr`.`contract_maturity_eff`, `stg_bcrs_t_cdr`.`counterparty_code_2`, `stg_bcrs_t_cdr`.`qualifying_transaction`, `stg_bcrs_t_cdr`.`qualifying_ccp`, `stg_bcrs_t_cdr`.`sov_rating_used`, `stg_bcrs_t_cdr`.`sov_rating_used_ori`, `stg_bcrs_t_cdr`.`current_ead_imm`, `stg_bcrs_t_cdr`.`current_maturity_eff_imm`, `stg_bcrs_t_cdr`.`obligor_grade_original`, `stg_bcrs_t_cdr`.`obligor_grade_new`, `stg_bcrs_t_cdr`.`deduction_step`, `stg_bcrs_t_cdr`.`significant_investment`, `stg_bcrs_t_cdr`.`el_std`, `stg_bcrs_t_cdr`.`deduction_pct`, `stg_bcrs_t_cdr`.`indirect_position`, `stg_bcrs_t_cdr`.`std_risk_bucket_ori`, `stg_bcrs_t_cdr`.`std_risk_bucket_new`, `stg_bcrs_t_cdr`.`ccp_dfund_method`, `stg_bcrs_t_cdr`.`secu_underlying_asset_type`, `stg_bcrs_t_cdr`.`margin_period`, `stg_bcrs_t_cdr`.`ead_scalar`, `stg_bcrs_t_cdr`.`crm_first_lien`, `stg_bcrs_t_cdr`.`available_amount`, `stg_bcrs_t_cdr`.`accounting_adjustment_type`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_1`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_2`, `stg_bcrs_t_cdr`.`adjusted_value`, `stg_bcrs_t_cdr`.`ead_before_acc_adj`, `stg_bcrs_t_cdr`.`lgd_before_acc_adj`, `stg_bcrs_t_cdr`.`subset_code`, `stg_bcrs_t_cdr`.`el_rwa_part`, `stg_bcrs_t_cdr`.`industry_sector_original`, `stg_bcrs_t_cdr`.`cds_qualifying`, `stg_bcrs_t_cdr`.`default_date`, `stg_bcrs_t_cdr`.`credit_bureau_name_original`, `stg_bcrs_t_cdr`.`credit_bureau_name_refreshed`, `stg_bcrs_t_cdr`.`fico_original`, `stg_bcrs_t_cdr`.`fico_refreshed`, `stg_bcrs_t_cdr`.`pool_ead_formula`, `stg_bcrs_t_cdr`.`clearing_member`, `stg_bcrs_t_cdr`.`securitization_depth`, `stg_bcrs_t_cdr`.`securitization_loop`, `stg_bcrs_t_cdr`.`bankruptcy_remote`, `stg_bcrs_t_cdr`.`margin_type`, `stg_bcrs_t_cdr`.`collateral_bankruptcy_remote`, `stg_bcrs_t_cdr`.`collateral_margin_type`, `stg_bcrs_t_cdr`.`remargining_frequency`, `stg_bcrs_t_cdr`.`settlement_ccy`, `stg_bcrs_t_cdr`.`vm_extinguishes_mtm`, `stg_bcrs_t_cdr`.`margin_agreement`, `stg_bcrs_t_cdr`.`rw_pre_floor_new`, `stg_bcrs_t_cdr`.`rwa_pre_floor`, `stg_bcrs_t_cdr`.`ccp_exposure_type`, `stg_bcrs_t_cdr`.`carrying_amount`, `stg_bcrs_t_cdr`.`exchange_rate`, `stg_bcrs_t_cdr`.`policy_update`, `stg_bcrs_t_cdr`.`methodology_update`, `stg_bcrs_t_cdr`.`model_update`, `stg_bcrs_t_cdr`.`pd_model_update`, `stg_bcrs_t_cdr`.`lgd_model_update`, `stg_bcrs_t_cdr`.`ccf_model_update`, `stg_bcrs_t_cdr`.`ead_model_update`, `stg_bcrs_t_cdr`.`covered_ead`, `stg_bcrs_t_cdr`.`fi_type`, `stg_bcrs_t_cdr`.`maturity_date`, `stg_bcrs_t_cdr`.`policy_name`, `stg_bcrs_t_cdr`.`methodology_name`, `stg_bcrs_t_cdr`.`model_name`, `stg_bcrs_t_cdr`.`fund_reference`, `stg_bcrs_t_cdr`.`fund_method`, `stg_bcrs_t_cdr`.`fund_depth`, `stg_bcrs_t_cdr`.`fund_initial`, `stg_bcrs_t_cdr`.`rwa_pre_lvr`, `stg_bcrs_t_cdr`.`leverage`, `stg_bcrs_t_cdr`.`rw_el`, `stg_bcrs_t_cdr`.`use_beel`, `stg_bcrs_t_cdr`.`k_ratio`, `stg_bcrs_t_cdr`.`trade_date`, `stg_bcrs_t_cdr`.`sme_ceiling`, `stg_bcrs_t_cdr`.`sme_floor`, `stg_bcrs_t_cdr`.`sme_ceiling_indicator`, `stg_bcrs_t_cdr`.`fund_assets`, `stg_bcrs_t_cdr`.`obligor_grade_rank_original`, `stg_bcrs_t_cdr`.`obligor_grade_sup_original`, `stg_bcrs_t_cdr`.`obligor_grade_inf_original`, `stg_bcrs_t_cdr`.`obligor_grade_rank_new`, `stg_bcrs_t_cdr`.`obligor_grade_sup_new`, `stg_bcrs_t_cdr`.`obligor_grade_inf_new`, `stg_bcrs_t_cdr`.`lgd_grade_inf`, `stg_bcrs_t_cdr`.`lgd_grade_sup`, `stg_bcrs_t_cdr`.`lgd_grade_rank`, `stg_bcrs_t_cdr`.`lgd_grade`, `stg_bcrs_t_cdr`.`conservation_buffer`, `stg_bcrs_t_cdr`.`conservation_rgc`, `stg_bcrs_t_cdr`.`ctcycal_buffer`, `stg_bcrs_t_cdr`.`ctcycal_rgc`, `stg_bcrs_t_cdr`.`sifi_buffer`, `stg_bcrs_t_cdr`.`sifi_rgc`, `stg_bcrs_t_cdr`.`leverage_ead`, `stg_bcrs_t_cdr`.`at1_deduction`, `stg_bcrs_t_cdr`.`cet1_deduction`, `stg_bcrs_t_cdr`.`adjustment_tag`, `stg_bcrs_t_cdr`.`rw_new_grouping`, `stg_bcrs_t_cdr`.`nominal_at_rw_new`, `stg_bcrs_t_cdr`.`ead_at_rw_new`, `stg_bcrs_t_cdr`.`collateral_completed`, `stg_bcrs_t_cdr`.`rep_product`, `stg_bcrs_t_cdr`.`rep_collateral_product`, `stg_bcrs_t_cdr`.`ltv_indexed`, `stg_bcrs_t_cdr`.`origination_date`, `stg_bcrs_t_cdr`.`is_le`, `stg_bcrs_t_cdr`.`rep_industry_sector`, `stg_bcrs_t_cdr`.`scenario_process_step`, `stg_bcrs_t_cdr`.`period_id`, `stg_bcrs_t_cdr`.`period_start_date`, `stg_bcrs_t_cdr`.`period_end_date`, `stg_bcrs_t_cdr`.`scenario_process_name`, `stg_bcrs_t_cdr`.`scenario_process_id`, `stg_bcrs_t_cdr`.`regulatory_scenario_name`, `stg_bcrs_t_cdr`.`rep_asset_class`, `stg_bcrs_t_cdr`.`rep_sub_product`, `stg_bcrs_t_cdr`.`rep_arrears_band_mia`, `stg_bcrs_t_cdr`.`rep_arrears_band_pia`, `stg_bcrs_t_cdr`.`rep_payment_type`, `stg_bcrs_t_cdr`.`weighted_avg_rate`, `stg_bcrs_t_cdr`.`customer_field11`, `stg_bcrs_t_cdr`.`customer_field12`, `stg_bcrs_t_cdr`.`customer_field13`, `stg_bcrs_t_cdr`.`customer_field14`, `stg_bcrs_t_cdr`.`customer_field15`, `stg_bcrs_t_cdr`.`customer_field16`, `stg_bcrs_t_cdr`.`customer_field17`, `stg_bcrs_t_cdr`.`customer_field18`, `stg_bcrs_t_cdr`.`customer_field19`, `stg_bcrs_t_cdr`.`customer_field20`, `stg_bcrs_t_cdr`.`customer_field21`, `stg_bcrs_t_cdr`.`customer_number11`, `stg_bcrs_t_cdr`.`customer_number12`, `stg_bcrs_t_cdr`.`customer_number13`, `stg_bcrs_t_cdr`.`customer_number14`, `stg_bcrs_t_cdr`.`customer_number15`, `stg_bcrs_t_cdr`.`customer_number16`, `stg_bcrs_t_cdr`.`customer_number17`, `stg_bcrs_t_cdr`.`customer_number18`, `stg_bcrs_t_cdr`.`customer_date1`, `stg_bcrs_t_cdr`.`customer_date2`, `stg_bcrs_t_cdr`.`customer_date3`, `stg_bcrs_t_cdr`.`rep_major_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_major_asset_class_new`, `stg_bcrs_t_cdr`.`rep_asset_class_new`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_new`, `stg_bcrs_t_cdr`.`rep_maturity_band`, `stg_bcrs_t_cdr`.`rep_segmentation`, `stg_bcrs_t_cdr`.`src_reporting_date`, `stg_bcrs_t_cdr`.`src_wks_name`, `stg_bcrs_t_cdr`.`src_position`, `stg_bcrs_t_cdr`.`generic_reporting_date`, `stg_bcrs_t_cdr`.`generic_wks_name`, `stg_bcrs_t_cdr`.`generic_position`, `stg_bcrs_t_cdr`.`securitization_mm`, `stg_bcrs_t_cdr`.`securitization_mm_factor`, `stg_bcrs_t_cdr`.`is_eligible_cva`, `stg_bcrs_t_cdr`.`audit_cva_eligibility`, `stg_bcrs_t_cdr`.`ead_pro_cva`, `stg_bcrs_t_cdr`.`generic_field1`, `stg_bcrs_t_cdr`.`generic_field2`, `stg_bcrs_t_cdr`.`generic_field3`, `stg_bcrs_t_cdr`.`generic_field4`, `stg_bcrs_t_cdr`.`generic_field5`, `stg_bcrs_t_cdr`.`generic_field6`, `stg_bcrs_t_cdr`.`generic_field7`, `stg_bcrs_t_cdr`.`generic_field8`, `stg_bcrs_t_cdr`.`generic_field9`, `stg_bcrs_t_cdr`.`generic_field10`, `stg_bcrs_t_cdr`.`generic_number1`, `stg_bcrs_t_cdr`.`generic_number2`, `stg_bcrs_t_cdr`.`generic_number3`, `stg_bcrs_t_cdr`.`generic_number4`, `stg_bcrs_t_cdr`.`generic_number5`, `stg_bcrs_t_cdr`.`generic_number6`, `stg_bcrs_t_cdr`.`generic_number7`, `stg_bcrs_t_cdr`.`generic_number8`, `stg_bcrs_t_cdr`.`generic_number9`, `stg_bcrs_t_cdr`.`generic_number10`, `stg_bcrs_t_cdr`.`customer_field1`, `stg_bcrs_t_cdr`.`customer_field2`, `stg_bcrs_t_cdr`.`customer_field3`, `stg_bcrs_t_cdr`.`customer_field4`, `stg_bcrs_t_cdr`.`customer_field5`, `stg_bcrs_t_cdr`.`customer_field6`, `stg_bcrs_t_cdr`.`customer_field7`, `stg_bcrs_t_cdr`.`customer_field8`, `stg_bcrs_t_cdr`.`customer_field9`, `stg_bcrs_t_cdr`.`customer_field10`, `stg_bcrs_t_cdr`.`customer_number1`, `stg_bcrs_t_cdr`.`customer_number2`, `stg_bcrs_t_cdr`.`customer_number3`, `stg_bcrs_t_cdr`.`customer_number4`, `stg_bcrs_t_cdr`.`customer_number5`, `stg_bcrs_t_cdr`.`customer_number6`, `stg_bcrs_t_cdr`.`customer_number7`, `stg_bcrs_t_cdr`.`customer_number8`, `stg_bcrs_t_cdr`.`customer_number9`, `stg_bcrs_t_cdr`.`customer_number10`, `stg_bcrs_t_cdr`.`run_date`, `stg_bcrs_t_cdr`.`process_profile_sr_id`, `stg_bcrs_t_cdr`.`conso_perimeter`, `stg_bcrs_t_cdr`.`interco`, `stg_bcrs_t_cdr`.`interco_type`, `stg_bcrs_t_cdr`.`valid_cpy_perimeter`, `stg_bcrs_t_cdr`.`issuer_id`, `stg_bcrs_t_cdr`.`approver_id`, `stg_bcrs_t_cdr`.`upload_date`, `stg_bcrs_t_cdr`.`approval_date`, `stg_bcrs_t_cdr`.`adj_batch_date`, `stg_bcrs_t_cdr`.`source_file_name`, `stg_bcrs_t_cdr`.`adj_seq`, `stg_bcrs_t_cdr`.`dp_rule_log`, `stg_bcrs_t_cdr`.`staging_source`, `stg_bcrs_t_cdr`.`id`, `stg_bcrs_t_cdr`.`parent_id`, `stg_bcrs_t_cdr`.`child_id`, `stg_bcrs_t_cdr`.`multipurpose_audit`, `stg_bcrs_t_cdr`.`saccr_pfe`, `stg_bcrs_t_cdr`.`saccr_rc`, `stg_bcrs_t_cdr`.`flag_deduction`, `stg_bcrs_t_cdr`.`w_snapshot_dt`, `stg_bcrs_t_cdr`.`w_datasource_id`, `stg_bcrs_t_cdr`.`w_country_cd`, `stg_bcrs_t_cdr`.`w_batch_id`,          (                 CASE                     WHEN nvl(`stg_bcrs_t_cdr`.`table_name`,'z') IN (                         'BOND',                         'EQUITY',                         'TRANCHE',                         'CONVERTIBLE',                         'FUND'                     ) THEN 'SECURITY_POSITIONS'                     ELSE nvl(`stg_bcrs_t_cdr`.`table_name`,'z')                 END             ) AS `sec_table_name`,             substr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'/') + 1,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'-') - (instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'/') + 1) ) `management_product`,             substr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,instr(`stg_bcrs_t_cdr`.`product_gl_criteria_2`,'-') + 1,2) `business_indentifier`         FROM             `sgmisitstg`.`stg_bcrs_t_cdr`   ) `t`   left join `sgmisitstg`.`stg_bcrs_companies_links` `complink` on `t`.`booking_company` = `complink`.`child_code` AND CASE WHEN 'WS29' like '%ADJ%' THEN `complink`.`w_batch_id` = '2018071116473300773' ELSE `complink`.`w_batch_id` = '2018071116473300773' END  left join (          SELECT `stg_bcrs_t_cdr`.`contract_reference`, SUM(`stg_bcrs_t_cdr`.`rwa`) AS `SUM_RWA`         FROM `sgmisitstg`.`stg_bcrs_t_cdr`         WHERE `stg_bcrs_t_cdr`.`w_batch_id` = '2018071116473300773'         GROUP BY `stg_bcrs_t_cdr`.`contract_reference`         ) `t2` on `t`.`contract_reference` = `t2`.`contract_reference`          left join `sgmisitstg`.`stg_bcrs_scb_gpr_default_indicator` `grpdfind` on `t`.`contract_type` = `grpdfind`.`indicator_value` AND CASE WHEN 'WS29' like '%ADJ%' THEN `grpdfind`.`w_batch_id` = '2018071116473300773' ELSE `grpdfind`.`w_batch_id` = '2018071116473300773' END  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_csr`.`contract_reference`,             `stg_bcrs_csr`.`start_date`,             `stg_bcrs_csr`.`maturity_date`,             `stg_bcrs_csr`.`value_date`         FROM `sgmisitstg`.`stg_bcrs_csr`         WHERE `stg_bcrs_csr`.`import_source` NOT LIKE '%WB%'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `stg_bcrs_csr`.`w_batch_id` = '2018071116473300773' ELSE `stg_bcrs_csr`.`w_batch_id` = '2018071116473300773' END ) `csr` ON `t`.`contract_reference` = `csr`.`contract_reference`  LEFT JOIN ( SELECT DISTINCT             `e`.`entity_code`,             `e`.`entity_desc`,             `e`.`attribute_4`,             `e`.`attribute_1`,             `e`.`incorporation_country`,             `e`.`origination_country`,             `cfi`.`scorecard_segment_code`,             `cfi`.`scorecard_segment_category`,             `cfi`.`cf_indicator`,             `e`.`attribute_7`,             `cd1`.`code_desc` AS `customer_segment_desc`,             `e`.`attribute_8`,             `cd2`.`code_desc` AS `customer_subsegment_desc`,             `e`.`et_code_user`,             `icr`.`long_term_rating`,             `icr`.`long_term_rating_local_ccy`,             `e`.`country_code`             , `el`.`bf_link_type`             , `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`  `e`                   LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON `e`.`entity_code` = `icr`.`entity_code`                                                    AND nvl(`icr`.`agency_code`,'z') = 'INTERNAL'                                                    AND `icr`.`w_batch_id` = '2018071116473300773'           LEFT JOIN ( SELECT DISTINCT  `links`.`child_code`,                          case when `linktype`.`link_type` is not null then 'BUYER_FINANCE' else null end `bf_link_type`                         FROM `sgmisitstg`.`stg_bcrs_entity_links` `links` left join (SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                 FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`) `linktype`                                  WHERE `links`.`link_type` IN ( SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                         FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`   ))  `el`              ON `e`.`entity_code` = `el`.`child_code`                      LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_co_fi` `cfi` ON `e`.`attribute_1` = `cfi`.`scorecard_segment`         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cfi`.`w_batch_id` = '2018071116473300773' ELSE `cfi`.`w_batch_id` = '2018071116473300773' END                  LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')         AND `cd1`.`code_type` = 'CUST_SEG'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd1`.`w_batch_id` = '2018071116473300773' ELSE `cd1`.`w_batch_id` = '2018071116473300773' END                  LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd2` ON nvl(`cd2`.`code`,'zz') = nvl(`e`.`attribute_8`,'zz')         AND `cd2`.`code_type` = 'CUST_SUB_SEG'         AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd2`.`w_batch_id` = '2018071116473300773' ELSE `cd2`.`w_batch_id` = '2018071116473300773' END          ) `e` ON `t`.`counterparty_original` = `e`.`entity_code` AND `e`.`w_batch_id` = '2018071116473300773'  LEFT JOIN (         SELECT DISTINCT             `e`.`entity_code`,             `e`.`attribute_7` AS `group_cust_segment_code`,             `cd1`.`code_desc` AS `group_cust_segment_desc`,             `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity` `e`                           LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')                    AND `cd1`.`code_type` = 'CUST_SEG'                    AND CASE WHEN 'WS29' like '%ADJ%' THEN `cd1`.`w_batch_id` = '2018071116473300773' ELSE `cd1`.`w_batch_id` = '2018071116473300773' END ) `egroup_orig` ON `t`.`cpty_group_original` = `egroup_orig`.`entity_code`  and `e`.`w_batch_id` = '2018071116473300773'  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_entity`.`entity_code`,             `stg_bcrs_entity`.`attribute_1`,             `stg_bcrs_entity`.`origination_country`,             `stg_bcrs_entity`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`         where `stg_bcrs_entity`.`w_batch_id` = '2018071116473300773' ) `enew` ON `t`.`counterparty_new` = `enew`.`entity_code`   LEFT JOIN ( SELECT             `stg_bcrs_companies`.`company_code`,             `stg_bcrs_companies`.`country_code`,             `stg_bcrs_companies`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_companies`         where `stg_bcrs_companies`.`w_batch_id` = '2018071116473300773' ) `cpies` ON `t`.`booking_company` = `cpies`.`company_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_scb_wb_bf_uns_recoveries`.`domicile_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`booking_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`contract_type`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`cf_ind`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`prr`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`         where CASE WHEN 'WS29' like '%ADJ%' THEN `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2018071116473300773' ELSE `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2018071116473300773' END     ) `bf` ON `bf`.`domicile_country_code` = `e`.`country_code`             AND `bf`.`booking_country_code` = `cpies`.`country_code`             AND `bf`.`contract_type` = `t`.`contract_type`             AND `bf`.`cf_ind` = `e`.`cf_indicator`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_contract_types`.`ct_code_user`,             `stg_bcrs_contract_types`.`ct_desc_user`,             `stg_bcrs_contract_types`.`attribute_2`,             `stg_bcrs_contract_types`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_contract_types`             where              `stg_bcrs_contract_types`.`w_batch_id` = '2018071116473300773'      ) `ct` ON `t`.`contract_type` = `ct`.`ct_code_user`  Left Join ( select distinct  `stg_bcrs_contract_types`.`ct_code_user`, `stg_bcrs_contract_types`.`contract_category`, `stg_bcrs_contract_types`.`w_batch_id` from  `sgmisitstg`.`stg_bcrs_contract_types` where   `stg_bcrs_contract_types`.`w_batch_id` = '2018071116473300773' and `stg_bcrs_contract_types`.`contract_category` = 'RECEIVABLE' ) `contracttype` on `t`.`contract_type` = `contracttype`.`ct_code_user`           LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`attribute_7` AS `non_gam_ind`,             `stg_bcrs_facility`.`attribute_8` AS `holdco_ind`,             `stg_bcrs_facility`.`trade_date`,             `stg_bcrs_facility`.`maturity_date`         FROM             `sgmisitstg`.`stg_bcrs_facility`         WHERE              `stg_bcrs_facility`.`w_batch_id` = '2018071116473300773'      ) `fac` ON `t`.`contract_reference` = `fac`.`contract_reference`      LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_mkt_fx_input`.`booking_company_code`,             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL'             AND `stg_bcrs_mkt_fx_input`.`w_batch_id` = '2018071116473300773'      ) `cer` ON `t`.`booking_company` = `cer`.`booking_company_code`              AND `t`.`currency` = `cer`.`ccy_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_country`.`country_code`,             `stg_bcrs_country`.`country_name`         FROM             `sgmisitstg`.`stg_bcrs_country`         WHERE              `stg_bcrs_country`.`w_batch_id` = '2018071116473300773'      ) `c` ON `t`.`incorporation_country_original` = `c`.`country_code`      LEFT JOIN (     select `prrsrtmp`.`contract_reference`, `prrsrtmp`.`bs_type`, `prrsrtmp`.`prr`, `prrsrtmp`.`w_batch_id`, `prrsrtmp`.`rnk` from (         SELECT DISTINCT             `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,              `stg_bcrs_scb_wb_prr_sr`.`bs_type`,              `stg_bcrs_scb_wb_prr_sr`.`prr`,              `stg_bcrs_scb_wb_prr_sr`.`w_batch_id`,             ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_wb_prr_sr`.`contract_reference` ORDER BY `stg_bcrs_scb_wb_prr_sr`.`contract_reference`) AS `rnk`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_prr_sr` ) `prrsrtmp`         where             `prrsrtmp`.`rnk` = 1     ) `prrsr` ON `t`.`contract_reference` = `prrsr`.`contract_reference`              AND `t`.`bs_type` = `prrsr`.`bs_type` and `prrsr`.`w_batch_id` = '2018071116473300773'                      LEFT JOIN (             select `addtinst`.`contract_reference`, `addtinst`.`table_name`, `addtinst`.`tp_portfolio_name`, `addtinst`.`psgl_department_id`, `addtinst`.`psgl_product_code`, `addtinst`.`psgl_operating_unit`, `addtinst`.`psgl_customer_class`, `addtinst`.`rnk` from (                 SELECT                     `stg_bcrs_scb_wb_addt_inst`.`contract_reference`,                     `stg_bcrs_scb_wb_addt_inst`.`table_name`,                     `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`,                     ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ORDER BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`) AS `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2018071116473300773') `addtinst`                              WHERE                         `addtinst`.`rnk` = 1     ) `inst` ON `inst`.`contract_reference` = `t`.`contract_reference`               AND `inst`.`table_name` = `t`.`sec_table_name`                               LEFT JOIN (         SELECT             nvl(`split_ref`.`contract_reference`,`a`.`contract_reference`) `contract_reference`,             `a`.`psgl_cust_class`,             `a`.`psgl_product`,             TRIM(`a`.`psgl_department`) `psgl_department`,             `a`.`fermat_table_name`         FROM             (                 SELECT DISTINCT                     `b`.`contract_reference`,                     `b`.`fermat_table_name`,                     `b`.`psgl_cust_class`,                     `b`.`psgl_product`,                     `b`.`psgl_department`,                     `c`.`priority`,                     ROW_NUMBER() OVER(PARTITION BY `b`.`contract_reference`, `b`.`fermat_table_name` ORDER BY `c`.`priority`) `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_psgl` `b`                     left join `sgmisitstg`.`stg_bcrs_scb_wb_amt_cat_priority` `c`                                         on `b`.`fermat_table_name` = `c`.`table_name`                      and `b`.`amount_category_dw_sorsa` = `c`.`amount_category_dw_sorsa`                     and `b`.`psgl_product` <> 'ZZZ'                     and `b`.`w_batch_id`='2018071116473300773'                      and `b`.`w_batch_id` = `c`.`w_batch_id`                                     ) `a`             left join             (                 SELECT DISTINCT                     `stg_bcrs_scb_wb_facility_links`.`contract_reference`,                     `stg_bcrs_scb_wb_facility_links`.`attribute_1` AS `orig_cont_ref`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_facility_links`                 WHERE                     `stg_bcrs_scb_wb_facility_links`.`attribute_1` IS NOT NULL and `stg_bcrs_scb_wb_facility_links`.`w_batch_id`='2018071116473300773'             ) `split_ref`         on             `a`.`contract_reference` = `split_ref`.`orig_cont_ref`             where   `a`.`rnk` = 1     ) `psgl` ON `t`.`contract_reference` = `psgl`.`contract_reference`               AND `t`.`sec_table_name` = `psgl`.`fermat_table_name`                                                 LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_mpdt_mru_map`.`mru_desc`,             `stg_bcrs_scb_wb_mpdt_mru_map`.`mpdt_code`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_mpdt_mru_map` where `stg_bcrs_scb_wb_mpdt_mru_map`.`w_batch_id`='2018071116473300773'     ) `mru_bus` ON `mru_bus`.`mpdt_code` = `t`.`management_product`                        LEFT JOIN `sgmisitstg`.`stg_bcrs_fdw_netting_agreement` `net` ON `net`.`agreement_reference` = `t`.`netting_agreement_reference`     and `net`.`w_batch_id`='2018071116473300773'          LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_fac_sub_limits`.`id`,             `stg_bcrs_scb_wb_fac_sub_limits`.`contract_reference`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_attribute`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_amount`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_fac_sub_limits` where `stg_bcrs_scb_wb_fac_sub_limits`.`w_batch_id`='2018071116473300773'     ) `sub` ON `t`.`id` = `sub`.`id`          LEFT JOIN (         SELECT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`book_code`,             `stg_bcrs_facility`.`currency`         FROM             `sgmisitstg`.`stg_bcrs_facility` where `stg_bcrs_facility`.`w_batch_id`='2018071116473300773'     ) `fac_curr` ON `sub`.`contract_reference` = `fac_curr`.`contract_reference`       LEFT JOIN (         SELECT             `stg_bcrs_deal_book`.`booking_company`,             `stg_bcrs_deal_book`.`book_code`         FROM             `sgmisitstg`.`stg_bcrs_deal_book` where `stg_bcrs_deal_book`.`w_batch_id`='2018071116473300773'     ) `dealbook` ON `dealbook`.`book_code` = `fac_curr`.`book_code`          LEFT JOIN (         SELECT             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`,             `stg_bcrs_mkt_fx_input`.`booking_company_code`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL' and `stg_bcrs_mkt_fx_input`.`w_batch_id`='2018071116473300773'     ) `fac_curr_exch` ON `fac_curr_exch`.`ccy_code` = `fac_curr`.`currency`                        AND `fac_curr_exch`.`booking_company_code` = `dealbook`.`booking_company`                               LEFT JOIN (         SELECT             `stg_bcrs_t_cva`.`contract_reference`,             count(`stg_bcrs_t_cva`.`contract_reference`) as `count_contract_ref`,             SUM(nvl(`stg_bcrs_t_cva`.`cva_rwa`,0) ) `cva_rwa`         FROM             `sgmisitstg`.`stg_bcrs_t_cva` where `stg_bcrs_t_cva`.`w_batch_id`='2018071116473300773'         GROUP BY             `stg_bcrs_t_cva`.`contract_reference`     ) `tcva` ON `tcva`.`contract_reference` = `t`.`contract_reference`              LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_mru_business_idntfr_map` `bus_ind`      ON `bus_ind`.`business_identifier` = `t`.`business_indentifier` and `bus_ind`.`w_batch_id`='2018071116473300773'      where `t`.`w_batch_id` = '2018071116473300773'      and `t`.`import_source` LIKE '%WB%'     and `t`.`w_snapshot_dt` = '2018-04-30'     and `t`.`w_datasource_id` = 'BCRS_ND'     and `t`.`w_country_cd`='SG'     and `t`.`import_source` <> 'PSGL-WBDS'
CREATE VIEW `temp_src_query_1808071858540061404` AS SELECT DISTINCT         NVL(`tcdr`.`accrued_fees`,0) `accrued_fees`,  CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY') THEN NVL(`tcdr`.`accrued_interest`, 0) ELSE 0 END `accrued_interest`,         NVL(`txn`.`accrued_interest`,0) `accrued_interest_dollar`,         NVL(`tcdr`.`add_on`,0) `add_on`,         `txn`.`add_on` AS `add_on_dollar`,         `txn`.`collateral_attribute_9`,         CASE                 WHEN `txn`.`collateral_attribute_9` IN (                     'Correct',                     'Reverse'                 ) THEN 'Y'                 ELSE 'N'             END         `adj_flag`,         NVL(`fac`.`amount`,0) `ADJUSTED_LIMIT_AMOUNT`,         `tcdr`.`adjustment_amount`,         `tcdr`.`id` `ais_id`,         `tcdr`.`amortized_cost`,         `tcdr`.`amortized_cost_no_ias`,         'MFU needed - RSK_LIMIT_STATIC.txt' `approved_lgd`,        'MFU needed - RSK_LIMIT_STATIC.txt' `approver_name`,         `inst`.`arm_code` `arm_cd`,         `inst`.`arm_description` `arm_description`,         `tcdr`.`asset_class_category_new`,         `tcdr`.`asset_class_category_original`,         `tcdr`.`asset_class_new`,         `tcdr`.`asset_class_original`,         `crm`.`attribute_6` `attribute_6`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`avg_pre_funded_contribution`                 ELSE NULL             END         `avg_prefunded_contribution`,         `txn`.`balance_category`,         `bca`.`bca_approval_dt` `BCA_APPROVAL_DATE`,         `bca`.`bca_review_dt` `BCA_REVIEW_DATE`,         `tcdr`.`beel`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`beta`                 ELSE NULL             END         `beta`,         nvl(`cva`.`bi`,0) `bi`,         `tcdr`.`method_new` `bii_calculation_method`,         `tcdr`.`bis_entity_type_new`,         `tcdr`.`bis_entity_type_original`,         `tcdr`.`bis_industry_sector_new`,         `tcdr`.`bis_industry_sector_original`,         `tcdr`.`bis_past_due`,         `tcdr`.`bis_past_due_original`,         `tcdr`.`bis_performing_status`,         `tcdr`.`bis_product` `BIS_PROD`,         `tcdr`.`bis_product_category` `BIS_PROD_CATEGORY`,         `txn`.`bis_risk_area_new`,         `txn`.`bis_risk_area_original`,        `tcdr`.`bis_risk_sub_area_new`,         `tcdr`.`bis_risk_sub_area_original`,         `tcdr`.`booking_company` `booking_entity_wid`,         `tcdr`.`booking_company` `booking_entity_id`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code` THEN `tcdr`.`counterparty_original`                         ELSE NULL                     END                 ELSE NULL             END `BROKER_ID`,         `tcdr`.`bs_type`,         `txn`.`business`,         `tcdr`.`business_line_code` `business_line_cd`,         `txn`.`customer_subsegment_code` `BUSINESS_SUB_SEGMENT`,         `txn`.`management_product` `BUSINESS_UNIT`,         `tcdr`.`capital_item`,         `tcdr`.`ccf`,         `tcdr`.`ccp_dfund_method`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`ccp_name`                 ELSE NULL             END         `ccp_name`,         `client`.`client_domicile_loc_id` `ccr_ctry`,         CASE                 WHEN `client`.`client_domicile_loc_id` IS NULL THEN `client`.`coi_loc_id`                 ELSE `client`.`client_domicile_loc_id`             END `CCR_EQ_CNTRY`,         `txn`.`ccr_new`,         `txn`.`ccr_original`,         `tcdr`.`ccy_code` `CCY_CD`,         `tcdrp`.`cec` `cec`,         CASE                 WHEN `tcdr`.`ead_method` IN (                     'CEM',                     'IMM'                 )                      AND                      CASE                         WHEN nvl(`txn`.`contract_type`,'UNMP') = 'GMGMKTLEAS' THEN 'F'                         ELSE `txn`.`derivative_ind`                     END                 = 'T' THEN `tcdr`.`ead_method`             END         `cem_imm_ind`,         `txn`.`cf_indicator`,         `tcdr`.`child_id`,         `tcdr`.`clearing_house_code` `CLEARING_HOUSE_CD`,         CASE                 WHEN `tcdr`.`contract_reference` NOT LIKE 'CCP_MARGIN%' THEN 'N'                 ELSE 'Y'             END         `client_trade`,         `tcdr`.`coll_issuer_bis_entity_type`,         `tcdr`.`collateral_bis_product` `COLLATERAL_BIS_PROD`,  `tcdr`.`collateral_contract_type` `COLLATERAL_CONTRACT_TYPE`,         `tcdr`.`collateral_issuer`,         `crm`.`attribute_6` `collateral_perfection_status`,         `txn`.`collateral_product_category` `collateral_prod_category`,         `tcdr`.`collateral_reference` `collateral_ref_no`,         `tcdr`.`collateral_valuation_date` `collateral_valuation_date`,         `tcdr`.`collateral_attribute_9` `collateral_adjusted_flag`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdragg`.`committed_amount`                 ELSE NULL             END         `committed_amount`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdragg`.`committed_available_amunt`                 ELSE NULL             END         `committed_available_amunt`,         CASE                 WHEN `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'Y'                      AND `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 ) THEN `tcdragg`.`committed_headroom`                 ELSE 0             END         `committed_headroom`,         `fac`.`commited` `committed_indicator`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE'                 )                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`outstanding`                 ELSE 0             END         `committed_os`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdragg`.`committed_amount`                 ELSE NULL             END         `committed_used_amount`,         '0' `committed_used_amt_temp`,         `tcdr`.`company_code` `company_cd`,         `txn`.`company_type`,         `tcdr`.`contract_reference` `contract_ref_no`,         `tcdr`.`contract_type`,         `tcdr`.`internal_rating_original` `correct_orig_crg`,         `inst`.`cost_center` `cost_center_cd`,         `inst`.`cost_center_descriotion` `cost_center_description`,         `tcdr`.`counterparty_new` `counterparty_new_wid`,         `tcdr`.`counterparty_new`,         `tcdr`.`counterparty_new_attribute_1`,         `tcdr`.`counterparty_new_attribute_2`,         `tcdr`.`counterparty_new_attribute_3`,         `tcdr`.`counterparty_new_attribute_4`,         `tcdr`.`counterparty_new_attribute_5`,         `tcdr`.`counterparty_new_attribute_6`,         `tcdr`.`counterparty_new_attribute_7`,         `tcdr`.`counterparty_new_attribute_8`,         `tcdr`.`counterparty_new_attribute_9`,         `tcdr`.`counterparty_new_desc`,         `tcdr`.`counterparty_original` `counterparty_original_wid`,         `tcdr`.`counterparty_original`,         `tcdr`.`counterparty_type_new`,         `tcdr`.`counterparty_type_original`,         `txn`.`country_name`,   CASE WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`collateral_bis_product` <>  'OTC_NET_COL' THEN `tcdr`.`ead` ELSE 0 END `covered_ead`,          `tcdr`.`cpty_group`,         `tcdr`.`cpty_group_original`,         `tcdr`.`cpty_new_sebc_not_qualifying`,         `tcdr`.`cpty_orig_sebc_not_qualifying`,         `tcdrp`.`crc`,         'MFU needed - CRE_CATEGORY.txt' `cre_category`,         'MFU needed - RSK_MAINPROF_CTC.txt' `cre_coverage`,         'MFU needed - CRE_CATEGORY.txt' `cre_property_type`,         `tcdr`.`credit_substitute`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_cd`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_name`,         'RMI REF needed - RSK_CRM_SR_PART' `crm_currency`,         'RMI REF needed - RSK_CRM_SR_PART' `crm_location`,         `txn`.`crm_method` `crm_method`,         'RMI REF needed - RSK_CRM_SR_PART' `crm_residual_maturity`,         `juris`.`csa` `csa_flg`,         `tcdr`.`currency`,         ( nvl(round(`tcdr`.`ead_pro_cva`,10),0) * nvl(round(`tcdr`.`rw_new`,10),0) ) `cva_ccr_rwa`,         `cva`.`cva_index_part` `cva_index_part`,         `txn`.`cva_rwa` `cva_rwa`,         (round(nvl(`cva`.`cva_rwa_addon`,0),10) * round(`obi`.`cva_static_val`,10)) `cva_rwa_addon`,         `txn`.`days_after_contractual_date`,         `tcdr`.`deal_status`,         `tcdr`.`dealbook` `book_wid`,         `tcdr`.`dealbook` `book_cd`,         `txn`.`delivery_type`,         `txn`.`derivative_ind`,         NVL(`clrh`.`df_cm`, 0) `df_cm`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfccp`                 ELSE NULL             END         `dfccp`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfi`                 ELSE NULL             END         `dfi`,         NVL(`enl`.`mother_code`, 'UNMP DLRFIN') `dlrfin_cd`,         `tcdr`.`ead`,         `tcdr`.`ead_formula`,         `tcdr`.`ead_method`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `ead_netting`,         `tcdr`.`ead_original`,         `tcdr`.`ead_pre_ccf`,         `tcdr`.`ead_pro`,         `tcdr`.`ead_pro_cva`,         `tcdr`.`ead_pro_discount`,         `tcdr`.`ead_pro_gen`,         `tcdr`.`ead_pro_write_off`,         nvl(round(`tcdr`.`ead`,10),0) * NVL(`prrsr`.`prr`,0) `ead_prr`,         `tcdr`.`ead_scalar` `ead_scalar`,         nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `ead_square`,         `txn`.`ec_filter_type`,         `txn`.`ec_w_filter_type`,         `tcdr`.`effective_epe`,         nvl(`tcdr`.`k_maturity`,0) `effective_matirity`,         `tcdr`.`el`,         NVL(`trfrsk`.`el_cpty`,0) `el_cpty`,         NVL(`tcdr`.`el`,0) `el_net_saves`,         'MFU needed - Pool_Ref_MONYY.txt' `el_saves`,         NVL(`trfrsk`.`el_total`,0) `el_total`,         `tcdr`.`entity_type_category_new`,         `tcdr`.`entity_type_category_original`,         `tcdr`.`equity_floor_applied`,         `tcdr`.`equity_preferential_treatment`,         `tcdr`.`equity_scaling_factor`,         `txn`.`exchange_rate`,         `tcdr`.`exemption_maturity_floor`,         ( nvl(             CASE                 WHEN `tcdr`.`table_name` IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT'                 ) THEN(                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN(                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE(                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END,0) + nvl(             CASE                 WHEN `tcdr`.`table_name` NOT IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT','FACILITY'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END,0) ) `exposure`,         `tcdr`.`exposure_attribute_1`,         `tcdr`.`exposure_attribute_2`,         `tcdr`.`exposure_attribute_3`,         `tcdr`.`exposure_attribute_4`,         `tcdr`.`exposure_attribute_5`,         `tcdr`.`exposure_attribute_6`,         `tcdr`.`exposure_attribute_7`,         CASE                 WHEN CAST(`tcdr`.`exposure_attribute_7` AS double) IS NOT NULL THEN 'Y'                 ELSE 'N'             END         `exposure_attribute_7d`,         `tcdr`.`exposure_attribute_8`,         `tcdr`.`exposure_attribute_9`,         CASE                 WHEN (                     `tcdr`.`table_name` = 'ON_OFF_BALANCE'                     OR `tcdr`.`table_name` = 'REPO'                     OR `tcdr`.`table_name` = 'RECEIVABLE'                     OR `tcdr`.`table_name` = 'TRANCHE'                     OR `tcdr`.`table_name` = 'BOND'                     OR `tcdr`.`table_name` = 'EQUITY'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END         `exposure_wo_mtm`,         `reposr`.`external_rating`,         `txn`.`customer_subsegment_desc` `F_BUSINESS_SUB_SEGMENT_NAME`,         nvl(`coltp`.`collateral_description`, 'Collateral Type Unmapped') `f_collatral_type_name`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `F_ORIGINAL_SCORECARD_NAME`,         `txn`.`contract_desc` `F_STANDARD_PROD_NAME`,         'MFU needed - ELIMIT' `facility_activated_flag`,         `facagg`.`facility_availability_end_date` `facility_availability_end_date`,         `tcdr`.`facility_reference` `FACILITY_REF_NO`,         `tcdr`.`used_amount_facility` `FACILITY_UTILIZATION_AMOUNT`,         `tcdr`.`fair_value`,         'PMI source needed' `fam_cd`,         `tcdr`.`family`,         `tcdr`.`fde_alternative_method`,         NVL(`txn`.`filter_type`,'NA') `filter_type`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_cd`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_name`,         `tcdr`.`internal_rating_new` `final_crg`,         nvl(`tcdr`.`pd_new`,0) `final_pd`,         `tcdr`.`flag_adjustment`,         `tcdr`.`floor1`,         `tcdr`.`floor2`,         `txn`.`fsa_exclusion_type`,         `txn`.`fsa004_asset_class`,         nvl(round(`tcdr`.`collateral_assigned_amount`,10),0) * ( 1 - nvl(round(`tcdr`.`hc`,10),0) ) `fsv`,         `tcdr`.`funding_ccy`,         `tcdr`.`gaap_code` `GAAP_CD`,         'CDW needed - RSK_BOE_LMT_PRO' `governing_law`,         `tcdr`.`grand_fathering_applied`,         `tcdr`.`guar_sub_reference` `GUARANTEE_SUB_REF_NO`,         `tcdr`.`guarantee_bis_product`,         CASE WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED' THEN 'Guarantee'   WHEN `tcdr`.`collateral_contract_type` = 'NET_AGR' THEN 'Netting'   WHEN NVL (round(`tcdr`.`ead`,10), 0) * `prrsr`.`prr` > 0 THEN 'Product Recovery'    ELSE 'UNMP' END `guarantee_ead_flag`,         `tcdr`.`guarantee_method`,         `tcdr`.`guarantee_reference` `GUARANTEE_REF_NO`,         `tcdr`.`guarantor`,         `tcdr`.`guarantor_bis_entity_type`,         CASE                 WHEN `tcdr`.`tranche_guarantee_type` = 'GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `gurantee_ead`,         `tcdr`.`hc`,         `tcdr`.`hcr`,         `tcdr`.`he`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND `tcdr`.`bs_type` = 'OFB' THEN `tcdr`.`outstanding`                 ELSE 0             END         `headroom`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`ead`                 ELSE 0             END         `headroom_ead`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`rwa`                 ELSE 0             END         `headroom_rwa`,         `tcdr`.`hfx`,         `txn`.`holding_company_ind`,         `tcdr`.`hr`,         `tcdr`.`id`,         'MFU needed - mfu_ifrs_category.txt' `ifrs_category`,         CASE                 WHEN `fac`.`commited` = 'N'                      AND `tcdr`.`table_name` = 'FACILITY' THEN nvl(`tcdr`.`nominal`,0)                 ELSE 0             END         `iip`,         `csr`.`imc_1`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_alpha_factor`,         'RMI TABLE NEEDED - rsk_scb_wb_imm_collat, NVL(SUM(amount),0)' `imm_collat_amount`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_eepe`,         `tcdr`.`import_source`,         `tcdr`.`incorporation_country` `incorp_country`,         `txn`.`incorporation_ccy_new`,         `txn`.`incorporation_ccy_original`,         `tcdr`.`inter_company`,         `tcdr`.`internal_maturity_class`,         'No' `isda_flg`,         `tcdr`.`k_function_used`,         `tcdr`.`k_maturity`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`kccp`                 ELSE NULL            END         `kccp`,         CASE                 WHEN `ccp`.`kccp` IS NOT NULL                      AND `ccp`.`kccp` != 0 THEN 'Y'                 ELSE 'N'             END         `kccp_calc`,         `tcdr`.`legislated_program_applied`,         `tcdr`.`lgd` `LGD`,        `txn`.`lgd` `lgd_dollar`,         `tcdr`.`lgd_grade`,         `tcdr`.`lgd_grade_agency`,         `tcdr`.`lgd_grade_inf`,         `tcdr`.`lgd_grade_rank`,         `tcdr`.`lgd_grade_sup`,         `tcdr`.`lgd_mitigation`,         `tcdr`.`lgd_pre_floor_new`,         `tcdr`.`lgd_pre_floor_original`,         CASE                 WHEN (                     (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0 )                     AND (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.05 )                 ) THEN '0% - 04.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.05                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.1                 ) THEN '05% - 09.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.1                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.15                 ) THEN '10% - 14.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.15                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.2                 ) THEN '15% - 19.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.2                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.25                 ) THEN '20% - 24.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.25                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.3                 ) THEN '25% - 29.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.3                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.35                 ) THEN '30% - 34.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.35                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.4                 ) THEN '35% - 39.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.4                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.45                 ) THEN '40% - 44.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.45                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.5                 ) THEN '45% - 49.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.5                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.55                 ) THEN '50% - 54.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.55                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.6                 ) THEN '55% - 59.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.6                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.65                 ) THEN '60% - 64.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.65                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.7                 ) THEN '65% - 69.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.70                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.75                 ) THEN '70% - 74.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.75                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.80                 ) THEN '75% - 79.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.80                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.85                 ) THEN '80% - 84.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.85                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.90                 ) THEN '85% - 89.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.90                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.95                 ) THEN '90% - 94.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.95                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     <= 1                 ) THEN '95% - 100%'                 WHEN (                     CASE                         WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                         ELSE `txn`.`lgd`                     END                 > 1 ) THEN '>100%'             END         `lgd_range`,         `tcdr`.`lgd` `lgd_tcdr`,         `txn`.`limit_attribute`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`contract_reference`                 ELSE NULL             END         `limit_id`,         CASE                 WHEN `tcdr`.`facility_reference` IS NOT NULL AND `tcdr`.`facility_reference` != ''  THEN 'Linked'                 ELSE 'Unlinked'             END         `linked_unlinked_ind`,         null `lmt_eff_dt`,         `tcdr`.`long_short`,         `tcdr`.`look_through_treatment`,         `crsr`.`lt_rat_agency_code` `lt_rat_agency_cd`,         NVL(`tcdr`.`ltv`,0) `LTV`,         `tcdr`.`ltv_current`,         CASE                 WHEN `prod`.`product_level` = 'Standard Product'                      AND `prod`.`description` LIKE 'Private Equity%' THEN concat('078||',substr(`tcdr`.`dealbook`,length(`tcdr`.`dealbook`) - 7,length(`tcdr`.`dealbook`) ) )                 ELSE `tcdr`.`dealbook`             END         `management_location_cd`,         `txn`.`management_product` `management_prod_wid`,         `txn`.`management_product` `management_prod_id`,         `tcdr`.`margin_period`,         `tcdr`.`maturity_date`,         `tcdr`.`maturity_eff`,         'N' `maturity_limit_flag`,         `txn`.`maturity_range` `maturity_range`,         `tcdr`.`method_new`,         `tcdr`.`method_original`,         `cva`.`mi`,         `cva`.`mi_hedge`,         `tcdr`.`mm`,         `tcdr`.`mortgage_alternative`,         `txn`.`business_identifier` `MRU_IDENTIFIER`,  `txn`.`business_identifier` `BUSINESS_IDENTIFIER`,         `txn`.`mtm`,         `inst`.`custom_attribute_18` `nbv_currency`,         `inst`.`custom_attribute_17` `nbv_value`,         CASE                 WHEN trim(`ent`.`attribute_3`) = 'T' THEN 'TRUE'                 WHEN trim(`ent`.`attribute_3`) = 'F' THEN 'FALSE'                 ELSE `ent`.`attribute_3`         END         `negative_pledge_identifier`,          CASE                 WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)    WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm` ELSE 0         END         `net_mtm`,          ( (CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY')                             THEN NVL(round(`txn`.`outstanding`,10), 0)ELSE 0                        END) + nvl(round(`txn`.`accrued_interest`,10),0) +   ( CASE WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)   WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm`  ELSE 0 END) )   `net_nominal`,          nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         `netted_ead`,         ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) * ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) `netted_ead_square`,         '0' `netted_nominal`,         `tcdr`.`netting_agreement_reference` `NETTING_AGREEMENT_REF_NO`,         `tcdr`.`netting_class`,         `juris`.`isda` `netting_flg`,         `clrh`.`no_clear_mem_n`,    ((CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY') THEN NVL(round(`tcdr`.`outstanding`,10), 0)                    ELSE 0                    END                   ) +                   NVL(round(`txn`.`accrued_interest`,10), 0) +                   (CASE WHEN `tcdr`.`table_name` IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT') THEN                        (CASE  WHEN UPPER(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN                              (CASE WHEN round(`tcdr`.`fair_value`,10) > 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                              )                         ELSE (CASE WHEN round(`tcdr`.`fair_value`,10) < 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                               )                         END                         )                     ELSE 0                     END                    )                  ) `nominal`,            `tcdr`.`nominal` `nominal_tcdr`,         `txn`.`non_borrowing_ind` `NON_BORROWING`,         substr(trim(`ent`.`attribute_17`), 1, 1) `non_contractual_parental_supt`,         substr(trim(`ent`.`attribute_17`), 3, 1) `non_financial_scorecard`,         `txn`.`non_gam_ind`,         `tcdr`.`non_material_equity`,         `txn`.`notional`,         `deal`.`nominal_2` `NOTIONAL_2`,         `deal`.`currency_2` `NOTIONAL_2CCY`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`tcdr`.`nominal`) *-1                         ELSE abs(`tcdr`.`nominal`)                     END                 )                 ELSE 0             END         `notional_tcdr`,         'CDW needed - cdw_txn_rmi_ddmmyyyy.txt' `obl_flg`,         `tcdr`.`obligor_grade_inf_new`,         `tcdr`.`obligor_grade_inf_original`,         `tcdr`.`obligor_grade_new`,         `tcdr`.`obligor_grade_original`,         `tcdr`.`obligor_grade_rank_new`,         `tcdr`.`obligor_grade_rank_original`,         `tcdr`.`obligor_grade_sup_new`,         `tcdr`.`obligor_grade_sup_original`,         CASE                 WHEN `inst`.`cost_center` IN (                     'FM ALM',                     'Principal Finance'                 ) THEN 'OCC_Own Account'                 ELSE nvl(`txn`.`customer_subsegment_code`,'UNMP')             END         `occ_sub_segment`,         `txn`.`bs_type` `ON_OFF_BALANCE_SHEET_FLAG`,         nvl(`tcdr`.`pd_original`,0) `org_pd`,         `tcdr`.`original_cost`,         nvl(`tcdr`.`internal_rating_original`,'CRG Original Unmapped') `original_crg`,          `txnf`.`original_limit_amount` `original_limit_amount`,          `tcdr`.`original_maturity`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `original_scorecard`,         `txn`.`outstanding` `os`,         `facprod`.`contract_type` `out_limit_product`,   CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY') THEN NVL(`tcdr`.`outstanding`, 0) ELSE 0 END `outstanding`,          `txn`.`outstanding` `outstanding_dollar`,         'MFU needed - cdw_BOEACBTXN_rmi_DDMMYYYY.txt' `overdue_days`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_1`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_2`,         `tcdr`.`parent_id`,         `tcdr`.`past_due_int`,         `tcdr`.`past_due_ppal`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`pce_flag`                 ELSE NULL             END         `pce_flag`,         `rat`.`one_year_pd` `pd_midpoint`,         `tcdr`.`pd_new`,         `tcdr`.`pd_original`,         `tcdr`.`pd_pre_floor_new`,         `tcdr`.`pd_pre_floor_original`,         `tcdr`.`performing_status`,         `tcdr`.`pool_code` `POOL_CD`,         `tcdr`.`premium_current`,         `contp`.`attribute_1` `prod_cat_info`,         `tcdr`.`product_gl_criteria`,         `tcdr`.`product_gl_criteria_2`,         NVL(`tcdrp`.`tot_el`,0) `PROXY_EL`,         NVL(`tcdrp`.`lgd_used`,0) `PROXY_LGD`,         NVL(`txn`.`prr`,0) `PRR`,    nvl(`inst`.`psgl_account_number`, `psgl`.`psgl_account`) `PSGL_ACCOUNT`,           nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_CD`,  nvl(nvl(`inst`.`psgl_customer_class`, `psgl`.`psgl_cust_class`), `txn`.`psgl_cust_class`) `PSGL_CUST_CLASS`,  nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_DEPARTMENT`,  nvl(nvl(`inst`.`psgl_operating_unit`, `psgl`.`psgl_operating_unit`), `txn`.`psgl_operating_unit`) `PSGL_OPERATING_UNIT`,  nvl(nvl(`inst`.`psgl_product_code`, `psgl`.`psgl_product`), `txn`.`psgl_product`) `PSGL_PRODUCT`,          `tcdr`.`qualifying_ccp`,         `tcdr`.`qualifying_transaction`,         `crsr`.`lt_rat_code` `RATING_CD`,         `txn`.`replacement_cost` `RC`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN (                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE (                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END         `rc_tcdr`,         `txn`.`replacement_cost` `REPLACEMENT_COST`,         `tcdr`.`residual_maturity`,         `tcdr`.`rgc`,         `tcdr`.`risk_bucket`,         `tcdr`.`risk_bucket_original`,         `tcdr`.`risk_country`,         `tcdr`.`risk_country_new`,         `tcdr`.`risk_country_original`,         `tcdr`.`risk_type`,         `crm`.`rw_expo` `rw_expo`,         `tcdr`.`rw_new`,         `tcdr`.`rw_original`,         `tcdr`.`rw_scaling_factor`,         `tcdr`.`rwa`,         NVL(`trfrsk`.`rwa_add_on`,0) `rwa_add_on`,         `tcdr`.`rwa` `rwa_after_scale`,         nvl(round(`tcdr`.`rwa`,10),0) / 1.06 `rwa_before_scale`,         `trfrsk`.`rwa_cpty` `rwa_cpty`,         `tcdr`.`rwa` `RWA_NET_SAVES`,         `tcdr`.`rwa_pre_cap`,         `tcdr`.`rwa_pre_crm`,         `tcdr`.`rwa_pre_floor_equity`,         'MFU needed - Pool_Ref_MONYY.txt' `rwa_saves`,         `tcdr`.`rwa_scaling_factor`,         `trfrsk`.`rwa_total` `rwa_total`,         `ccp`.`is_scb_clr_mem` `scb_clearing_mem`,         `tcdr`.`second_loss_treatment`,         `tcdr`.`secu_bank_role`,         `tcdr`.`secu_company_weight`,         `tcdr`.`secu_ea_controlled`,         `tcdr`.`secu_issue_date`,         `tcdr`.`secu_loss_position`,         `tcdr`.`secu_mode`,         `tcdr`.`secu_retail_line_fg`,         `tcdr`.`secu_spread_trapping_ratio`,         `tcdr`.`secu_uncommited_retail_fg`,         `txn`.`lgd` `SECURED_LGD`,         `tcdr`.`securitization_n`,         `tcdr`.`securitization_reference` `SECURITIZATION_REF_NO`,         `tcdr`.`securitized`,         `tcdr`.`security_positions_ref`,         `txn`.`segment_original`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code`                              AND `clrm`.`entity_code` = `clrm`.`clearing_house_code` THEN `clrm`.`clearing_member_conditions`                         ELSE NULL                     END                 ELSE NULL             END         `segregated`,         `tcdr`.`seniority_new`,         `tcdr`.`seniority_original`,         `tcdr`.`settlement_price`,         `reposr`.`sov_indicator` `sov_indicator`,         `tcdr`.`sovereign_risk_bucket_new`,         `tcdr`.`sovereign_risk_bucket_ori`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_wid`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_cd`,         `tcdr`.`standard_rw_new`,         `tcdr`.`standard_rw_original`,         `txn`.`start_date`,         null `std_rw_override_indicator`,         `inst`.`custom_attribute_16` `strategy`,         `tcdr`.`stress_testing_scenario_id`,         `txn`.`sub_limit_fac_reference` `sub_limit_fac_ref_no`,         `tcdr`.`sub_method_new`,         `tcdr`.`sub_method_original`,         `tcdr`.`sub_reference`,         `tcdr`.`supervisor_code` `SUPERVISOR_CD`,         CASE WHEN `enl`.`link_type` = 'SUPFIN' then `enl`.`mother_code` else 'UNMP SUPFIN' end `supfin_cd`,         `tcdr`.`table_name` `table_name`,         'SMC_PERIMETER required' `tbs_cd`,         `txn`.`maturity_range` `TENOR_BUCKETS`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`third_party_cp_flag`                 ELSE '0'             END         `third_party_cp_flag`,         `tcdr`.`tier1_deduction`,         `tcdr`.`tier2_deduction`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`tot_pre_fund_con`                 ELSE NULL             END         `tot_pre_fund_con`,         `tcdr`.`total_annual_assets`,         `tcdr`.`total_annual_sales`,         `fac`.`amount` `total_facility_amount`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`total_initital_margin`                 ELSE NULL             END         `total_initital_margin`,         `inst`.`tp_portfolio_name` `tp_portfolio_name`,         'MFU needed - e_balances.txt' `tp_sys_scr_id`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / round(`t_cdr_temp`.`rwa`,10) ) )                 ELSE 0             END         `tr_addon_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN ( nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0) )                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / `t_cdr_temp`.`rwa` ) )                 ELSE 0             END         `tr_addon_rwa`,         nvl(`trfrsk`.`tr_el`,0) `tr_el`,         NVL(`trfrsk`.`tr_gua_ctry`, 'UNMP') `tr_gua_ctry`,         CASE                 WHEN `t_cdr_temp`.`el` != 0          THEN nvl(round(`t_cdr_temp`.`el`,10),0) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) )                 ELSE 0             END         `tr_pre_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN nvl(round(`t_cdr_temp`.`rwa`,10),0) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) ) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) )                 ELSE 0             END         `tr_pre_rwa`,         `tcdr`.`trade_date`,         `tcdr`.`trading_book_type`,         `tcdr`.`trading_book_type` `TRADING_IND`,         `tcdr`.`tranche_collateral_type`,         `tcdr`.`tranche_guarantee_type`,         `txn`.`tranche_lgd`,         NVL(`trfrsk`.`transfer_risk`,'N') `transfer_risk`,         `txn`.`limit_amount` `txn_limit_amount`,         `txn`.`rw_new` `txn_rw_new`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`uci`                 ELSE NULL             END         `uci`,         `tcdr`.`uncommited` `uncommited`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdragg`.`committed_amount`             END         `uncommitted_amount`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdragg`.`committed_available_amunt`             END         `uncommitted_available_amunt`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 )                      AND `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_headroom`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE'                 )                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_os`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdragg`.`committed_available_amunt`             END         `uncommitted_used_amount`,         `tcdr`.`unconditionnaly_cancelable`,         `tcdr`.`und_pool_ref`,         `txn`.`unmapped_ind`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                      AND `tcdr`.`tranche_guarantee_type` = 'NOT GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `unsecured_ead`,         `tcdr`.`used_amount_facility`,         `tcdr`.`value_date`,         `txn`.`waterfall_seniority`,         `cva`.`wi` `wi`,         case when `rat`.`row_owner` = 'C' AND `rat`.`agency_code` = 'INTERNAL' AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) >= nvl(round(`rat`.`pd_inf`,10),0)   AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) < nvl(round(`rat`.`pd_sup`,10),0)   THEN `rat`.`rating` ELSE `icr`.`long_term_rating` END `wt_crg`,         nvl(round(`tcdr`.`pd_new`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_final_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`k_maturity`,10) ) `wt_k_maturity`,         `txn`.`wt_lgd`,         (nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`k_maturity`,10),0)) `wt_mat_eff`,         nvl(round(`tcdr`.`pd_original`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_org_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_new`,10) ) `wt_pd_new`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_original`,10) ) `wt_pd_original`,         nvl(`txn`.`wt_residual_maturity`,0) `wt_residual_maturity`,         ( round(`tcdr`.`pd_new`,10) * round(`tcdr`.`nominal`,10) ) `wtpdlgd`,         ( round(`tcdr`.`pd_new`,10) * round(`txn`.`wt_lgd`,10) ) `wtpdnm`,         `tcdrp`.`xrc`,         `tcdr`.`zero_haircut_for_repo`,         `tcdr`.`zero_rw_for_equity`,         `tcdr`.`zone_a_new`,         `tcdr`.`zone_a_original`,  `tcdr`.`collateral_assigned_amount` `COLLATERAL_ASSIGNED_AMOUNT`,  '0' `collateral_unique_id`,  `smeprod`.`product_type` `sme_product_type`,   CASE WHEN SUBSTR((case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END ), -2) = '-M'                   THEN                   substr( (case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END)         , 1         ,  length(trim(case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END ))-2                   )                     ELSE                  case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END          END `DERIVED_LIMIT_ID`,   CASE WHEN `tcdr`.`method_new` = 'ADV' THEN round(NVL(`tcdr`.`ead`, 0),5) *          (CASE WHEN ( (`tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') <> 'RW_LGD_UPDATE'                         ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`txn`.`lgd`,0),5)                 WHEN ( (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') = 'RW_LGD_UPDATE'                          ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`tcdr`.`exposure_attribute_7`,0),5)                 ELSE 0 END         ) ELSE 0 END `unsecured_lgd_dollar`,    case when `be`.`booking_loc_id` = 'SG'  then 'SG' else 'OTHERS' end as `SECURITY_CTRY`,   case when `tcdr`.`dealbook` like '%CI%' OR `tcdr`.`dealbook` like '%CC%' then 'CICC'   when `tcdr`.`dealbook` like '%RT%' then 'RT'   when `tcdr`.`dealbook` like '%PB%' then 'PB'   when `tcdr`.`dealbook` like '%OB%' then 'OB'   else 'OTHERS' end AS `SECURITY_SEG`                          FROM         `sgmisitstg`.`stg_bcrs_t_cdr` `tcdr`           LEFT JOIN `sgmisit`.`sgmi_txn_rwa_f` `txn` ON `tcdr`.`id` = `txn`.`id`                                                             AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`txn`.`partition_key`,'UNM')            AND `txn`.`w_datasource_id` = 'BCRS_PRA'            AND `txn`.`w_snapshot_dt` = '2018-04-30'            AND `txn`.`w_country_cd` = 'ALL'            AND `txn`.`w_workspace` = 'WS9'    LEFT JOIN (select `sgmi_txn_rwa_f`.`netting_agreement_reference`, sum(`sgmi_txn_rwa_f`.`mtm`) `sum_mtm`, `sgmi_txn_rwa_f`.`partition_key`    from `sgmisit`.`sgmi_txn_rwa_f`    where    `sgmi_txn_rwa_f`.`w_snapshot_dt` = '2018-04-30' and   `sgmi_txn_rwa_f`.`w_workspace` in (case when instr('WS9','ADJ')>0 then substr('WS9',1,instr('WS9','_ADJ') - 1) else concat('WS9','_ADJ') end)   group by `sgmi_txn_rwa_f`.`netting_agreement_reference`, `sgmi_txn_rwa_f`.`partition_key` ) `txn2`   ON `txn`.`netting_agreement_reference` = `txn2`.`netting_agreement_reference`                                                               AND nvl(`txn`.`partition_key`,'UNM') = nvl(`txn2`.`partition_key`,'UNM')                  LEFT JOIN `sgmisitstg`.`stg_bcrs_facility` `fac` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`fac`.`contract_reference`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`fac`.`partition_key`,1,8)                                                       AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`fac`.`contract_type`,'UNM')             AND `fac`.`w_batch_id` = '2018071113463400417'          LEFT JOIN (select `stg_bcrs_scb_wb_addt_inst`.`partition_key`, `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`, `stg_bcrs_scb_wb_addt_inst`.`arm_code`, `stg_bcrs_scb_wb_addt_inst`.`arm_description`, `stg_bcrs_scb_wb_addt_inst`.`cost_center`, `stg_bcrs_scb_wb_addt_inst`.`cost_center_descriotion`,    `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_18`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_17`, `stg_bcrs_scb_wb_addt_inst`.`psgl_account_number`, `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`, `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`, `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_16`, `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`, `stg_bcrs_scb_wb_addt_inst`.`w_batch_id`,    ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ) AS `rnk`      FROM `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2018071113463400417' AND  NVL(`stg_bcrs_scb_wb_addt_inst`.`arm_code`,'') <> ''     ) `inst` ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`inst`.`contract_reference`),'UNM')                                                       AND trim(`tcdr`.`table_name`) = trim(`inst`.`table_name`)                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`inst`.`partition_key`,1,8)             AND `inst`.`rnk`=1   LEFT JOIN ( select `stg_bcrs_scb_wb_psgl`.`partition_key`, `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name`, `stg_bcrs_scb_wb_psgl`.`psgl_bu`, `stg_bcrs_scb_wb_psgl`.`psgl_account`, `stg_bcrs_scb_wb_psgl`.`psgl_product`, `stg_bcrs_scb_wb_psgl`.`psgl_department`, `stg_bcrs_scb_wb_psgl`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_psgl`.`psgl_cust_class`, `stg_bcrs_scb_wb_psgl`.`financial_book_code`, `stg_bcrs_scb_wb_psgl`.`booking_location`, `stg_bcrs_scb_wb_psgl`.`w_batch_id`, ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name` ) AS `rnk`       FROM `sgmisitstg`.`stg_bcrs_scb_wb_psgl`   WHERE `stg_bcrs_scb_wb_psgl`.`w_batch_id` = '2018071113463400417'     AND  NVL(`stg_bcrs_scb_wb_psgl`.`psgl_bu`,'') <> '') `psgl`   ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`psgl`.`contract_reference`),'UNM')    AND trim(`tcdr`.`table_name`) = trim(`psgl`.`fermat_table_name`)   AND substr(`tcdr`.`partition_key`,1,8) = substr(`psgl`.`partition_key`,1,8)               AND `psgl`.`rnk`=1                        LEFT JOIN ( select `stg_bcrs_t_crm`.`partition_key`, `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`,`stg_bcrs_t_crm`.`expo_table_name`,`stg_bcrs_t_crm`.`w_batch_id`,`stg_bcrs_t_crm`.`rw_expo`,`stg_bcrs_t_crm`.`attribute_6`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ORDER BY `stg_bcrs_t_crm`.`expo_contract_reference`,    `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ) AS `rnk`    FROM `sgmisitstg`.`stg_bcrs_t_crm`   WHERE CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_t_crm`.`w_batch_id` = '2018071113463400417' ELSE `stg_bcrs_t_crm`.`w_batch_id` = '2018071116300200148' END           ) `crm` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`crm`.`expo_contract_reference`,'UNM')          AND nvl(`tcdr`.`counterparty_original`, 'UMP') = nvl(`crm`.`expo_counterparty`, 'UMP')                                                    AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`crm`.`partition_key`,'UNM')          AND `crm`.`expo_table_name` = 'ON_OFF_BALANCE'          AND `crm`.`rw_expo` is not null          AND `crm`.`rnk` = 1            LEFT JOIN (             SELECT   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                                `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`avg_pre_funded_contribution`) `avg_pre_funded_contribution`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`beta`) `beta`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`clearing_house_name`) `ccp_name`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`pre_funded_financial`) `dfccp`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_prefunded_contribution`) `dfi`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`kccp`) `kccp`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`sum_pre_fund_contribution`) `tot_pre_fund_con`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`total_initial_margin`) `total_initital_margin`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_committed_contributions`) `uci`             FROM                 `sgmisitstg`.`stg_bcrs_scb_wb_ccp_static`   WHERE `stg_bcrs_scb_wb_ccp_static`.`w_batch_id` = '2018071113463400417'       AND `stg_bcrs_scb_wb_ccp_static`.`beta` is not null AND `stg_bcrs_scb_wb_ccp_static`.`beta` != ''             GROUP BY   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                 `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`         ) `ccp` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`ccp`.`clearing_house_code`,'UNM')                  AND substr(`tcdr`.`partition_key`,1,8) = substr(`ccp`.`partition_key`,1,8)          LEFT JOIN (             SELECT   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`,                 SUM(`stg_bcrs_t_cva`.`bi`) `bi`,                 SUM(`stg_bcrs_t_cva`.`cva_index_part`) `cva_index_part`,                 SUM(`stg_bcrs_t_cva`.`cva_capital_charge`) `cva_rwa_addon`,                 MAX(`stg_bcrs_t_cva`.`mi`) `mi`,                 SUM(`stg_bcrs_t_cva`.`mi_hedge`) `mi_hedge`,                 MAX(`stg_bcrs_t_cva`.`wi`) `wi`             FROM                 `sgmisitstg`.`stg_bcrs_t_cva`   WHERE `stg_bcrs_t_cva`.`w_batch_id` = '2018071116300200148'             GROUP BY   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`         ) `cva` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`cva`.`contract_reference`,'UNM')                  AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`cva`.`partition_key`,'UNM')                  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`cva`.`counterparty`,'UNM')          LEFT JOIN `sgmisit`.`sgmi_client_d` `client` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`client`.`client_id`,'UNM')    AND `client`.`w_datasource_id` = 'BCRS_PRA' AND `client`.`w_snapshot_dt` = '2018-04-30'    LEFT JOIN `sgmisit`.`obi_pd_lookup` `obi` ON substr(`tcdr`.`partition_key`,1,6) = nvl(`obi`.`partition_key`,'UNM')          LEFT JOIN `sgmisitstg`.`stg_bcrs_v_scb_gpr_ec_t_cdr_prx` `tcdrp` ON nvl(`tcdr`.`id`,'UNM') = nvl(`tcdrp`.`id`,'UNM')                                                                       AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`tcdrp`.`partition_key`,'UNM')               AND `tcdrp`.`w_batch_id` = '2018071113463400417'         LEFT JOIN (             SELECT   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`,                 MAX(`stg_bcrs_bis_clearing_house`.`df_cm`) `df_cm`,                 MAX(`stg_bcrs_bis_clearing_house`.`n`) `no_clear_mem_n`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_house`   WHERE CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2018071113463400417' ELSE `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2018071116300200148' END             GROUP BY   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`         ) `clrh` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`clrh`.`entity_code`,'UNM')                   AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrh`.`partition_key`,'UNM')          LEFT JOIN   (select `stg_bcrs_entity_links`.`partition_key`, `stg_bcrs_entity_links`.`child_code`, `stg_bcrs_entity_links`.`link_type`, `stg_bcrs_entity_links`.`mother_code`, `stg_bcrs_entity_links`.`w_batch_id`, ROW_NUMBER() OVER(ORDER BY `stg_bcrs_entity_links`.`mother_code` desc) AS `rnk`  FROM `sgmisitstg`.`stg_bcrs_entity_links` where `stg_bcrs_entity_links`.`w_batch_id` = '2018071113463400417' and `stg_bcrs_entity_links`.`link_type` = 'DLRFIN' ) `enl`   ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`enl`.`child_code`,'UNM')         AND substr(`tcdr`.`partition_key`,1,8) = substr(`enl`.`partition_key`,1,8)         AND `enl`.`rnk`=1           LEFT JOIN (select `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`, `stg_bcrs_csr`.`table_name`, `stg_bcrs_csr`.`imc_1`, `stg_bcrs_csr`.`w_batch_id`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ORDER BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ) AS `rnk`   from `sgmisitstg`.`stg_bcrs_csr`   where CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_csr`.`w_batch_id` = '2018071113463400417' ELSE `stg_bcrs_csr`.`w_batch_id` = '2018071116300200148' END ) `csr`     ON `tcdr`.`contract_reference` = `csr`.`contract_reference`    AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`csr`.`contract_type`,'UNM')    AND nvl(`tcdr`.`counterparty_new`,'UNM') = nvl(`csr`.`counterparty`,'UNM')    AND nvl(`tcdr`.`method_new`,'UNM') = nvl(`csr`.`method`,'UNM')    AND `tcdr`.`bs_type` = `csr`.`bs_type`    AND `tcdr`.`dealbook` = `csr`.`book_code`    AND (case when nvl(`tcdr`.`table_name`,'z') in ('BOND', 'EQUITY', 'TRANCHE', 'CONVERTIBLE', 'FUND') then 'SECURITY_POSITIONS'             else nvl(`tcdr`.`table_name`, 'z') end) = `csr`.`table_name`    AND `csr`.`imc_1` is not null    AND trim(`csr`.`imc_1`) != ''    AND `csr`.`rnk` = 1    LEFT JOIN ( select `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_cpty`),0) `EL_CPTY`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_total`),0) `EL_TOTAL`,      NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`),0) `rwa_add_on`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`),0) `rwa_cpty`,      NVL(NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_total`),SUM(NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`,0) +  NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`,0))),0) `RWA_TOTAL`,      NVL(sum(`stg_bcrs_scb_wb_tr_sr`.`tr_el`),0) `tr_el`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry` `TR_GUA_CTRY`, MAX(NVL(`stg_bcrs_scb_wb_tr_sr`.`is_tr`,'N')) `TRANSFER_RISK`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`   from `sgmisitstg`.`stg_bcrs_scb_wb_tr_sr`    where `stg_bcrs_scb_wb_tr_sr`.`w_batch_id` = '2018071113463400417'    group by `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`  ) `trfrsk`  ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`trfrsk`.`contract_reference`,'UNM')  AND nvl(`tcdr`.`table_name`,'UNM') = nvl(`trfrsk`.`table_name`,'UNM')  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`trfrsk`.`pr_obligor`,'UNM')  AND `tcdr`.`contract_type` = `trfrsk`.`contract_type`  and `tcdr`.`bs_type` = `trfrsk`.`bs_type`    LEFT JOIN (             SELECT    `stg_bcrs_scb_wb_prr_sr`.`w_batch_id`,                 `stg_bcrs_scb_wb_prr_sr`.`partition_key`,                 `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,   case when (max(`stg_bcrs_scb_wb_prr_sr`.`prr`) - min(`stg_bcrs_scb_wb_prr_sr`.`prr`)) <> 0 Then 0 else max(`stg_bcrs_scb_wb_prr_sr`.`prr`) end `prr`             FROM                 `sgmisitstg`.`stg_bcrs_scb_wb_prr_sr`   WHERE CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2018071113463400417' ELSE `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2018071116300200148' END       AND  NVL(`stg_bcrs_scb_wb_prr_sr`.`prr`,'') <> ''        GROUP BY           `stg_bcrs_scb_wb_prr_sr`.`w_batch_id`,                 `stg_bcrs_scb_wb_prr_sr`.`partition_key`,                 `stg_bcrs_scb_wb_prr_sr`.`contract_reference`                 ) `prrsr` ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`prrsr`.`partition_key`,'UNM')                    AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`prrsr`.`contract_reference`,'UNM')        LEFT JOIN (select `stg_bcrs_scb_wb_repo_sr`.`partition_key`, `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`, `stg_bcrs_scb_wb_repo_sr`.`external_rating`, `stg_bcrs_scb_wb_repo_sr`.`sov_indicator`, `stg_bcrs_scb_wb_repo_sr`.`security_contract_ref`,     ROW_NUMBER() OVER(ORDER BY `stg_bcrs_scb_wb_repo_sr`.`security_contract_ref`) as `rnk`   from `sgmisitstg`.`stg_bcrs_scb_wb_repo_sr`  WHERE CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2018071113463400417' ELSE `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2018071116300200148' END ) `reposr`   ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`reposr`.`partition_key`,'UNM')  AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`reposr`.`repo_contract_ref`,'UNM')  AND `reposr`.`rnk`=1 AND `reposr`.`sov_indicator` IS NOT NULL           LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `scrd` ON nvl(`scrd`.`org_scrd_g3_code`,'UNM') = nvl(`txn`.`scorecard_original`,'UNM')           LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`,                 MIN(`stg_bcrs_facility`.`dim3`) `facility_availability_end_date`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2018071113463400417'              GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`         ) `facagg` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`facagg`.`contract_reference`,'UNM')                     AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`facagg`.`counterparty_code`,'UNM')                     AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`facagg`.`partition_key`,'UNM')                   LEFT JOIN `sgmisitstg`.`stg_bcrs_credit_rating_sr` `crsr` ON nvl(`reposr`.`security_contract_ref`,'UNM') = nvl(`crsr`.`reference`,'UNM')                                                                AND `crsr`.`lt_rat_agency_code` IS NOT NULL               AND CASE WHEN 'WS9' like '%ADJ%' THEN `crsr`.`w_batch_id` = '2018071113463400417' ELSE `crsr`.`w_batch_id` = '2018071116300200148' END          LEFT JOIN `sgmisitstg`.`stg_bcrs_product` `prod` ON nvl(`tcdr`.`contract_type`,'UNM') = nvl(`prod`.`product`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`prod`.`partition_key`,1,8)             AND `prod`.`w_batch_id` = '2018071113463400417'          LEFT JOIN `sgmisitstg`.`stg_bcrs_entity` `ent` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`ent`.`entity_code`,'UNM')                                                     AND substr(`tcdr`.`partition_key`,1,8) = substr(`ent`.`partition_key`,1,8)            AND `ent`.`w_batch_id` = '2018071113463400417'          LEFT JOIN `sgmisitstg`.`stg_bcrs_deal_import` `deal` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`deal`.`contract_reference`,'UNM')                                                           AND substr(`tcdr`.`partition_key`,1,8) = substr(`deal`.`contract_reference`,1,8)          AND `deal`.`w_batch_id` = '2018071113463400417'          LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`,                 MAX(nvl(case when trim(`stg_bcrs_facility`.`attribute_4`) = '' then null else `stg_bcrs_facility`.`attribute_4` end,`stg_bcrs_facility`.`amount`) ) `original_limit_amount`,                 MIN(`stg_bcrs_facility`.`dim2`) `pce_flag`,                 MIN(`stg_bcrs_facility`.`dim1`) `third_party_cp_flag`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2018071113463400417'                GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`         ) `txnf` ON nvl(`txn`.`sub_limit_fac_reference`,'UNM') = nvl(`txnf`.`contract_reference`,'UNM')                   AND substr(`txn`.`partition_key`,1,8) = substr(`txnf`.`partition_key`,1,8)                   AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`txn`.`contract_reference`,'UNM')     AND `tcdr`.`import_source` like '%WB%'                                       AND `tcdr`.`id` = `txn`.`id`             LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`icr`.`entity_code`,'UNM')                                                                    AND substr(`tcdr`.`partition_key`,1,8) = substr(`icr`.`partition_key`,1,8)                                                                    AND `icr`.`agency_code` = 'INTERNAL'            AND `icr`.`w_batch_id` = '2018071113463400417'          LEFT JOIN `sgmisitstg`.`stg_bcrs_rating` `rat` ON nvl(`icr`.`long_term_rating`,'UNM') = nvl(`rat`.`rating`,'UNM')                                                     AND substr(`icr`.`partition_key`,1,8) = substr(`rat`.`partition_key`,1,8)                                                     AND `rat`.`agency_code` = 'INTERNAL'           AND `rat`.`w_batch_id` = '2018071113463400417'          LEFT JOIN (             SELECT    `stg_bcrs_bis_clearing_member`.`w_batch_id`,                 `stg_bcrs_bis_clearing_member`.`partition_key`,                 `stg_bcrs_bis_clearing_member`.`entity_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_house_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_member_conditions`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_bis_clearing_member`.`entity_code`, `stg_bcrs_bis_clearing_member`.`clearing_house_code` ORDER BY `stg_bcrs_bis_clearing_member`.`entity_code`, `stg_bcrs_bis_clearing_member`.`clearing_house_code` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_member`   WHERE CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2018071113463400417' ELSE `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2018071116300200148' END          ) `clrm` ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrm`.`partition_key`,'UNM')                   AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`clrm`.`entity_code`,'UNM')     AND `clrm`.`w_batch_id` = '2018071116300200148'     AND `clrm`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_currency` `cur` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`cur`.`partition_key`,'UNM')                                                       AND nvl(`fac`.`currency`,'UNM') = nvl(`cur`.`ccy_code`,'UNM')             AND `cur`.`w_batch_id` = '2018071113463400417'          LEFT JOIN (             SELECT   `stg_bcrs_t_cdr`.`w_batch_id`,                 `stg_bcrs_t_cdr`.`partition_key`,                 `stg_bcrs_t_cdr`.`id`,                 `stg_bcrs_t_cdr`.`contract_reference`,                 `stg_bcrs_t_cdr`.`contract_type`,                 `stg_bcrs_t_cdr`.`bs_type`,                 SUM(`stg_bcrs_t_cdr`.`nominal`) `committed_amount`,                 SUM(`stg_bcrs_t_cdr`.`ead_pre_ccf`) `committed_available_amunt`,                 SUM(`stg_bcrs_t_cdr`.`outstanding`) `committed_headroom`             FROM                 `sgmisitstg`.`stg_bcrs_t_cdr`   WHERE `stg_bcrs_t_cdr`.`w_batch_id` = '2018071116300200148'              GROUP BY   `stg_bcrs_t_cdr`.`w_batch_id`,                 `stg_bcrs_t_cdr`.`partition_key`,                 `stg_bcrs_t_cdr`.`id`,                 `stg_bcrs_t_cdr`.`contract_reference`,                 `stg_bcrs_t_cdr`.`contract_type`,                 `stg_bcrs_t_cdr`.`bs_type`         ) `tcdragg` ON nvl(`tcdr`.`id`,'UNM') = nvl(`tcdragg`.`id`,'UNM')                      AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`tcdragg`.`partition_key`,'UNM')          LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `juris` ON nvl(`tcdr`.`incorporation_country`,'UNM') = nvl(`juris`.`country_cd`,'UNM')                                                                  AND `juris`.`etl_current_record_flag` = 'Y'          LEFT JOIN (             SELECT    `stg_bcrs_facility_products`.`w_batch_id`,                 `stg_bcrs_facility_products`.`partition_key`,                 `stg_bcrs_facility_products`.`facility_reference`,                 `stg_bcrs_facility_products`.`contract_type`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_facility_products`.`facility_reference` ORDER BY `stg_bcrs_facility_products`.`facility_reference` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_facility_products`   WHERE `stg_bcrs_facility_products`.`w_batch_id` = '2018071113463400417'         ) `facprod` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`facprod`.`partition_key`,'UNM')                      AND nvl(`facprod`.`facility_reference`,'UNM') = substr(`fac`.`contract_reference`,1,instr(`fac`.`contract_reference`,'-M') - 1)                      AND `fac`.`attribute_1` = 'MOTHER'        AND `facprod`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON substr(`tcdr`.`partition_key`,1,8) = substr(`contp`.`partition_key`,1,8)                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`facprod`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2018071113463400417'          LEFT JOIN (             SELECT   w_batch_id,                 partition_key,                 nvl(`t_cdr`.`contract_reference`,'UNM') `contract_reference`,                 nvl(`t_cdr`.`table_name`,'UNM') `table_name`,                 nvl(`t_cdr`.`counterparty_original`,'UNM') `counterparty_original`,                 SUM(nvl(`t_cdr`.`rwa`,0) ) `rwa`,                 SUM(nvl(`t_cdr`.`el`,0) ) `el`             FROM                 `sgmisitstg`.`stg_bcrs_t_cdr` `t_cdr`   WHERE `t_cdr`.`w_batch_id` = '2018071116300200148'             GROUP BY   `t_cdr`.`w_batch_id`,                 `t_cdr`.`partition_key`,                 nvl(`t_cdr`.`contract_reference`,'UNM'),                 nvl(`t_cdr`.`table_name`,'UNM'),                 nvl(`t_cdr`.`counterparty_original`,'UNM')         ) `t_cdr_temp` ON nvl(`tcdr`.`partition_key`,'UNM') = `t_cdr_temp`.`partition_key`                         AND nvl(`tcdr`.`contract_reference`,'UNM') = `t_cdr_temp`.`contract_reference`                         AND nvl(`tcdr`.`table_name`,'UNM') = `t_cdr_temp`.`table_name`                         AND nvl(`tcdr`.`counterparty_original`,'UNM') = `t_cdr_temp`.`counterparty_original`     left join `sgmisitstg`.`stg_bcrs_facility_links` `facl`   on (CASE WHEN (length(`tcdr`.`contract_reference`) = 10 or length(`tcdr`.`contract_reference`) = 11 or length(`tcdr`.`contract_reference`) = 12) THEN substr(`tcdr`.`contract_reference`,1,instr(`tcdr`.`contract_reference`,'-M') - 1)          ELSE `tcdr`.`contract_reference` END) = `facl`.`contract_reference`   and substr(`tcdr`.`partition_key`,1,8) = substr(`facl`.`partition_key`,1,8)   and `facl`.`table_name` = `tcdr`.`table_name`   and `facl`.`w_batch_id` = '2018071113463400417'    left join (select `sgmi_client_bca_d`.`client_le_wid`, `sgmi_client_bca_d`.`client_le_id`, `sgmi_client_bca_d`.`bca_ref_no`, `sgmi_client_bca_d`.`bca_approval_dt`, `sgmi_client_bca_d`.`bca_review_dt`, `sgmi_client_bca_d`.`w_snapshot_dt`,   ROW_NUMBER() OVER( PARTITION BY `sgmi_client_bca_d`.`client_le_id` ORDER BY `sgmi_client_bca_d`.`client_le_id` ) AS `rnk`                 from `sgmisit`.`sgmi_client_bca_d` ) `bca`                 on substr(`tcdr`.`counterparty_original`,1,8) = `bca`.`client_le_id`                 and `tcdr`.`w_snapshot_dt` = `bca`.`w_snapshot_dt`   and `bca`.`rnk` = 1   left join `sgmisit`.`sgmi_collateral_type_dat` `coltp`   on `tcdr`.`collateral_contract_type` = `coltp`.`collateral_code`   and `coltp`.`etl_current_record_flag` = 'Y'   left join `sgmisit`.`sgmi_sme_product` `smeprod`   on `tcdr`.`contract_type` = `smeprod`.`contract_type`   LEFT JOIN `sgmisit`.`SGMI_BOOK_CD_D` `BOOK`    ON `tcdr`.`dealbook`  =`book`.`book_wid` AND `tcdr`.`w_datasource_id` = `book`.`w_datasource_id` AND `tcdr`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE`    ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`    AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`   WHERE          `tcdr`.`w_batch_id` = '2018071116300200148'
CREATE VIEW `temp_src_query_1808151759280002670` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no`  ,  `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  case when `comb`.`transaction_type` = 'EXPOSURE' then nvl(`limit_cl`.`client_wid`,`comb`.`client_wid`) else `comb`.`client_wid` end `client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `cl`.`client_group_name` AS `Client_Group_Name`, `cl`.`client_group_id` AS `Client_Group_Code`, `cl`.`client_group_segment_id` AS `Client_Group_Segement`, `cl`.`client_group_domicile_loc` AS `Client_Group_Domicile_Country`, `cl`.`client_name` AS `Client_Name`, `cl`.`client_le_name` AS `Customer_Main_Profile_Name`, `cl`.`client_le_id` AS `Customer_Main_Profile_Identification_Number_LE_ID`, `cl`.`client_pri_ind_id` , `cl`.`client_segment_sub_category_id`, `cl`.`client_segment_desc`, `cl`.`client_subsegment_desc`, `obl`.`client_group_name` AS `Obligor_Client_Group_Name`, `obl`.`client_group_id` AS `Obligor_Client_Group_Code`, `obl`.`client_group_segment_id` AS `Obligor_Client_Group_Segement`, `obl`.`client_group_domicile_loc` AS `Obligor_Client_Group_Domicile_Country`, `obl`.`client_name` AS `Obligor_Name`, `obl`.`client_id`  AS `Obligor_ID`, `obl`.`client_le_name` AS `Obl_Customer_Main_Profile_Name`, `obl`.`client_le_id` AS `Obl_Customer_Main_Profile_Identification_Number_LE_ID`, `obl`.`client_pri_ind_id` as `obl_client_pri_ind_id`, `obl`.`client_segment_sub_category_id` as `obl_segment_sub_category_id`, `obl`.`client_segment_desc` as `obl_segment_desc`, `obl`.`client_subsegment_desc` as `obl_subsegment_desc`, `limit_cl`.`client_group_name` AS `Limit_Client_Group_Name`, `limit_cl`.`client_group_id` AS `Limit_Client_Group_Code`, `limit_cl`.`client_group_segment_id` AS `Limit_Client_Group_Segement`, `limit_cl`.`client_group_domicile_loc` AS `Limit_Client_Group_Domicile_Country`, `limit_cl`.`client_name` AS `Limit_Client_Name`, `limit_cl`.`client_id`  AS `Limit_Client_ID`, `limit_cl`.`client_le_name` AS `Limit_Customer_Main_Profile_Name`, `limit_cl`.`client_le_id` AS `Limit_Customer_Main_Profile_Identification_Number_LE_ID`, `limit_cl`.`client_pri_ind_id` as `limit_client_pri_ind_id`, `gua`.`client_group_name` AS `Guarantor_Client_Group_Name`, `gua`.`client_group_id` AS `Guarantor_Client_Group_Code`, `gua`.`client_group_segment_id` AS `Guarantor_Client_Group_Segement`, `gua`.`client_group_domicile_loc` AS `Guarantor_Client_Group_Domicile_Country`, `gua`.`client_name` AS `Guarantor_Name`, `gua`.`client_id`  AS `Guarantor_ID`, `gua`.`client_le_name` AS `Guarantor_Customer_Main_Profile_Name`, `gua`.`client_le_id` AS `Guarantor_Customer_Main_Profile_Identification_Number_LE_ID`, `gua`.`client_pri_ind_id` as `Guarantor_client_pri_ind_id`, `coll_owner`.`client_group_name` AS `Coll_Owner_Client_Group_Name`, `coll_owner`.`client_group_id` AS `Coll_Owner_Client_Group_Code`, `coll_owner`.`client_group_segment_id` AS `Coll_Owner_Client_Group_Segement`, `coll_owner`.`client_group_domicile_loc` AS `Coll_Owner_Client_Group_Domicile_Country`, `coll_owner`.`client_name` AS `Coll_Owner_Name`, `coll_owner`.`client_id`  AS `Coll_Owner_ID`, `coll_owner`.`client_le_name` AS `Coll_Owner_Customer_Main_Profile_Name`, `coll_owner`.`client_le_id` AS `Coll_Owner_Customer_Main_Profile_Identification_Number_LE_ID`, `coll_owner`.`client_pri_ind_id` as `Collateral_Owner_pri_ind_id`, `cl`.`client_domicile_loc_id` As `cl_client_domicile_loc_id`, `cl`.`client_group_domicile_loc` As `cl_client_group_domicile_loc`, `cl`.`coi_loc_id` As `cl_coi_loc_id`, `cl`.`client_segment_category_id` As `cl_client_segment_category_id`, `obl`.`client_domicile_loc_id` As `Obl_client_domicile_loc_id`, `obl`.`client_group_domicile_loc` As `Obl_client_group_domicile_loc`, `obl`.`coi_loc_id` As `Obl_coi_loc_id`, `obl`.`client_segment_category_id` As `Obl_client_segment_category_id`, `limit_cl`.`client_domicile_loc_id` As `limit_cl_client_domicile_loc_id`, `limit_cl`.`client_group_domicile_loc` As `limit_cl_client_group_domicile_loc`, `limit_cl`.`coi_loc_id` As `limit_cl_coi_loc_id`, `limit_cl`.`client_segment_category_id` As `limit_cl_client_segment_category_id`, `gua`.`client_domicile_loc_id` As `Gua_client_domicile_loc_id`, `gua`.`client_group_domicile_loc` As `Gua_client_group_domicile_loc`, `gua`.`coi_loc_id` As `Gua_coi_loc_id`, `gua`.`client_segment_category_id` As `Gua_client_segment_category_id`, `coll_owner`.`client_domicile_loc_id` As `coll_owner_client_domicile_loc_id`, `coll_owner`.`client_group_domicile_loc` As `coll_owner_client_group_domicile_loc`, `coll_owner`.`coi_loc_id` As `coll_owner_coi_loc_id`, `coll_owner`.`client_segment_category_id` As `coll_owner_client_segment_category_id`, `limit_cl`.`client_segment_sub_category_id` as `limit_client_segment_sub_category_id`, `limit_cl`.`client_segment_desc` as `limit_client_segment_desc`, `limit_cl`.`client_subsegment_desc` as `limit_client_subsegment_desc`, `gua`.`client_segment_sub_category_id` as `Guarantor_client_segment_sub_category_id`, `gua`.`client_segment_desc` as `Guarantor_client_segment_desc`, `gua`.`client_subsegment_desc` as `Guarantor_client_subsegment_desc`, `coll_owner`.`client_segment_sub_category_id` as `Coll_Owner_client_segment_sub_category_id`, `coll_owner`.`client_segment_desc` as `Coll_Owner_client_segment_desc`, `coll_owner`.`client_subsegment_desc` as `Coll_Owner_client_subsegment_desc`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `exp_f`.`reporting_currency`  as  `Reporting_Currency`, `exp_f`.`company_reg_no`  as `Company_Reg_No`, `exp_f`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `exp_f`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`obl_client_segment_category_id` AS `Client_Segment_Category`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`  *  1 AS `HE`, `exp_f`.`hfx`  *  1 AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`  *  1 AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`  *  1 AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`  *  1 AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`  *  1 AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`  *  1 AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`  *  1 AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`  *  1 AS `RW_NEW`, `exp_f`.`rw_original` *  1 AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor` *  1 AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor` *  1 AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`  *  1 AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n` *  1 AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new` *  1 AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original` *  1 AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * 1   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * 1   AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * 1   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel` * 1   AS `BEEL`, `exp_f`.`guarantee_bis_product` AS `BIS_PRODUCT`, `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, `exp_f`.`ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_SQUARE`, `exp_f`.`effective_matirity` * 1   AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd` * 1   AS `FINAL_PD`, `exp_f`.`hc` * 1   AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`, `exp_f`.`mru_identifier` AS `MRU`, `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd` * 1   AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new` * 1   AS `PD_NEW`, `exp_f`.`pd_original` * 1   AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`wt_pd_new` * 1   AS `Wt_LGD_Pdnew`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`, `exp_f`.`exposure_wo_mtm`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Mark_To_Market_MTM`, `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * 1   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * 1   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * 1   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd` * 1   AS `LGD`, `exp_f`.`wt_lgd` * 1   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * 1   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * 1   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Expected_Loss`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity` * 1   AS `Residual_Maturity`, `exp_f`.`k_maturity` * 1   AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  `exp_f`.`l7_mgt_prod_code` AS `L7_Mgt_Prod_Code`, `exp_f`.`l7_mgt_prod_desc` AS `L7_Mgt_Prod_Desc`, `exp_f`.`l6_mgt_prod_subfamily_code` AS `L6_Mgt_Prod_Subfamily_Code`, `exp_f`.`l6_mgt_prod_subfamily_desc` AS `L6_Mgt_Prod_Subfamily_Desc`, `exp_f`.`l5_mgt_prod_family_code` AS `L5_Mgt_Prod_Family_Code`, `exp_f`.`l5_mgt_prod_family_desc` AS `L5_Mgt_Prod_Family_Desc`, `exp_f`.`l4_mgt_prod_subseg_code` AS `L4_Mgt_Prod_SubSeg_Code`, `exp_f`.`l4_mgt_prod_subseg_desc` AS `L4_Mgt_Prod_SubSeg_Desc`, `exp_f`.`l3_mgt_prod_seg_code` AS `L3_Mgt_Prod_Seg_Code`, `exp_f`.`l3_mgt_prod_seg_desc` AS `L3_Mgt_Prod_Seg_Desc`, `exp_f`.`l2_mgt_prod_subarea_code` AS `L2_Mgt_Prod_SubArea_Code`, `exp_f`.`l2_mgt_prod_subarea_desc` AS `L2_Mgt_Prod_SubArea_Desc`, `exp_f`.`l1_mgt_prod_area_code` AS `L1_Mgt_Prod_Area_Code`, `exp_f`.`l1_mgt_prod_area_desc` AS `L1_Mgt_Prod_Area_Desc`, `exp_f`.`l0_mgt_prod_cat_code` AS `L0_Mgt_Prod_Cat_Code`, `exp_f`.`l0_mgt_prod_cat_desc` AS `L0_Mgt_Prod_Cat_Desc`, `exp_f`.`mgt_prod_grouping_code` AS `Mgt_Prod_Grouping_Code`, `exp_f`.`mgt_prod_grouping` AS `Mgt_Prod_Grouping`, `exp_f`.`product_xsell_mapping` AS `Product_Xsell_Mapping`, `exp_f`.`x_sell_mapping_desc` AS `X_Sell_Mapping_Desc`, `exp_f`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , `exp_f`.`from_currency` AS  `From_Currency`, `exp_f`.`nd_rate` AS  `Exchange_Rate`, `exp_f`.`to_currency` AS  `To_Currency`, `exp_f`.`exchange_rate_date` AS  `Exchange_Rate_Date`, `exp_f`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `exp_f`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `exp_f`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `exp_f`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `exp_f`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `exp_f`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `exp_f`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `exp_f`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `exp_f`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `exp_f`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `exp_f`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `exp_f`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `exp_f`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `exp_f`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, `standard_prod`.`standard_product_code` as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, `cty`.`internal_country_region_code`, `cty`.`internal_country_region_description`, `cl`.`client_business_type`, `cl`.`client_entity_gl_criteria`, `cl`.`client_long_desc`, `cl`.`client_cva_exempted`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `exp_f`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`, `br`.`client_name` as `Broker_Name`, case when `comb`.`booking_loc_id`='SG' OR `ccr`.`country_code` ='SG' OR `lmt_ref`.`edm_limit_booking_loc` ='SG' then 'SG' else 'OTHERS' end AS `SECURITY_CTRY`, case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`  * 1 as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `exp_f`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_f`.`edm_limit_booking_loc` <> `lmt_f`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f_dn` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`                AND `exp_f`.`counterparty_original_wid`  = `comb`.`client_wid`      and `exp_f`.`w_snapshot_dt`= '2018-04-30' AND `exp_f`.`w_datasource_id` = 'BCRS_ND' AND `exp_f`.`w_country_cd` =  'SG' AND `exp_f`.`w_workspace` = 'WS36'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2018-04-30' AND `lmt_f`.`w_datasource_id` = 'BCRS_ND' AND `lmt_f`.`w_country_cd` =  'SG'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2018-04-30' AND `col_f`.`w_datasource_id` = 'BCRS_ND' AND `col_f`.`w_country_cd` =  'SG' AND `col_f`.`w_workspace` = split('WS36','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2018-04-30' AND `lmt_ref`.`w_datasource_id` = 'BCRS_ND' AND `lmt_ref`.`w_country_cd` =  'SG'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2018-04-30' AND `col_ref`.`w_datasource_id` = 'BCRS_ND' AND `col_ref`.`w_country_cd` =  'SG' AND `col_ref`.`w_workspace` = split('WS36','_ADJ')[0]          left join `sgmisit`.`sgmi_crm_contract_ref_f` `gua_ref` on `exp_f`.`guarantee_ref_no` = `gua_ref`.`crm_contract_ref_no`        and `gua_ref`.`w_snapshot_dt`= '2018-04-30' AND `gua_ref`.`w_datasource_id` = 'BCRS_ND' AND `gua_ref`.`w_country_cd` =  'SG' AND `gua_ref`.`w_workspace` = split('WS36','_ADJ')[0]      LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on   `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid`    and `limit_cl`.`w_snapshot_dt`= '2018-04-30' AND `limit_cl`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `cl` on  `cl`.`client_wid`  = case when `comb`.`transaction_type` = 'EXPOSURE' then nvl(`limit_cl`.`client_wid`,`comb`.`client_wid`) else `comb`.`client_wid` end          and `cl`.`w_snapshot_dt`= '2018-04-30' AND `cl`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `Obl` on  `obl`.`client_wid`  = `exp_f`.`counterparty_original_wid`              and `obl`.`w_snapshot_dt`= '2018-04-30' AND `obl`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `Gua` on   `gua`.`client_wid`  = `gua_ref`.`client_id`   and `gua`.`w_snapshot_dt`= '2018-04-30' AND `gua`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id`   and `coll_owner`.`w_snapshot_dt`= '2018-04-30' AND `coll_owner`.`w_datasource_id` = 'BCRS_ND'     LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CTY` ON `cl`.`client_domicile_loc_id`=`cty`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `Cl`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `Cl`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2018-04-30' AND `br`.`w_datasource_id` = 'BCRS_ND'  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_ND'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2018-04-30' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2018-04-30' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2018-04-30' and `exc_rate_usd`.`w_datasource_id`='BCRS_ND' and `exp_f`.`ccy_cd` = `exc_rate_usd`.`currency_id`   where  `comb`.`w_snapshot_dt`= '2018-04-30' AND `comb`.`w_datasource_id` = 'BCRS_ND' AND `comb`.`w_country_cd` =  'SG' AND `comb`.`w_workspace`='WS36'  AND (`comb`.`booking_loc_id`='SG' OR `ccr`.`country_code` ='SG' OR `lmt_ref`.`edm_limit_booking_loc` ='SG')
CREATE VIEW `temp_src_query_1808171615310028212` AS SELECT DISTINCT         NVL(`tcdr`.`accrued_fees`,0) `accrued_fees`,  CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY') THEN NVL(`tcdr`.`accrued_interest`, 0) ELSE 0 END `accrued_interest`,         NVL(`txn`.`accrued_interest`,0) `accrued_interest_dollar`,         NVL(`tcdr`.`add_on`,0) `add_on`,         `txn`.`add_on` AS `add_on_dollar`,         `txn`.`collateral_attribute_9`,         CASE                 WHEN `txn`.`collateral_attribute_9` IN (                     'Correct',                     'Reverse'                 ) THEN 'Y'                 ELSE 'N'             END         `adj_flag`,         NVL(`fac`.`amount`,0) `ADJUSTED_LIMIT_AMOUNT`,         `tcdr`.`adjustment_amount`,         `tcdr`.`id` `ais_id`,         `tcdr`.`amortized_cost`,         `tcdr`.`amortized_cost_no_ias`,         'MFU needed - RSK_LIMIT_STATIC.txt' `approved_lgd`,        'MFU needed - RSK_LIMIT_STATIC.txt' `approver_name`,         `inst`.`arm_code` `arm_cd`,         `inst`.`arm_description` `arm_description`,         `tcdr`.`asset_class_category_new`,         `tcdr`.`asset_class_category_original`,         `tcdr`.`asset_class_new`,         `tcdr`.`asset_class_original`,         `crm`.`attribute_6` `attribute_6`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`avg_pre_funded_contribution`                 ELSE NULL             END         `avg_prefunded_contribution`,         `txn`.`balance_category`,         `bca`.`bca_approval_dt` `BCA_APPROVAL_DATE`,         `bca`.`bca_review_dt` `BCA_REVIEW_DATE`,         `tcdr`.`beel`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`beta`                 ELSE NULL             END         `beta`,         nvl(`cva`.`bi`,0) `bi`,         `tcdr`.`method_new` `bii_calculation_method`,         `tcdr`.`bis_entity_type_new`,         `tcdr`.`bis_entity_type_original`,         `tcdr`.`bis_industry_sector_new`,         `tcdr`.`bis_industry_sector_original`,         `tcdr`.`bis_past_due`,         `tcdr`.`bis_past_due_original`,         `tcdr`.`bis_performing_status`,         `tcdr`.`bis_product` `BIS_PROD`,         `tcdr`.`bis_product_category` `BIS_PROD_CATEGORY`,         `txn`.`bis_risk_area_new`,         `txn`.`bis_risk_area_original`,        `tcdr`.`bis_risk_sub_area_new`,         `tcdr`.`bis_risk_sub_area_original`,         `tcdr`.`booking_company` `booking_entity_wid`,         `tcdr`.`booking_company` `booking_entity_id`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code` THEN `tcdr`.`counterparty_original`                         ELSE NULL                     END                 ELSE NULL             END `BROKER_ID`,         `tcdr`.`bs_type`,         `txn`.`business`,         `tcdr`.`business_line_code` `business_line_cd`,         `txn`.`customer_subsegment_code` `BUSINESS_SUB_SEGMENT`,         `txn`.`management_product` `BUSINESS_UNIT`,         `tcdr`.`capital_item`,         `tcdr`.`ccf`,         `tcdr`.`ccp_dfund_method`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`ccp_name`                 ELSE NULL             END         `ccp_name`,         `client`.`client_domicile_loc_id` `ccr_ctry`,         CASE                 WHEN `client`.`client_domicile_loc_id` IS NULL THEN `client`.`coi_loc_id`                 ELSE `client`.`client_domicile_loc_id`             END `CCR_EQ_CNTRY`,         `txn`.`ccr_new`,         `txn`.`ccr_original`,         `tcdr`.`ccy_code` `CCY_CD`,         `tcdrp`.`cec` `cec`,         CASE                 WHEN `tcdr`.`ead_method` IN (                     'CEM',                     'IMM'                 )                      AND                      CASE                         WHEN nvl(`txn`.`contract_type`,'UNMP') = 'GMGMKTLEAS' THEN 'F'                         ELSE `txn`.`derivative_ind`                     END                 = 'T' THEN `tcdr`.`ead_method`             END         `cem_imm_ind`,         `txn`.`cf_indicator`,         `tcdr`.`child_id`,         `tcdr`.`clearing_house_code` `CLEARING_HOUSE_CD`,         CASE                 WHEN `tcdr`.`contract_reference` NOT LIKE 'CCP_MARGIN%' THEN 'N'                 ELSE 'Y'             END         `client_trade`,         `tcdr`.`coll_issuer_bis_entity_type`,         `tcdr`.`collateral_bis_product` `COLLATERAL_BIS_PROD`,  `tcdr`.`collateral_contract_type` `COLLATERAL_CONTRACT_TYPE`,         `tcdr`.`collateral_issuer`,         `crm`.`attribute_6` `collateral_perfection_status`,         `txn`.`collateral_product_category` `collateral_prod_category`,         `tcdr`.`collateral_reference` `collateral_ref_no`,         `tcdr`.`collateral_valuation_date` `collateral_valuation_date`,         `tcdr`.`collateral_attribute_9` `collateral_adjusted_flag`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdragg`.`committed_amount`                 ELSE NULL             END         `committed_amount`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdragg`.`committed_available_amunt`                 ELSE NULL             END         `committed_available_amunt`,         CASE                 WHEN `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'Y'                      AND `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 ) THEN `tcdragg`.`committed_headroom`                 ELSE 0             END         `committed_headroom`,         `fac`.`commited` `committed_indicator`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE'                 )                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`outstanding`                 ELSE 0             END         `committed_os`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdragg`.`committed_amount`                 ELSE NULL             END         `committed_used_amount`,         '0' `committed_used_amt_temp`,         `tcdr`.`company_code` `company_cd`,         `txn`.`company_type`,         `tcdr`.`contract_reference` `contract_ref_no`,         `tcdr`.`contract_type`,         `tcdr`.`internal_rating_original` `correct_orig_crg`,         `inst`.`cost_center` `cost_center_cd`,         `inst`.`cost_center_descriotion` `cost_center_description`,         `tcdr`.`counterparty_new` `counterparty_new_wid`,         `tcdr`.`counterparty_new`,         `tcdr`.`counterparty_new_attribute_1`,         `tcdr`.`counterparty_new_attribute_2`,         `tcdr`.`counterparty_new_attribute_3`,         `tcdr`.`counterparty_new_attribute_4`,         `tcdr`.`counterparty_new_attribute_5`,         `tcdr`.`counterparty_new_attribute_6`,         `tcdr`.`counterparty_new_attribute_7`,         `tcdr`.`counterparty_new_attribute_8`,         `tcdr`.`counterparty_new_attribute_9`,         `tcdr`.`counterparty_new_desc`,         `tcdr`.`counterparty_original` `counterparty_original_wid`,         `tcdr`.`counterparty_original`,         `tcdr`.`counterparty_type_new`,         `tcdr`.`counterparty_type_original`,         `txn`.`country_name`,   CASE WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`collateral_bis_product` <>  'OTC_NET_COL' THEN `tcdr`.`ead` ELSE 0 END `covered_ead`,          `tcdr`.`cpty_group`,         `tcdr`.`cpty_group_original`,         `tcdr`.`cpty_new_sebc_not_qualifying`,         `tcdr`.`cpty_orig_sebc_not_qualifying`,         `tcdrp`.`crc`,         'MFU needed - CRE_CATEGORY.txt' `cre_category`,         'MFU needed - RSK_MAINPROF_CTC.txt' `cre_coverage`,         'MFU needed - CRE_CATEGORY.txt' `cre_property_type`,         `tcdr`.`credit_substitute`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_cd`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_name`,         'RMI REF needed - RSK_CRM_SR_PART' `crm_currency`,         'RMI REF needed - RSK_CRM_SR_PART' `crm_location`,         `txn`.`crm_method` `crm_method`,         'RMI REF needed - RSK_CRM_SR_PART' `crm_residual_maturity`,         `juris`.`csa` `csa_flg`,         `tcdr`.`currency`,         ( nvl(round(`tcdr`.`ead_pro_cva`,10),0) * nvl(round(`tcdr`.`rw_new`,10),0) ) `cva_ccr_rwa`,         `cva`.`cva_index_part` `cva_index_part`,         `txn`.`cva_rwa` `cva_rwa`,         (round(nvl(`cva`.`cva_rwa_addon`,0),10) * round(`obi`.`cva_static_val`,10)) `cva_rwa_addon`,         `txn`.`days_after_contractual_date`,         `tcdr`.`deal_status`,         `tcdr`.`dealbook` `book_wid`,         `tcdr`.`dealbook` `book_cd`,         `txn`.`delivery_type`,         `txn`.`derivative_ind`,         NVL(`clrh`.`df_cm`, 0) `df_cm`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfccp`                 ELSE NULL             END         `dfccp`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfi`                 ELSE NULL             END         `dfi`,         NVL(`enl`.`mother_code`, 'UNMP DLRFIN') `dlrfin_cd`,         `tcdr`.`ead`,         `tcdr`.`ead_formula`,         `tcdr`.`ead_method`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `ead_netting`,         `tcdr`.`ead_original`,         `tcdr`.`ead_pre_ccf`,         `tcdr`.`ead_pro`,         `tcdr`.`ead_pro_cva`,         `tcdr`.`ead_pro_discount`,         `tcdr`.`ead_pro_gen`,         `tcdr`.`ead_pro_write_off`,         nvl(round(`tcdr`.`ead`,10),0) * NVL(`prrsr`.`prr`,0) `ead_prr`,         `tcdr`.`ead_scalar` `ead_scalar`,         nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `ead_square`,         `txn`.`ec_filter_type`,         `txn`.`ec_w_filter_type`,         `tcdr`.`effective_epe`,         nvl(`tcdr`.`k_maturity`,0) `effective_matirity`,         `tcdr`.`el`,         NVL(`trfrsk`.`el_cpty`,0) `el_cpty`,         NVL(`tcdr`.`el`,0) `el_net_saves`,         'MFU needed - Pool_Ref_MONYY.txt' `el_saves`,         NVL(`trfrsk`.`el_total`,0) `el_total`,         `tcdr`.`entity_type_category_new`,         `tcdr`.`entity_type_category_original`,         `tcdr`.`equity_floor_applied`,         `tcdr`.`equity_preferential_treatment`,         `tcdr`.`equity_scaling_factor`,         `txn`.`exchange_rate`,         `tcdr`.`exemption_maturity_floor`,         ( nvl(             CASE                 WHEN `tcdr`.`table_name` IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT'                 ) THEN(                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN(                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE(                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END,0) + nvl(             CASE                 WHEN `tcdr`.`table_name` NOT IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT','FACILITY'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END,0) ) `exposure`,         `tcdr`.`exposure_attribute_1`,         `tcdr`.`exposure_attribute_2`,         `tcdr`.`exposure_attribute_3`,         `tcdr`.`exposure_attribute_4`,         `tcdr`.`exposure_attribute_5`,         `tcdr`.`exposure_attribute_6`,         `tcdr`.`exposure_attribute_7`,         CASE                 WHEN CAST(`tcdr`.`exposure_attribute_7` AS double) IS NOT NULL THEN 'Y'                 ELSE 'N'             END         `exposure_attribute_7d`,         `tcdr`.`exposure_attribute_8`,         `tcdr`.`exposure_attribute_9`,         CASE                 WHEN (                     `tcdr`.`table_name` = 'ON_OFF_BALANCE'                     OR `tcdr`.`table_name` = 'REPO'                     OR `tcdr`.`table_name` = 'RECEIVABLE'                     OR `tcdr`.`table_name` = 'TRANCHE'                     OR `tcdr`.`table_name` = 'BOND'                     OR `tcdr`.`table_name` = 'EQUITY'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END         `exposure_wo_mtm`,         `reposr`.`external_rating`,         `txn`.`customer_subsegment_desc` `F_BUSINESS_SUB_SEGMENT_NAME`,         nvl(`coltp`.`collateral_description`, 'Collateral Type Unmapped') `f_collatral_type_name`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `F_ORIGINAL_SCORECARD_NAME`,         `txn`.`contract_desc` `F_STANDARD_PROD_NAME`,         'MFU needed - ELIMIT' `facility_activated_flag`,         `facagg`.`facility_availability_end_date` `facility_availability_end_date`,         `tcdr`.`facility_reference` `FACILITY_REF_NO`,         `tcdr`.`used_amount_facility` `FACILITY_UTILIZATION_AMOUNT`,         `tcdr`.`fair_value`,         'PMI source needed' `fam_cd`,         `tcdr`.`family`,         `tcdr`.`fde_alternative_method`,         NVL(`txn`.`filter_type`,'NA') `filter_type`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_cd`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_name`,         `tcdr`.`internal_rating_new` `final_crg`,         nvl(`tcdr`.`pd_new`,0) `final_pd`,         `tcdr`.`flag_adjustment`,         `tcdr`.`floor1`,         `tcdr`.`floor2`,         `txn`.`fsa_exclusion_type`,         `txn`.`fsa004_asset_class`,         nvl(round(`tcdr`.`collateral_assigned_amount`,10),0) * ( 1 - nvl(round(`tcdr`.`hc`,10),0) ) `fsv`,         `tcdr`.`funding_ccy`,         `tcdr`.`gaap_code` `GAAP_CD`,         'CDW needed - RSK_BOE_LMT_PRO' `governing_law`,         `tcdr`.`grand_fathering_applied`,         `tcdr`.`guar_sub_reference` `GUARANTEE_SUB_REF_NO`,         `tcdr`.`guarantee_bis_product`,         CASE WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED' THEN 'Guarantee'   WHEN `tcdr`.`collateral_contract_type` = 'NET_AGR' THEN 'Netting'   WHEN NVL (round(`tcdr`.`ead`,10), 0) * `prrsr`.`prr` > 0 THEN 'Product Recovery'    ELSE 'UNMP' END `guarantee_ead_flag`,         `tcdr`.`guarantee_method`,         `tcdr`.`guarantee_reference` `GUARANTEE_REF_NO`,         `tcdr`.`guarantor`,         `tcdr`.`guarantor_bis_entity_type`,         CASE                 WHEN `tcdr`.`tranche_guarantee_type` = 'GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `gurantee_ead`,         `tcdr`.`hc`,         `tcdr`.`hcr`,         `tcdr`.`he`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND `tcdr`.`bs_type` = 'OFB' THEN `tcdr`.`outstanding`                 ELSE 0             END         `headroom`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`ead`                 ELSE 0             END         `headroom_ead`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`rwa`                 ELSE 0             END         `headroom_rwa`,         `tcdr`.`hfx`,         `txn`.`holding_company_ind`,         `tcdr`.`hr`,         `tcdr`.`id`,         'MFU needed - mfu_ifrs_category.txt' `ifrs_category`,         CASE                 WHEN `fac`.`commited` = 'N'                      AND `tcdr`.`table_name` = 'FACILITY' THEN nvl(`tcdr`.`nominal`,0)                 ELSE 0             END         `iip`,         `csr`.`imc_1`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_alpha_factor`,         'RMI TABLE NEEDED - rsk_scb_wb_imm_collat, NVL(SUM(amount),0)' `imm_collat_amount`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_eepe`,         `tcdr`.`import_source`,         `tcdr`.`incorporation_country` `incorp_country`,         `txn`.`incorporation_ccy_new`,         `txn`.`incorporation_ccy_original`,         `tcdr`.`inter_company`,         `tcdr`.`internal_maturity_class`,         NVL(`juris`.`isda`, 'No') `isda_flg`,         `tcdr`.`k_function_used`,         `tcdr`.`k_maturity`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`kccp`                 ELSE NULL            END         `kccp`,         CASE                 WHEN `ccp`.`kccp` IS NOT NULL                      AND `ccp`.`kccp` != 0 THEN 'Y'                 ELSE 'N'             END         `kccp_calc`,         `tcdr`.`legislated_program_applied`,         `tcdr`.`lgd` `LGD`,        `txn`.`lgd` `lgd_dollar`,         `tcdr`.`lgd_grade`,         `tcdr`.`lgd_grade_agency`,         `tcdr`.`lgd_grade_inf`,         `tcdr`.`lgd_grade_rank`,         `tcdr`.`lgd_grade_sup`,         `tcdr`.`lgd_mitigation`,         `tcdr`.`lgd_pre_floor_new`,         `tcdr`.`lgd_pre_floor_original`,         CASE                 WHEN (                     (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0 )                     AND (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.05 )                 ) THEN '0% - 04.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.05                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.1                 ) THEN '05% - 09.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.1                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.15                 ) THEN '10% - 14.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.15                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.2                 ) THEN '15% - 19.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.2                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.25                 ) THEN '20% - 24.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.25                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.3                 ) THEN '25% - 29.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.3                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.35                 ) THEN '30% - 34.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.35                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.4                 ) THEN '35% - 39.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.4                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.45                 ) THEN '40% - 44.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.45                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.5                 ) THEN '45% - 49.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.5                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.55                 ) THEN '50% - 54.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.55                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.6                 ) THEN '55% - 59.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.6                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.65                 ) THEN '60% - 64.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.65                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.7                 ) THEN '65% - 69.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.70                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.75                 ) THEN '70% - 74.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.75                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.80                 ) THEN '75% - 79.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.80                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.85                 ) THEN '80% - 84.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.85                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.90                 ) THEN '85% - 89.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.90                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.95                 ) THEN '90% - 94.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.95                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     <= 1                 ) THEN '95% - 100%'                 WHEN (                     CASE                         WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                         ELSE `txn`.`lgd`                     END                 > 1 ) THEN '>100%'             END         `lgd_range`,         `tcdr`.`lgd` `lgd_tcdr`,         `txn`.`limit_attribute`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`contract_reference`                 ELSE NULL             END         `limit_id`,         CASE                 WHEN `tcdr`.`facility_reference` IS NOT NULL AND `tcdr`.`facility_reference` != ''  THEN 'Linked'                 ELSE 'Unlinked'             END         `linked_unlinked_ind`,         null `lmt_eff_dt`,         `tcdr`.`long_short`,         `tcdr`.`look_through_treatment`,         `crsr`.`lt_rat_agency_code` `lt_rat_agency_cd`,         NVL(`tcdr`.`ltv`,0) `LTV`,         `tcdr`.`ltv_current`,         CASE                 WHEN `prod`.`product_level` = 'Standard Product'                      AND `prod`.`description` LIKE 'Private Equity%' THEN concat('078||',substr(`tcdr`.`dealbook`,length(`tcdr`.`dealbook`) - 7,length(`tcdr`.`dealbook`) ) )                 ELSE `tcdr`.`dealbook`             END         `management_location_cd`,         `txn`.`management_product` `management_prod_wid`,         `txn`.`management_product` `management_prod_id`,         `tcdr`.`margin_period`,         `tcdr`.`maturity_date`,         `tcdr`.`maturity_eff`,         'N' `maturity_limit_flag`,         `txn`.`maturity_range` `maturity_range`,         `tcdr`.`method_new`,         `tcdr`.`method_original`,         `cva`.`mi`,         `cva`.`mi_hedge`,         `tcdr`.`mm`,         `tcdr`.`mortgage_alternative`,         `txn`.`business_identifier` `MRU_IDENTIFIER`,  `txn`.`business_identifier` `BUSINESS_IDENTIFIER`,         `txn`.`mtm`,         `inst`.`custom_attribute_18` `nbv_currency`,         `inst`.`custom_attribute_17` `nbv_value`,         CASE                 WHEN trim(`ent`.`attribute_3`) = 'T' THEN 'TRUE'                 WHEN trim(`ent`.`attribute_3`) = 'F' THEN 'FALSE'                 ELSE `ent`.`attribute_3`         END         `negative_pledge_identifier`,          CASE                 WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)    WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm` ELSE 0         END         `net_mtm`,          ( (CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY')                             THEN NVL(round(`txn`.`outstanding`,10), 0)ELSE 0                        END) + nvl(round(`txn`.`accrued_interest`,10),0) +   ( CASE WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)   WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm`  ELSE 0 END) )   `net_nominal`,          nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         `netted_ead`,         ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) * ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) `netted_ead_square`,         '0' `netted_nominal`,         `tcdr`.`netting_agreement_reference` `NETTING_AGREEMENT_REF_NO`,         `tcdr`.`netting_class`,         NVL(`juris`.`isda`, 'No') `netting_flg`,         `clrh`.`no_clear_mem_n`,    ((CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY') THEN NVL(round(`tcdr`.`outstanding`,10), 0)                    ELSE 0                    END                   ) +                   NVL(round(`txn`.`accrued_interest`,10), 0) +                   (CASE WHEN `tcdr`.`table_name` IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT') THEN                        (CASE  WHEN UPPER(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN                              (CASE WHEN round(`tcdr`.`fair_value`,10) > 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                              )                         ELSE (CASE WHEN round(`tcdr`.`fair_value`,10) < 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                               )                         END                         )                     ELSE 0                     END                    )                  ) `nominal`,            `tcdr`.`nominal` `nominal_tcdr`,         `txn`.`non_borrowing_ind` `NON_BORROWING`,         substr(trim(`ent`.`attribute_17`), 1, 1) `non_contractual_parental_supt`,         substr(trim(`ent`.`attribute_17`), 3, 1) `non_financial_scorecard`,         `txn`.`non_gam_ind`,         `tcdr`.`non_material_equity`,         `txn`.`notional`,         `deal`.`nominal_2` `NOTIONAL_2`,         `deal`.`currency_2` `NOTIONAL_2CCY`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`tcdr`.`nominal`) *-1                         ELSE abs(`tcdr`.`nominal`)                     END                 )                 ELSE 0             END         `notional_tcdr`,         'CDW needed - cdw_txn_rmi_ddmmyyyy.txt' `obl_flg`,         `tcdr`.`obligor_grade_inf_new`,         `tcdr`.`obligor_grade_inf_original`,         `tcdr`.`obligor_grade_new`,         `tcdr`.`obligor_grade_original`,         `tcdr`.`obligor_grade_rank_new`,         `tcdr`.`obligor_grade_rank_original`,         `tcdr`.`obligor_grade_sup_new`,         `tcdr`.`obligor_grade_sup_original`,         CASE                 WHEN `inst`.`cost_center` IN (                     'FM ALM',                     'Principal Finance'                 ) THEN 'OCC_Own Account'                 ELSE nvl(`txn`.`customer_subsegment_code`,'UNMP')             END         `occ_sub_segment`,         `txn`.`bs_type` `ON_OFF_BALANCE_SHEET_FLAG`,         nvl(`tcdr`.`pd_original`,0) `org_pd`,         `tcdr`.`original_cost`,         nvl(`tcdr`.`internal_rating_original`,'CRG Original Unmapped') `original_crg`,          `txnf`.`original_limit_amount` `original_limit_amount`,          `tcdr`.`original_maturity`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `original_scorecard`,         `txn`.`outstanding` `os`,         `facprod`.`contract_type` `out_limit_product`,   CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY') THEN NVL(`tcdr`.`outstanding`, 0) ELSE 0 END `outstanding`,          `txn`.`outstanding` `outstanding_dollar`,         'MFU needed - cdw_BOEACBTXN_rmi_DDMMYYYY.txt' `overdue_days`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_1`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_2`,         `tcdr`.`parent_id`,         `tcdr`.`past_due_int`,         `tcdr`.`past_due_ppal`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`pce_flag`                 ELSE NULL             END         `pce_flag`,         `rat`.`one_year_pd` `pd_midpoint`,         `tcdr`.`pd_new`,         `tcdr`.`pd_original`,         `tcdr`.`pd_pre_floor_new`,         `tcdr`.`pd_pre_floor_original`,         `tcdr`.`performing_status`,         `tcdr`.`pool_code` `POOL_CD`,         `tcdr`.`premium_current`,         `contp`.`attribute_1` `prod_cat_info`,         `tcdr`.`product_gl_criteria`,         `tcdr`.`product_gl_criteria_2`,         NVL(`tcdrp`.`tot_el`,0) `PROXY_EL`,         NVL(`tcdrp`.`lgd_used`,0) `PROXY_LGD`,         NVL(`txn`.`prr`,0) `PRR`,    nvl(`inst`.`psgl_account_number`, `psgl`.`psgl_account`) `PSGL_ACCOUNT`,           nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_CD`,  nvl(nvl(`inst`.`psgl_customer_class`, `psgl`.`psgl_cust_class`), `txn`.`psgl_cust_class`) `PSGL_CUST_CLASS`,  nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_DEPARTMENT`,  nvl(nvl(`inst`.`psgl_operating_unit`, `psgl`.`psgl_operating_unit`), `txn`.`psgl_operating_unit`) `PSGL_OPERATING_UNIT`,  nvl(nvl(`inst`.`psgl_product_code`, `psgl`.`psgl_product`), `txn`.`psgl_product`) `PSGL_PRODUCT`,          `tcdr`.`qualifying_ccp`,         `tcdr`.`qualifying_transaction`,         `crsr`.`lt_rat_code` `RATING_CD`,         `txn`.`replacement_cost` `RC`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN (                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE (                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END         `rc_tcdr`,         `txn`.`replacement_cost` `REPLACEMENT_COST`,         `tcdr`.`residual_maturity`,         `tcdr`.`rgc`,         `tcdr`.`risk_bucket`,         `tcdr`.`risk_bucket_original`,         `tcdr`.`risk_country`,         `tcdr`.`risk_country_new`,         `tcdr`.`risk_country_original`,         `tcdr`.`risk_type`,         `crm`.`rw_expo` `rw_expo`,         `tcdr`.`rw_new`,         `tcdr`.`rw_original`,         `tcdr`.`rw_scaling_factor`,         `tcdr`.`rwa`,         NVL(`trfrsk`.`rwa_add_on`,0) `rwa_add_on`,         `tcdr`.`rwa` `rwa_after_scale`,         nvl(round(`tcdr`.`rwa`,10),0) / 1.06 `rwa_before_scale`,         `trfrsk`.`rwa_cpty` `rwa_cpty`,         `tcdr`.`rwa` `RWA_NET_SAVES`,         `tcdr`.`rwa_pre_cap`,         `tcdr`.`rwa_pre_crm`,         `tcdr`.`rwa_pre_floor_equity`,         'MFU needed - Pool_Ref_MONYY.txt' `rwa_saves`,         `tcdr`.`rwa_scaling_factor`,         `trfrsk`.`rwa_total` `rwa_total`,         `ccp`.`is_scb_clr_mem` `scb_clearing_mem`,         `tcdr`.`second_loss_treatment`,         `tcdr`.`secu_bank_role`,         `tcdr`.`secu_company_weight`,         `tcdr`.`secu_ea_controlled`,         `tcdr`.`secu_issue_date`,         `tcdr`.`secu_loss_position`,         `tcdr`.`secu_mode`,         `tcdr`.`secu_retail_line_fg`,         `tcdr`.`secu_spread_trapping_ratio`,         `tcdr`.`secu_uncommited_retail_fg`,         `txn`.`lgd` `SECURED_LGD`,         `tcdr`.`securitization_n`,         `tcdr`.`securitization_reference` `SECURITIZATION_REF_NO`,         `tcdr`.`securitized`,         `tcdr`.`security_positions_ref`,         `txn`.`segment_original`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code`                              AND `clrm`.`entity_code` = `clrm`.`clearing_house_code` THEN `clrm`.`clearing_member_conditions`                         ELSE NULL                     END                 ELSE NULL             END         `segregated`,         `tcdr`.`seniority_new`,         `tcdr`.`seniority_original`,         `tcdr`.`settlement_price`,         `reposr`.`sov_indicator` `sov_indicator`,         `tcdr`.`sovereign_risk_bucket_new`,         `tcdr`.`sovereign_risk_bucket_ori`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_wid`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_cd`,         `tcdr`.`standard_rw_new`,         `tcdr`.`standard_rw_original`,         `txn`.`start_date`,         null `std_rw_override_indicator`,         `inst`.`custom_attribute_16` `strategy`,         `tcdr`.`stress_testing_scenario_id`,         `txn`.`sub_limit_fac_reference` `sub_limit_fac_ref_no`,         `tcdr`.`sub_method_new`,         `tcdr`.`sub_method_original`,         `tcdr`.`sub_reference`,         `tcdr`.`supervisor_code` `SUPERVISOR_CD`,         CASE WHEN `enl`.`link_type` = 'SUPFIN' then `enl`.`mother_code` else 'UNMP SUPFIN' end `supfin_cd`,         `tcdr`.`table_name` `table_name`,         'SMC_PERIMETER required' `tbs_cd`,         `txn`.`maturity_range` `TENOR_BUCKETS`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`third_party_cp_flag`                 ELSE 'N/A'             END         `third_party_cp_flag`,         `tcdr`.`tier1_deduction`,         `tcdr`.`tier2_deduction`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`tot_pre_fund_con`                 ELSE NULL             END         `tot_pre_fund_con`,         `tcdr`.`total_annual_assets`,         `tcdr`.`total_annual_sales`,         `fac`.`amount` `total_facility_amount`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`total_initital_margin`                 ELSE NULL             END         `total_initital_margin`,         `inst`.`tp_portfolio_name` `tp_portfolio_name`,         'MFU needed - e_balances.txt' `tp_sys_scr_id`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / round(`t_cdr_temp`.`rwa`,10) ) )                 ELSE 0             END         `tr_addon_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN ( nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0) )                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / `t_cdr_temp`.`rwa` ) )                 ELSE 0             END         `tr_addon_rwa`,         nvl(`trfrsk`.`tr_el`,0) `tr_el`,         NVL(`trfrsk`.`tr_gua_ctry`, 'UNMP') `tr_gua_ctry`,         CASE                 WHEN `t_cdr_temp`.`el` != 0          THEN nvl(round(`t_cdr_temp`.`el`,10),0) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) )                 ELSE 0             END         `tr_pre_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN nvl(round(`t_cdr_temp`.`rwa`,10),0) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) ) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) )                 ELSE 0             END         `tr_pre_rwa`,         `tcdr`.`trade_date`,         `tcdr`.`trading_book_type`,         `tcdr`.`trading_book_type` `TRADING_IND`,         `tcdr`.`tranche_collateral_type`,         `tcdr`.`tranche_guarantee_type`,         `txn`.`tranche_lgd`,         NVL(`trfrsk`.`transfer_risk`,'N') `transfer_risk`,         `txn`.`limit_amount` `txn_limit_amount`,         `txn`.`rw_new` `txn_rw_new`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`uci`                 ELSE NULL             END         `uci`,         `tcdr`.`uncommited` `uncommited`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdragg`.`committed_amount`             END         `uncommitted_amount`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdragg`.`committed_available_amunt`             END         `uncommitted_available_amunt`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 )                      AND `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_headroom`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE'                 )                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_os`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdragg`.`committed_available_amunt`             END         `uncommitted_used_amount`,         `tcdr`.`unconditionnaly_cancelable`,         `tcdr`.`und_pool_ref`,         `txn`.`unmapped_ind`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                      AND `tcdr`.`tranche_guarantee_type` = 'NOT GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `unsecured_ead`,         `tcdr`.`used_amount_facility`,         `tcdr`.`value_date`,         `txn`.`waterfall_seniority`,         `cva`.`wi` `wi`,         case when `rat`.`row_owner` = 'C' AND `rat`.`agency_code` = 'INTERNAL' AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) >= nvl(round(`rat`.`pd_inf`,10),0)   AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) < nvl(round(`rat`.`pd_sup`,10),0)   THEN `rat`.`rating` ELSE `icr`.`long_term_rating` END `wt_crg`,         nvl(round(`tcdr`.`pd_new`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_final_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`k_maturity`,10) ) `wt_k_maturity`,         `txn`.`wt_lgd`,         (nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`k_maturity`,10),0)) `wt_mat_eff`,         nvl(round(`tcdr`.`pd_original`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_org_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_new`,10) ) `wt_pd_new`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_original`,10) ) `wt_pd_original`,         nvl(`txn`.`wt_residual_maturity`,0) `wt_residual_maturity`,         ( round(`tcdr`.`pd_new`,10) * round(`tcdr`.`nominal`,10) ) `wtpdlgd`,         ( round(`tcdr`.`pd_new`,10) * round(`txn`.`wt_lgd`,10) ) `wtpdnm`,         `tcdrp`.`xrc`,         `tcdr`.`zero_haircut_for_repo`,         `tcdr`.`zero_rw_for_equity`,         `tcdr`.`zone_a_new`,         `tcdr`.`zone_a_original`,  `tcdr`.`collateral_assigned_amount` `COLLATERAL_ASSIGNED_AMOUNT`,  '0' `collateral_unique_id`,  `smeprod`.`product_type` `sme_product_type`,   CASE WHEN SUBSTR((case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END ), -2) = '-M'                   THEN                   substr( (case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END)         , 1         ,  length(trim(case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END ))-2                   )                     ELSE                  case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END          END `DERIVED_LIMIT_ID`,   CASE WHEN `tcdr`.`method_new` = 'ADV' THEN round(NVL(`tcdr`.`ead`, 0),5) *          (CASE WHEN ( (`tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') <> 'RW_LGD_UPDATE'                         ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`txn`.`lgd`,0),5)                 WHEN ( (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') = 'RW_LGD_UPDATE'                          ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`tcdr`.`exposure_attribute_7`,0),5)                 ELSE 0 END         ) ELSE 0 END `unsecured_lgd_dollar`,    case when `be`.`booking_loc_id` = 'SG'  then 'SG' else 'OTHERS' end as `SECURITY_CTRY`,   case when `tcdr`.`dealbook` like '%CI%' OR `tcdr`.`dealbook` like '%CC%' then 'CICC'   when `tcdr`.`dealbook` like '%RT%' then 'RT'   when `tcdr`.`dealbook` like '%PB%' then 'PB'   when `tcdr`.`dealbook` like '%OB%' then 'OB'   else 'OTHERS' end AS `SECURITY_SEG`                          FROM         `sgmisitstg`.`stg_bcrs_t_cdr` `tcdr`           LEFT JOIN `sgmisit`.`sgmi_txn_rwa_f` `txn` ON `tcdr`.`id` = `txn`.`id`                                                             AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`txn`.`partition_key`,'UNM')            AND `txn`.`w_datasource_id` = 'BCRS_PRA'            AND `txn`.`w_snapshot_dt` = '2018-04-30'            AND `txn`.`w_country_cd` = 'ALL'            AND `txn`.`w_workspace` = 'WS7'    LEFT JOIN (select `sgmi_txn_rwa_f`.`netting_agreement_reference`, sum(`sgmi_txn_rwa_f`.`mtm`) `sum_mtm`, `sgmi_txn_rwa_f`.`partition_key`    from `sgmisit`.`sgmi_txn_rwa_f`    where    `sgmi_txn_rwa_f`.`w_snapshot_dt` = '2018-04-30' and   `sgmi_txn_rwa_f`.`w_workspace` in (   (case when instr('WS7','ADJ')>0 then substr('WS7',1,instr('WS7','_ADJ') - 1) else concat('WS7','_ADJ') end), 'WS7')   group by `sgmi_txn_rwa_f`.`netting_agreement_reference`, `sgmi_txn_rwa_f`.`partition_key` ) `txn2`   ON `txn`.`netting_agreement_reference` = `txn2`.`netting_agreement_reference`                                                               AND nvl(`txn`.`partition_key`,'UNM') = nvl(`txn2`.`partition_key`,'UNM')                  LEFT JOIN `sgmisitstg`.`stg_bcrs_facility` `fac` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`fac`.`contract_reference`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`fac`.`partition_key`,1,8)                                                       AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`fac`.`contract_type`,'UNM')             AND `fac`.`w_batch_id` = '2018081423444300838'          LEFT JOIN (select `stg_bcrs_scb_wb_addt_inst`.`partition_key`, `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`, `stg_bcrs_scb_wb_addt_inst`.`arm_code`, `stg_bcrs_scb_wb_addt_inst`.`arm_description`, `stg_bcrs_scb_wb_addt_inst`.`cost_center`, `stg_bcrs_scb_wb_addt_inst`.`cost_center_descriotion`,    `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_18`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_17`, `stg_bcrs_scb_wb_addt_inst`.`psgl_account_number`, `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`, `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`, `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_16`, `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`, `stg_bcrs_scb_wb_addt_inst`.`w_batch_id`,    ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ) AS `rnk`      FROM `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2018081423444300838' AND  NVL(`stg_bcrs_scb_wb_addt_inst`.`arm_code`,'') <> ''     ) `inst` ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`inst`.`contract_reference`),'UNM')                                                       AND trim(`tcdr`.`table_name`) = trim(`inst`.`table_name`)                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`inst`.`partition_key`,1,8)             AND `inst`.`rnk`=1   LEFT JOIN ( select `stg_bcrs_scb_wb_psgl`.`partition_key`, `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name`, `stg_bcrs_scb_wb_psgl`.`psgl_bu`, `stg_bcrs_scb_wb_psgl`.`psgl_account`, `stg_bcrs_scb_wb_psgl`.`psgl_product`, `stg_bcrs_scb_wb_psgl`.`psgl_department`, `stg_bcrs_scb_wb_psgl`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_psgl`.`psgl_cust_class`, `stg_bcrs_scb_wb_psgl`.`financial_book_code`, `stg_bcrs_scb_wb_psgl`.`booking_location`, `stg_bcrs_scb_wb_psgl`.`w_batch_id`, ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name` ) AS `rnk`       FROM `sgmisitstg`.`stg_bcrs_scb_wb_psgl`   WHERE `stg_bcrs_scb_wb_psgl`.`w_batch_id` = '2018081423444300838'     AND  NVL(`stg_bcrs_scb_wb_psgl`.`psgl_bu`,'') <> '') `psgl`   ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`psgl`.`contract_reference`),'UNM')    AND trim(`tcdr`.`table_name`) = trim(`psgl`.`fermat_table_name`)   AND substr(`tcdr`.`partition_key`,1,8) = substr(`psgl`.`partition_key`,1,8)               AND `psgl`.`rnk`=1                        LEFT JOIN ( select `stg_bcrs_t_crm`.`partition_key`, `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`,`stg_bcrs_t_crm`.`expo_table_name`,`stg_bcrs_t_crm`.`w_batch_id`,`stg_bcrs_t_crm`.`rw_expo`,`stg_bcrs_t_crm`.`attribute_6`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ORDER BY `stg_bcrs_t_crm`.`expo_contract_reference`,    `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ) AS `rnk`    FROM `sgmisitstg`.`stg_bcrs_t_crm`   WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_t_crm`.`w_batch_id` = '2018081423444300838' ELSE `stg_bcrs_t_crm`.`w_batch_id` = '2018071113463400417' END           ) `crm` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`crm`.`expo_contract_reference`,'UNM')          AND nvl(`tcdr`.`counterparty_original`, 'UMP') = nvl(`crm`.`expo_counterparty`, 'UMP')                                                    AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`crm`.`partition_key`,'UNM')          AND `crm`.`expo_table_name` = 'ON_OFF_BALANCE'          AND `crm`.`rw_expo` is not null          AND `crm`.`rnk` = 1            LEFT JOIN (             SELECT   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                                `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`avg_pre_funded_contribution`) `avg_pre_funded_contribution`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`beta`) `beta`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`clearing_house_name`) `ccp_name`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`pre_funded_financial`) `dfccp`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_prefunded_contribution`) `dfi`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`kccp`) `kccp`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`sum_pre_fund_contribution`) `tot_pre_fund_con`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`total_initial_margin`) `total_initital_margin`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_committed_contributions`) `uci`             FROM                 `sgmisitstg`.`stg_bcrs_scb_wb_ccp_static`   WHERE `stg_bcrs_scb_wb_ccp_static`.`w_batch_id` = '2018081423444300838'       AND `stg_bcrs_scb_wb_ccp_static`.`beta` is not null AND `stg_bcrs_scb_wb_ccp_static`.`beta` != ''             GROUP BY   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                 `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`         ) `ccp` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`ccp`.`clearing_house_code`,'UNM')                  AND substr(`tcdr`.`partition_key`,1,8) = substr(`ccp`.`partition_key`,1,8)          LEFT JOIN (             SELECT   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`,                 SUM(`stg_bcrs_t_cva`.`bi`) `bi`,                 SUM(`stg_bcrs_t_cva`.`cva_index_part`) `cva_index_part`,                 SUM(`stg_bcrs_t_cva`.`cva_capital_charge`) `cva_rwa_addon`,                 MAX(`stg_bcrs_t_cva`.`mi`) `mi`,                 SUM(`stg_bcrs_t_cva`.`mi_hedge`) `mi_hedge`,                 MAX(`stg_bcrs_t_cva`.`wi`) `wi`             FROM                 `sgmisitstg`.`stg_bcrs_t_cva`   WHERE `stg_bcrs_t_cva`.`w_batch_id` = '2018071113463400417'             GROUP BY   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`         ) `cva` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`cva`.`contract_reference`,'UNM')                  AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`cva`.`partition_key`,'UNM')                  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`cva`.`counterparty`,'UNM')          LEFT JOIN `sgmisit`.`sgmi_client_d` `client` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`client`.`client_id`,'UNM')    AND `client`.`w_datasource_id` = 'BCRS_PRA' AND `client`.`w_snapshot_dt` = '2018-04-30'    LEFT JOIN `sgmisit`.`obi_pd_lookup` `obi` ON substr(`tcdr`.`partition_key`,1,6) = nvl(`obi`.`partition_key`,'UNM')          LEFT JOIN `sgmisitstg`.`stg_bcrs_v_scb_gpr_ec_t_cdr_prx` `tcdrp` ON nvl(`tcdr`.`id`,'UNM') = nvl(`tcdrp`.`id`,'UNM')                                                                       AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`tcdrp`.`partition_key`,'UNM')               AND `tcdrp`.`w_batch_id` = '2018081423444300838'         LEFT JOIN (             SELECT   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`,                 MAX(`stg_bcrs_bis_clearing_house`.`df_cm`) `df_cm`,                 MAX(`stg_bcrs_bis_clearing_house`.`n`) `no_clear_mem_n`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_house`   WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2018081423444300838' ELSE `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2018071113463400417' END             GROUP BY   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`         ) `clrh` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`clrh`.`entity_code`,'UNM')                   AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrh`.`partition_key`,'UNM')          LEFT JOIN   (select `stg_bcrs_entity_links`.`partition_key`, `stg_bcrs_entity_links`.`child_code`, `stg_bcrs_entity_links`.`link_type`, `stg_bcrs_entity_links`.`mother_code`, `stg_bcrs_entity_links`.`w_batch_id`, ROW_NUMBER() OVER(ORDER BY `stg_bcrs_entity_links`.`mother_code` desc) AS `rnk`  FROM `sgmisitstg`.`stg_bcrs_entity_links` where `stg_bcrs_entity_links`.`w_batch_id` = '2018081423444300838' and `stg_bcrs_entity_links`.`link_type` = 'DLRFIN' ) `enl`   ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`enl`.`child_code`,'UNM')         AND substr(`tcdr`.`partition_key`,1,8) = substr(`enl`.`partition_key`,1,8)         AND `enl`.`rnk`=1           LEFT JOIN (select `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`, `stg_bcrs_csr`.`table_name`, `stg_bcrs_csr`.`imc_1`, `stg_bcrs_csr`.`w_batch_id`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ORDER BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ) AS `rnk`   from `sgmisitstg`.`stg_bcrs_csr`   where CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_csr`.`w_batch_id` = '2018081423444300838' ELSE `stg_bcrs_csr`.`w_batch_id` = '2018071113463400417' END ) `csr`     ON `tcdr`.`contract_reference` = `csr`.`contract_reference`    AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`csr`.`contract_type`,'UNM')    AND nvl(`tcdr`.`counterparty_new`,'UNM') = nvl(`csr`.`counterparty`,'UNM')    AND nvl(`tcdr`.`method_new`,'UNM') = nvl(`csr`.`method`,'UNM')    AND `tcdr`.`bs_type` = `csr`.`bs_type`    AND `tcdr`.`dealbook` = `csr`.`book_code`    AND (case when nvl(`tcdr`.`table_name`,'z') in ('BOND', 'EQUITY', 'TRANCHE', 'CONVERTIBLE', 'FUND') then 'SECURITY_POSITIONS'             else nvl(`tcdr`.`table_name`, 'z') end) = `csr`.`table_name`    AND `csr`.`imc_1` is not null    AND trim(`csr`.`imc_1`) != ''    AND `csr`.`rnk` = 1    LEFT JOIN ( select `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_cpty`),0) `EL_CPTY`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_total`),0) `EL_TOTAL`,      NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`),0) `rwa_add_on`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`),0) `rwa_cpty`,      NVL(NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_total`),SUM(NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`,0) +  NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`,0))),0) `RWA_TOTAL`,      NVL(sum(`stg_bcrs_scb_wb_tr_sr`.`tr_el`),0) `tr_el`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry` `TR_GUA_CTRY`, MAX(NVL(`stg_bcrs_scb_wb_tr_sr`.`is_tr`,'N')) `TRANSFER_RISK`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`   from `sgmisitstg`.`stg_bcrs_scb_wb_tr_sr`    where `stg_bcrs_scb_wb_tr_sr`.`w_batch_id` = '2018081423444300838'    group by `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`  ) `trfrsk`  ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`trfrsk`.`contract_reference`,'UNM')  AND nvl(`tcdr`.`table_name`,'UNM') = nvl(`trfrsk`.`table_name`,'UNM')  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`trfrsk`.`pr_obligor`,'UNM')  AND `tcdr`.`contract_type` = `trfrsk`.`contract_type`  and `tcdr`.`bs_type` = `trfrsk`.`bs_type`    LEFT JOIN (             SELECT    `stg_bcrs_scb_wb_prr_sr`.`w_batch_id`,                 `stg_bcrs_scb_wb_prr_sr`.`partition_key`,                 `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,   case when (max(`stg_bcrs_scb_wb_prr_sr`.`prr`) - min(`stg_bcrs_scb_wb_prr_sr`.`prr`)) <> 0 Then 0 else max(`stg_bcrs_scb_wb_prr_sr`.`prr`) end `prr`             FROM                 `sgmisitstg`.`stg_bcrs_scb_wb_prr_sr`   WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2018081423444300838' ELSE `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2018071113463400417' END       AND  NVL(`stg_bcrs_scb_wb_prr_sr`.`prr`,'') <> ''        GROUP BY           `stg_bcrs_scb_wb_prr_sr`.`w_batch_id`,                 `stg_bcrs_scb_wb_prr_sr`.`partition_key`,                 `stg_bcrs_scb_wb_prr_sr`.`contract_reference`                 ) `prrsr` ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`prrsr`.`partition_key`,'UNM')                    AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`prrsr`.`contract_reference`,'UNM')        LEFT JOIN (select `stg_bcrs_scb_wb_repo_sr`.`partition_key`, `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`, `stg_bcrs_scb_wb_repo_sr`.`external_rating`, `stg_bcrs_scb_wb_repo_sr`.`sov_indicator`, `stg_bcrs_scb_wb_repo_sr`.`security_contract_ref`,     ROW_NUMBER() OVER(partition by `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref` order by `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`) as `rnk`   from `sgmisitstg`.`stg_bcrs_scb_wb_repo_sr`  WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2018081423444300838' ELSE `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2018071113463400417' END   AND `stg_bcrs_scb_wb_repo_sr`.`sov_indicator` IS NOT NULL ) `reposr`   ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`reposr`.`partition_key`,'UNM')  AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`reposr`.`repo_contract_ref`,'UNM')  AND `reposr`.`rnk`=1            LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `scrd` ON nvl(`scrd`.`org_scrd_g3_code`,'UNM') = nvl(`txn`.`scorecard_original`,'UNM')           LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`,                 MIN(`stg_bcrs_facility`.`dim3`) `facility_availability_end_date`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2018081423444300838'              GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`         ) `facagg` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`facagg`.`contract_reference`,'UNM')                     AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`facagg`.`counterparty_code`,'UNM')                     AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`facagg`.`partition_key`,'UNM')                   LEFT JOIN `sgmisitstg`.`stg_bcrs_credit_rating_sr` `crsr` ON nvl(`reposr`.`security_contract_ref`,'UNM') = nvl(`crsr`.`reference`,'UNM')                                                                AND `crsr`.`lt_rat_agency_code` IS NOT NULL               AND CASE WHEN 'WS7' like '%ADJ%' THEN `crsr`.`w_batch_id` = '2018081423444300838' ELSE `crsr`.`w_batch_id` = '2018071113463400417' END          LEFT JOIN `sgmisitstg`.`stg_bcrs_product` `prod` ON nvl(`tcdr`.`contract_type`,'UNM') = nvl(`prod`.`product`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`prod`.`partition_key`,1,8)             AND `prod`.`w_batch_id` = '2018081423444300838'          LEFT JOIN `sgmisitstg`.`stg_bcrs_entity` `ent` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`ent`.`entity_code`,'UNM')                                                     AND substr(`tcdr`.`partition_key`,1,8) = substr(`ent`.`partition_key`,1,8)            AND `ent`.`w_batch_id` = '2018081423444300838'          LEFT JOIN `sgmisitstg`.`stg_bcrs_deal_import` `deal` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`deal`.`contract_reference`,'UNM')                                                           AND substr(`tcdr`.`partition_key`,1,8) = substr(`deal`.`contract_reference`,1,8)          AND `deal`.`w_batch_id` = '2018081423444300838'          LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`,                 MAX(nvl(case when trim(`stg_bcrs_facility`.`attribute_4`) = '' then null else `stg_bcrs_facility`.`attribute_4` end,`stg_bcrs_facility`.`amount`) ) `original_limit_amount`,                 MIN(`stg_bcrs_facility`.`dim2`) `pce_flag`,                 MIN(`stg_bcrs_facility`.`dim1`) `third_party_cp_flag`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2018081423444300838'                GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`         ) `txnf` ON nvl(`txn`.`sub_limit_fac_reference`,'UNM') = nvl(`txnf`.`contract_reference`,'UNM')                   AND substr(`txn`.`partition_key`,1,8) = substr(`txnf`.`partition_key`,1,8)                   AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`txn`.`contract_reference`,'UNM')     AND `tcdr`.`import_source` like '%WB%'                                       AND `tcdr`.`id` = `txn`.`id`             LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`icr`.`entity_code`,'UNM')                                                                    AND substr(`tcdr`.`partition_key`,1,8) = substr(`icr`.`partition_key`,1,8)                                                                    AND `icr`.`agency_code` = 'INTERNAL'            AND `icr`.`w_batch_id` = '2018081423444300838'          LEFT JOIN `sgmisitstg`.`stg_bcrs_rating` `rat` ON nvl(`icr`.`long_term_rating`,'UNM') = nvl(`rat`.`rating`,'UNM')                                                     AND substr(`icr`.`partition_key`,1,8) = substr(`rat`.`partition_key`,1,8)                                                     AND `rat`.`agency_code` = 'INTERNAL'           AND `rat`.`w_batch_id` = '2018081423444300838'          LEFT JOIN (             SELECT    `stg_bcrs_bis_clearing_member`.`w_batch_id`,                 `stg_bcrs_bis_clearing_member`.`partition_key`,                 `stg_bcrs_bis_clearing_member`.`entity_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_house_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_member_conditions`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_bis_clearing_member`.`entity_code`, `stg_bcrs_bis_clearing_member`.`clearing_house_code` ORDER BY `stg_bcrs_bis_clearing_member`.`entity_code`, `stg_bcrs_bis_clearing_member`.`clearing_house_code` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_member`   WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2018081423444300838' ELSE `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2018071113463400417' END          ) `clrm` ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrm`.`partition_key`,'UNM')                   AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`clrm`.`entity_code`,'UNM')     AND `clrm`.`w_batch_id` = '2018071113463400417'     AND `clrm`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_currency` `cur` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`cur`.`partition_key`,'UNM')                                                       AND nvl(`fac`.`currency`,'UNM') = nvl(`cur`.`ccy_code`,'UNM')             AND `cur`.`w_batch_id` = '2018081423444300838'          LEFT JOIN (             SELECT   `stg_bcrs_t_cdr`.`w_batch_id`,                 `stg_bcrs_t_cdr`.`partition_key`,                 `stg_bcrs_t_cdr`.`id`,                 `stg_bcrs_t_cdr`.`contract_reference`,                 `stg_bcrs_t_cdr`.`contract_type`,                 `stg_bcrs_t_cdr`.`bs_type`,                 SUM(`stg_bcrs_t_cdr`.`nominal`) `committed_amount`,                 SUM(`stg_bcrs_t_cdr`.`ead_pre_ccf`) `committed_available_amunt`,                 SUM(`stg_bcrs_t_cdr`.`outstanding`) `committed_headroom`             FROM                 `sgmisitstg`.`stg_bcrs_t_cdr`   WHERE `stg_bcrs_t_cdr`.`w_batch_id` = '2018071113463400417'              GROUP BY   `stg_bcrs_t_cdr`.`w_batch_id`,                 `stg_bcrs_t_cdr`.`partition_key`,                 `stg_bcrs_t_cdr`.`id`,                 `stg_bcrs_t_cdr`.`contract_reference`,                 `stg_bcrs_t_cdr`.`contract_type`,                 `stg_bcrs_t_cdr`.`bs_type`         ) `tcdragg` ON nvl(`tcdr`.`id`,'UNM') = nvl(`tcdragg`.`id`,'UNM')                      AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`tcdragg`.`partition_key`,'UNM')          LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `juris` ON nvl(`tcdr`.`incorporation_country`,'UNM') = nvl(`juris`.`country_cd`,'UNM')                                                                  AND `juris`.`etl_current_record_flag` = 'Y'          LEFT JOIN (             SELECT    `stg_bcrs_facility_products`.`w_batch_id`,                 `stg_bcrs_facility_products`.`partition_key`,                 `stg_bcrs_facility_products`.`facility_reference`,                 `stg_bcrs_facility_products`.`contract_type`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_facility_products`.`facility_reference` ORDER BY `stg_bcrs_facility_products`.`facility_reference` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_facility_products`   WHERE `stg_bcrs_facility_products`.`w_batch_id` = '2018081423444300838'         ) `facprod` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`facprod`.`partition_key`,'UNM')                      AND nvl(`facprod`.`facility_reference`,'UNM') = substr(`fac`.`contract_reference`,1,instr(`fac`.`contract_reference`,'-M') - 1)                      AND `fac`.`attribute_1` = 'MOTHER'        AND `facprod`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON substr(`tcdr`.`partition_key`,1,8) = substr(`contp`.`partition_key`,1,8)                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`facprod`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2018081423444300838'          LEFT JOIN (             SELECT   w_batch_id,                 partition_key,                 nvl(`t_cdr`.`contract_reference`,'UNM') `contract_reference`,                 nvl(`t_cdr`.`table_name`,'UNM') `table_name`,                 nvl(`t_cdr`.`counterparty_original`,'UNM') `counterparty_original`,                 SUM(nvl(`t_cdr`.`rwa`,0) ) `rwa`,                 SUM(nvl(`t_cdr`.`el`,0) ) `el`             FROM                 `sgmisitstg`.`stg_bcrs_t_cdr` `t_cdr`   WHERE `t_cdr`.`w_batch_id` = '2018071113463400417'             GROUP BY   `t_cdr`.`w_batch_id`,                 `t_cdr`.`partition_key`,                 nvl(`t_cdr`.`contract_reference`,'UNM'),                 nvl(`t_cdr`.`table_name`,'UNM'),                 nvl(`t_cdr`.`counterparty_original`,'UNM')         ) `t_cdr_temp` ON nvl(`tcdr`.`partition_key`,'UNM') = `t_cdr_temp`.`partition_key`                         AND nvl(`tcdr`.`contract_reference`,'UNM') = `t_cdr_temp`.`contract_reference`                         AND nvl(`tcdr`.`table_name`,'UNM') = `t_cdr_temp`.`table_name`                         AND nvl(`tcdr`.`counterparty_original`,'UNM') = `t_cdr_temp`.`counterparty_original`     left join `sgmisitstg`.`stg_bcrs_facility_links` `facl`   on (CASE WHEN (length(`tcdr`.`contract_reference`) = 10 or length(`tcdr`.`contract_reference`) = 11 or length(`tcdr`.`contract_reference`) = 12) THEN substr(`tcdr`.`contract_reference`,1,instr(`tcdr`.`contract_reference`,'-M') - 1)          ELSE `tcdr`.`contract_reference` END) = `facl`.`contract_reference`   and substr(`tcdr`.`partition_key`,1,8) = substr(`facl`.`partition_key`,1,8)   and `facl`.`table_name` = `tcdr`.`table_name`   and `facl`.`w_batch_id` = '2018081423444300838'    left join (select `sgmi_client_bca_d`.`client_le_wid`, `sgmi_client_bca_d`.`client_le_id`, `sgmi_client_bca_d`.`bca_ref_no`, `sgmi_client_bca_d`.`bca_approval_dt`, `sgmi_client_bca_d`.`bca_review_dt`, `sgmi_client_bca_d`.`w_snapshot_dt`,   ROW_NUMBER() OVER( PARTITION BY `sgmi_client_bca_d`.`client_le_id` ORDER BY `sgmi_client_bca_d`.`client_le_id` ) AS `rnk`                 from `sgmisit`.`sgmi_client_bca_d` ) `bca`                 on substr(`tcdr`.`counterparty_original`,1,8) = `bca`.`client_le_id`                 and `tcdr`.`w_snapshot_dt` = `bca`.`w_snapshot_dt`   and `bca`.`rnk` = 1   left join `sgmisit`.`sgmi_collateral_type_dat` `coltp`   on `tcdr`.`collateral_contract_type` = `coltp`.`collateral_code`   and `coltp`.`etl_current_record_flag` = 'Y'   left join `sgmisit`.`sgmi_sme_product` `smeprod`   on `tcdr`.`contract_type` = `smeprod`.`contract_type`   LEFT JOIN `sgmisit`.`SGMI_BOOK_CD_D` `BOOK`    ON `tcdr`.`dealbook`  =`book`.`book_wid` AND `tcdr`.`w_datasource_id` = `book`.`w_datasource_id` AND `tcdr`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE`    ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`    AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`     LEFT JOIN `sgmisitstg`.`stg_bcrs_crm_sr` `crmsr`   on NVL(trim(`tcdr`.`collateral_reference`),trim(`tcdr`.`guarantee_reference`)) = `crmsr`.`contract_reference`          and    CASE WHEN 'WS7' like '%ADJ%' THEN `crmsr`.`w_batch_id` = '2018081423444300838' ELSE `crmsr`.`w_batch_id` = '2018071113463400417' END   WHERE          `tcdr`.`w_batch_id` = '2018071113463400417'
CREATE VIEW `temp_src_query_1808271847280098682` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no`  ,  `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  case when `comb`.`transaction_type` = 'EXPOSURE' then nvl(`limit_cl`.`client_wid`,`comb`.`client_wid`) else `comb`.`client_wid` end `client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `cl`.`client_group_name` AS `Client_Group_Name`, `cl`.`client_group_id` AS `Client_Group_Code`, `cl`.`client_group_segment_id` AS `Client_Group_Segement`, `cl`.`client_group_domicile_loc` AS `Client_Group_Domicile_Country`, `cl`.`client_name` AS `Client_Name`, `cl`.`client_le_name` AS `Customer_Main_Profile_Name`, `cl`.`client_le_id` AS `Customer_Main_Profile_Identification_Number_LE_ID`, `cl`.`client_pri_ind_id` , `cl`.`client_segment_sub_category_id`, `cl`.`client_segment_desc`, `cl`.`client_subsegment_desc`, `obl`.`client_group_name` AS `Obligor_Client_Group_Name`, `obl`.`client_group_id` AS `Obligor_Client_Group_Code`, `obl`.`client_group_segment_id` AS `Obligor_Client_Group_Segement`, `obl`.`client_group_domicile_loc` AS `Obligor_Client_Group_Domicile_Country`, `obl`.`client_name` AS `Obligor_Name`, `obl`.`client_id`  AS `Obligor_ID`, `obl`.`client_le_name` AS `Obl_Customer_Main_Profile_Name`, `obl`.`client_le_id` AS `Obl_Customer_Main_Profile_Identification_Number_LE_ID`, `obl`.`client_pri_ind_id` as `obl_client_pri_ind_id`, `obl`.`client_segment_sub_category_id` as `obl_segment_sub_category_id`, `obl`.`client_segment_desc` as `obl_segment_desc`, `obl`.`client_subsegment_desc` as `obl_subsegment_desc`, `limit_cl`.`client_group_name` AS `Limit_Client_Group_Name`, `limit_cl`.`client_group_id` AS `Limit_Client_Group_Code`, `limit_cl`.`client_group_segment_id` AS `Limit_Client_Group_Segement`, `limit_cl`.`client_group_domicile_loc` AS `Limit_Client_Group_Domicile_Country`, `limit_cl`.`client_name` AS `Limit_Client_Name`, `limit_cl`.`client_id`  AS `Limit_Client_ID`, `limit_cl`.`client_le_name` AS `Limit_Customer_Main_Profile_Name`, `limit_cl`.`client_le_id` AS `Limit_Customer_Main_Profile_Identification_Number_LE_ID`, `limit_cl`.`client_pri_ind_id` as `limit_client_pri_ind_id`, `gua`.`client_group_name` AS `Guarantor_Client_Group_Name`, `gua`.`client_group_id` AS `Guarantor_Client_Group_Code`, `gua`.`client_group_segment_id` AS `Guarantor_Client_Group_Segement`, `gua`.`client_group_domicile_loc` AS `Guarantor_Client_Group_Domicile_Country`, `gua`.`client_name` AS `Guarantor_Name`, `gua`.`client_id`  AS `Guarantor_ID`, `gua`.`client_le_name` AS `Guarantor_Customer_Main_Profile_Name`, `gua`.`client_le_id` AS `Guarantor_Customer_Main_Profile_Identification_Number_LE_ID`, `gua`.`client_pri_ind_id` as `Guarantor_client_pri_ind_id`, `coll_owner`.`client_group_name` AS `Coll_Owner_Client_Group_Name`, `coll_owner`.`client_group_id` AS `Coll_Owner_Client_Group_Code`, `coll_owner`.`client_group_segment_id` AS `Coll_Owner_Client_Group_Segement`, `coll_owner`.`client_group_domicile_loc` AS `Coll_Owner_Client_Group_Domicile_Country`, `coll_owner`.`client_name` AS `Coll_Owner_Name`, `coll_owner`.`client_id`  AS `Coll_Owner_ID`, `coll_owner`.`client_le_name` AS `Coll_Owner_Customer_Main_Profile_Name`, `coll_owner`.`client_le_id` AS `Coll_Owner_Customer_Main_Profile_Identification_Number_LE_ID`, `coll_owner`.`client_pri_ind_id` as `Collateral_Owner_pri_ind_id`, `cl`.`client_domicile_loc_id` As `cl_client_domicile_loc_id`, `cl`.`client_group_domicile_loc` As `cl_client_group_domicile_loc`, `cl`.`coi_loc_id` As `cl_coi_loc_id`, `cl`.`client_segment_category_id` As `cl_client_segment_category_id`, `obl`.`client_domicile_loc_id` As `Obl_client_domicile_loc_id`, `obl`.`client_group_domicile_loc` As `Obl_client_group_domicile_loc`, `obl`.`coi_loc_id` As `Obl_coi_loc_id`, `obl`.`client_segment_category_id` As `Obl_client_segment_category_id`, `limit_cl`.`client_domicile_loc_id` As `limit_cl_client_domicile_loc_id`, `limit_cl`.`client_group_domicile_loc` As `limit_cl_client_group_domicile_loc`, `limit_cl`.`coi_loc_id` As `limit_cl_coi_loc_id`, `limit_cl`.`client_segment_category_id` As `limit_cl_client_segment_category_id`, `gua`.`client_domicile_loc_id` As `Gua_client_domicile_loc_id`, `gua`.`client_group_domicile_loc` As `Gua_client_group_domicile_loc`, `gua`.`coi_loc_id` As `Gua_coi_loc_id`, `gua`.`client_segment_category_id` As `Gua_client_segment_category_id`, `coll_owner`.`client_domicile_loc_id` As `coll_owner_client_domicile_loc_id`, `coll_owner`.`client_group_domicile_loc` As `coll_owner_client_group_domicile_loc`, `coll_owner`.`coi_loc_id` As `coll_owner_coi_loc_id`, `coll_owner`.`client_segment_category_id` As `coll_owner_client_segment_category_id`, `limit_cl`.`client_segment_sub_category_id` as `limit_client_segment_sub_category_id`, `limit_cl`.`client_segment_desc` as `limit_client_segment_desc`, `limit_cl`.`client_subsegment_desc` as `limit_client_subsegment_desc`, `gua`.`client_segment_sub_category_id` as `Guarantor_client_segment_sub_category_id`, `gua`.`client_segment_desc` as `Guarantor_client_segment_desc`, `gua`.`client_subsegment_desc` as `Guarantor_client_subsegment_desc`, `coll_owner`.`client_segment_sub_category_id` as `Coll_Owner_client_segment_sub_category_id`, `coll_owner`.`client_segment_desc` as `Coll_Owner_client_segment_desc`, `coll_owner`.`client_subsegment_desc` as `Coll_Owner_client_subsegment_desc`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `exp_f`.`reporting_currency`  as  `Reporting_Currency`, `exp_f`.`company_reg_no`  as `Company_Reg_No`, `exp_f`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `exp_f`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`obl_client_segment_category_id` AS `Client_Segment_Category`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`  *  1 AS `HE`, `exp_f`.`hfx`  *  1 AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`  *  1 AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`  *  1 AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`  *  1 AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`  *  1 AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`  *  1 AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`  *  1 AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`  *  1 AS `RW_NEW`, `exp_f`.`rw_original` *  1 AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor` *  1 AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor` *  1 AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`  *  1 AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n` *  1 AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new` *  1 AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original` *  1 AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * 1   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * 1   AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * 1   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel` * 1   AS `BEEL`, `exp_f`.`guarantee_bis_product` AS `BIS_PRODUCT`, `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, `exp_f`.`ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_SQUARE`, `exp_f`.`effective_matirity` * 1   AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd` * 1   AS `FINAL_PD`, `exp_f`.`hc` * 1   AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`, `exp_f`.`mru_identifier` AS `MRU`, `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd` * 1   AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new` * 1   AS `PD_NEW`, `exp_f`.`pd_original` * 1   AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`wt_pd_new` * 1   AS `Wt_LGD_Pdnew`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`, `exp_f`.`exposure_wo_mtm`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Mark_To_Market_MTM`, `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * 1   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * 1   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * 1   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd` * 1   AS `LGD`, `exp_f`.`wt_lgd` * 1   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * 1   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * 1   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Expected_Loss`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity` * 1   AS `Residual_Maturity`, `exp_f`.`k_maturity` * 1   AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  `exp_f`.`l7_mgt_prod_code` AS `L7_Mgt_Prod_Code`, `exp_f`.`l7_mgt_prod_desc` AS `L7_Mgt_Prod_Desc`, `exp_f`.`l6_mgt_prod_subfamily_code` AS `L6_Mgt_Prod_Subfamily_Code`, `exp_f`.`l6_mgt_prod_subfamily_desc` AS `L6_Mgt_Prod_Subfamily_Desc`, `exp_f`.`l5_mgt_prod_family_code` AS `L5_Mgt_Prod_Family_Code`, `exp_f`.`l5_mgt_prod_family_desc` AS `L5_Mgt_Prod_Family_Desc`, `exp_f`.`l4_mgt_prod_subseg_code` AS `L4_Mgt_Prod_SubSeg_Code`, `exp_f`.`l4_mgt_prod_subseg_desc` AS `L4_Mgt_Prod_SubSeg_Desc`, `exp_f`.`l3_mgt_prod_seg_code` AS `L3_Mgt_Prod_Seg_Code`, `exp_f`.`l3_mgt_prod_seg_desc` AS `L3_Mgt_Prod_Seg_Desc`, `exp_f`.`l2_mgt_prod_subarea_code` AS `L2_Mgt_Prod_SubArea_Code`, `exp_f`.`l2_mgt_prod_subarea_desc` AS `L2_Mgt_Prod_SubArea_Desc`, `exp_f`.`l1_mgt_prod_area_code` AS `L1_Mgt_Prod_Area_Code`, `exp_f`.`l1_mgt_prod_area_desc` AS `L1_Mgt_Prod_Area_Desc`, `exp_f`.`l0_mgt_prod_cat_code` AS `L0_Mgt_Prod_Cat_Code`, `exp_f`.`l0_mgt_prod_cat_desc` AS `L0_Mgt_Prod_Cat_Desc`, `exp_f`.`mgt_prod_grouping_code` AS `Mgt_Prod_Grouping_Code`, `exp_f`.`mgt_prod_grouping` AS `Mgt_Prod_Grouping`, `exp_f`.`product_xsell_mapping` AS `Product_Xsell_Mapping`, `exp_f`.`x_sell_mapping_desc` AS `X_Sell_Mapping_Desc`, `exp_f`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , `exp_f`.`from_currency` AS  `From_Currency`, `exp_f`.`nd_rate` AS  `Exchange_Rate`, `exp_f`.`to_currency` AS  `To_Currency`, `exp_f`.`exchange_rate_date` AS  `Exchange_Rate_Date`, `exp_f`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `exp_f`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `exp_f`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `exp_f`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `exp_f`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `exp_f`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `exp_f`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `exp_f`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `exp_f`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `exp_f`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `exp_f`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `exp_f`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `exp_f`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `exp_f`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, `standard_prod`.`standard_product_code` as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, `cty`.`internal_country_region_code`, `cty`.`internal_country_region_description`, `cl`.`client_business_type`, `cl`.`client_entity_gl_criteria`, `cl`.`client_long_desc`, `cl`.`client_cva_exempted`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `exp_f`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`, `br`.`client_name` as `Broker_Name`, case when `comb`.`booking_loc_id`='SG' OR `ccr`.`country_code` ='SG' OR `lmt_ref`.`edm_limit_booking_loc` ='SG' then 'SG' else 'OTHERS' end AS `SECURITY_CTRY`, case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`  * 1 as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `exp_f`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_f`.`edm_limit_booking_loc` <> `lmt_f`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f_dn` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`                AND `exp_f`.`counterparty_original_wid`  = `comb`.`client_wid`      and `exp_f`.`w_snapshot_dt`= '2018-04-30' AND `exp_f`.`w_datasource_id` = 'BCRS_ND' AND `exp_f`.`w_country_cd` =  'SG' AND `exp_f`.`w_workspace` = 'WS36'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2018-04-30' AND `lmt_f`.`w_datasource_id` = 'BCRS_ND' AND `lmt_f`.`w_country_cd` =  'SG'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2018-04-30' AND `col_f`.`w_datasource_id` = 'BCRS_ND' AND `col_f`.`w_country_cd` =  'SG' AND `col_f`.`w_workspace` = split('WS36','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2018-04-30' AND `lmt_ref`.`w_datasource_id` = 'BCRS_ND' AND `lmt_ref`.`w_country_cd` =  'SG'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2018-04-30' AND `col_ref`.`w_datasource_id` = 'BCRS_ND' AND `col_ref`.`w_country_cd` =  'SG' AND `col_ref`.`w_workspace` = split('WS36','_ADJ')[0]          left join `sgmisit`.`sgmi_crm_contract_ref_f` `gua_ref` on `exp_f`.`guarantee_ref_no` = `gua_ref`.`crm_contract_ref_no`        and `gua_ref`.`w_snapshot_dt`= '2018-04-30' AND `gua_ref`.`w_datasource_id` = 'BCRS_ND' AND `gua_ref`.`w_country_cd` =  'SG' AND `gua_ref`.`w_workspace` = split('WS36','_ADJ')[0]      LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on   `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid`    and `limit_cl`.`w_snapshot_dt`= '2018-04-30' AND `limit_cl`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `cl` on  `cl`.`client_wid`  = case when `comb`.`transaction_type` = 'EXPOSURE' then nvl(`limit_cl`.`client_wid`,`comb`.`client_wid`) else `comb`.`client_wid` end          and `cl`.`w_snapshot_dt`= '2018-04-30' AND `cl`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `Obl` on  `obl`.`client_wid`  = `exp_f`.`counterparty_original_wid`              and `obl`.`w_snapshot_dt`= '2018-04-30' AND `obl`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `Gua` on   `gua`.`client_wid`  = `gua_ref`.`client_id`   and `gua`.`w_snapshot_dt`= '2018-04-30' AND `gua`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id`   and `coll_owner`.`w_snapshot_dt`= '2018-04-30' AND `coll_owner`.`w_datasource_id` = 'BCRS_ND'     LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CTY` ON `cl`.`client_domicile_loc_id`=`cty`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `Cl`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `Cl`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2018-04-30' AND `br`.`w_datasource_id` = 'BCRS_ND'  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_ND'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2018-04-30' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2018-04-30' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2018-04-30' and `exc_rate_usd`.`w_datasource_id`='BCRS_ND' and `exp_f`.`ccy_cd` = `exc_rate_usd`.`currency_id`   where  `comb`.`w_snapshot_dt`= '2018-04-30' AND `comb`.`w_datasource_id` = 'BCRS_ND' AND `comb`.`w_country_cd` =  'SG' AND `comb`.`w_workspace`='WS36'  AND (`comb`.`booking_loc_id`='SG' OR `ccr`.`country_code` ='SG' OR `lmt_ref`.`edm_limit_booking_loc` ='SG')
CREATE VIEW `temp_src_query_1808291031060067341` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no`  ,  `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity`    AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new`    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original`    AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, `exp_f`.`ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity`    AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd`    AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff`    AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd`    AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm`    as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd`    AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'UNMAPPED') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'UNMAPPED') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'UNMAPPED') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'UNMAPPED') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'UNMAPPED') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'UNMAPPED') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'UNMAPPED') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'UNMAPPED') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'UNMAPPED') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, `standard_prod`.`standard_product_code` as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `exp_f`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`, case when `comb`.`booking_loc_id`='SG' OR `ccr`.`country_code` ='SG' OR `lmt_ref`.`edm_limit_booking_loc` ='SG' then 'SG' else 'OTHERS' end AS `SECURITY_CTRY`, case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `exp_f`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_f`.`edm_limit_booking_loc` <> `lmt_f`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, `exp_f`.`ccr_eq_cntry`,  `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`, `exp_f`.`management_prod_wid`, `exp_f`.`management_prod_id`, `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`                AND `exp_f`.`counterparty_original_wid`  = `comb`.`client_wid`      and `exp_f`.`w_snapshot_dt`= '2018-04-30' AND `exp_f`.`w_datasource_id` = 'BCRS_PRA' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS7'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2018-04-30' AND `lmt_f`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2018-04-30' AND `col_f`.`w_datasource_id` = 'BCRS_PRA' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS7','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2018-04-30' AND `lmt_ref`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2018-04-30' AND `col_ref`.`w_datasource_id` = 'BCRS_PRA' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS7','_ADJ')[0]          left join `sgmisit`.`sgmi_crm_contract_ref_f` `gua_ref` on `exp_f`.`guarantee_ref_no` = `gua_ref`.`crm_contract_ref_no`        and `gua_ref`.`w_snapshot_dt`= '2018-04-30' AND `gua_ref`.`w_datasource_id` = 'BCRS_PRA' AND `gua_ref`.`w_country_cd` =  'ALL' AND `gua_ref`.`w_workspace` = split('WS7','_ADJ')[0]      LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2018-04-30' AND `obl`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2018-04-30' AND `gua`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2018-04-30' AND `client`.`w_datasource_id`='BCRS_PRA' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2018-04-30' AND `limit_cl`.`w_datasource_id` = 'BCRS_PRA'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2018-04-30' AND `coll_owner`.`w_datasource_id` = 'BCRS_PRA'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2018-04-30' AND `br`.`w_datasource_id` = 'BCRS_PRA'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_PRA'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2018-04-30' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2018-04-30' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2018-04-30' and `exc_rate_usd`.`w_datasource_id`='BCRS_PRA' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_PRA' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`     LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = `exp_f`.`management_prod_wid`                   AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`     LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2018-04-30' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`                 where  `comb`.`w_snapshot_dt`= '2018-04-30' AND `comb`.`w_datasource_id` = 'BCRS_PRA' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS7'  AND (`comb`.`booking_loc_id`='SG' OR `ccr`.`country_code` ='SG' OR `lmt_ref`.`edm_limit_booking_loc` ='SG')
CREATE VIEW `temp_src_query_1808291034430024846` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no`  ,  `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity`    AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new`    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original`    AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, `exp_f`.`ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity`    AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd`    AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff`    AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd`    AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm`    as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd`    AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'UNMAPPED') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'UNMAPPED') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'UNMAPPED') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'UNMAPPED') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'UNMAPPED') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'UNMAPPED') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'UNMAPPED') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'UNMAPPED') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'UNMAPPED') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, `standard_prod`.`standard_product_code` as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `exp_f`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`, case when `comb`.`booking_loc_id`='SG' OR `ccr`.`country_code` ='SG' OR `lmt_ref`.`edm_limit_booking_loc` ='SG' then 'SG' else 'OTHERS' end AS `SECURITY_CTRY`, case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `exp_f`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_f`.`edm_limit_booking_loc` <> `lmt_f`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, `exp_f`.`ccr_eq_cntry`,  `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`, `exp_f`.`management_prod_wid`, `exp_f`.`management_prod_id`, `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`                AND `exp_f`.`counterparty_original_wid`  = `comb`.`client_wid`      and `exp_f`.`w_snapshot_dt`= '2018-04-30' AND `exp_f`.`w_datasource_id` = 'BCRS_PRA' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS7'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2018-04-30' AND `lmt_f`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2018-04-30' AND `col_f`.`w_datasource_id` = 'BCRS_PRA' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS7','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2018-04-30' AND `lmt_ref`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2018-04-30' AND `col_ref`.`w_datasource_id` = 'BCRS_PRA' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS7','_ADJ')[0]          left join `sgmisit`.`sgmi_crm_contract_ref_f` `gua_ref` on `exp_f`.`guarantee_ref_no` = `gua_ref`.`crm_contract_ref_no`        and `gua_ref`.`w_snapshot_dt`= '2018-04-30' AND `gua_ref`.`w_datasource_id` = 'BCRS_PRA' AND `gua_ref`.`w_country_cd` =  'ALL' AND `gua_ref`.`w_workspace` = split('WS7','_ADJ')[0]      LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2018-04-30' AND `obl`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2018-04-30' AND `gua`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2018-04-30' AND `client`.`w_datasource_id`='BCRS_PRA' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2018-04-30' AND `limit_cl`.`w_datasource_id` = 'BCRS_PRA'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2018-04-30' AND `coll_owner`.`w_datasource_id` = 'BCRS_PRA'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2018-04-30' AND `br`.`w_datasource_id` = 'BCRS_PRA'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_PRA'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2018-04-30' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2018-04-30' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2018-04-30' and `exc_rate_usd`.`w_datasource_id`='BCRS_PRA' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_PRA' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`     LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = `exp_f`.`management_prod_wid`                   AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`     LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2018-04-30' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`                 where  `comb`.`w_snapshot_dt`= '2018-04-30' AND `comb`.`w_datasource_id` = 'BCRS_PRA' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS7'  AND (`comb`.`booking_loc_id`='SG' OR `ccr`.`country_code` ='SG' OR `lmt_ref`.`edm_limit_booking_loc` ='SG')
CREATE VIEW `temp_src_query_1809021059480040390` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no`  ,  `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity`    AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new`    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original`    AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, `exp_f`.`ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity`    AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd`    AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff`    AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd`    AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm`    as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd`    AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'UNMAPPED') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'UNMAPPED') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'UNMAPPED') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'UNMAPPED') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'UNMAPPED') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'UNMAPPED') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'UNMAPPED') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'UNMAPPED') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'UNMAPPED') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, `standard_prod`.`standard_product_code` as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `exp_f`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`, case when `comb`.`booking_loc_id`='SG' OR `ccr`.`country_code` ='SG' OR `lmt_ref`.`edm_limit_booking_loc` ='SG' then 'SG' else 'OTHERS' end AS `SECURITY_CTRY`, case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `exp_f`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_f`.`edm_limit_booking_loc` <> `lmt_f`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, `exp_f`.`ccr_eq_cntry`,  `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`, `exp_f`.`management_prod_wid`, `exp_f`.`management_prod_id`, `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`                AND `exp_f`.`counterparty_original_wid`  = `comb`.`client_wid`      and `exp_f`.`w_snapshot_dt`= '2018-04-30' AND `exp_f`.`w_datasource_id` = 'BCRS_ND' AND `exp_f`.`w_country_cd` =  'SG' AND `exp_f`.`w_workspace` = 'WS29'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2018-04-30' AND `lmt_f`.`w_datasource_id` = 'BCRS_ND' AND `lmt_f`.`w_country_cd` =  'SG'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2018-04-30' AND `col_f`.`w_datasource_id` = 'BCRS_ND' AND `col_f`.`w_country_cd` =  'SG' AND `col_f`.`w_workspace` = split('WS29','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2018-04-30' AND `lmt_ref`.`w_datasource_id` = 'BCRS_ND' AND `lmt_ref`.`w_country_cd` =  'SG'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2018-04-30' AND `col_ref`.`w_datasource_id` = 'BCRS_ND' AND `col_ref`.`w_country_cd` =  'SG' AND `col_ref`.`w_workspace` = split('WS29','_ADJ')[0]          left join `sgmisit`.`sgmi_crm_contract_ref_f` `gua_ref` on `exp_f`.`guarantee_ref_no` = `gua_ref`.`crm_contract_ref_no`        and `gua_ref`.`w_snapshot_dt`= '2018-04-30' AND `gua_ref`.`w_datasource_id` = 'BCRS_ND' AND `gua_ref`.`w_country_cd` =  'SG' AND `gua_ref`.`w_workspace` = split('WS29','_ADJ')[0]      LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2018-04-30' AND `obl`.`w_datasource_id`='BCRS_ND' AND `obl`.`w_country_cd`='SG'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2018-04-30' AND `gua`.`w_datasource_id`='BCRS_ND' AND `obl`.`w_country_cd`='SG'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2018-04-30' AND `client`.`w_datasource_id`='BCRS_ND' AND `client`.`w_country_cd`='SG'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2018-04-30' AND `limit_cl`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2018-04-30' AND `coll_owner`.`w_datasource_id` = 'BCRS_ND'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2018-04-30' AND `br`.`w_datasource_id` = 'BCRS_ND'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_ND'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2018-04-30' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2018-04-30' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2018-04-30' and `exc_rate_usd`.`w_datasource_id`='BCRS_ND' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_ND' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`     LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = `exp_f`.`management_prod_wid`                   AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`     LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2018-04-30' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_ND' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='SG'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`                 where  `comb`.`w_snapshot_dt`= '2018-04-30' AND `comb`.`w_datasource_id` = 'BCRS_ND' AND `comb`.`w_country_cd` =  'SG' AND `comb`.`w_workspace`='WS29'  AND (`comb`.`booking_loc_id`='SG' OR `ccr`.`country_code` ='SG' OR `lmt_ref`.`edm_limit_booking_loc` ='SG')
CREATE VIEW `temp_src_query_1811121723530033426` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no`  ,  `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, `standard_prod`.`standard_product_code` as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `exp_f`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`, case when `comb`.`booking_loc_id`='SG' OR   IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`) in ('SG','UNMAPPED') OR   `lmt_ref`.`edm_limit_booking_loc` ='SG' then 'SG' else 'OTHERS' end AS `SECURITY_CTRY`, case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `exp_f`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_f`.`edm_limit_booking_loc` <> `lmt_f`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`) `ccr_eq_cntry`,  `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`, `exp_f`.`management_prod_wid`, `exp_f`.`management_prod_id`, `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,  `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2018-05-31' AND `exp_f`.`w_datasource_id` = 'BCRS_PRA' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS9'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2018-05-31' AND `lmt_f`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2018-05-31' AND `col_f`.`w_datasource_id` = 'BCRS_PRA' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS9','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2018-05-31' AND `lmt_ref`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2018-05-31' AND `col_ref`.`w_datasource_id` = 'BCRS_PRA' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS9','_ADJ')[0]          left join `sgmisit`.`sgmi_crm_contract_ref_f` `gua_ref` on `exp_f`.`guarantee_ref_no` = `gua_ref`.`crm_contract_ref_no`        and `gua_ref`.`w_snapshot_dt`= '2018-05-31' AND `gua_ref`.`w_datasource_id` = 'BCRS_PRA' AND `gua_ref`.`w_country_cd` =  'ALL' AND `gua_ref`.`w_workspace` = split('WS9','_ADJ')[0]      LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2018-05-31' AND `obl`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2018-05-31' AND `gua`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2018-05-31' AND `client`.`w_datasource_id`='BCRS_PRA' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2018-05-31' AND `limit_cl`.`w_datasource_id` = 'BCRS_PRA'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2018-05-31' AND `coll_owner`.`w_datasource_id` = 'BCRS_PRA'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2018-05-31' AND `br`.`w_datasource_id` = 'BCRS_PRA'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_PRA'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2018-05-31' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2018-05-31' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2018-05-31' and `exc_rate_usd`.`w_datasource_id`='BCRS_PRA' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_PRA' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`     LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = `exp_f`.`management_prod_wid`                   AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`     LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2018-05-31' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2018-05-31'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`        where  `comb`.`w_snapshot_dt`= '2018-05-31' AND `comb`.`w_datasource_id` = 'BCRS_PRA' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS9'    AND (`comb`.`booking_loc_id`='SG' OR  IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`)  IN ('SG','UNMAPPED') OR    `lmt_ref`.`edm_limit_booking_loc` ='SG')
CREATE VIEW `temp_src_query_2109222203290056333` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`,  case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `SECURITY_CTRY`,  case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `ccr_eq_cntry`, `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-03-31' AND `exp_f`.`w_datasource_id` = 'BCRS_PRA' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS7'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-03-31' AND `lmt_f`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-03-31' AND `col_f`.`w_datasource_id` = 'BCRS_PRA' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS7','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-03-31' AND `lmt_ref`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-03-31' AND `col_ref`.`w_datasource_id` = 'BCRS_PRA' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS7','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-03-31' AND `obl`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-03-31' AND `gua`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-03-31' AND `client`.`w_datasource_id`='BCRS_PRA' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-03-31' AND `limit_cl`.`w_datasource_id` = 'BCRS_PRA'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-03-31' AND `coll_owner`.`w_datasource_id` = 'BCRS_PRA'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-03-31' AND `br`.`w_datasource_id` = 'BCRS_PRA'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_PRA'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-03-31' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-03-31' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-03-31' and `exc_rate_usd`.`w_datasource_id`='BCRS_PRA' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_PRA' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-03-31' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-03-31'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-03-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-03-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-03-31'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021092212555600620'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-03-31' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-03-31' AND `comb`.`w_datasource_id` = 'BCRS_PRA' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS7'
CREATE VIEW `temp_src_query_2109240815040033173` AS select   `stg_bcrs_t_opr`.`conso_perimeter` `conso_perimeter`, `stg_bcrs_t_opr`.`interco` `interco`, `stg_bcrs_t_opr`.`interco_type` `interco_type`, `stg_bcrs_t_opr`.`valid_cpy_perimeter` `valid_cpy_perimeter`, `stg_bcrs_t_opr`.`issuer_id` `issuer_id`, `stg_bcrs_t_opr`.`approver_id` `approver_id`, `stg_bcrs_t_opr`.`upload_date` `upload_date`, `stg_bcrs_t_opr`.`approval_date` `approval_date`, `stg_bcrs_t_opr`.`adj_batch_date` `adj_batch_date`, `stg_bcrs_t_opr`.`source_file_name` `source_file_name`, `stg_bcrs_t_opr`.`adj_seq` `adj_seq`, `stg_bcrs_t_opr`.`dp_rule_log` `dp_rule_log`, `stg_bcrs_t_opr`.`partition_key` `partition_key`, `stg_bcrs_t_opr`.`id` `id`, `stg_bcrs_t_opr`.`alpha_factor` `alpha_factor`, `stg_bcrs_t_opr`.`beta_factor` `beta_factor`, `stg_bcrs_t_opr`.`bis_business_line_code` `bis_business_line_code`, `stg_bcrs_t_opr`.`business_line_code` `business_line_code`, `stg_bcrs_t_opr`.`ccy_code` `ccy_code`, `stg_bcrs_t_opr`.`company_code` `company_code`, `stg_bcrs_t_opr`.`el` `el`, `stg_bcrs_t_opr`.`factor_applied` `factor_applied`, `stg_bcrs_t_opr`.`gross_income_value` `gross_income_value`, `stg_bcrs_t_opr`.`m` `m`, `stg_bcrs_t_opr`.`method` `method`, `stg_bcrs_t_opr`.`number_of_year` `number_of_year`, `stg_bcrs_t_opr`.`retail_value` `retail_value`, `stg_bcrs_t_opr`.`rgc` `rgc`, `stg_bcrs_t_opr`.`value_date` `value_date`, `stg_bcrs_t_opr`.`value_eff` `value_eff`, `stg_bcrs_t_opr`.`booking_company` `booking_company`, `stg_bcrs_t_opr`.`booking_company_desc` `booking_company_desc`, `stg_bcrs_t_opr`.`supervisor_code` `supervisor_code`, `stg_bcrs_t_opr`.`gaap_code` `gaap_code`, `stg_bcrs_t_opr`.`rgc_guar` `rgc_guar`, `stg_bcrs_t_opr`.`rgc_insured` `rgc_insured`, `stg_bcrs_t_opr`.`guar_excess` `guar_excess`, `stg_bcrs_t_opr`.`import_source` `import_source`, `stg_bcrs_t_opr`.`flag_adjustment` `flag_adjustment`, `stg_bcrs_t_opr`.`nominal` `nominal`, `stg_bcrs_t_opr`.`bis_income_expense_type` `bis_income_expense_type`, `stg_bcrs_t_opr`.`fdw_income_expense_type` `fdw_income_expense_type`, `stg_bcrs_t_opr`.`parent_id` `parent_id`, `stg_bcrs_t_opr`.`child_id` `child_id`, `stg_bcrs_t_opr`.`staging_source` `staging_source`, `stg_bcrs_t_opr`.`src_reporting_date` `src_reporting_date`, `stg_bcrs_t_opr`.`src_wks_name` `src_wks_name`, `stg_bcrs_t_opr`.`src_position` `src_position`, `stg_bcrs_t_opr`.`generic_reporting_date` `generic_reporting_date`, `stg_bcrs_t_opr`.`generic_wks_name` `generic_wks_name`, `stg_bcrs_t_opr`.`generic_position` `generic_position`, `stg_bcrs_t_opr`.`generic_field1` `generic_field1`, `stg_bcrs_t_opr`.`generic_field2` `generic_field2`, `stg_bcrs_t_opr`.`generic_field3` `generic_field3`, `stg_bcrs_t_opr`.`generic_field4` `generic_field4`, `stg_bcrs_t_opr`.`generic_field5` `generic_field5`, `stg_bcrs_t_opr`.`generic_field6` `generic_field6`, `stg_bcrs_t_opr`.`generic_field7` `generic_field7`, `stg_bcrs_t_opr`.`generic_field8` `generic_field8`, `stg_bcrs_t_opr`.`generic_field9` `generic_field9`, `stg_bcrs_t_opr`.`generic_field10` `generic_field10`, `stg_bcrs_t_opr`.`generic_number1` `generic_number1`, `stg_bcrs_t_opr`.`generic_number2` `generic_number2`, `stg_bcrs_t_opr`.`generic_number3` `generic_number3`, `stg_bcrs_t_opr`.`generic_number4` `generic_number4`, `stg_bcrs_t_opr`.`generic_number5` `generic_number5`, `stg_bcrs_t_opr`.`generic_number6` `generic_number6`, `stg_bcrs_t_opr`.`generic_number7` `generic_number7`, `stg_bcrs_t_opr`.`generic_number8` `generic_number8`, `stg_bcrs_t_opr`.`generic_number9` `generic_number9`, `stg_bcrs_t_opr`.`generic_number10` `generic_number10`, `stg_bcrs_t_opr`.`customer_field1` `customer_field1`, `stg_bcrs_t_opr`.`customer_field2` `customer_field2`, `stg_bcrs_t_opr`.`customer_field3` `customer_field3`, `stg_bcrs_t_opr`.`customer_field4` `customer_field4`, `stg_bcrs_t_opr`.`customer_field5` `customer_field5`, `stg_bcrs_t_opr`.`customer_field6` `customer_field6`, `stg_bcrs_t_opr`.`customer_field7` `customer_field7`, `stg_bcrs_t_opr`.`customer_field8` `customer_field8`, `stg_bcrs_t_opr`.`customer_field9` `customer_field9`, `stg_bcrs_t_opr`.`customer_field10` `customer_field10`, `stg_bcrs_t_opr`.`customer_number1` `customer_number1`, `stg_bcrs_t_opr`.`customer_number2` `customer_number2`, `stg_bcrs_t_opr`.`customer_number3` `customer_number3`, `stg_bcrs_t_opr`.`customer_number4` `customer_number4`, `stg_bcrs_t_opr`.`customer_number5` `customer_number5`, `stg_bcrs_t_opr`.`customer_number6` `customer_number6`, `stg_bcrs_t_opr`.`customer_number7` `customer_number7`, `stg_bcrs_t_opr`.`customer_number8` `customer_number8`, `stg_bcrs_t_opr`.`customer_number9` `customer_number9`, `stg_bcrs_t_opr`.`customer_number10` `customer_number10`, `stg_bcrs_t_opr`.`conservation_buffer` `conservation_buffer`, `stg_bcrs_t_opr`.`conservation_rgc` `conservation_rgc`, `stg_bcrs_t_opr`.`sifi_buffer` `sifi_buffer`, `stg_bcrs_t_opr`.`sifi_rgc` `sifi_rgc`, `stg_bcrs_t_opr`.`regulatory_scenario_name` `regulatory_scenario_name`, `stg_bcrs_t_opr`.`stress_testing_scenario_id` `stress_testing_scenario_id`, `stg_bcrs_t_opr`.`period_id` `period_id`, `stg_bcrs_t_opr`.`period_start_date` `period_start_date`, `stg_bcrs_t_opr`.`period_end_date` `period_end_date`, `stg_bcrs_t_opr`.`scenario_process_name` `scenario_process_name`, `stg_bcrs_t_opr`.`scenario_process_id` `scenario_process_id`, `stg_bcrs_t_opr`.`scenario_process_step` `scenario_process_step`  from `sgmisitstg`.`stg_bcrs_T_OPR` where `stg_bcrs_t_opr`.`w_batch_id`='2021092321122500573'
CREATE VIEW `temp_src_query_2109250716520044414` AS SELECT  `stg_bcrs_t_mr`.`partition_key` `partition_key`, `stg_bcrs_t_mr`.`supervisor_code` `supervisor_code`, `stg_bcrs_t_mr`.`company_code` `company_code`, `stg_bcrs_t_mr`.`ccy_code` `ccy_code`, `stg_bcrs_t_mr`.`gaap_code` `gaap_code`, `stg_bcrs_t_mr`.`booking_company` `booking_company`, `stg_bcrs_t_mr`.`underlying_risk` `underlying_risk`, `stg_bcrs_t_mr`.`risk_type` `risk_type`, `stg_bcrs_t_mr`.`position_type` `position_type`, `stg_bcrs_t_mr`.`method` `method`, `stg_bcrs_t_mr`.`sub_method` `sub_method`, `stg_bcrs_t_mr`.`irr_band_method` `irr_band_method`, `stg_bcrs_t_mr`.`underlying_table_id` `underlying_table_id`, `stg_bcrs_t_mr`.`contract_reference` `contract_reference`, `stg_bcrs_t_mr`.`table_name` `table_name`, `stg_bcrs_t_mr`.`underlying_reference` `underlying_reference`, `stg_bcrs_t_mr`.`underlying_table_name` `underlying_table_name`, `stg_bcrs_t_mr`.`deal_book_code` `deal_book_code`, `stg_bcrs_t_mr`.`trading` `trading`, `stg_bcrs_t_mr`.`currency_detail` `currency_detail`, `stg_bcrs_t_mr`.`exchange_rate` `exchange_rate`, `stg_bcrs_t_mr`.`long_short` `long_short`, `stg_bcrs_t_mr`.`put_call` `put_call`, `stg_bcrs_t_mr`.`fdw_contract_type` `fdw_contract_type`, `stg_bcrs_t_mr`.`mkr_product_type` `mkr_product_type`, `stg_bcrs_t_mr`.`mkr_product_category` `mkr_product_category`, `stg_bcrs_t_mr`.`mkr_asset_class` `mkr_asset_class`, `stg_bcrs_t_mr`.`mkr_asset_category` `mkr_asset_category`, `stg_bcrs_t_mr`.`under_mkr_product_type` `under_mkr_product_type`, `stg_bcrs_t_mr`.`under_mkr_product_category` `under_mkr_product_category`, `stg_bcrs_t_mr`.`fdw_entity_type` `fdw_entity_type`, `stg_bcrs_t_mr`.`issuer` `issuer`, `stg_bcrs_t_mr`.`issuer_incorporation_country` `issuer_incorporation_country`, `stg_bcrs_t_mr`.`country_group` `country_group`, `stg_bcrs_t_mr`.`bis_entity_type` `bis_entity_type`, `stg_bcrs_t_mr`.`bis_entity_category` `bis_entity_category`, `stg_bcrs_t_mr`.`grade_ind` `grade_ind`, `stg_bcrs_t_mr`.`risk_bucket` `risk_bucket`, `stg_bcrs_t_mr`.`qualifying` `qualifying`, `stg_bcrs_t_mr`.`rate_type` `rate_type`, `stg_bcrs_t_mr`.`rate_value` `rate_value`, `stg_bcrs_t_mr`.`assumed_change_yield` `assumed_change_yield`, `stg_bcrs_t_mr`.`yield` `yield`, `stg_bcrs_t_mr`.`duration` `duration`, `stg_bcrs_t_mr`.`modified_duration` `modified_duration`, `stg_bcrs_t_mr`.`position_date` `position_date`, `stg_bcrs_t_mr`.`irr_band` `irr_band`, `stg_bcrs_t_mr`.`irr_zone_begin` `irr_zone_begin`, `stg_bcrs_t_mr`.`irr_zone_end` `irr_zone_end`, `stg_bcrs_t_mr`.`irr_currency_group` `irr_currency_group`, `stg_bcrs_t_mr`.`mkr_index_code` `mkr_index_code`, `stg_bcrs_t_mr`.`mkr_index_category` `mkr_index_category`, `stg_bcrs_t_mr`.`irr_category_code` `irr_category_code`, `stg_bcrs_t_mr`.`currency_1` `currency_1`, `stg_bcrs_t_mr`.`currency_2` `currency_2`, `stg_bcrs_t_mr`.`fx_currency_group_code` `fx_currency_group_code`, `stg_bcrs_t_mr`.`fx_currency_group` `fx_currency_group`, `stg_bcrs_t_mr`.`fx_currency_group_category` `fx_currency_group_category`, `stg_bcrs_t_mr`.`mkr_fx_position_type` `mkr_fx_position_type`, `stg_bcrs_t_mr`.`structural_hedged_position` `structural_hedged_position`, `stg_bcrs_t_mr`.`arbitrage_strategy` `arbitrage_strategy`, `stg_bcrs_t_mr`.`codifier` `codifier`, `stg_bcrs_t_mr`.`security_external_code` `security_external_code`, `stg_bcrs_t_mr`.`national_market` `national_market`, `stg_bcrs_t_mr`.`is_liquid` `is_liquid`, `stg_bcrs_t_mr`.`is_diversified` `is_diversified`, `stg_bcrs_t_mr`.`is_listed` `is_listed`, `stg_bcrs_t_mr`.`beta_portfolio` `beta_portfolio`, `stg_bcrs_t_mr`.`diversification_ratio` `diversification_ratio`, `stg_bcrs_t_mr`.`recognized_index` `recognized_index`, `stg_bcrs_t_mr`.`diversified_index` `diversified_index`, `stg_bcrs_t_mr`.`underwriting_weight` `underwriting_weight`, `stg_bcrs_t_mr`.`underwriting_position_red` `underwriting_position_red`, `stg_bcrs_t_mr`.`residual_maturity` `residual_maturity`, `stg_bcrs_t_mr`.`booking_company_desc` `booking_company_desc`, `stg_bcrs_t_mr`.`booking_company_type` `booking_company_type`, `stg_bcrs_t_mr`.`booking_company_incorp_country` `booking_company_incorp_country`, `stg_bcrs_t_mr`.`regulation` `regulation`, `stg_bcrs_t_mr`.`premium` `premium`, `stg_bcrs_t_mr`.`underlying_market_value` `underlying_market_value`, `stg_bcrs_t_mr`.`volatility_change` `volatility_change`, `stg_bcrs_t_mr`.`volatility` `volatility`, `stg_bcrs_t_mr`.`delta` `delta`, `stg_bcrs_t_mr`.`gamma` `gamma`, `stg_bcrs_t_mr`.`vega` `vega`, `stg_bcrs_t_mr`.`vega_risk` `vega_risk`, `stg_bcrs_t_mr`.`gamma_risk` `gamma_risk`, `stg_bcrs_t_mr`.`vega_impact` `vega_impact`, `stg_bcrs_t_mr`.`gamma_impact` `gamma_impact`, `stg_bcrs_t_mr`.`in_the_money` `in_the_money`, `stg_bcrs_t_mr`.`amount_option_in_the_money` `amount_option_in_the_money`, `stg_bcrs_t_mr`.`naked` `naked`, `stg_bcrs_t_mr`.`consolidated` `consolidated`, `stg_bcrs_t_mr`.`stock_financing` `stock_financing`, `stg_bcrs_t_mr`.`commodity_reference` `commodity_reference`, `stg_bcrs_t_mr`.`mkr_commodity_code` `mkr_commodity_code`, `stg_bcrs_t_mr`.`bis_commodity_type` `bis_commodity_type`, `stg_bcrs_t_mr`.`commodity_band_begin` `commodity_band_begin`, `stg_bcrs_t_mr`.`commodity_band_end` `commodity_band_end`, `stg_bcrs_t_mr`.`exposure_formula` `exposure_formula`, `stg_bcrs_t_mr`.`linked_contract_reference` `linked_contract_reference`, `stg_bcrs_t_mr`.`linked_table_name` `linked_table_name`, `stg_bcrs_t_mr`.`financing_mode` `financing_mode`, `stg_bcrs_t_mr`.`financing_percentage` `financing_percentage`, `stg_bcrs_t_mr`.`with_parallel_contract` `with_parallel_contract`, `stg_bcrs_t_mr`.`ordered` `ordered`, `stg_bcrs_t_mr`.`binding_promise` `binding_promise`, `stg_bcrs_t_mr`.`right_to_recoup_loss` `right_to_recoup_loss`, `stg_bcrs_t_mr`.`deal_stage` `deal_stage`, `stg_bcrs_t_mr`.`purchase_at_maturity` `purchase_at_maturity`, `stg_bcrs_t_mr`.`adjustment_type` `adjustment_type`, `stg_bcrs_t_mr`.`matched_position` `matched_position`, `stg_bcrs_t_mr`.`unmatched_position` `unmatched_position`, `stg_bcrs_t_mr`.`weighted_position` `weighted_position`, `stg_bcrs_t_mr`.`exposure` `exposure`, `stg_bcrs_t_mr`.`credit_derivative_offset` `credit_derivative_offset`, `stg_bcrs_t_mr`.`commodity_offset` `commodity_offset`, `stg_bcrs_t_mr`.`netting_offset` `netting_offset`, `stg_bcrs_t_mr`.`effective_exposure` `effective_exposure`, `stg_bcrs_t_mr`.`scaling_factor` `scaling_factor`, `stg_bcrs_t_mr`.`exp1` `exp1`, `stg_bcrs_t_mr`.`exp2` `exp2`, `stg_bcrs_t_mr`.`exp3` `exp3`, `stg_bcrs_t_mr`.`spec_rw` `spec_rw`, `stg_bcrs_t_mr`.`gen_rw` `gen_rw`, `stg_bcrs_t_mr`.`rw` `rw`, `stg_bcrs_t_mr`.`rgc` `rgc`, `stg_bcrs_t_mr`.`tier1_deduction` `tier1_deduction`, `stg_bcrs_t_mr`.`tier2_deduction` `tier2_deduction`, `stg_bcrs_t_mr`.`capital_item` `capital_item`, `stg_bcrs_t_mr`.`industry_sector` `industry_sector`, `stg_bcrs_t_mr`.`bis_industry_sector` `bis_industry_sector`, `stg_bcrs_t_mr`.`economic_sector` `economic_sector`, `stg_bcrs_t_mr`.`risk_area` `risk_area`, `stg_bcrs_t_mr`.`bis_risk_area` `bis_risk_area`, `stg_bcrs_t_mr`.`risk_sub_area` `risk_sub_area`, `stg_bcrs_t_mr`.`bis_risk_sub_area` `bis_risk_sub_area`, `stg_bcrs_t_mr`.`deal_attribute_1` `deal_attribute_1`, `stg_bcrs_t_mr`.`deal_attribute_2` `deal_attribute_2`, `stg_bcrs_t_mr`.`deal_attribute_3` `deal_attribute_3`, `stg_bcrs_t_mr`.`deal_attribute_4` `deal_attribute_4`, `stg_bcrs_t_mr`.`deal_attribute_5` `deal_attribute_5`, `stg_bcrs_t_mr`.`deal_attribute_6` `deal_attribute_6`, `stg_bcrs_t_mr`.`deal_attribute_7` `deal_attribute_7`, `stg_bcrs_t_mr`.`deal_attribute_8` `deal_attribute_8`, `stg_bcrs_t_mr`.`deal_attribute_9` `deal_attribute_9`, `stg_bcrs_t_mr`.`flag_adjustment` `flag_adjustment`, `stg_bcrs_t_mr`.`src_reporting_date` `src_reporting_date`, `stg_bcrs_t_mr`.`src_wks_name` `src_wks_name`, `stg_bcrs_t_mr`.`src_position` `src_position`, `stg_bcrs_t_mr`.`generic_reporting_date` `generic_reporting_date`, `stg_bcrs_t_mr`.`generic_wks_name` `generic_wks_name`, `stg_bcrs_t_mr`.`generic_position` `generic_position`, `stg_bcrs_t_mr`.`generic_field1` `generic_field1`, `stg_bcrs_t_mr`.`generic_field2` `generic_field2`, `stg_bcrs_t_mr`.`generic_field3` `generic_field3`, `stg_bcrs_t_mr`.`generic_field4` `generic_field4`, `stg_bcrs_t_mr`.`generic_field5` `generic_field5`, `stg_bcrs_t_mr`.`generic_field6` `generic_field6`, `stg_bcrs_t_mr`.`generic_field7` `generic_field7`, `stg_bcrs_t_mr`.`generic_field8` `generic_field8`, `stg_bcrs_t_mr`.`generic_field9` `generic_field9`, `stg_bcrs_t_mr`.`generic_field10` `generic_field10`, `stg_bcrs_t_mr`.`generic_number1` `generic_number1`, `stg_bcrs_t_mr`.`generic_number2` `generic_number2`, `stg_bcrs_t_mr`.`generic_number3` `generic_number3`, `stg_bcrs_t_mr`.`generic_number4` `generic_number4`, `stg_bcrs_t_mr`.`generic_number5` `generic_number5`, `stg_bcrs_t_mr`.`generic_number6` `generic_number6`, `stg_bcrs_t_mr`.`generic_number7` `generic_number7`, `stg_bcrs_t_mr`.`generic_number8` `generic_number8`, `stg_bcrs_t_mr`.`generic_number9` `generic_number9`, `stg_bcrs_t_mr`.`generic_number10` `generic_number10`, `stg_bcrs_t_mr`.`customer_field1` `customer_field1`, `stg_bcrs_t_mr`.`customer_field2` `customer_field2`, `stg_bcrs_t_mr`.`customer_field3` `customer_field3`, `stg_bcrs_t_mr`.`customer_field4` `customer_field4`, `stg_bcrs_t_mr`.`customer_field5` `customer_field5`, `stg_bcrs_t_mr`.`customer_field6` `customer_field6`, `stg_bcrs_t_mr`.`customer_field7` `customer_field7`, `stg_bcrs_t_mr`.`customer_field8` `customer_field8`, `stg_bcrs_t_mr`.`customer_field9` `customer_field9`, `stg_bcrs_t_mr`.`customer_field10` `customer_field10`, `stg_bcrs_t_mr`.`customer_number1` `customer_number1`, `stg_bcrs_t_mr`.`customer_number2` `customer_number2`, `stg_bcrs_t_mr`.`customer_number3` `customer_number3`, `stg_bcrs_t_mr`.`customer_number4` `customer_number4`, `stg_bcrs_t_mr`.`customer_number5` `customer_number5`, `stg_bcrs_t_mr`.`customer_number6` `customer_number6`, `stg_bcrs_t_mr`.`customer_number7` `customer_number7`, `stg_bcrs_t_mr`.`customer_number8` `customer_number8`, `stg_bcrs_t_mr`.`customer_number9` `customer_number9`, `stg_bcrs_t_mr`.`customer_number10` `customer_number10`, `stg_bcrs_t_mr`.`sub_reference` `sub_reference`, `stg_bcrs_t_mr`.`sub_table_name` `sub_table_name`, `stg_bcrs_t_mr`.`trading_portfolio` `trading_portfolio`, `stg_bcrs_t_mr`.`underlying_scenario_id` `underlying_scenario_id`, `stg_bcrs_t_mr`.`volatility_scenario_id` `volatility_scenario_id`, `stg_bcrs_t_mr`.`sup_reg_vers_code` `sup_reg_vers_code`, `stg_bcrs_t_mr`.`dataset_version` `dataset_version`, `stg_bcrs_t_mr`.`conservation_buffer` `conservation_buffer`, `stg_bcrs_t_mr`.`conservation_rgc` `conservation_rgc`, `stg_bcrs_t_mr`.`ctcycal_buffer` `ctcycal_buffer`, `stg_bcrs_t_mr`.`ctcycal_rgc` `ctcycal_rgc`, `stg_bcrs_t_mr`.`leverage_ead` `leverage_ead`, `stg_bcrs_t_mr`.`sifi_buffer` `sifi_buffer`, `stg_bcrs_t_mr`.`sifi_rgc` `sifi_rgc`, `stg_bcrs_t_mr`.`qualifying_index` `qualifying_index`, `stg_bcrs_t_mr`.`equity_method` `equity_method`, `stg_bcrs_t_mr`.`foreign_ccy` `foreign_ccy`, `stg_bcrs_t_mr`.`domestic_ccy` `domestic_ccy`, `stg_bcrs_t_mr`.`notional_maturity_years` `notional_maturity_years`, `stg_bcrs_t_mr`.`notional_maturity_months` `notional_maturity_months`, `stg_bcrs_t_mr`.`notional_maturity_days` `notional_maturity_days`, `stg_bcrs_t_mr`.`notional_periodicity` `notional_periodicity`, `stg_bcrs_t_mr`.`notional_rate` `notional_rate`, `stg_bcrs_t_mr`.`notional_family` `notional_family`, `stg_bcrs_t_mr`.`pay_currency` `pay_currency`, `stg_bcrs_t_mr`.`rec_currency` `rec_currency`, `stg_bcrs_t_mr`.`pay_mkt_spread` `pay_mkt_spread`, `stg_bcrs_t_mr`.`rec_mkt_spread` `rec_mkt_spread`, `stg_bcrs_t_mr`.`pay_rate` `pay_rate`, `stg_bcrs_t_mr`.`pay_rate_value` `pay_rate_value`, `stg_bcrs_t_mr`.`rec_rate` `rec_rate`, `stg_bcrs_t_mr`.`rec_rate_value` `rec_rate_value`, `stg_bcrs_t_mr`.`pay_periodicity` `pay_periodicity`, `stg_bcrs_t_mr`.`rec_periodicity` `rec_periodicity`, `stg_bcrs_t_mr`.`pay_broken_period_type` `pay_broken_period_type`, `stg_bcrs_t_mr`.`rec_broken_period_type` `rec_broken_period_type`, `stg_bcrs_t_mr`.`pay_amortizing_type` `pay_amortizing_type`, `stg_bcrs_t_mr`.`rec_amortizing_type` `rec_amortizing_type`, `stg_bcrs_t_mr`.`pay_amortizing_periodicity` `pay_amortizing_periodicity`, `stg_bcrs_t_mr`.`rec_amortizing_periodicity` `rec_amortizing_periodicity`, `stg_bcrs_t_mr`.`conv_profit_loss` `conv_profit_loss`, `stg_bcrs_t_mr`.`rgc_unadjusted` `rgc_unadjusted`, `stg_bcrs_t_mr`.`adjustment` `adjustment`, `stg_bcrs_t_mr`.`unallocated_conv_profit` `unallocated_conv_profit`, `stg_bcrs_t_mr`.`regulatory_scenario_name` `regulatory_scenario_name`, `stg_bcrs_t_mr`.`stress_testing_scenario_id` `stress_testing_scenario_id`, `stg_bcrs_t_mr`.`period_id` `period_id`, `stg_bcrs_t_mr`.`period_start_date` `period_start_date`, `stg_bcrs_t_mr`.`period_end_date` `period_end_date`, `stg_bcrs_t_mr`.`scenario_process_name` `scenario_process_name`, `stg_bcrs_t_mr`.`scenario_process_id` `scenario_process_id`, `stg_bcrs_t_mr`.`scenario_process_step` `scenario_process_step`, `stg_bcrs_t_mr`.`security_issuer` `security_issuer`, `stg_bcrs_t_mr`.`security_guarantor` `security_guarantor`, `stg_bcrs_t_mr`.`conso_perimeter` `conso_perimeter`, `stg_bcrs_t_mr`.`interco` `interco`, `stg_bcrs_t_mr`.`interco_type` `interco_type`, `stg_bcrs_t_mr`.`valid_cpy_perimeter` `valid_cpy_perimeter`, `stg_bcrs_t_mr`.`issuer_id` `issuer_id`, `stg_bcrs_t_mr`.`approver_id` `approver_id`, `stg_bcrs_t_mr`.`upload_date` `upload_date`, `stg_bcrs_t_mr`.`approval_date` `approval_date`, `stg_bcrs_t_mr`.`adj_batch_date` `adj_batch_date`, `stg_bcrs_t_mr`.`source_file_name` `source_file_name`, `stg_bcrs_t_mr`.`adj_seq` `adj_seq`, `stg_bcrs_t_mr`.`dp_rule_log` `dp_rule_log`, `stg_bcrs_t_mr`.`id` `id`, `stg_bcrs_t_mr`.`parent_id` `parent_id`, `stg_bcrs_t_mr`.`child_id` `child_id`, `stg_bcrs_t_mr`.`import_source` `import_source`, `stg_bcrs_t_mr`.`staging_source` `staging_source`, `stg_bcrs_t_mr`.`run_date` `run_date`, `stg_bcrs_t_mr`.`process_profile_sr_id` `process_profile_sr_id`    from `sgmisitstg`.`stg_bcrs_t_mr` where `stg_bcrs_t_mr`.`w_batch_id`='2021092420324200862'
CREATE VIEW `temp_src_query_2110050749130010169` AS SELECT `a`.`client_group_id` `CLIENT_GROUP_ID`, `a`.`client_group_name` `CLIENT_GROUP_NAME`, `gm`.`cat1_st_lending` + `gm`.`cat1_lt_lending` + `gm`.`cat1_trade` + `gm`.`cat1_other` `CAT1_Limit`, `cl1`.`cat_utl` `CAT1_UTLZ`, `gm`.`cat2_st` + `gm`.`cat2_lt` `CAT2_Limit`, `cl2`.`cat_utl` `CAT2_UTLZ`, `gm`.`cat_3_settlement_limits` `CAT3_Limit`, `cl3`.`cat_utl` `CAT3_UTLZ`, `gm`.`cat_5_limits` `CAT5_Limit`, `cl5`.`cat_utl` `CAT5_UTLZ`, `gm`.`control_limits`, `cl`.`cat_utl` `CONTROL_LIMIT_UTLZ`,  `gm`.`cat1_st_lending` + `gm`.`cat1_lt_lending` + `gm`.`cat1_trade` + `gm`.`cat1_other` `CAT1_Limit_AGG`, `cag1`.`cat_utl_agg` `cat1_limit_UTLZ_agg`,  `gm`.`cat2_st` + `gm`.`cat2_lt` `CAT2_Limit_AGG`, `cag2`.`cat_utl_agg` `cat2_limit_UTLZ_agg`, `gm`.`cat_3_settlement_limits` `CAT3_Limit_AGG`, `cag3`.`cat_utl_agg` `cat3_limit_UTLZ_agg`, `gm`.`cat_5_limits` `CAT5_Limit_AGG`, `cag5`.`cat_utl_agg` `cat5_limit_UTLZ_agg`, `gm`.`control_limits` `control_limit_agg`, `cntag`.`cat_utl_agg` `control_limit_utlz_agg`  FROM `sgmisit`.`SGMI_CLIENT_GROUP_D` `A` LEFT JOIN (SELECT `stg_edm_client_gm`.`group_id`,`stg_edm_client_gm`.`gm_reference_number`, CAST(regexp_replace(TRIM(`stg_edm_client_gm`.`cat1_st_lending`),',','') as decimal(38,12)) `cat1_st_lending`, CAST(regexp_replace(TRIM(`stg_edm_client_gm`.`cat1_lt_lending`),',','') as decimal(12,2)) `cat1_lt_lending`,                   CAST(regexp_replace(TRIM(`stg_edm_client_gm`.`cat1_trade`),',','') as decimal(38,12)) `cat1_trade`, CAST(regexp_replace(TRIM(`stg_edm_client_gm`.`cat1_other`),',','') as decimal(38,12)) `cat1_other`,                   CAST(regexp_replace(TRIM(`stg_edm_client_gm`.`cat2_st`),',','') as decimal(38,12)) `cat2_st`, CAST(regexp_replace(TRIM(`stg_edm_client_gm`.`cat2_lt`),',','') as decimal(38,12)) `cat2_lt`,                   CAST(regexp_replace(TRIM(`stg_edm_client_gm`.`cat_3_settlement_limits`),',','') as decimal(38,12)) `cat_3_settlement_limits`,                   `stg_edm_client_gm`.`control_limits`,`stg_edm_client_gm`.`cat_5_limits`                          FROM `sgmisitstg`.`STG_EDM_CLIENT_GM` WHERE `stg_edm_client_gm`.`w_snapshot_dt` = '2021-03-31' AND `stg_edm_client_gm`.`w_country_cd`='ALL')`GM` ON `gm`.`group_id`=`a`.`client_group_id`            LEFT JOIN (SELECT `sgmi_client_limit_f`.`edm_group_id`, SUM(CAST(`sgmi_client_limit_f`.`edm_approved_limit_amount` as decimal(38,12))) `CAT_UTL` FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` WHERE `sgmi_client_limit_f`.`edm_limit_category_cd`='CAT1' AND `sgmi_client_limit_f`.`edm_limit_type`='OUTER'  AND `sgmi_client_limit_f`.`w_snapshot_dt` = '2021-03-31' AND `sgmi_client_limit_f`.`w_country_cd`='ALL' AND `sgmi_client_limit_f`.`w_datasource_id`='BCRS_RC'  GROUP BY  `sgmi_client_limit_f`.`edm_group_id`) `CL1` ON `cl1`.`edm_group_id`=`gm`.`gm_reference_number` LEFT JOIN (SELECT `sgmi_client_limit_f`.`edm_group_id`, SUM(CAST(`sgmi_client_limit_f`.`edm_approved_limit_amount` as decimal(38,12))) `CAT_UTL` FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` WHERE `sgmi_client_limit_f`.`edm_limit_category_cd`='CAT2' AND `sgmi_client_limit_f`.`edm_limit_type`='OUTER'  AND `sgmi_client_limit_f`.`w_snapshot_dt` = '2021-03-31' AND `sgmi_client_limit_f`.`w_country_cd`='ALL' AND `sgmi_client_limit_f`.`w_datasource_id`='BCRS_RC'  GROUP BY  `sgmi_client_limit_f`.`edm_group_id`) `CL2` ON `cl2`.`edm_group_id`=`GM`.`gm_reference_number` LEFT JOIN (SELECT `sgmi_client_limit_f`.`edm_group_id`, SUM(CAST(`sgmi_client_limit_f`.`edm_approved_limit_amount` as decimal(38,12))) `CAT_UTL` FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` WHERE `sgmi_client_limit_f`.`edm_limit_category_cd`='CAT3' AND `sgmi_client_limit_f`.`edm_limit_type`='OUTER'  AND `sgmi_client_limit_f`.`w_snapshot_dt` = '2021-03-31' AND `sgmi_client_limit_f`.`w_country_cd`='ALL' AND `sgmi_client_limit_f`.`w_datasource_id`='BCRS_RC'  GROUP BY  `sgmi_client_limit_f`.`edm_group_id`) `CL3` ON `cl3`.`edm_group_id`=`GM`.`gm_reference_number` LEFT JOIN (SELECT `sgmi_client_limit_f`.`edm_group_id`, SUM(CAST(`sgmi_client_limit_f`.`edm_approved_limit_amount` as decimal(38,12))) `CAT_UTL` FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` WHERE `sgmi_client_limit_f`.`edm_limit_category_cd`='CAT5' AND `sgmi_client_limit_f`.`edm_limit_type`='OUTER'  AND `sgmi_client_limit_f`.`w_snapshot_dt` = '2021-03-31' AND `sgmi_client_limit_f`.`w_country_cd`='ALL' AND `sgmi_client_limit_f`.`w_datasource_id`='BCRS_RC'  GROUP BY  `sgmi_client_limit_f`.`edm_group_id`) `CL5` ON `cl5`.`edm_group_id`=`GM`.`gm_reference_number` LEFT JOIN (SELECT `sgmi_client_limit_f`.`edm_group_id`, SUM(CAST(`sgmi_client_limit_f`.`edm_approved_limit_amount` as decimal(38,12))) `CAT_UTL` FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` WHERE `sgmi_client_limit_f`.`edm_limit_category_cd`='CAT1' AND `sgmi_client_limit_f`.`edm_limit_type`='CONTROL' AND `sgmi_client_limit_f`.`w_snapshot_dt` = '2021-03-31' AND `sgmi_client_limit_f`.`w_country_cd`='ALL' AND `sgmi_client_limit_f`.`w_datasource_id`='BCRS_RC' GROUP BY  `sgmi_client_limit_f`.`edm_group_id`) `CL`  ON `cl`.`edm_group_id`=`GM`.`gm_reference_number`  LEFT JOIN (SELECT `c`.`risk_clnt_group_id`, SUM(CAST(`c`.`edm_lt_amt` as decimal(38,12))) `CAT_UTL_AGG`          FROM (SELECT `a`.`client_id`, `b`.`risk_clnt_group_id`, `a`.`edm_approved_limit_amount`, `a`.`edm_limit_category_cd`, `a`.`edm_limit_type`,`cur`.`currency_id`, `cur`.`exchange_rate`,        `a`.`edm_approved_limit_amount` * `cur`.`exchange_rate` `EDM_LT_AMT`  FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` `A`                 LEFT JOIN (SELECT `sgmi_client_d`.`client_id`,`sgmi_client_d`.`risk_clnt_group_id` FROM `sgmisit`.`SGMI_CLIENT_D` WHERE `sgmi_client_d`.`w_snapshot_dt` = '2021-03-31' AND `sgmi_client_d`.`w_country_cd`='ALL' AND `sgmi_client_d`.`w_datasource_id`='BCRS_RC')`B` ON `a`.`client_id`=`b`.`client_id`                 LEFT JOIN (SELECT `sgmi_currency_exc_rate_d`.`currency_id`, `sgmi_currency_exc_rate_d`.`exchange_rate` from `sgmisit`.`sgmi_currency_exc_rate_d`  where trim(`sgmi_currency_exc_rate_d`.`booking_company_cd`)='' AND `sgmi_currency_exc_rate_d`.`fx_input_set`='GRP_PE_ACTUAL' )`CUR` ON `a`.`edm_approved_limit_currency`=`cur`.`currency_id`                WHERE `a`.`w_snapshot_dt` = '2021-03-31' AND `a`.`w_country_cd`='ALL' AND `a`.`w_datasource_id`='BCRS_RC') `C`            WHERE `c`.`edm_limit_category_cd`='CAT1' AND `c`.`edm_limit_type`='OUTER' GROUP BY `c`.`risk_clnt_group_id` ) `CAG1` ON `cag1`.`risk_clnt_group_id`=`a`.`client_group_id`   LEFT JOIN (SELECT `c`.`risk_clnt_group_id`, SUM(CAST(`c`.`edm_lt_amt` as decimal(38,12))) `CAT_UTL_AGG`          FROM (SELECT `a`.`client_id`, `b`.`risk_clnt_group_id`, `a`.`edm_approved_limit_amount`, `a`.`edm_limit_category_cd`, `a`.`edm_limit_type`,`cur`.`currency_id`, `cur`.`exchange_rate`, `a`.`edm_approved_limit_amount` * `cur`.`exchange_rate` `EDM_LT_AMT`  FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` `A`                 LEFT JOIN (SELECT `sgmi_client_d`.`client_id`,`sgmi_client_d`.`risk_clnt_group_id` FROM `sgmisit`.`SGMI_CLIENT_D` WHERE `sgmi_client_d`.`w_snapshot_dt` = '2021-03-31' AND `sgmi_client_d`.`w_country_cd`='ALL' AND `sgmi_client_d`.`w_datasource_id`='BCRS_RC')`B` ON `a`.`client_id`=`b`.`client_id`                 LEFT JOIN (SELECT `sgmi_currency_exc_rate_d`.`currency_id`, `sgmi_currency_exc_rate_d`.`exchange_rate` from `sgmisit`.`sgmi_currency_exc_rate_d`  where trim(`sgmi_currency_exc_rate_d`.`booking_company_cd`)='' AND `sgmi_currency_exc_rate_d`.`fx_input_set`='GRP_PE_ACTUAL' )`CUR` ON `a`.`edm_approved_limit_currency`=`cur`.`currency_id`                WHERE `a`.`w_snapshot_dt` = '2021-03-31' AND `a`.`w_country_cd`='ALL' AND `a`.`w_datasource_id`='BCRS_RC') `C`            WHERE `c`.`edm_limit_category_cd`='CAT2' AND `c`.`edm_limit_type`='OUTER' GROUP BY `c`.`risk_clnt_group_id` ) `CAG2` ON `cag2`.`risk_clnt_group_id`=`A`.`client_group_id`   LEFT JOIN (SELECT `c`.`risk_clnt_group_id`, SUM(CAST(`c`.`edm_lt_amt` as decimal(38,12))) `CAT_UTL_AGG`          FROM (SELECT `a`.`client_id`, `b`.`risk_clnt_group_id`, `a`.`edm_approved_limit_amount`, `a`.`edm_limit_category_cd`, `a`.`edm_limit_type`,`cur`.`currency_id`, `cur`.`exchange_rate`, `a`.`edm_approved_limit_amount` * `cur`.`exchange_rate` `EDM_LT_AMT`  FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` `A`                 LEFT JOIN (SELECT `sgmi_client_d`.`client_id`,`sgmi_client_d`.`risk_clnt_group_id` FROM `sgmisit`.`SGMI_CLIENT_D` WHERE `sgmi_client_d`.`w_snapshot_dt` = '2021-03-31' AND `sgmi_client_d`.`w_country_cd`='ALL' AND `sgmi_client_d`.`w_datasource_id`='BCRS_RC')`B` ON `a`.`client_id`=`b`.`client_id`                 LEFT JOIN (SELECT `sgmi_currency_exc_rate_d`.`currency_id`, `sgmi_currency_exc_rate_d`.`exchange_rate` from `sgmisit`.`sgmi_currency_exc_rate_d`  where trim(`sgmi_currency_exc_rate_d`.`booking_company_cd`)='' AND `sgmi_currency_exc_rate_d`.`fx_input_set`='GRP_PE_ACTUAL' )`CUR` ON `a`.`edm_approved_limit_currency`=`cur`.`currency_id`                WHERE `a`.`w_snapshot_dt` = '2021-03-31' AND `a`.`w_country_cd`='ALL' AND `a`.`w_datasource_id`='BCRS_RC') `C`            WHERE `c`.`edm_limit_category_cd`='CAT3' AND `c`.`edm_limit_type`='OUTER' GROUP BY `c`.`risk_clnt_group_id` ) `CAG3` ON `cag3`.`risk_clnt_group_id`=`A`.`client_group_id`             LEFT JOIN (SELECT `c`.`risk_clnt_group_id`, SUM(CAST(`c`.`edm_lt_amt` as decimal(38,12))) `CAT_UTL_AGG`          FROM (SELECT `a`.`client_id`, `b`.`risk_clnt_group_id`, `a`.`edm_approved_limit_amount`, `a`.`edm_limit_category_cd`, `a`.`edm_limit_type`,`cur`.`currency_id`, `cur`.`exchange_rate`, `a`.`edm_approved_limit_amount` * `cur`.`exchange_rate` `EDM_LT_AMT`  FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` `A`                 LEFT JOIN (SELECT `sgmi_client_d`.`client_id`,`sgmi_client_d`.`risk_clnt_group_id` FROM `sgmisit`.`SGMI_CLIENT_D` WHERE `sgmi_client_d`.`w_snapshot_dt` = '2021-03-31' AND `sgmi_client_d`.`w_country_cd`='ALL' AND `sgmi_client_d`.`w_datasource_id`='BCRS_RC')`B` ON `a`.`client_id`=`b`.`client_id`                 LEFT JOIN (SELECT `sgmi_currency_exc_rate_d`.`currency_id`, `sgmi_currency_exc_rate_d`.`exchange_rate` from `sgmisit`.`sgmi_currency_exc_rate_d`  where trim(`sgmi_currency_exc_rate_d`.`booking_company_cd`)='' AND `sgmi_currency_exc_rate_d`.`fx_input_set`='GRP_PE_ACTUAL' )`CUR` ON `a`.`edm_approved_limit_currency`=`cur`.`currency_id`                WHERE `a`.`w_snapshot_dt` = '2021-03-31' AND `a`.`w_country_cd`='ALL' AND `a`.`w_datasource_id`='BCRS_RC') `C`            WHERE `c`.`edm_limit_category_cd`='CAT5' AND `c`.`edm_limit_type`='OUTER' GROUP BY `c`.`risk_clnt_group_id` ) `CAG5` ON `cag5`.`risk_clnt_group_id`=`A`.`client_group_id`         LEFT JOIN (SELECT `c`.`risk_clnt_group_id`, SUM(CAST(`c`.`edm_lt_amt` as decimal(38,12))) `CAT_UTL_AGG`          FROM (SELECT `a`.`client_id`, `b`.`risk_clnt_group_id`, `a`.`edm_approved_limit_amount`, `a`.`edm_limit_category_cd`, `a`.`edm_limit_type`,`cur`.`currency_id`, `cur`.`exchange_rate`, `a`.`edm_approved_limit_amount` * `cur`.`exchange_rate` `EDM_LT_AMT`  FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` `A`                 LEFT JOIN (SELECT `sgmi_client_d`.`client_id`,`sgmi_client_d`.`risk_clnt_group_id` FROM `sgmisit`.`SGMI_CLIENT_D` WHERE `sgmi_client_d`.`w_snapshot_dt` = '2021-03-31' AND `sgmi_client_d`.`w_country_cd`='ALL' AND `sgmi_client_d`.`w_datasource_id`='BCRS_RC')`B` ON `a`.`client_id`=`b`.`client_id`                 LEFT JOIN (SELECT `sgmi_currency_exc_rate_d`.`currency_id`, `sgmi_currency_exc_rate_d`.`exchange_rate` from `sgmisit`.`sgmi_currency_exc_rate_d`  where trim(`sgmi_currency_exc_rate_d`.`booking_company_cd`)='' AND `sgmi_currency_exc_rate_d`.`fx_input_set`='GRP_PE_ACTUAL' )`CUR` ON `a`.`edm_approved_limit_currency`=`cur`.`currency_id`                WHERE `a`.`w_snapshot_dt` = '2021-03-31' AND `a`.`w_country_cd`='ALL' AND `a`.`w_datasource_id`='BCRS_RC') `C`            WHERE `c`.`edm_limit_category_cd`='CAT1' AND `c`.`edm_limit_type`='CONTROL' GROUP BY `c`.`risk_clnt_group_id` ) `CNTAG` ON `cntag`.`risk_clnt_group_id`=`A`.`client_group_id`      WHERE `a`.`w_snapshot_dt` = '2021-03-31' AND `a`.`w_country_cd`='ALL' AND `a`.`w_datasource_id`='BCRS_RC'
CREATE VIEW `temp_src_query_2110142210120092980` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`, case when `comb`.`booking_loc_id`='SG' OR   IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`) in ('SG','UNMAPPED') OR   `lmt_ref`.`edm_limit_booking_loc` ='SG' then 'SG' else 'OTHERS' end AS `SECURITY_CTRY`, case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`) `ccr_eq_cntry`,  `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-06-30' AND `exp_f`.`w_datasource_id` = 'BCRS_ND' AND `exp_f`.`w_country_cd` =  'SG' AND `exp_f`.`w_workspace` = 'WS29'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-06-30' AND `lmt_f`.`w_datasource_id` = 'BCRS_ND' AND `lmt_f`.`w_country_cd` =  'SG'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-06-30' AND `col_f`.`w_datasource_id` = 'BCRS_ND' AND `col_f`.`w_country_cd` =  'SG' AND `col_f`.`w_workspace` = split('WS29','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-06-30' AND `lmt_ref`.`w_datasource_id` = 'BCRS_ND' AND `lmt_ref`.`w_country_cd` =  'SG'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-06-30' AND `col_ref`.`w_datasource_id` = 'BCRS_ND' AND `col_ref`.`w_country_cd` =  'SG' AND `col_ref`.`w_workspace` = split('WS29','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-06-30' AND `obl`.`w_datasource_id`='BCRS_ND' AND `obl`.`w_country_cd`='SG'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-06-30' AND `gua`.`w_datasource_id`='BCRS_ND' AND `obl`.`w_country_cd`='SG'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-06-30' AND `client`.`w_datasource_id`='BCRS_ND' AND `client`.`w_country_cd`='SG'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-06-30' AND `limit_cl`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-06-30' AND `coll_owner`.`w_datasource_id` = 'BCRS_ND'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-06-30' AND `br`.`w_datasource_id` = 'BCRS_ND'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_ND'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-06-30' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-06-30' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-06-30' and `exc_rate_usd`.`w_datasource_id`='BCRS_ND' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_ND' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_ND' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='SG'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-06-30'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-06-30' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-06-30' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-06-30'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021101412555400692'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-06-30' AND `comb`.`w_datasource_id` = 'BCRS_ND' AND `comb`.`w_country_cd` =  'SG' AND `comb`.`w_workspace`='WS29'     AND (`comb`.`booking_loc_id`='SG' OR  IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`)  IN ('SG') OR    `lmt_ref`.`edm_limit_booking_loc` ='SG')
CREATE VIEW `temp_src_query_2110192312460072690` AS SELECT   `a`.`partition_key` `partition_key`, `a`.`contract_reference` `contract_reference`, `a`.`contract_type` `contract_type`, `a`.`book_code` `book_code`, `a`.`pool_code` `pool_code`, `a`.`maturity_date` `maturity_date`, `a`.`exchange_rate` `exchange_rate`, `a`.`counterparty` `counterparty`, `a`.`counterparty_group` `counterparty_group`, `a`.`currency` `currency`, `a`.`carrying_amount` `carrying_amount`, `a`.`outstanding` `outstanding`, `a`.`ead` `ead`, `a`.`pd` `pd`, `a`.`ccf` `ccf`, `a`.`lgd` `lgd`, `a`.`rw` `rw`, `a`.`dim1` `dim1`, `a`.`dim2` `dim2`, `a`.`dim3` `dim3`, `a`.`dim4` `dim4`, `a`.`dim5` `dim5`, `a`.`dim6` `dim6`, `a`.`dim7` `dim7`, `a`.`dim8` `dim8`, `a`.`dim9` `dim9`, `a`.`dim10` `dim10`, `a`.`dim11` `dim11`, `a`.`dim12` `dim12`, `a`.`dim13` `dim13`, `a`.`dim14` `dim14`, `a`.`dim15` `dim15`, `a`.`dim16` `dim16`, `a`.`dim17` `dim17`, `a`.`dim18` `dim18`, `a`.`dim19` `dim19`, `a`.`dim20` `dim20`, `a`.`fair_value` `fair_value`, `a`.`accrued_interests` `accrued_interests`, `a`.`net_interest_income` `net_interest_income`, `a`.`amortized_cost` `amortized_cost`, `a`.`past_due_ppal` `past_due_ppal`, `a`.`past_due_int` `past_due_int`, `a`.`product_gl_criteria` `product_gl_criteria`, `a`.`entity_gl_criteria` `entity_gl_criteria`, `a`.`contract_desc` `contract_desc`, `a`.`nominal` `nominal`, `a`.`effective_yield` `effective_yield`, `a`.`original_cost` `original_cost`, `a`.`account_code` `account_code`, `a`.`max_exposure_amount` `max_exposure_amount`, `a`.`performing_status` `performing_status`, `a`.`flag_trigger_before` `flag_trigger_before`, `a`.`import_source` `import_source`, `a`.`attribute_1` `attribute_1`, `a`.`attribute_2` `attribute_2`, `a`.`attribute_3` `attribute_3`, `a`.`attribute_4` `attribute_4`, `a`.`attribute_5` `attribute_5`, `a`.`attribute_6` `attribute_6`, `a`.`attribute_7` `attribute_7`, `a`.`attribute_8` `attribute_8`, `a`.`attribute_9` `attribute_9`, `a`.`amount_1` `amount_1`, `a`.`amount_2` `amount_2`, `a`.`trade_date` `trade_date`, `a`.`value_date` `value_date`, `a`.`unconditionally_cancelable` `unconditionally_cancelable`, `a`.`revolving` `revolving`, `a`.`amortized_cost_no_ias` `amortized_cost_no_ias`, `a`.`gl_strategy_code` `gl_strategy_code`, `a`.`cover_pct` `cover_pct`, `a`.`accrued_fees` `accrued_fees`, `a`.`counterparty_type` `counterparty_type`, `a`.`best_estimate_el` `best_estimate_el`, `a`.`residual_value` `residual_value`, `a`.`residual_value_ccy` `residual_value_ccy`, `a`.`is_leasing` `is_leasing`, `a`.`aggregated` `aggregated`, `a`.`min_exposure_amount` `min_exposure_amount`, `a`.`parameter_1` `parameter_1`, `a`.`parameter_2` `parameter_2`, `a`.`parameter_3` `parameter_3`, `a`.`parameter_4` `parameter_4`, `a`.`parameter_5` `parameter_5`, `a`.`family` `family`, `a`.`fg_occupied_or_rented` `fg_occupied_or_rented`, `a`.`crm_location` `crm_location`, `a`.`ead_fi` `ead_fi`, `a`.`total_annual_sales` `total_annual_sales`, `a`.`total_assets` `total_assets`, `a`.`sub_type` `sub_type`, `a`.`unsecured` `unsecured`, `a`.`commited` `commited`, `a`.`sub_portfolio_ref` `sub_portfolio_ref`, `a`.`benefit_from_sovereign_gua` `benefit_from_sovereign_gua`, `a`.`und_pool_ref` `und_pool_ref`, `a`.`securitization_percentage` `securitization_percentage`, `a`.`fixed_rate` `fixed_rate`, `a`.`seniority` `seniority`, `a`.`lgd_rating` `lgd_rating`, `a`.`ccf_rating` `ccf_rating`, `a`.`maturity_eff` `maturity_eff`, `a`.`first_contract_reference` `first_contract_reference`, `a`.`ndim1` `ndim1`, `a`.`ndim2` `ndim2`, `a`.`ndim3` `ndim3`, `a`.`ndim4` `ndim4`, `a`.`ndim5` `ndim5`, `a`.`ndim6` `ndim6`, `a`.`ndim7` `ndim7`, `a`.`ndim8` `ndim8`, `a`.`ndim9` `ndim9`, `a`.`ndim10` `ndim10`, `a`.`ndim11` `ndim11`, `a`.`ndim12` `ndim12`, `a`.`ndim13` `ndim13`, `a`.`ndim14` `ndim14`, `a`.`ndim15` `ndim15`, `a`.`ndim16` `ndim16`, `a`.`ndim17` `ndim17`, `a`.`ndim18` `ndim18`, `a`.`ndim19` `ndim19`, `a`.`ndim20` `ndim20`, `a`.`available_amount` `available_amount`, `a`.`crm_first_lien` `crm_first_lien`, `a`.`crm_completed` `crm_completed`, `a`.`crm_uncorelated_mv_borrower` `crm_uncorelated_mv_borrower`, `a`.`crm_uncorelated_borrower_mv` `crm_uncorelated_borrower_mv`, `a`.`crm_damage_insurance` `crm_damage_insurance`, `a`.`crm_legal_certainty` `crm_legal_certainty`, `a`.`crm_evaluation_date` `crm_evaluation_date`, `a`.`crm_independent_valuer` `crm_independent_valuer`, `a`.`crm_mortgage_lending_value` `crm_mortgage_lending_value`, `a`.`crm_sub_type` `crm_sub_type`, `a`.`total_sales_date` `total_sales_date`, `a`.`total_assets_date` `total_assets_date`, `a`.`ltv` `ltv`, `a`.`crm_market_value` `crm_market_value`, `a`.`crm_nominal` `crm_nominal`, `a`.`bargain_option_value` `bargain_option_value`, `a`.`past_due_days` `past_due_days`, `a`.`retail_purpose` `retail_purpose`, `a`.`staging_source` `staging_source`, `a`.`funding_ccy` `funding_ccy`, `a`.`risk_country` `risk_country`, `a`.`risk_area` `risk_area`, `a`.`risk_sub_area` `risk_sub_area`, `a`.`lgd_rating_agency` `lgd_rating_agency`, `a`.`ccf_rating_agency` `ccf_rating_agency`, `a`.`internal_rating_agency` `internal_rating_agency`, `a`.`performing_status_change_date` `performing_status_change_date`, `a`.`cpty_group_desc` `cpty_group_desc`, `a`.`cpty_group_incorp_country` `cpty_group_incorp_country`, `a`.`rate_category` `rate_category`, `a`.`el_std` `el_std`, `a`.`incorporation_country` `incorporation_country`, `a`.`flag_adjustment` `flag_adjustment`, `a`.`product_gl_criteria_2` `product_gl_criteria_2`, `a`.`nb_of_employees` `nb_of_employees`, `a`.`industry_sector` `industry_sector`, `a`.`past_due_installments` `past_due_installments`, `a`.`flag_generic_1` `flag_generic_1`, `a`.`flag_generic_2` `flag_generic_2`, `a`.`lgd_non_performing` `lgd_non_performing`, `a`.`amount_1_ccy` `amount_1_ccy`, `a`.`amount_2_ccy` `amount_2_ccy`, `a`.`ead_fi_solo` `ead_fi_solo`, `a`.`cover_pct_solo` `cover_pct_solo`, `a`.`origination_country` `origination_country`, `a`.`business` `business`, `a`.`ttc_lgd` `ttc_lgd`, `a`.`retail_type` `retail_type`, `a`.`bank_owned_deal` `bank_owned_deal`, `a`.`multiple_counterparty` `multiple_counterparty`, `a`.`was_acquired` `was_acquired`, `a`.`acquisition_date` `acquisition_date`, `a`.`limit_change` `limit_change`, `a`.`max_exposure_amount_change` `max_exposure_amount_change`, `a`.`credit_line_status` `credit_line_status`, `a`.`credit_line_close_request` `credit_line_close_request`, `a`.`crm_lien_position` `crm_lien_position`, `a`.`crm_property_type` `crm_property_type`, `a`.`crm_occupancy` `crm_occupancy`, `a`.`crm_number_of_units` `crm_number_of_units`, `a`.`crm_census_tract` `crm_census_tract`, `a`.`crm_street_1` `crm_street_1`, `a`.`crm_street_2` `crm_street_2`, `a`.`crm_city` `crm_city`, `a`.`crm_state` `crm_state`, `a`.`crm_zip_code` `crm_zip_code`, `a`.`crm_valuation_method_actual` `crm_valuation_method_actual`, `a`.`crm_valuation_method_mod` `crm_valuation_method_mod`, `a`.`cltv` `cltv`, `a`.`cltv_actual` `cltv_actual`, `a`.`income_doc_original` `income_doc_original`, `a`.`income_original` `income_original`, `a`.`income_source_original` `income_source_original`, `a`.`income_refresh` `income_refresh`, `a`.`income_source_refresh` `income_source_refresh`, `a`.`income_refresh_date` `income_refresh_date`, `a`.`dti_back_end_original` `dti_back_end_original`, `a`.`dti_front_end_original` `dti_front_end_original`, `a`.`dti_back_end_refreshed` `dti_back_end_refreshed`, `a`.`dti_front_end_refreshed` `dti_front_end_refreshed`, `a`.`fico_original` `fico_original`, `a`.`fico_original_co_borrower` `fico_original_co_borrower`, `a`.`fico_refreshed` `fico_refreshed`, `a`.`fico_refreshed_date` `fico_refreshed_date`, `a`.`in_bankruptcy` `in_bankruptcy`, `a`.`bankruptcy_chapter` `bankruptcy_chapter`, `a`.`street_1` `street_1`, `a`.`street_2` `street_2`, `a`.`city` `city`, `a`.`state` `state`, `a`.`zip_code` `zip_code`, `a`.`country_of_residence` `country_of_residence`, `a`.`accounting_adjustment_type` `accounting_adjustment_type`, `a`.`acc_adjustment_amount_1` `acc_adjustment_amount_1`, `a`.`acc_adjustment_amount_2` `acc_adjustment_amount_2`, `a`.`adjusted_value` `adjusted_value`, `a`.`unrealized_gains_losses` `unrealized_gains_losses`, `a`.`atrr` `atrr`, `a`.`credit_bureau_name_original` `credit_bureau_name_original`, `a`.`credit_bureau_name_refreshed` `credit_bureau_name_refreshed`, `a`.`non_accrual_date` `non_accrual_date`, `a`.`limit_type` `limit_type`, `a`.`crm_valuation_method_orig` `crm_valuation_method_orig`, `a`.`transfered` `transfered`, `a`.`quoted` `quoted`, `a`.`fair_value_option` `fair_value_option`, `a`.`accu_fair_value_changes` `accu_fair_value_changes`, `a`.`default_date` `default_date`, `b`.`product_type`   FROM `sgmisitstg`.`stg_bcrs_retail_exposure` `a`  left join `sgmisit`.`sgmi_retail_product_dat` `b` on concat(`a`.`attribute_1`,`a`.`contract_desc`) = `b`.`contract_type`   WHERE `a`.`w_batch_id`='2021101912453900275'
CREATE VIEW `temp_src_query_2110201828070045559` AS SELECT         NVL(`tcdr`.`accrued_fees`,0) `accrued_fees`,  CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(`tcdr`.`accrued_interest`, 0) ELSE 0 END `accrued_interest`,         NVL(`txn`.`accrued_interest`,0) `accrued_interest_dollar`,         NVL(`tcdr`.`add_on`,0) `add_on`,         `txn`.`add_on` AS `add_on_dollar`,         `txn`.`collateral_attribute_9`,         CASE                 WHEN `txn`.`collateral_attribute_9` IN (                     'Correct',                     'Reverse'                 ) THEN 'Y'                 ELSE 'N'             END         `adj_flag`,         NVL(`fac`.`amount`,0) `ADJUSTED_LIMIT_AMOUNT`,         `tcdr`.`adjustment_amount`,         `tcdr`.`id` `ais_id`,         `tcdr`.`amortized_cost`,         `tcdr`.`amortized_cost_no_ias`,         'MFU needed - RSK_LIMIT_STATIC.txt' `approved_lgd`,        'MFU needed - RSK_LIMIT_STATIC.txt' `approver_name`,         `inst`.`arm_code` `arm_cd`,         `inst`.`arm_description` `arm_description`,         `tcdr`.`asset_class_category_new`,         `tcdr`.`asset_class_category_original`,         `tcdr`.`asset_class_new`,         `tcdr`.`asset_class_original`,         `crm`.`attribute_6` `attribute_6`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`avg_pre_funded_contribution`                 ELSE NULL             END         `avg_prefunded_contribution`,         `txn`.`balance_category`,         `bca`.`bca_approval_dt` `BCA_APPROVAL_DATE`,         `bca`.`bca_review_dt` `BCA_REVIEW_DATE`,         `tcdr`.`beel`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`beta`                 ELSE NULL             END         `beta`,         nvl(`cva`.`bi`,0) `bi`,         `tcdr`.`method_new` `bii_calculation_method`,         `tcdr`.`bis_entity_type_new`,         `tcdr`.`bis_entity_type_original`,         `tcdr`.`bis_industry_sector_new`,         `tcdr`.`bis_industry_sector_original`,         `tcdr`.`bis_past_due`,         `tcdr`.`bis_past_due_original`,         `tcdr`.`bis_performing_status`,         `tcdr`.`bis_product` `BIS_PROD`,         `tcdr`.`bis_product_category` `BIS_PROD_CATEGORY`,         `txn`.`bis_risk_area_new`,         `txn`.`bis_risk_area_original`,        `tcdr`.`bis_risk_sub_area_new`,         `tcdr`.`bis_risk_sub_area_original`,         `tcdr`.`booking_company` `booking_entity_wid`,         `tcdr`.`booking_company` `booking_entity_id`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code` THEN `tcdr`.`counterparty_original`                         ELSE NULL                     END                 ELSE NULL             END `BROKER_ID`,         `tcdr`.`bs_type`,         `tcdr`.`business`,         `tcdr`.`business_line_code` `business_line_cd`,         `txn`.`customer_subsegment_code` `BUSINESS_SUB_SEGMENT`,         NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `BUSINESS_UNIT`,         `tcdr`.`capital_item`,         `tcdr`.`ccf`,         `tcdr`.`ccp_dfund_method`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`ccp_name`                 ELSE NULL             END         `ccp_name`,         `client`.`client_domicile_loc_id` `ccr_ctry`,         CASE                 WHEN `client`.`client_domicile_loc_id` IS NULL THEN `client`.`coi_loc_id`                 ELSE `client`.`client_domicile_loc_id`             END `CCR_EQ_CNTRY`,         `txn`.`ccr_new`,         `txn`.`ccr_original`,         `tcdr`.`ccy_code` `CCY_CD`,         `tcdrp`.`cec` `cec`,         CASE                 WHEN `tcdr`.`ead_method` IN (                     'CEM',                     'IMM'                 )                      AND                      CASE                         WHEN nvl(`txn`.`contract_type`,'UNMP') = 'GMGMKTLEAS' THEN 'F'                         ELSE `txn`.`derivative_ind`                     END                 = 'T' THEN `tcdr`.`ead_method`             END         `cem_imm_ind`,         `txn`.`cf_indicator`,         `tcdr`.`child_id`,         `tcdr`.`clearing_house_code` `CLEARING_HOUSE_CD`,         CASE                 WHEN `tcdr`.`contract_reference` NOT LIKE 'CCP_MARGIN%' THEN 'N'                 ELSE 'Y'             END         `client_trade`,         `tcdr`.`coll_issuer_bis_entity_type`,         `tcdr`.`collateral_bis_product` `COLLATERAL_BIS_PROD`,  `tcdr`.`collateral_contract_type` `COLLATERAL_CONTRACT_TYPE`,         `tcdr`.`collateral_issuer`,         `crm`.`attribute_6` `collateral_perfection_status`,         `txn`.`collateral_product_category` `collateral_prod_category`,         `tcdr`.`collateral_reference` `collateral_ref_no`,         `tcdr`.`collateral_valuation_date` `collateral_valuation_date`,         `tcdr`.`collateral_attribute_9` `collateral_adjusted_flag`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`nominal`                 ELSE NULL             END         `committed_amount`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`ead_pre_ccf`                 ELSE NULL             END         `committed_available_amunt`,         CASE                 WHEN `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'Y'                      AND `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END         `committed_headroom`,         `fac`.`commited` `committed_indicator`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 )                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`outstanding`                 ELSE 0             END         `committed_os`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`nominal`                 ELSE NULL             END         `committed_used_amount`,         '0' `committed_used_amt_temp`,         `tcdr`.`company_code` `company_cd`,         `txn`.`company_type`,         `tcdr`.`contract_reference` `contract_ref_no`,         `tcdr`.`contract_type`,         'null' `contract_desc`,         `tcdr`.`internal_rating_original` `correct_orig_crg`,         `inst`.`cost_center` `cost_center_cd`,         `inst`.`cost_center_descriotion` `cost_center_description`,         `tcdr`.`counterparty_new` `counterparty_new_wid`,         `tcdr`.`counterparty_new`,         `tcdr`.`counterparty_new_attribute_1`,         `tcdr`.`counterparty_new_attribute_2`,         `tcdr`.`counterparty_new_attribute_3`,         `tcdr`.`counterparty_new_attribute_4`,         `tcdr`.`counterparty_new_attribute_5`,         `tcdr`.`counterparty_new_attribute_6`,         `tcdr`.`counterparty_new_attribute_7`,         `tcdr`.`counterparty_new_attribute_8`,         `tcdr`.`counterparty_new_attribute_9`,         `tcdr`.`counterparty_new_desc`,         `tcdr`.`counterparty_original` `counterparty_original_wid`,         `tcdr`.`counterparty_original`,         `tcdr`.`counterparty_type_new`,         `tcdr`.`counterparty_type_original`,         `txn`.`country_name`,   CASE WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`collateral_bis_product` <>  'OTC_NET_COL' THEN `tcdr`.`ead` ELSE 0 END `covered_ead`,          `tcdr`.`cpty_group`,         `tcdr`.`cpty_group_original`,         `tcdr`.`cpty_new_sebc_not_qualifying`,         `tcdr`.`cpty_orig_sebc_not_qualifying`,         `tcdrp`.`crc`,         'MFU needed - CRE_CATEGORY.txt' `cre_category`,         'MFU needed - RSK_MAINPROF_CTC.txt' `cre_coverage`,         'MFU needed - CRE_CATEGORY.txt' `cre_property_type`,         `tcdr`.`credit_substitute`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_cd`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_name`,         `crmsr`.`currency` `crm_currency`,         `crmsr`.`crm_location` `crm_location`,         `txn`.`crm_method` `crm_method`,         `crmsr`.`residual_maturity` `crm_residual_maturity`,         `juris`.`csa` `csa_flg`,         `tcdr`.`currency`,         ( nvl(round(`tcdr`.`ead_pro_cva`,10),0) * nvl(round(`tcdr`.`rw_new`,10),0) ) `cva_ccr_rwa`,         `cva`.`cva_index_part` `cva_index_part`,         `txn`.`cva_rwa` `cva_rwa`,         (round(nvl(`cva`.`cva_rwa_addon`,0),10) * round(`obi`.`cva_static_val`,10)) `cva_rwa_addon`,         `txn`.`days_after_contractual_date`,         `tcdr`.`deal_status`,         `tcdr`.`dealbook` `book_wid`,         `tcdr`.`dealbook` `book_cd`,         `txn`.`delivery_type`,         `txn`.`derivative_ind`,         NVL(`clrh`.`df_cm`, 0) `df_cm`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfccp`                 ELSE NULL             END         `dfccp`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfi`                 ELSE NULL             END         `dfi`,         NVL(`enl`.`mother_code`, 'UNMP DLRFIN') `dlrfin_cd`,         `tcdr`.`ead`,         `tcdr`.`ead_formula`,         `tcdr`.`ead_method`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `ead_netting`,         `tcdr`.`ead_original`,         `tcdr`.`ead_pre_ccf`,         `tcdr`.`ead_pro`,         `tcdr`.`ead_pro_cva`,         `tcdr`.`ead_pro_discount`,         `tcdr`.`ead_pro_gen`,         `tcdr`.`ead_pro_write_off`,         nvl(round(`tcdr`.`ead`,10),0) * NVL(NVL(`prrsr`.`prr`,`sme_prr`.`product_recovery_rate`  ),0) `ead_prr`,         `tcdr`.`ead_scalar` `ead_scalar`,         nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `ead_square`,         `txn`.`ec_filter_type`,         `txn`.`ec_w_filter_type`,         `tcdr`.`effective_epe`,         nvl(`tcdr`.`k_maturity`,0) `effective_matirity`,         `tcdr`.`el`,         NVL(`trfrsk`.`el_cpty`,0) `el_cpty`,         NVL(`tcdr`.`el`,0) `el_net_saves`,         'MFU needed - Pool_Ref_MONYY.txt' `el_saves`,         NVL(`trfrsk`.`el_total`,0) `el_total`,         `tcdr`.`entity_type_category_new`,         `tcdr`.`entity_type_category_original`,         `tcdr`.`equity_floor_applied`,         `tcdr`.`equity_preferential_treatment`,         `tcdr`.`equity_scaling_factor`,         `txn`.`exchange_rate`,         `tcdr`.`exemption_maturity_floor`,         ( nvl(             CASE                 WHEN `tcdr`.`table_name` IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN(                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN(                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE(                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END,0) + nvl(             CASE                 WHEN `tcdr`.`table_name` NOT IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT','FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END,0) ) `exposure`,         `tcdr`.`exposure_attribute_1`,         `tcdr`.`exposure_attribute_2`,         `tcdr`.`exposure_attribute_3`,         `tcdr`.`exposure_attribute_4`,         `tcdr`.`exposure_attribute_5`,         `tcdr`.`exposure_attribute_6`,         `tcdr`.`exposure_attribute_7`,         CASE                 WHEN CAST(`tcdr`.`exposure_attribute_7` AS double) IS NOT NULL THEN 'Y'                 ELSE 'N'             END         `exposure_attribute_7d`,         `tcdr`.`exposure_attribute_8`,         `tcdr`.`exposure_attribute_9`,         CASE                 WHEN (                     `tcdr`.`table_name` = 'ON_OFF_BALANCE'                     OR `tcdr`.`table_name` = 'REPO'                     OR `tcdr`.`table_name` = 'RECEIVABLE'                     OR `tcdr`.`table_name` = 'TRANCHE'                     OR `tcdr`.`table_name` = 'BOND'                     OR `tcdr`.`table_name` = 'EQUITY'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END         `exposure_wo_mtm`,         `reposr`.`external_rating`,         `txn`.`customer_subsegment_desc` `F_BUSINESS_SUB_SEGMENT_NAME`,         nvl(`coltp`.`collateral_description`, 'Collateral Type Unmapped') `f_collatral_type_name`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `F_ORIGINAL_SCORECARD_NAME`,         `txn`.`contract_desc` `F_STANDARD_PROD_NAME`,         'MFU needed - ELIMIT' `facility_activated_flag`,         `facagg`.`facility_availability_end_date` `facility_availability_end_date`,         `tcdr`.`facility_reference` `FACILITY_REF_NO`,         `tcdr`.`used_amount_facility` `FACILITY_UTILIZATION_AMOUNT`,         `tcdr`.`fair_value`,         'PMI source needed' `fam_cd`,         `tcdr`.`family`,         `tcdr`.`fde_alternative_method`,         NVL(`txn`.`filter_type`,'NA') `filter_type`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_cd`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_name`,         `tcdr`.`internal_rating_new` `final_crg`,         nvl(`tcdr`.`pd_new`,0) `final_pd`,         `tcdr`.`flag_adjustment`,         `tcdr`.`floor1`,         `tcdr`.`floor2`,         `txn`.`fsa_exclusion_type`,         `txn`.`fsa004_asset_class`,         nvl(round(`tcdr`.`collateral_assigned_amount`,10),0) * ( 1 - nvl(round(`tcdr`.`hc`,10),0) ) `fsv`,         `tcdr`.`funding_ccy`,         `tcdr`.`gaap_code` `GAAP_CD`,         'CDW needed - RSK_BOE_LMT_PRO' `governing_law`,         `tcdr`.`grand_fathering_applied`,         `tcdr`.`guar_sub_reference` `GUARANTEE_SUB_REF_NO`,         `tcdr`.`guarantee_bis_product`,         CASE WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED' THEN 'Guarantee'   WHEN `tcdr`.`collateral_contract_type` = 'NET_AGR' THEN 'Netting'   WHEN NVL (round(`tcdr`.`ead`,10), 0) * NVL(NVL(`prrsr`.`prr`, `sme_prr`.`product_recovery_rate` ),0) > 0 THEN 'Product Recovery'    ELSE 'UNMP' END `guarantee_ead_flag`,         `tcdr`.`guarantee_method`,         `tcdr`.`guarantee_reference` `GUARANTEE_REF_NO`,         `tcdr`.`guarantor`,         `tcdr`.`guarantor_bis_entity_type`,         CASE                 WHEN `tcdr`.`tranche_guarantee_type` = 'GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `gurantee_ead`,         `tcdr`.`hc`,         `tcdr`.`hcr`,         `tcdr`.`he`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND `tcdr`.`bs_type` = 'OFB' THEN `tcdr`.`outstanding`                 ELSE 0             END         `headroom`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`ead`                 ELSE 0             END         `headroom_ead`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`rwa`                 ELSE 0             END         `headroom_rwa`,         `tcdr`.`hfx`,         `txn`.`holding_company_ind`,         `tcdr`.`hr`,         `tcdr`.`id`,         'MFU needed - mfu_ifrs_category.txt' `ifrs_category`,         CASE                 WHEN `fac`.`commited` = 'N'                      AND `tcdr`.`table_name` = 'FACILITY' THEN nvl(`tcdr`.`nominal`,0)                 ELSE 0             END         `iip`,         `csr`.`imc_1`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_alpha_factor`,         'RMI TABLE NEEDED - rsk_scb_wb_imm_collat, NVL(SUM(amount),0)' `imm_collat_amount`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_eepe`,         `tcdr`.`import_source`,         `tcdr`.`incorporation_country` `incorp_country`,         `txn`.`incorporation_ccy_new`,         `txn`.`incorporation_ccy_original`,         `tcdr`.`inter_company`,         `tcdr`.`internal_maturity_class`,         NVL(`juris`.`isda`, 'No') `isda_flg`,         `tcdr`.`k_function_used`,         `tcdr`.`k_maturity`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`kccp`                 ELSE NULL            END         `kccp`,         CASE                 WHEN `ccp`.`kccp` IS NOT NULL                      AND `ccp`.`kccp` != 0 THEN 'Y'                 ELSE 'N'             END         `kccp_calc`,         `tcdr`.`legislated_program_applied`,         `tcdr`.`lgd` `LGD`,        `txn`.`lgd` `lgd_dollar`,         `tcdr`.`lgd_grade`,         `tcdr`.`lgd_grade_agency`,         `tcdr`.`lgd_grade_inf`,         `tcdr`.`lgd_grade_rank`,         `tcdr`.`lgd_grade_sup`,         `tcdr`.`lgd_mitigation`,         `tcdr`.`lgd_pre_floor_new`,         `tcdr`.`lgd_pre_floor_original`,         CASE                 WHEN (                     (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0 )                     AND (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.05 )                 ) THEN '0% - 04.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.05                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.1                 ) THEN '05% - 09.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.1                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.15                 ) THEN '10% - 14.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.15                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.2                 ) THEN '15% - 19.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.2                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.25                 ) THEN '20% - 24.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.25                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.3                 ) THEN '25% - 29.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.3                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.35                 ) THEN '30% - 34.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.35                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.4                 ) THEN '35% - 39.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.4                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.45                 ) THEN '40% - 44.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.45                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.5                 ) THEN '45% - 49.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.5                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.55                 ) THEN '50% - 54.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.55                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.6                 ) THEN '55% - 59.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.6                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.65                 ) THEN '60% - 64.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.65                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.7                 ) THEN '65% - 69.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.70                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.75                 ) THEN '70% - 74.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.75                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.80                 ) THEN '75% - 79.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.80                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.85                 ) THEN '80% - 84.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.85                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.90                 ) THEN '85% - 89.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.90                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.95                 ) THEN '90% - 94.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.95                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     <= 1                 ) THEN '95% - 100%'                 WHEN (                     CASE                         WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                         ELSE `txn`.`lgd`                     END                 > 1 ) THEN '>100%'             END         `lgd_range`,         `tcdr`.`lgd` `lgd_tcdr`,         `txn`.`limit_attribute`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`contract_reference`                 ELSE NULL             END         `limit_id`,         CASE                 WHEN `tcdr`.`facility_reference` IS NOT NULL AND `tcdr`.`facility_reference` != ''  THEN 'Linked'                 ELSE 'Unlinked'             END         `linked_unlinked_ind`,         null `lmt_eff_dt`,         `tcdr`.`long_short`,         `tcdr`.`look_through_treatment`,         `crsr`.`lt_rat_agency_code` `lt_rat_agency_cd`,         NVL(`tcdr`.`ltv`,0) `LTV`,         `tcdr`.`ltv_current`,         CASE                 WHEN `prod`.`product_level` = 'Standard Product'                      AND `prod`.`description` LIKE 'Private Equity%' THEN concat('078||',substr(`tcdr`.`dealbook`,length(`tcdr`.`dealbook`) - 7,length(`tcdr`.`dealbook`) ) )                 ELSE `tcdr`.`dealbook`             END         `management_location_cd`,            NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `management_prod_wid`,  NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `management_prod_id`,                    `tcdr`.`margin_period`,         `tcdr`.`maturity_date`,         `tcdr`.`maturity_eff`,         'N' `maturity_limit_flag`,         `txn`.`maturity_range` `maturity_range`,         `tcdr`.`method_new`,         `tcdr`.`method_original`,         `cva`.`mi`,         `cva`.`mi_hedge`,         `tcdr`.`mm`,         `tcdr`.`mortgage_alternative`,         `tcdr`.`business_identifier` `MRU_IDENTIFIER`,  `tcdr`.`business_identifier` `BUSINESS_IDENTIFIER`,         `txn`.`mtm`,         `inst`.`custom_attribute_18` `nbv_currency`,         `inst`.`custom_attribute_17` `nbv_value`,         CASE                 WHEN trim(`ent`.`attribute_3`) = 'T' THEN 'TRUE'                 WHEN trim(`ent`.`attribute_3`) = 'F' THEN 'FALSE'                 ELSE `ent`.`attribute_3`         END         `negative_pledge_identifier`,          CASE                 WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)    WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm` ELSE 0         END         `net_mtm`,          ( (CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL')                             THEN NVL(round(`txn`.`outstanding`,10), 0)ELSE 0                        END) + nvl(round(`txn`.`accrued_interest`,10),0) +   ( CASE WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)   WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm`  ELSE 0 END) )   `net_nominal`,          nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         `netted_ead`,         ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) * ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) `netted_ead_square`,         '0' `netted_nominal`,         `tcdr`.`netting_agreement_reference` `NETTING_AGREEMENT_REF_NO`,         `tcdr`.`netting_class`,         NVL(`juris`.`isda`, 'No') `netting_flg`,         `clrh`.`no_clear_mem_n`,    ((CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX',           'FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(round(`tcdr`.`outstanding`,10), 0)                    ELSE 0                    END                   ) +                   NVL(round(`txn`.`accrued_interest`,10), 0) +                   (CASE WHEN `tcdr`.`table_name` IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX',               'FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN                        (CASE  WHEN UPPER(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN                              (CASE WHEN round(`tcdr`.`fair_value`,10) > 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                              )                         ELSE (CASE WHEN round(`tcdr`.`fair_value`,10) < 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                               )                         END                         )                     ELSE 0                     END                    )                  ) `nominal`,            `tcdr`.`nominal` `nominal_tcdr`,         `txn`.`non_borrowing_ind` `NON_BORROWING`,         substr(trim(`ent`.`attribute_17`), 1, 1) `non_contractual_parental_supt`,         substr(trim(`ent`.`attribute_17`), 3, 1) `non_financial_scorecard`,         `txn`.`non_gam_ind`,         `tcdr`.`non_material_equity`,         `txn`.`notional`,         `deal`.`nominal_2` `NOTIONAL_2`,         `deal`.`currency_2` `NOTIONAL_2CCY`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`tcdr`.`nominal`) *-1                         ELSE abs(`tcdr`.`nominal`)                     END                 )                 ELSE 0             END         `notional_tcdr`,         'CDW needed - cdw_txn_rmi_ddmmyyyy.txt' `obl_flg`,         `tcdr`.`obligor_grade_inf_new`,         `tcdr`.`obligor_grade_inf_original`,         `tcdr`.`obligor_grade_new`,         `tcdr`.`obligor_grade_original`,         `tcdr`.`obligor_grade_rank_new`,         `tcdr`.`obligor_grade_rank_original`,         `tcdr`.`obligor_grade_sup_new`,         `tcdr`.`obligor_grade_sup_original`,         CASE                 WHEN `inst`.`cost_center` IN (                     'FM ALM',                     'Principal Finance'                 ) THEN 'OCC_Own Account'                 ELSE nvl(`txn`.`customer_subsegment_code`,'UNMP')             END         `occ_sub_segment`,         `txn`.`bs_type` `ON_OFF_BALANCE_SHEET_FLAG`,         nvl(`tcdr`.`pd_original`,0) `org_pd`,         `tcdr`.`original_cost`,         nvl(`tcdr`.`internal_rating_original`,'CRG Original Unmapped') `original_crg`,          `txnf`.`original_limit_amount` `original_limit_amount`,          `tcdr`.`original_maturity`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `original_scorecard`,         `txn`.`outstanding` `os`,         `facprod`.`contract_type` `out_limit_product`,   CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(`tcdr`.`outstanding`, 0) ELSE 0 END `outstanding`,          `txn`.`outstanding` `outstanding_dollar`,         'MFU needed - cdw_BOEACBTXN_rmi_DDMMYYYY.txt' `overdue_days`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_1`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_2`,         `tcdr`.`parent_id`,         `tcdr`.`past_due_int`,         `tcdr`.`past_due_ppal`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`pce_flag`                 ELSE NULL             END         `pce_flag`,         `rat`.`one_year_pd` `pd_midpoint`,         `tcdr`.`pd_new`,         `tcdr`.`pd_original`,         `tcdr`.`pd_pre_floor_new`,         `tcdr`.`pd_pre_floor_original`,         `tcdr`.`performing_status`,         `tcdr`.`pool_code` `POOL_CD`,         `tcdr`.`premium_current`,         `contp`.`attribute_1` `prod_cat_info`,         `tcdr`.`product_gl_criteria`,         `tcdr`.`product_gl_criteria_2`,         NVL(`tcdrp`.`tot_el`,0) `PROXY_EL`,         NVL(`tcdrp`.`lgd_used`,0) `PROXY_LGD`,         NVL(NVL(`txn`.`prr`, `sme_prr`.`product_recovery_rate`  ),0) `PRR`,    nvl(`inst`.`psgl_account_number`, `psgl`.`psgl_account`) `PSGL_ACCOUNT`,           nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_CD`,  nvl(nvl(`inst`.`psgl_customer_class`, `psgl`.`psgl_cust_class`), `txn`.`psgl_cust_class`) `PSGL_CUST_CLASS`,  nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_DEPARTMENT`,  nvl(nvl(`inst`.`psgl_operating_unit`, `psgl`.`psgl_operating_unit`), `txn`.`psgl_operating_unit`) `PSGL_OPERATING_UNIT`,  nvl(nvl(`inst`.`psgl_product_code`, `psgl`.`psgl_product`), `txn`.`psgl_product`) `PSGL_PRODUCT`,          `tcdr`.`qualifying_ccp`,         `tcdr`.`qualifying_transaction`,         `crsr`.`lt_rat_code` `RATING_CD`,         `txn`.`replacement_cost` `RC`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN (                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE (                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END         `rc_tcdr`,         `txn`.`replacement_cost` `REPLACEMENT_COST`,         `tcdr`.`residual_maturity`,         `tcdr`.`rgc`,         `tcdr`.`risk_bucket`,         `tcdr`.`risk_bucket_original`,         `tcdr`.`risk_country`,         `tcdr`.`risk_country_new`,         `tcdr`.`risk_country_original`,         `tcdr`.`risk_type`,         `crm`.`rw_expo` `rw_expo`,         `tcdr`.`rw_new`,         `tcdr`.`rw_original`,         `tcdr`.`rw_scaling_factor`,         `tcdr`.`rwa`,         NVL(`trfrsk`.`rwa_add_on`,0) `rwa_add_on`,         `tcdr`.`rwa` `rwa_after_scale`,         nvl(round(`tcdr`.`rwa`,10),0) / 1.06 `rwa_before_scale`,         `trfrsk`.`rwa_cpty` `rwa_cpty`,         `tcdr`.`rwa` `RWA_NET_SAVES`,         `tcdr`.`rwa_pre_cap`,         `tcdr`.`rwa_pre_crm`,         `tcdr`.`rwa_pre_floor_equity`,         'MFU needed - Pool_Ref_MONYY.txt' `rwa_saves`,         `tcdr`.`rwa_scaling_factor`,         `trfrsk`.`rwa_total` `rwa_total`,         `ccp`.`is_scb_clr_mem` `scb_clearing_mem`,         `tcdr`.`second_loss_treatment`,         `tcdr`.`secu_bank_role`,         `tcdr`.`secu_company_weight`,         `tcdr`.`secu_ea_controlled`,         `tcdr`.`secu_issue_date`,         `tcdr`.`secu_loss_position`,         `tcdr`.`secu_mode`,         `tcdr`.`secu_retail_line_fg`,         `tcdr`.`secu_spread_trapping_ratio`,         `tcdr`.`secu_uncommited_retail_fg`,         `txn`.`lgd` `SECURED_LGD`,         `tcdr`.`securitization_n`,         `tcdr`.`securitization_reference` `SECURITIZATION_REF_NO`,         `tcdr`.`securitized`,         `tcdr`.`security_positions_ref`,         `txn`.`segment_original`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code`                              AND `clrm`.`entity_code` = `clrm`.`clearing_house_code` THEN `clrm`.`clearing_member_conditions`                         ELSE NULL                     END                 ELSE NULL             END         `segregated`,         `tcdr`.`seniority_new`,         `tcdr`.`seniority_original`,         `tcdr`.`settlement_price`,         `reposr`.`sov_indicator` `sov_indicator`,         `tcdr`.`sovereign_risk_bucket_new`,         `tcdr`.`sovereign_risk_bucket_ori`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_wid`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_cd`,         `tcdr`.`standard_rw_new`,         `tcdr`.`standard_rw_original`,         `txn`.`start_date`,         null `std_rw_override_indicator`,         `inst`.`custom_attribute_16` `strategy`,         `tcdr`.`stress_testing_scenario_id`,         `txn`.`sub_limit_fac_reference` `sub_limit_fac_ref_no`,         `tcdr`.`sub_method_new`,         `tcdr`.`sub_method_original`,         `tcdr`.`sub_reference`,         `tcdr`.`supervisor_code` `SUPERVISOR_CD`,         CASE WHEN `enl`.`link_type` = 'SUPFIN' then `enl`.`mother_code` else 'UNMP SUPFIN' end `supfin_cd`,         `tcdr`.`table_name` `table_name`,         'SMC_PERIMETER required' `tbs_cd`,         `txn`.`maturity_range` `TENOR_BUCKETS`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`third_party_cp_flag`                 ELSE 'N/A'             END         `third_party_cp_flag`,         `tcdr`.`tier1_deduction`,         `tcdr`.`tier2_deduction`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`tot_pre_fund_con`                 ELSE NULL             END         `tot_pre_fund_con`,         `tcdr`.`total_annual_assets`,         `tcdr`.`total_annual_sales`,         `fac`.`amount` `total_facility_amount`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`total_initital_margin`                 ELSE NULL             END         `total_initital_margin`,         `inst`.`tp_portfolio_name` `tp_portfolio_name`,         'MFU needed - e_balances.txt' `tp_sys_scr_id`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / round(`t_cdr_temp`.`rwa`,10) ) )                 ELSE 0             END         `tr_addon_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN ( nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0) )                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / `t_cdr_temp`.`rwa` ) )                 ELSE 0             END         `tr_addon_rwa`,         nvl(`trfrsk`.`tr_el`,0) `tr_el`,         NVL(`trfrsk`.`tr_gua_ctry`, 'UNMP') `tr_gua_ctry`,         CASE                 WHEN `t_cdr_temp`.`el` != 0          THEN nvl(round(`t_cdr_temp`.`el`,10),0) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) )                 ELSE 0             END         `tr_pre_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN nvl(round(`t_cdr_temp`.`rwa`,10),0) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) ) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) )                 ELSE 0             END         `tr_pre_rwa`,         `tcdr`.`trade_date`,         `tcdr`.`trading_book_type`,         `tcdr`.`trading_book_type` `TRADING_IND`,         `tcdr`.`tranche_collateral_type`,         `tcdr`.`tranche_guarantee_type`,         `txn`.`tranche_lgd`,         NVL(`trfrsk`.`transfer_risk`,'N') `transfer_risk`,         `txn`.`limit_amount` `txn_limit_amount`,         `txn`.`rw_new` `txn_rw_new`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`uci`                 ELSE NULL             END         `uci`,         `tcdr`.`uncommited` `uncommited`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`nominal`             END         `uncommitted_amount`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`ead_pre_ccf`             END         `uncommitted_available_amunt`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 )                      AND `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_headroom`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 )                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_os`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`ead_pre_ccf`             END         `uncommitted_used_amount`,         `tcdr`.`unconditionnaly_cancelable`,         `tcdr`.`und_pool_ref`,         `txn`.`unmapped_ind`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                      AND `tcdr`.`tranche_guarantee_type` = 'NOT GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `unsecured_ead`,         `tcdr`.`used_amount_facility`,         `tcdr`.`value_date`,         `txn`.`waterfall_seniority`,         `cva`.`wi` `wi`,         case when `rat`.`row_owner` = 'C' AND `rat`.`agency_code` = 'INTERNAL' AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) >= nvl(round(`rat`.`pd_inf`,10),0)   AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) < nvl(round(`rat`.`pd_sup`,10),0)   THEN `rat`.`rating` ELSE `icr`.`long_term_rating` END `wt_crg`,         nvl(round(`tcdr`.`pd_new`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_final_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`k_maturity`,10) ) `wt_k_maturity`,         `txn`.`wt_lgd`,         (nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`k_maturity`,10),0)) `wt_mat_eff`,         nvl(round(`tcdr`.`pd_original`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_org_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_new`,10) ) `wt_pd_new`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_original`,10) ) `wt_pd_original`,         nvl(`txn`.`wt_residual_maturity`,0) `wt_residual_maturity`,         ( round(`tcdr`.`pd_new`,10) * round(`tcdr`.`nominal`,10) ) `wtpdlgd`,         ( round(`tcdr`.`pd_new`,10) * round(`txn`.`wt_lgd`,10) ) `wtpdnm`,         `tcdrp`.`xrc`,         `tcdr`.`zero_haircut_for_repo`,         `tcdr`.`zero_rw_for_equity`,         `tcdr`.`zone_a_new`,         `tcdr`.`zone_a_original`,  `tcdr`.`collateral_assigned_amount` `COLLATERAL_ASSIGNED_AMOUNT`,  '0' `collateral_unique_id`,  NVL(`smeprod`.`product_type`,`retail_exp`.`product_type`) `sme_product_type`,   CASE WHEN SUBSTR((case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END ), -2) = '-M'                   THEN                   substr( (case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END)         , 1         ,  length(trim(case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END ))-2                   )                     ELSE                  case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END          END `DERIVED_LIMIT_ID`,  `derived_lt`.`limit_id_trim` `DERIVED_LIMIT_ID_STP`,  CASE WHEN `tcdr`.`method_new` = 'ADV' THEN round(NVL(`tcdr`.`ead`, 0),5) *          (CASE WHEN ( (`tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') <> 'RW_LGD_UPDATE'                         ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`txn`.`lgd`,0),5)                 WHEN ( (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') = 'RW_LGD_UPDATE'                          ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`tcdr`.`exposure_attribute_7`,0),5)                 ELSE 0 END         ) ELSE 0 END `unsecured_lgd_dollar`,    case when `be`.`booking_loc_id` = 'SG'  then 'SG'  when `be`.`booking_loc_id` = 'MY'  then 'MY' when `be`.`booking_loc_id` = 'VN'  then 'VN' when `be`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end as `SECURITY_CTRY`,    case when `tcdr`.`dealbook` like '%CI%' OR `tcdr`.`dealbook` like '%CC%' then 'CICC'   when `tcdr`.`dealbook` like '%RT%' then 'RT'   when `tcdr`.`dealbook` like '%PB%' then 'PB'   when `tcdr`.`dealbook` like '%OB%' then 'OB'   else 'OTHERS' end AS `SECURITY_SEG`                          FROM         `sgmisitstg`.`stg_bcrs_t_cdr` `tcdr`           LEFT JOIN `sgmisit`.`sgmi_txn_rwa_f` `txn` ON `tcdr`.`id` = `txn`.`id`                                                             AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`txn`.`partition_key`,'UNM')            AND `txn`.`w_datasource_id` = 'BCRS_RC'            AND `txn`.`w_snapshot_dt` = '2021-06-30'            AND `txn`.`w_country_cd` = 'ALL'            AND `txn`.`w_workspace` = 'WS42'            LEFT JOIN (select `tbl`.`netting_agreement_reference`, `tbl`.`partition_key`, `tbl`.`rnk`, `tbl`.`sum_mtm` from (select `sgmi_txn_rwa_f`.`netting_agreement_reference`,`sgmi_txn_rwa_f`.`partition_key`, row_number() over(partition by `sgmi_txn_rwa_f`.`netting_agreement_reference`,`sgmi_txn_rwa_f`.`partition_key`) `rnk`, sum(`sgmi_txn_rwa_f`.`mtm`) over(partition by netting_agreement_reference,partition_key) `sum_mtm`   from `sgmisit`.`sgmi_txn_rwa_f`    where    `sgmi_txn_rwa_f`.`w_snapshot_dt` = '2021-06-30' and   `sgmi_txn_rwa_f`.`w_workspace` in (   (case when instr('WS42','ADJ')>0 then substr('WS42',1,instr('WS42','_ADJ') - 1) else concat('WS42','_ADJ') end), 'WS42')  ) `tbl` where `tbl`.`rnk`=1  ) `txn2`  ON `txn`.`netting_agreement_reference` = `txn2`.`netting_agreement_reference`                                                               AND nvl(`txn`.`partition_key`,'UNM') = nvl(`txn2`.`partition_key`,'UNM')                   LEFT JOIN `sgmisitstg`.`stg_bcrs_facility` `fac` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`fac`.`contract_reference`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`fac`.`partition_key`,1,8)                                                       AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`fac`.`contract_type`,'UNM')             AND `fac`.`w_batch_id` = '2021101912453900275'          LEFT JOIN (select `stg_bcrs_scb_wb_addt_inst`.`partition_key`, `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`, `stg_bcrs_scb_wb_addt_inst`.`arm_code`, `stg_bcrs_scb_wb_addt_inst`.`arm_description`, `stg_bcrs_scb_wb_addt_inst`.`cost_center`, `stg_bcrs_scb_wb_addt_inst`.`cost_center_descriotion`,    `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_18`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_17`, `stg_bcrs_scb_wb_addt_inst`.`psgl_account_number`, `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`, `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`, `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_16`, `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`, `stg_bcrs_scb_wb_addt_inst`.`w_batch_id`,    ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ) AS `rnk`      FROM `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2021101912453900275' AND  NVL(`stg_bcrs_scb_wb_addt_inst`.`arm_code`,'') <> ''     ) `inst` ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`inst`.`contract_reference`),'UNM')                                                       AND trim(`tcdr`.`table_name`) = trim(`inst`.`table_name`)                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`inst`.`partition_key`,1,8)             AND `inst`.`rnk`=1   LEFT JOIN ( select `stg_bcrs_scb_wb_psgl`.`partition_key`, `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name`, `stg_bcrs_scb_wb_psgl`.`psgl_bu`, `stg_bcrs_scb_wb_psgl`.`psgl_account`, `stg_bcrs_scb_wb_psgl`.`psgl_product`, `stg_bcrs_scb_wb_psgl`.`psgl_department`, `stg_bcrs_scb_wb_psgl`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_psgl`.`psgl_cust_class`, `stg_bcrs_scb_wb_psgl`.`financial_book_code`, `stg_bcrs_scb_wb_psgl`.`booking_location`, `stg_bcrs_scb_wb_psgl`.`w_batch_id`, ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name` ) AS `rnk`       FROM `sgmisitstg`.`stg_bcrs_scb_wb_psgl`   WHERE `stg_bcrs_scb_wb_psgl`.`w_batch_id` = '2021101912453900275'     AND  NVL(`stg_bcrs_scb_wb_psgl`.`psgl_bu`,'') <> '') `psgl`   ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`psgl`.`contract_reference`),'UNM')    AND trim(`tcdr`.`table_name`) = trim(`psgl`.`fermat_table_name`)   AND substr(`tcdr`.`partition_key`,1,8) = substr(`psgl`.`partition_key`,1,8)               AND `psgl`.`rnk`=1                        LEFT JOIN ( select `stg_bcrs_t_crm`.`partition_key`, `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`,`stg_bcrs_t_crm`.`expo_table_name`,`stg_bcrs_t_crm`.`w_batch_id`,`stg_bcrs_t_crm`.`rw_expo`,`stg_bcrs_t_crm`.`attribute_6`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ORDER BY `stg_bcrs_t_crm`.`expo_contract_reference`,    `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ) AS `rnk`    FROM `sgmisitstg`.`stg_bcrs_t_crm`   WHERE CASE WHEN 'WS42' like '%ADJ%' THEN `stg_bcrs_t_crm`.`w_batch_id` = '2021101912453900275' ELSE `stg_bcrs_t_crm`.`w_batch_id` = '2021101912453900275' END           ) `crm` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`crm`.`expo_contract_reference`,'UNM')          AND nvl(`tcdr`.`counterparty_original`, 'UMP') = nvl(`crm`.`expo_counterparty`, 'UMP')                                                    AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`crm`.`partition_key`,'UNM')          AND `crm`.`expo_table_name` = 'ON_OFF_BALANCE'          AND `crm`.`rw_expo` is not null          AND `crm`.`rnk` = 1            LEFT JOIN (             SELECT   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                                `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`avg_pre_funded_contribution`) `avg_pre_funded_contribution`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`beta`) `beta`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`clearing_house_name`) `ccp_name`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`pre_funded_financial`) `dfccp`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_prefunded_contribution`) `dfi`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`kccp`) `kccp`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`sum_pre_fund_contribution`) `tot_pre_fund_con`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`total_initial_margin`) `total_initital_margin`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_committed_contributions`) `uci`             FROM                 `sgmisitstg`.`stg_bcrs_scb_wb_ccp_static`   WHERE `stg_bcrs_scb_wb_ccp_static`.`w_batch_id` = '2021101912453900275'       AND `stg_bcrs_scb_wb_ccp_static`.`beta` is not null AND `stg_bcrs_scb_wb_ccp_static`.`beta` != ''             GROUP BY   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                 `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`         ) `ccp` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`ccp`.`clearing_house_code`,'UNM')                  AND substr(`tcdr`.`partition_key`,1,8) = substr(`ccp`.`partition_key`,1,8)          LEFT JOIN (             SELECT   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`,                 SUM(`stg_bcrs_t_cva`.`bi`) `bi`,                 SUM(`stg_bcrs_t_cva`.`cva_index_part`) `cva_index_part`,                 SUM(`stg_bcrs_t_cva`.`cva_capital_charge`) `cva_rwa_addon`,                 MAX(`stg_bcrs_t_cva`.`mi`) `mi`,                 SUM(`stg_bcrs_t_cva`.`mi_hedge`) `mi_hedge`,                 MAX(`stg_bcrs_t_cva`.`wi`) `wi`             FROM                 `sgmisitstg`.`stg_bcrs_t_cva`   WHERE `stg_bcrs_t_cva`.`w_batch_id` = '2021101912453900275'             GROUP BY   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`         ) `cva` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`cva`.`contract_reference`,'UNM')                  AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`cva`.`partition_key`,'UNM')                  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`cva`.`counterparty`,'UNM')          LEFT JOIN `sgmisit`.`sgmi_client_d` `client` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`client`.`client_id`,'UNM')    AND `client`.`w_datasource_id` = 'BCRS_RC' AND `client`.`w_snapshot_dt` = '2021-06-30'    LEFT JOIN `sgmisit`.`sgmi_obi_pd_lookup_dat` `obi` ON substr(`tcdr`.`partition_key`,1,6) = nvl(`obi`.`partition_key`,'UNM')          LEFT JOIN `sgmisitstg`.`stg_bcrs_v_scb_gpr_ec_t_cdr_prx` `tcdrp` ON nvl(`tcdr`.`id`,'UNM') = nvl(`tcdrp`.`id`,'UNM')                                                                       AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`tcdrp`.`partition_key`,'UNM')               AND `tcdrp`.`w_batch_id` = '2021101912453900275'         LEFT JOIN (             SELECT   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`,                 MAX(`stg_bcrs_bis_clearing_house`.`df_cm`) `df_cm`,                 MAX(`stg_bcrs_bis_clearing_house`.`n`) `no_clear_mem_n`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_house`   WHERE CASE WHEN 'WS42' like '%ADJ%' THEN `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2021101912453900275' ELSE `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2021101912453900275' END             GROUP BY   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`         ) `clrh` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`clrh`.`entity_code`,'UNM')                   AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrh`.`partition_key`,'UNM')          LEFT JOIN   (select `stg_bcrs_entity_links`.`partition_key`, `stg_bcrs_entity_links`.`child_code`, `stg_bcrs_entity_links`.`link_type`, `stg_bcrs_entity_links`.`mother_code`, `stg_bcrs_entity_links`.`w_batch_id`, ROW_NUMBER() OVER(ORDER BY `stg_bcrs_entity_links`.`mother_code` desc) AS `rnk`  FROM `sgmisitstg`.`stg_bcrs_entity_links` where `stg_bcrs_entity_links`.`w_batch_id` = '2021101912453900275' and `stg_bcrs_entity_links`.`link_type` = 'DLRFIN' ) `enl`   ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`enl`.`child_code`,'UNM')         AND substr(`tcdr`.`partition_key`,1,8) = substr(`enl`.`partition_key`,1,8)         AND `enl`.`rnk`=1           LEFT JOIN (select `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`, `stg_bcrs_csr`.`table_name`, `stg_bcrs_csr`.`imc_1`, `stg_bcrs_csr`.`w_batch_id`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ORDER BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ) AS `rnk`   from `sgmisitstg`.`stg_bcrs_csr`   where CASE WHEN 'WS42' like '%ADJ%' THEN `stg_bcrs_csr`.`w_batch_id` = '2021101912453900275' ELSE `stg_bcrs_csr`.`w_batch_id` = '2021101912453900275' END ) `csr`     ON `tcdr`.`contract_reference` = `csr`.`contract_reference`    AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`csr`.`contract_type`,'UNM')    AND nvl(`tcdr`.`counterparty_new`,'UNM') = nvl(`csr`.`counterparty`,'UNM')    AND nvl(`tcdr`.`method_new`,'UNM') = nvl(`csr`.`method`,'UNM')    AND `tcdr`.`bs_type` = `csr`.`bs_type`    AND `tcdr`.`dealbook` = `csr`.`book_code`    AND (case when nvl(`tcdr`.`table_name`,'z') in ('BOND', 'EQUITY', 'TRANCHE', 'CONVERTIBLE', 'FUND') then 'SECURITY_POSITIONS'             else nvl(`tcdr`.`table_name`, 'z') end) = `csr`.`table_name`    AND `csr`.`imc_1` is not null    AND trim(`csr`.`imc_1`) != ''    AND `csr`.`rnk` = 1    LEFT JOIN ( select `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_cpty`),0) `EL_CPTY`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_total`),0) `EL_TOTAL`,      NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`),0) `rwa_add_on`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`),0) `rwa_cpty`,      NVL(NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_total`),SUM(NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`,0) +  NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`,0))),0) `RWA_TOTAL`,      NVL(sum(`stg_bcrs_scb_wb_tr_sr`.`tr_el`),0) `tr_el`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry` `TR_GUA_CTRY`, MAX(NVL(`stg_bcrs_scb_wb_tr_sr`.`is_tr`,'N')) `TRANSFER_RISK`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`   from `sgmisitstg`.`stg_bcrs_scb_wb_tr_sr`    where CASE WHEN 'WS42' like '%ADJ%' THEN `stg_bcrs_scb_wb_tr_sr`.`w_batch_id` = '2021101912453900275' ELSE `stg_bcrs_scb_wb_tr_sr`.`w_batch_id` = '2021101912453900275' END    group by `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`  ) `trfrsk`  ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`trfrsk`.`contract_reference`,'UNM')  AND nvl(`tcdr`.`table_name`,'UNM') = nvl(`trfrsk`.`table_name`,'UNM')  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`trfrsk`.`pr_obligor`,'UNM')  AND `tcdr`.`contract_type` = `trfrsk`.`contract_type`  and `tcdr`.`bs_type` = `trfrsk`.`bs_type`    LEFT JOIN (   select  `tbl`.`contract_reference`, `tbl`.`und_pool_ref`, `tbl`.`bs_type`, `tbl`.`sub_reference`, `tbl`.`prr`, `tbl`.`rnk` from (     SELECT      `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,     `stg_bcrs_scb_wb_prr_sr`.`und_pool_ref`,     `stg_bcrs_scb_wb_prr_sr`.`bs_type`,     `stg_bcrs_scb_wb_prr_sr`.`sub_reference`,     `stg_bcrs_scb_wb_prr_sr`.`prr`,     row_number() over(partition by `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,`stg_bcrs_scb_wb_prr_sr`.`und_pool_ref`,`stg_bcrs_scb_wb_prr_sr`.`bs_type`,`stg_bcrs_scb_wb_prr_sr`.`sub_reference`,`stg_bcrs_scb_wb_prr_sr`.`prr`) `rnk`      FROM       `sgmisitstg`.`stg_bcrs_scb_wb_prr_sr`     WHERE CASE WHEN 'WS42' like '%ADJ%' THEN `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2021101912453900275' ELSE `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2021101912453900275' END         AND  NVL(`stg_bcrs_scb_wb_prr_sr`.`prr`,'') <> ''    ) `tbl` where `tbl`.`rnk`=1   ) `prrsr` on `tcdr`.`contract_reference` = `prrsr`.`contract_reference` and nvl(`tcdr`.`und_pool_ref`,'UNM') = nvl(`prrsr`.`und_pool_ref`,'UNM')  and nvl(`tcdr`.`bs_type`,'UNM') = nvl(`prrsr`.`bs_type`,'UNM') and nvl(`tcdr`.`sub_reference`,'UNM') = nvl(`prrsr`.`sub_reference`,'UNM')      LEFT JOIN (select `stg_bcrs_scb_wb_repo_sr`.`partition_key`, `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`, `stg_bcrs_scb_wb_repo_sr`.`external_rating`, `stg_bcrs_scb_wb_repo_sr`.`sov_indicator`, `stg_bcrs_scb_wb_repo_sr`.`security_contract_ref`,     ROW_NUMBER() OVER(partition by `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref` order by `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`) as `rnk`   from `sgmisitstg`.`stg_bcrs_scb_wb_repo_sr`  WHERE CASE WHEN 'WS42' like '%ADJ%' THEN `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2021101912453900275' ELSE `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2021101912453900275' END   AND `stg_bcrs_scb_wb_repo_sr`.`sov_indicator` IS NOT NULL ) `reposr`   ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`reposr`.`partition_key`,'UNM')  AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`reposr`.`repo_contract_ref`,'UNM')  AND `reposr`.`rnk`=1            LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `scrd` ON nvl(`scrd`.`org_scrd_g3_code`,'UNM') = nvl(`txn`.`scorecard_original`,'UNM')           LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`,                 MIN(`stg_bcrs_facility`.`dim3`) `facility_availability_end_date`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2021101912453900275'              GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`         ) `facagg` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`facagg`.`contract_reference`,'UNM')                     AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`facagg`.`counterparty_code`,'UNM')                     AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`facagg`.`partition_key`,'UNM')                   LEFT JOIN `sgmisitstg`.`stg_bcrs_credit_rating_sr` `crsr` ON nvl(`reposr`.`security_contract_ref`,'UNM') = nvl(`crsr`.`reference`,'UNM')                                                                AND `crsr`.`lt_rat_agency_code` IS NOT NULL               AND CASE WHEN 'WS42' like '%ADJ%' THEN `crsr`.`w_batch_id` = '2021101912453900275' ELSE `crsr`.`w_batch_id` = '2021101912453900275' END          LEFT JOIN `sgmisitstg`.`stg_bcrs_product` `prod` ON nvl(`tcdr`.`contract_type`,'UNM') = nvl(`prod`.`product`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`prod`.`partition_key`,1,8)             AND `prod`.`w_batch_id` = '2021101912453900275'          LEFT JOIN `sgmisitstg`.`stg_bcrs_entity` `ent` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`ent`.`entity_code`,'UNM')                                                     AND substr(`tcdr`.`partition_key`,1,8) = substr(`ent`.`partition_key`,1,8)            AND `ent`.`w_batch_id` = '2021101912453900275'          LEFT JOIN `sgmisitstg`.`stg_bcrs_deal_import` `deal` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`deal`.`contract_reference`,'UNM')                                                           AND substr(`tcdr`.`partition_key`,1,8) = substr(`deal`.`contract_reference`,1,8)          AND `deal`.`w_batch_id` = '2021101912453900275'          LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`,                 MAX(nvl(case when trim(`stg_bcrs_facility`.`attribute_4`) = '' then null else `stg_bcrs_facility`.`attribute_4` end,`stg_bcrs_facility`.`amount`) ) `original_limit_amount`,                 MIN(`stg_bcrs_facility`.`dim2`) `pce_flag`,                 MIN(`stg_bcrs_facility`.`dim1`) `third_party_cp_flag`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2021101912453900275'                GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`         ) `txnf` ON nvl(`txn`.`sub_limit_fac_reference`,'UNM') = nvl(`txnf`.`contract_reference`,'UNM')                   AND substr(`txn`.`partition_key`,1,8) = substr(`txnf`.`partition_key`,1,8)                   AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`txn`.`contract_reference`,'UNM')     AND `tcdr`.`import_source` like '%WB%'                                       AND `tcdr`.`id` = `txn`.`id`             LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`icr`.`entity_code`,'UNM')                                                                    AND substr(`tcdr`.`partition_key`,1,8) = substr(`icr`.`partition_key`,1,8)                                                                    AND `icr`.`agency_code` = 'INTERNAL'            AND `icr`.`w_batch_id` = '2021101912453900275'          LEFT JOIN `sgmisitstg`.`stg_bcrs_rating` `rat` ON nvl(`icr`.`long_term_rating`,'UNM') = nvl(`rat`.`rating`,'UNM')                                                     AND substr(`icr`.`partition_key`,1,8) = substr(`rat`.`partition_key`,1,8)                                                     AND `rat`.`agency_code` = 'INTERNAL'           AND `rat`.`w_batch_id` = '2021101912453900275'          LEFT JOIN (             SELECT    `stg_bcrs_bis_clearing_member`.`w_batch_id`,                 `stg_bcrs_bis_clearing_member`.`partition_key`,                 `stg_bcrs_bis_clearing_member`.`entity_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_house_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_member_conditions`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_bis_clearing_member`.`entity_code` ORDER BY `stg_bcrs_bis_clearing_member`.`entity_code` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_member`   WHERE CASE WHEN 'WS42' like '%ADJ%' THEN `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2021101912453900275' ELSE `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2021101912453900275' END          ) `clrm` ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrm`.`partition_key`,'UNM')                   AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`clrm`.`entity_code`,'UNM')     AND `clrm`.`w_batch_id` = '2021101912453900275'     AND `clrm`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_currency` `cur` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`cur`.`partition_key`,'UNM')                                                       AND nvl(`fac`.`currency`,'UNM') = nvl(`cur`.`ccy_code`,'UNM')             AND `cur`.`w_batch_id` = '2021101912453900275'           LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `juris` ON nvl(`tcdr`.`incorporation_country`,'UNM') = nvl(`juris`.`country_cd`,'UNM')                                                                  AND `juris`.`etl_current_record_flag` = 'Y'          LEFT JOIN (             SELECT    `stg_bcrs_facility_products`.`w_batch_id`,                 `stg_bcrs_facility_products`.`partition_key`,                 `stg_bcrs_facility_products`.`facility_reference`,                 `stg_bcrs_facility_products`.`contract_type`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_facility_products`.`facility_reference` ORDER BY `stg_bcrs_facility_products`.`facility_reference` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_facility_products`   WHERE `stg_bcrs_facility_products`.`w_batch_id` = '2021101912453900275'         ) `facprod` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`facprod`.`partition_key`,'UNM')                      AND nvl(`facprod`.`facility_reference`,'UNM') = substr(`fac`.`contract_reference`,1,instr(`fac`.`contract_reference`,'-M') - 1)                      AND `fac`.`attribute_1` = 'MOTHER'        AND `facprod`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON substr(`tcdr`.`partition_key`,1,8) = substr(`contp`.`partition_key`,1,8)                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`facprod`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021101912453900275'          LEFT JOIN (             SELECT   w_batch_id,                 partition_key,                 nvl(`t_cdr`.`contract_reference`,'UNM') `contract_reference`,                 nvl(`t_cdr`.`table_name`,'UNM') `table_name`,                 nvl(`t_cdr`.`counterparty_original`,'UNM') `counterparty_original`,                 SUM(nvl(`t_cdr`.`rwa`,0) ) `rwa`,                 SUM(nvl(`t_cdr`.`el`,0) ) `el`             FROM                 `sgmisitstg`.`stg_bcrs_t_cdr` `t_cdr`   WHERE `t_cdr`.`w_batch_id` = '2021101912453900275'             GROUP BY   `t_cdr`.`w_batch_id`,                 `t_cdr`.`partition_key`,                 nvl(`t_cdr`.`contract_reference`,'UNM'),                 nvl(`t_cdr`.`table_name`,'UNM'),                 nvl(`t_cdr`.`counterparty_original`,'UNM')         ) `t_cdr_temp` ON nvl(`tcdr`.`partition_key`,'UNM') = `t_cdr_temp`.`partition_key`                         AND nvl(`tcdr`.`contract_reference`,'UNM') = `t_cdr_temp`.`contract_reference`                         AND nvl(`tcdr`.`table_name`,'UNM') = `t_cdr_temp`.`table_name`                         AND nvl(`tcdr`.`counterparty_original`,'UNM') = `t_cdr_temp`.`counterparty_original`     left join `sgmisitstg`.`stg_bcrs_facility_links` `facl`   on (CASE WHEN (length(`tcdr`.`contract_reference`) = 10 or length(`tcdr`.`contract_reference`) = 11 or length(`tcdr`.`contract_reference`) = 12) THEN substr(`tcdr`.`contract_reference`,1,instr(`tcdr`.`contract_reference`,'-M') - 1)          ELSE `tcdr`.`contract_reference` END) = `facl`.`contract_reference`   and substr(`tcdr`.`partition_key`,1,8) = substr(`facl`.`partition_key`,1,8)   and `facl`.`table_name` = `tcdr`.`table_name`   and `facl`.`w_batch_id` = '2021101912453900275'    left join (select `sgmi_client_bca_d`.`client_le_wid`, `sgmi_client_bca_d`.`client_le_id`, `sgmi_client_bca_d`.`bca_ref_no`, `sgmi_client_bca_d`.`bca_approval_dt`, `sgmi_client_bca_d`.`bca_review_dt`, `sgmi_client_bca_d`.`w_snapshot_dt`,   ROW_NUMBER() OVER( PARTITION BY `sgmi_client_bca_d`.`client_le_id` ORDER BY `sgmi_client_bca_d`.`client_le_id` ) AS `rnk`                 from `sgmisit`.`sgmi_client_bca_d` ) `bca`                 on substr(`tcdr`.`counterparty_original`,1,8) = `bca`.`client_le_id`                 and `tcdr`.`w_snapshot_dt` = `bca`.`w_snapshot_dt`   and `bca`.`rnk` = 1   left join `sgmisit`.`sgmi_collateral_type_dat` `coltp`   on `tcdr`.`collateral_contract_type` = `coltp`.`collateral_code`   and `coltp`.`etl_current_record_flag` = 'Y'   left join `sgmisit`.`sgmi_sme_product_dat` `smeprod`   on `tcdr`.`contract_type` = `smeprod`.`contract_type`   LEFT JOIN `sgmisit`.`SGMI_BOOK_CD_D` `BOOK`    ON `tcdr`.`dealbook`  =`book`.`book_wid` AND `tcdr`.`w_datasource_id` = `book`.`w_datasource_id` AND `tcdr`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE`    ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`    AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_sme_prr` `sme_prr`    ON `tcdr`.`contract_type` = regexp_replace(`sme_prr`.`product_code`,'S_','')                                                 and `be`.`booking_loc_id` = `sme_prr`.`country`                and `sme_prr`.`w_batch_id` = '2021101912453900275'     LEFT JOIN (SELECT `stg_bcrs_crm_sr`.`partition_key`, `stg_bcrs_crm_sr`.`crm_id`, `stg_bcrs_crm_sr`.`collateral_mode`, `stg_bcrs_crm_sr`.`beneficiary`, `stg_bcrs_crm_sr`.`group_link_type`, `stg_bcrs_crm_sr`.`currency`, `stg_bcrs_crm_sr`.`guarantee_percentage`, `stg_bcrs_crm_sr`.`market_value`, `stg_bcrs_crm_sr`.`market_value_ccy`, `stg_bcrs_crm_sr`.`evaluation_date`, `stg_bcrs_crm_sr`.`benef_table_name`, `stg_bcrs_crm_sr`.`benef_contract_ref`, `stg_bcrs_crm_sr`.`repartition_method`, `stg_bcrs_crm_sr`.`amount_prior_claims`, `stg_bcrs_crm_sr`.`pct_same_rank_claims`, `stg_bcrs_crm_sr`.`fdw_netting_agreement`, `stg_bcrs_crm_sr`.`parent_collateral`, `stg_bcrs_crm_sr`.`parent_nominal`, `stg_bcrs_crm_sr`.`parent_currency`, `stg_bcrs_crm_sr`.`parent_amount_prior_claims`, `stg_bcrs_crm_sr`.`parent_pct_same_rank_claims`, `stg_bcrs_crm_sr`.`parent_lgd`, `stg_bcrs_crm_sr`.`parent_maturity_date`, `stg_bcrs_crm_sr`.`own_estimated_haircut`, `stg_bcrs_crm_sr`.`flag_on_deposit`, `stg_bcrs_crm_sr`.`zero_haircut_eligible`, `stg_bcrs_crm_sr`.`securitization_only`, `stg_bcrs_crm_sr`.`repo_type`, `stg_bcrs_crm_sr`.`cardinality`, `stg_bcrs_crm_sr`.`restructuring`, `stg_bcrs_crm_sr`.`risk_type_mode`, `stg_bcrs_crm_sr`.`underlying_security_ref`, `stg_bcrs_crm_sr`.`flag_generic_2`, `stg_bcrs_crm_sr`.`materiality_threshold`, `stg_bcrs_crm_sr`.`rw_floor_generic_flag`, `stg_bcrs_crm_sr`.`flag_recognized_cre`, `stg_bcrs_crm_sr`.`floor2`, `stg_bcrs_crm_sr`.`guar_lgd_mitigation`, `stg_bcrs_crm_sr`.`overlapping_priority`, `stg_bcrs_crm_sr`.`scenario_id`, `stg_bcrs_crm_sr`.`crm_eligibility`, `stg_bcrs_crm_sr`.`crm_rank`, `stg_bcrs_crm_sr`.`col_family`, `stg_bcrs_crm_sr`.`rw`, `stg_bcrs_crm_sr`.`residual_maturity`, `stg_bcrs_crm_sr`.`contract_reference`, `stg_bcrs_crm_sr`.`sub_reference`, `stg_bcrs_crm_sr`.`table_name`, `stg_bcrs_crm_sr`.`method`, `stg_bcrs_crm_sr`.`bs_type`, `stg_bcrs_crm_sr`.`counterparty`, `stg_bcrs_crm_sr`.`contract_type`, `stg_bcrs_crm_sr`.`bis_product_type`, `stg_bcrs_crm_sr`.`bis_product_category`, `stg_bcrs_crm_sr`.`asset_class`, `stg_bcrs_crm_sr`.`pd`, `stg_bcrs_crm_sr`.`nominal`, `stg_bcrs_crm_sr`.`lgd`, `stg_bcrs_crm_sr`.`risk_bucket`, `stg_bcrs_crm_sr`.`risk_type`, `stg_bcrs_crm_sr`.`haircut_risk_bucket`, `stg_bcrs_crm_sr`.`eligibility_risk_bucket`, `stg_bcrs_crm_sr`.`revaluation_frequency`, `stg_bcrs_crm_sr`.`holding_period`, `stg_bcrs_crm_sr`.`underlying_maturity`, `stg_bcrs_crm_sr`.`maturity_date`, `stg_bcrs_crm_sr`.`start_date`, `stg_bcrs_crm_sr`.`book_code`, `stg_bcrs_crm_sr`.`family`, `stg_bcrs_crm_sr`.`exchange_rate`, `stg_bcrs_crm_sr`.`inter_company`, `stg_bcrs_crm_sr`.`attribute_1`, `stg_bcrs_crm_sr`.`attribute_2`, `stg_bcrs_crm_sr`.`attribute_3`, `stg_bcrs_crm_sr`.`attribute_4`, `stg_bcrs_crm_sr`.`attribute_5`, `stg_bcrs_crm_sr`.`attribute_6`, `stg_bcrs_crm_sr`.`attribute_7`, `stg_bcrs_crm_sr`.`attribute_8`, `stg_bcrs_crm_sr`.`attribute_9`, `stg_bcrs_crm_sr`.`amount_1`, `stg_bcrs_crm_sr`.`amount_2`, `stg_bcrs_crm_sr`.`hc_eff`, `stg_bcrs_crm_sr`.`guar_management`, `stg_bcrs_crm_sr`.`bis_key_analysis_id`, `stg_bcrs_crm_sr`.`cover_principal_only`, `stg_bcrs_crm_sr`.`flag_issued_by_the_bank`, `stg_bcrs_crm_sr`.`issuer_guarantor`, `stg_bcrs_crm_sr`.`import_source`, `stg_bcrs_crm_sr`.`allocable_amount`, `stg_bcrs_crm_sr`.`lgd_internal_rating`, `stg_bcrs_crm_sr`.`standard_rw`, `stg_bcrs_crm_sr`.`first_loss`, `stg_bcrs_crm_sr`.`seniority`, `stg_bcrs_crm_sr`.`flag_generic`, `stg_bcrs_crm_sr`.`crm_location`, `stg_bcrs_crm_sr`.`reference_seniority`, `stg_bcrs_crm_sr`.`first_lien`, `stg_bcrs_crm_sr`.`occupied_or_rented`, `stg_bcrs_crm_sr`.`completed`, `stg_bcrs_crm_sr`.`uncorelated_mv_borrower`, `stg_bcrs_crm_sr`.`uncorelated_borrower_mv`, `stg_bcrs_crm_sr`.`damage_insurance`, `stg_bcrs_crm_sr`.`legal_certainty`, `stg_bcrs_crm_sr`.`independant_valuer`, `stg_bcrs_crm_sr`.`mortgage_lending_value`, `stg_bcrs_crm_sr`.`assigned_amount`, `stg_bcrs_crm_sr`.`collateral_portion`, `stg_bcrs_crm_sr`.`asset_class_category`, `stg_bcrs_crm_sr`.`sub_type`, `stg_bcrs_crm_sr`.`mn_rank`, `stg_bcrs_crm_sr`.`mn_nominal`, `stg_bcrs_crm_sr`.`mn_prudential_apc`, `stg_bcrs_crm_sr`.`mn_external_deal`, `stg_bcrs_crm_sr`.`lgd_rating_agency`, `stg_bcrs_crm_sr`.`flag_fictive`, `stg_bcrs_crm_sr`.`elg_risk_bucket_int`, `stg_bcrs_crm_sr`.`benef_category`, `stg_bcrs_crm_sr`.`actual_rating_agency`, `stg_bcrs_crm_sr`.`actual_rating`, `stg_bcrs_crm_sr`.`flag_adjustment`, `stg_bcrs_crm_sr`.`guar_management_adv`, `stg_bcrs_crm_sr`.`guar_lgd_adv`, `stg_bcrs_crm_sr`.`guar_lgd_adv_pre_stress`, `stg_bcrs_crm_sr`.`k_function_used`, `stg_bcrs_crm_sr`.`re_recast`, `stg_bcrs_crm_sr`.`audit_crm_eligibility`, `stg_bcrs_crm_sr`.`booking_company`, `stg_bcrs_crm_sr`.`payout_option`, `stg_bcrs_crm_sr`.`crm_location_currency`, `stg_bcrs_crm_sr`.`std_risk_bucket`, `stg_bcrs_crm_sr`.`pd_pre_floor`, `stg_bcrs_crm_sr`.`lgd_pre_stress`, `stg_bcrs_crm_sr`.`fi_type`, `stg_bcrs_crm_sr`.`rw_floor`, `stg_bcrs_crm_sr`.`sov_rating_used`, `stg_bcrs_crm_sr`.`internal_rating_code`, `stg_bcrs_crm_sr`.`internal_rating_agency`, `stg_bcrs_crm_sr`.`external_rating_code`, `stg_bcrs_crm_sr`.`external_rating_agency`, `stg_bcrs_crm_sr`.`bankruptcy_remote`, `stg_bcrs_crm_sr`.`margin_type`, `stg_bcrs_crm_sr`.`margin_agreement`, `stg_bcrs_crm_sr`.`rw_pre_floor`, `stg_bcrs_crm_sr`.`sov_rw_floor`, `stg_bcrs_crm_sr`.`clearing_house_code`, `stg_bcrs_crm_sr`.`qualifying_ccp`, `stg_bcrs_crm_sr`.`qualifying_transaction`, `stg_bcrs_crm_sr`.`clearing_member`, `stg_bcrs_crm_sr`.`audit_crm_eligibility_sa`, `stg_bcrs_crm_sr`.`w_snapshot_dt`, `stg_bcrs_crm_sr`.`w_datasource_id`, `stg_bcrs_crm_sr`.`w_country_cd`, `stg_bcrs_crm_sr`.`w_batch_id`, ROW_NUMBER() OVER( partition by `stg_bcrs_crm_sr`.`contract_reference` ) AS `rnk`  FROM `sgmisitstg`.`stg_bcrs_crm_sr`   where CASE WHEN 'WS42' like '%ADJ%' THEN `stg_bcrs_crm_sr`.`w_batch_id` = '2021101912453900275' ELSE `stg_bcrs_crm_sr`.`w_batch_id` = '2021101912453900275' END   ) `crmsr`  on (CASE WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' then `tcdr`.`collateral_reference`                 WHEN `tcdr`.`tranche_guarantee_type` = 'GUARANTEED' then `tcdr`.`guarantee_reference`                 ELSE Null End ) = `crmsr`.`contract_reference`         and `crmsr`.`rnk`=1   LEFT JOIN (select `tbl`.`contract_reference`, `tbl`.`product_type`, `tbl`.`rnk` from (  select `sgmi_retail_exposure_f`.`contract_reference`, `sgmi_retail_exposure_f`.`product_type`, row_number() over(partition by `sgmi_retail_exposure_f`.`contract_reference`) `rnk`   from `sgmisit`.`SGMI_RETAIL_EXPOSURE_F` where `sgmi_retail_exposure_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_retail_exposure_f`.`w_datasource_id`='BCRS_RC' and `sgmi_retail_exposure_f`.`w_country_cd`='ALL')   `tbl` where `tbl`.`rnk`=1) `RETAIL_EXP` ON `retail_exp`.`contract_reference`=`tcdr`.`contract_reference`        LEFT JOIN `sgmisit`.`SGMI_CTCODE_PRODUCT_LINKAGE_DAT` `PROD_LINK` ON `tcdr`.`contract_type`=`prod_link`.`ct_code_user`  LEFT JOIN (SELECT `lt`.`client_id` `CLIENT_ID`, `lt`.`limit_id` `LIMIT_ID`, `lt`.`limit_id_trim` `LIMIT_ID_TRIM`, `lt`.`product_cd` `PRODUCT_CD`,ROW_NUMBER() OVER (PARTITION BY `lt`.`client_id`, `lt`.`product_cd`) `RN` FROM (SELECT   CASE WHEN trim(`sgmi_client_limit_f`.`client_id`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})-(\\d{1,2})$' OR trim(`sgmi_client_limit_f`.`client_id`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})$' THEN   regexp_replace( regexp_replace(trim(`sgmi_client_limit_f`.`client_id`),'^(SME)(\\w{0,4})-','') ,'-(\\d{1,2})$','') WHEN `sgmi_client_limit_f`.`client_id` regexp '^(\\d{8})$' OR `sgmi_client_limit_f`.`client_id` regexp '^(\\d{8})-(\\d{1,2})$' THEN   regexp_replace(`sgmi_client_limit_f`.`client_id`,'-(\\d{1,2})$','') ELSE   trim(`sgmi_client_limit_f`.`client_id`) END `Client_id`, `sgmi_client_limit_f`.`limit_id`, `sgmi_client_limit_f`.`limit_id_trim`, `sgmi_client_limit_f`.`product_cd`  FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` WHERE `sgmi_client_limit_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_client_limit_f`.`w_datasource_id`='BCRS_RC')`LT` ) `DERIVED_LT`   ON `derived_lt`.`client_id`=CASE WHEN trim(`tcdr`.`counterparty_original`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})-(\\d{1,2})$' OR trim(`tcdr`.`counterparty_original`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})$' THEN   regexp_replace( regexp_replace(trim(`tcdr`.`counterparty_original`),'^(SME)(\\w{0,4})-','') ,'-(\\d{1,2})$','') WHEN `tcdr`.`counterparty_original` regexp '^(\\d{8})$' OR `tcdr`.`counterparty_original` regexp '^(\\d{8})-(\\d{1,2})$' THEN   regexp_replace(`tcdr`.`counterparty_original`,'-(\\d{1,2})$','') ELSE   trim(`tcdr`.`counterparty_original`) END AND `derived_lt`.`product_cd`=`prod_link`.`lt_product_cd` and `derived_lt`.`rn` = 1       WHERE          `tcdr`.`w_batch_id` = '2021101912453900275'
CREATE VIEW `temp_src_query_2110251724100000069` AS SELECT         NVL(`tcdr`.`accrued_fees`,0) `accrued_fees`,  CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(`tcdr`.`accrued_interest`, 0) ELSE 0 END `accrued_interest`,         NVL(`txn`.`accrued_interest`,0) `accrued_interest_dollar`,         NVL(`tcdr`.`add_on`,0) `add_on`,         `txn`.`add_on` AS `add_on_dollar`,         `txn`.`collateral_attribute_9`,         CASE                 WHEN `txn`.`collateral_attribute_9` IN (                     'Correct',                     'Reverse'                 ) THEN 'Y'                 ELSE 'N'             END         `adj_flag`,         NVL(`fac`.`amount`,0) `ADJUSTED_LIMIT_AMOUNT`,         `tcdr`.`adjustment_amount`,         `tcdr`.`id` `ais_id`,         `tcdr`.`amortized_cost`,         `tcdr`.`amortized_cost_no_ias`,         'MFU needed - RSK_LIMIT_STATIC.txt' `approved_lgd`,        'MFU needed - RSK_LIMIT_STATIC.txt' `approver_name`,         `inst`.`arm_code` `arm_cd`,         `inst`.`arm_description` `arm_description`,         `tcdr`.`asset_class_category_new`,         `tcdr`.`asset_class_category_original`,         `tcdr`.`asset_class_new`,         `tcdr`.`asset_class_original`,         `crm`.`attribute_6` `attribute_6`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`avg_pre_funded_contribution`                 ELSE NULL             END         `avg_prefunded_contribution`,         `txn`.`balance_category`,         `bca`.`bca_approval_dt` `BCA_APPROVAL_DATE`,         `bca`.`bca_review_dt` `BCA_REVIEW_DATE`,         `tcdr`.`beel`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`beta`                 ELSE NULL             END         `beta`,         nvl(`cva`.`bi`,0) `bi`,         `tcdr`.`method_new` `bii_calculation_method`,         `tcdr`.`bis_entity_type_new`,         `tcdr`.`bis_entity_type_original`,         `tcdr`.`bis_industry_sector_new`,         `tcdr`.`bis_industry_sector_original`,         `tcdr`.`bis_past_due`,         `tcdr`.`bis_past_due_original`,         `tcdr`.`bis_performing_status`,         `tcdr`.`bis_product` `BIS_PROD`,         `tcdr`.`bis_product_category` `BIS_PROD_CATEGORY`,         `txn`.`bis_risk_area_new`,         `txn`.`bis_risk_area_original`,        `tcdr`.`bis_risk_sub_area_new`,         `tcdr`.`bis_risk_sub_area_original`,         `tcdr`.`booking_company` `booking_entity_wid`,         `tcdr`.`booking_company` `booking_entity_id`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code` THEN `tcdr`.`counterparty_original`                         ELSE NULL                     END                 ELSE NULL             END `BROKER_ID`,         `tcdr`.`bs_type`,         `tcdr`.`business`,         `tcdr`.`business_line_code` `business_line_cd`,         `txn`.`customer_subsegment_code` `BUSINESS_SUB_SEGMENT`,         NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `BUSINESS_UNIT`,         `tcdr`.`capital_item`,         `tcdr`.`ccf`,         `tcdr`.`ccp_dfund_method`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`ccp_name`                 ELSE NULL             END         `ccp_name`,         `client`.`client_domicile_loc_id` `ccr_ctry`,         CASE                 WHEN `client`.`client_domicile_loc_id` IS NULL THEN `client`.`coi_loc_id`                 ELSE `client`.`client_domicile_loc_id`             END `CCR_EQ_CNTRY`,         `txn`.`ccr_new`,         `txn`.`ccr_original`,         `tcdr`.`ccy_code` `CCY_CD`,         `tcdrp`.`cec` `cec`,         CASE                 WHEN `tcdr`.`ead_method` IN (                     'CEM',                     'IMM'                 )                      AND                      CASE                         WHEN nvl(`txn`.`contract_type`,'UNMP') = 'GMGMKTLEAS' THEN 'F'                         ELSE `txn`.`derivative_ind`                     END                 = 'T' THEN `tcdr`.`ead_method`             END         `cem_imm_ind`,         `txn`.`cf_indicator`,         `tcdr`.`child_id`,         `tcdr`.`clearing_house_code` `CLEARING_HOUSE_CD`,         CASE                 WHEN `tcdr`.`contract_reference` NOT LIKE 'CCP_MARGIN%' THEN 'N'                 ELSE 'Y'             END         `client_trade`,         `tcdr`.`coll_issuer_bis_entity_type`,         `tcdr`.`collateral_bis_product` `COLLATERAL_BIS_PROD`,  `tcdr`.`collateral_contract_type` `COLLATERAL_CONTRACT_TYPE`,         `tcdr`.`collateral_issuer`,         `crm`.`attribute_6` `collateral_perfection_status`,         `txn`.`collateral_product_category` `collateral_prod_category`,         `tcdr`.`collateral_reference` `collateral_ref_no`,         `tcdr`.`collateral_valuation_date` `collateral_valuation_date`,         `tcdr`.`collateral_attribute_9` `collateral_adjusted_flag`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`nominal`                 ELSE NULL             END         `committed_amount`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`ead_pre_ccf`                 ELSE NULL             END         `committed_available_amunt`,         CASE                 WHEN `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'Y'                      AND `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END         `committed_headroom`,         `fac`.`commited` `committed_indicator`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 )                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`outstanding`                 ELSE 0             END         `committed_os`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`nominal`                 ELSE NULL             END         `committed_used_amount`,         '0' `committed_used_amt_temp`,         `tcdr`.`company_code` `company_cd`,         `txn`.`company_type`,         `tcdr`.`contract_reference` `contract_ref_no`,         `tcdr`.`contract_type`,         'null' `contract_desc`,         `tcdr`.`internal_rating_original` `correct_orig_crg`,         `inst`.`cost_center` `cost_center_cd`,         `inst`.`cost_center_descriotion` `cost_center_description`,         `tcdr`.`counterparty_new` `counterparty_new_wid`,         `tcdr`.`counterparty_new`,         `tcdr`.`counterparty_new_attribute_1`,         `tcdr`.`counterparty_new_attribute_2`,         `tcdr`.`counterparty_new_attribute_3`,         `tcdr`.`counterparty_new_attribute_4`,         `tcdr`.`counterparty_new_attribute_5`,         `tcdr`.`counterparty_new_attribute_6`,         `tcdr`.`counterparty_new_attribute_7`,         `tcdr`.`counterparty_new_attribute_8`,         `tcdr`.`counterparty_new_attribute_9`,         `tcdr`.`counterparty_new_desc`,         `tcdr`.`counterparty_original` `counterparty_original_wid`,         `tcdr`.`counterparty_original`,         `tcdr`.`counterparty_type_new`,         `tcdr`.`counterparty_type_original`,         `txn`.`country_name`,   CASE WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`collateral_bis_product` <>  'OTC_NET_COL' THEN `tcdr`.`ead` ELSE 0 END `covered_ead`,          `tcdr`.`cpty_group`,         `tcdr`.`cpty_group_original`,         `tcdr`.`cpty_new_sebc_not_qualifying`,         `tcdr`.`cpty_orig_sebc_not_qualifying`,         `tcdrp`.`crc`,         'MFU needed - CRE_CATEGORY.txt' `cre_category`,         'MFU needed - RSK_MAINPROF_CTC.txt' `cre_coverage`,         'MFU needed - CRE_CATEGORY.txt' `cre_property_type`,         `tcdr`.`credit_substitute`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_cd`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_name`,         `crmsr`.`currency` `crm_currency`,         `crmsr`.`crm_location` `crm_location`,         `txn`.`crm_method` `crm_method`,         `crmsr`.`residual_maturity` `crm_residual_maturity`,         `juris`.`csa` `csa_flg`,         `tcdr`.`currency`,         ( nvl(round(`tcdr`.`ead_pro_cva`,10),0) * nvl(round(`tcdr`.`rw_new`,10),0) ) `cva_ccr_rwa`,         `cva`.`cva_index_part` `cva_index_part`,         `txn`.`cva_rwa` `cva_rwa`,         (round(nvl(`cva`.`cva_rwa_addon`,0),10) * round(`obi`.`cva_static_val`,10)) `cva_rwa_addon`,         `txn`.`days_after_contractual_date`,         `tcdr`.`deal_status`,         `tcdr`.`dealbook` `book_wid`,         `tcdr`.`dealbook` `book_cd`,         `txn`.`delivery_type`,         `txn`.`derivative_ind`,         NVL(`clrh`.`df_cm`, 0) `df_cm`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfccp`                 ELSE NULL             END         `dfccp`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfi`                 ELSE NULL             END         `dfi`,         NVL(`enl`.`mother_code`, 'UNMP DLRFIN') `dlrfin_cd`,         `tcdr`.`ead`,         `tcdr`.`ead_formula`,         `tcdr`.`ead_method`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `ead_netting`,         `tcdr`.`ead_original`,         `tcdr`.`ead_pre_ccf`,         `tcdr`.`ead_pro`,         `tcdr`.`ead_pro_cva`,         `tcdr`.`ead_pro_discount`,         `tcdr`.`ead_pro_gen`,         `tcdr`.`ead_pro_write_off`,         nvl(round(`tcdr`.`ead`,10),0) * NVL(NVL(`prrsr`.`prr`,`sme_prr`.`product_recovery_rate`  ),0) `ead_prr`,         `tcdr`.`ead_scalar` `ead_scalar`,         nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `ead_square`,         `txn`.`ec_filter_type`,         `txn`.`ec_w_filter_type`,         `tcdr`.`effective_epe`,         nvl(`tcdr`.`k_maturity`,0) `effective_matirity`,         `tcdr`.`el`,         NVL(`trfrsk`.`el_cpty`,0) `el_cpty`,         NVL(`tcdr`.`el`,0) `el_net_saves`,         'MFU needed - Pool_Ref_MONYY.txt' `el_saves`,         NVL(`trfrsk`.`el_total`,0) `el_total`,         `tcdr`.`entity_type_category_new`,         `tcdr`.`entity_type_category_original`,         `tcdr`.`equity_floor_applied`,         `tcdr`.`equity_preferential_treatment`,         `tcdr`.`equity_scaling_factor`,         `txn`.`exchange_rate`,         `tcdr`.`exemption_maturity_floor`,         ( nvl(             CASE                 WHEN `tcdr`.`table_name` IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN(                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN(                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE(                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END,0) + nvl(             CASE                 WHEN `tcdr`.`table_name` NOT IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT','FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END,0) ) `exposure`,         `tcdr`.`exposure_attribute_1`,         `tcdr`.`exposure_attribute_2`,         `tcdr`.`exposure_attribute_3`,         `tcdr`.`exposure_attribute_4`,         `tcdr`.`exposure_attribute_5`,         `tcdr`.`exposure_attribute_6`,         `tcdr`.`exposure_attribute_7`,         CASE                 WHEN CAST(`tcdr`.`exposure_attribute_7` AS double) IS NOT NULL THEN 'Y'                 ELSE 'N'             END         `exposure_attribute_7d`,         `tcdr`.`exposure_attribute_8`,         `tcdr`.`exposure_attribute_9`,         CASE                 WHEN (                     `tcdr`.`table_name` = 'ON_OFF_BALANCE'                     OR `tcdr`.`table_name` = 'REPO'                     OR `tcdr`.`table_name` = 'RECEIVABLE'                     OR `tcdr`.`table_name` = 'TRANCHE'                     OR `tcdr`.`table_name` = 'BOND'                     OR `tcdr`.`table_name` = 'EQUITY'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END         `exposure_wo_mtm`,         `reposr`.`external_rating`,         `txn`.`customer_subsegment_desc` `F_BUSINESS_SUB_SEGMENT_NAME`,         nvl(`coltp`.`collateral_description`, 'Collateral Type Unmapped') `f_collatral_type_name`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `F_ORIGINAL_SCORECARD_NAME`,         `txn`.`contract_desc` `F_STANDARD_PROD_NAME`,         'MFU needed - ELIMIT' `facility_activated_flag`,         `facagg`.`facility_availability_end_date` `facility_availability_end_date`,         `tcdr`.`facility_reference` `FACILITY_REF_NO`,         `tcdr`.`used_amount_facility` `FACILITY_UTILIZATION_AMOUNT`,         `tcdr`.`fair_value`,         'PMI source needed' `fam_cd`,         `tcdr`.`family`,         `tcdr`.`fde_alternative_method`,         NVL(`txn`.`filter_type`,'NA') `filter_type`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_cd`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_name`,         `tcdr`.`internal_rating_new` `final_crg`,         nvl(`tcdr`.`pd_new`,0) `final_pd`,         `tcdr`.`flag_adjustment`,         `tcdr`.`floor1`,         `tcdr`.`floor2`,         `txn`.`fsa_exclusion_type`,         `txn`.`fsa004_asset_class`,         nvl(round(`tcdr`.`collateral_assigned_amount`,10),0) * ( 1 - nvl(round(`tcdr`.`hc`,10),0) ) `fsv`,         `tcdr`.`funding_ccy`,         `tcdr`.`gaap_code` `GAAP_CD`,         'CDW needed - RSK_BOE_LMT_PRO' `governing_law`,         `tcdr`.`grand_fathering_applied`,         `tcdr`.`guar_sub_reference` `GUARANTEE_SUB_REF_NO`,         `tcdr`.`guarantee_bis_product`,         CASE WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED' THEN 'Guarantee'   WHEN `tcdr`.`collateral_contract_type` = 'NET_AGR' THEN 'Netting'   WHEN NVL (round(`tcdr`.`ead`,10), 0) * NVL(NVL(`prrsr`.`prr`, `sme_prr`.`product_recovery_rate` ),0) > 0 THEN 'Product Recovery'    ELSE 'UNMP' END `guarantee_ead_flag`,         `tcdr`.`guarantee_method`,         `tcdr`.`guarantee_reference` `GUARANTEE_REF_NO`,         `tcdr`.`guarantor`,         `tcdr`.`guarantor_bis_entity_type`,         CASE                 WHEN `tcdr`.`tranche_guarantee_type` = 'GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `gurantee_ead`,         `tcdr`.`hc`,         `tcdr`.`hcr`,         `tcdr`.`he`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND `tcdr`.`bs_type` = 'OFB' THEN `tcdr`.`outstanding`                 ELSE 0             END         `headroom`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`ead`                 ELSE 0             END         `headroom_ead`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`rwa`                 ELSE 0             END         `headroom_rwa`,         `tcdr`.`hfx`,         `txn`.`holding_company_ind`,         `tcdr`.`hr`,         `tcdr`.`id`,         'MFU needed - mfu_ifrs_category.txt' `ifrs_category`,         CASE                 WHEN `fac`.`commited` = 'N'                      AND `tcdr`.`table_name` = 'FACILITY' THEN nvl(`tcdr`.`nominal`,0)                 ELSE 0             END         `iip`,         `csr`.`imc_1`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_alpha_factor`,         'RMI TABLE NEEDED - rsk_scb_wb_imm_collat, NVL(SUM(amount),0)' `imm_collat_amount`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_eepe`,         `tcdr`.`import_source`,         `tcdr`.`incorporation_country` `incorp_country`,         `txn`.`incorporation_ccy_new`,         `txn`.`incorporation_ccy_original`,         `tcdr`.`inter_company`,         `tcdr`.`internal_maturity_class`,         NVL(`juris`.`isda`, 'No') `isda_flg`,         `tcdr`.`k_function_used`,         `tcdr`.`k_maturity`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`kccp`                 ELSE NULL            END         `kccp`,         CASE                 WHEN `ccp`.`kccp` IS NOT NULL                      AND `ccp`.`kccp` != 0 THEN 'Y'                 ELSE 'N'             END         `kccp_calc`,         `tcdr`.`legislated_program_applied`,         `tcdr`.`lgd` `LGD`,        `txn`.`lgd` `lgd_dollar`,         `tcdr`.`lgd_grade`,         `tcdr`.`lgd_grade_agency`,         `tcdr`.`lgd_grade_inf`,         `tcdr`.`lgd_grade_rank`,         `tcdr`.`lgd_grade_sup`,         `tcdr`.`lgd_mitigation`,         `tcdr`.`lgd_pre_floor_new`,         `tcdr`.`lgd_pre_floor_original`,         CASE                 WHEN (                     (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0 )                     AND (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.05 )                 ) THEN '0% - 04.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.05                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.1                 ) THEN '05% - 09.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.1                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.15                 ) THEN '10% - 14.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.15                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.2                 ) THEN '15% - 19.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.2                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.25                 ) THEN '20% - 24.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.25                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.3                 ) THEN '25% - 29.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.3                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.35                 ) THEN '30% - 34.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.35                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.4                 ) THEN '35% - 39.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.4                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.45                 ) THEN '40% - 44.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.45                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.5                 ) THEN '45% - 49.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.5                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.55                 ) THEN '50% - 54.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.55                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.6                 ) THEN '55% - 59.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.6                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.65                 ) THEN '60% - 64.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.65                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.7                 ) THEN '65% - 69.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.70                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.75                 ) THEN '70% - 74.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.75                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.80                 ) THEN '75% - 79.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.80                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.85                 ) THEN '80% - 84.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.85                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.90                 ) THEN '85% - 89.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.90                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.95                 ) THEN '90% - 94.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.95                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     <= 1                 ) THEN '95% - 100%'                 WHEN (                     CASE                         WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                         ELSE `txn`.`lgd`                     END                 > 1 ) THEN '>100%'             END         `lgd_range`,         `tcdr`.`lgd` `lgd_tcdr`,         `txn`.`limit_attribute`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`contract_reference`                 ELSE NULL             END         `limit_id`,         CASE                 WHEN `tcdr`.`facility_reference` IS NOT NULL AND `tcdr`.`facility_reference` != ''  THEN 'Linked'                 ELSE 'Unlinked'             END         `linked_unlinked_ind`,         null `lmt_eff_dt`,         `tcdr`.`long_short`,         `tcdr`.`look_through_treatment`,         `crsr`.`lt_rat_agency_code` `lt_rat_agency_cd`,         NVL(`tcdr`.`ltv`,0) `LTV`,         `tcdr`.`ltv_current`,         CASE                 WHEN `prod`.`product_level` = 'Standard Product'                      AND `prod`.`description` LIKE 'Private Equity%' THEN concat('078||',substr(`tcdr`.`dealbook`,length(`tcdr`.`dealbook`) - 7,length(`tcdr`.`dealbook`) ) )                 ELSE `tcdr`.`dealbook`             END         `management_location_cd`,            NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `management_prod_wid`,  NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `management_prod_id`,                    `tcdr`.`margin_period`,         `tcdr`.`maturity_date`,         `tcdr`.`maturity_eff`,         'N' `maturity_limit_flag`,         `txn`.`maturity_range` `maturity_range`,         `tcdr`.`method_new`,         `tcdr`.`method_original`,         `cva`.`mi`,         `cva`.`mi_hedge`,         `tcdr`.`mm`,         `tcdr`.`mortgage_alternative`,         `tcdr`.`business_identifier` `MRU_IDENTIFIER`,  `tcdr`.`business_identifier` `BUSINESS_IDENTIFIER`,         `txn`.`mtm`,         `inst`.`custom_attribute_18` `nbv_currency`,         `inst`.`custom_attribute_17` `nbv_value`,         CASE                 WHEN trim(`ent`.`attribute_3`) = 'T' THEN 'TRUE'                 WHEN trim(`ent`.`attribute_3`) = 'F' THEN 'FALSE'                 ELSE `ent`.`attribute_3`         END         `negative_pledge_identifier`,          CASE                 WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)    WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm` ELSE 0         END         `net_mtm`,          ( (CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL')                             THEN NVL(round(`txn`.`outstanding`,10), 0)ELSE 0                        END) + nvl(round(`txn`.`accrued_interest`,10),0) +   ( CASE WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)   WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm`  ELSE 0 END) )   `net_nominal`,          nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         `netted_ead`,         ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) * ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) `netted_ead_square`,         '0' `netted_nominal`,         `tcdr`.`netting_agreement_reference` `NETTING_AGREEMENT_REF_NO`,         `tcdr`.`netting_class`,         NVL(`juris`.`isda`, 'No') `netting_flg`,         `clrh`.`no_clear_mem_n`,    ((CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX',           'FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(round(`tcdr`.`outstanding`,10), 0)                    ELSE 0                    END                   ) +                   NVL(round(`txn`.`accrued_interest`,10), 0) +                   (CASE WHEN `tcdr`.`table_name` IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX',               'FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN                        (CASE  WHEN UPPER(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN                              (CASE WHEN round(`tcdr`.`fair_value`,10) > 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                              )                         ELSE (CASE WHEN round(`tcdr`.`fair_value`,10) < 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                               )                         END                         )                     ELSE 0                     END                    )                  ) `nominal`,            `tcdr`.`nominal` `nominal_tcdr`,         `txn`.`non_borrowing_ind` `NON_BORROWING`,         substr(trim(`ent`.`attribute_17`), 1, 1) `non_contractual_parental_supt`,         substr(trim(`ent`.`attribute_17`), 3, 1) `non_financial_scorecard`,         `txn`.`non_gam_ind`,         `tcdr`.`non_material_equity`,         `txn`.`notional`,         `deal`.`nominal_2` `NOTIONAL_2`,         `deal`.`currency_2` `NOTIONAL_2CCY`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`tcdr`.`nominal`) *-1                         ELSE abs(`tcdr`.`nominal`)                     END                 )                 ELSE 0             END         `notional_tcdr`,         'CDW needed - cdw_txn_rmi_ddmmyyyy.txt' `obl_flg`,         `tcdr`.`obligor_grade_inf_new`,         `tcdr`.`obligor_grade_inf_original`,         `tcdr`.`obligor_grade_new`,         `tcdr`.`obligor_grade_original`,         `tcdr`.`obligor_grade_rank_new`,         `tcdr`.`obligor_grade_rank_original`,         `tcdr`.`obligor_grade_sup_new`,         `tcdr`.`obligor_grade_sup_original`,         CASE                 WHEN `inst`.`cost_center` IN (                     'FM ALM',                     'Principal Finance'                 ) THEN 'OCC_Own Account'                 ELSE nvl(`txn`.`customer_subsegment_code`,'UNMP')             END         `occ_sub_segment`,         `txn`.`bs_type` `ON_OFF_BALANCE_SHEET_FLAG`,         nvl(`tcdr`.`pd_original`,0) `org_pd`,         `tcdr`.`original_cost`,         nvl(`tcdr`.`internal_rating_original`,'CRG Original Unmapped') `original_crg`,          `txnf`.`original_limit_amount` `original_limit_amount`,          `tcdr`.`original_maturity`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `original_scorecard`,         `txn`.`outstanding` `os`,         `facprod`.`contract_type` `out_limit_product`,   CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(`tcdr`.`outstanding`, 0) ELSE 0 END `outstanding`,          `txn`.`outstanding` `outstanding_dollar`,         'MFU needed - cdw_BOEACBTXN_rmi_DDMMYYYY.txt' `overdue_days`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_1`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_2`,         `tcdr`.`parent_id`,         `tcdr`.`past_due_int`,         `tcdr`.`past_due_ppal`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`pce_flag`                 ELSE NULL             END         `pce_flag`,         `rat`.`one_year_pd` `pd_midpoint`,         `tcdr`.`pd_new`,         `tcdr`.`pd_original`,         `tcdr`.`pd_pre_floor_new`,         `tcdr`.`pd_pre_floor_original`,         `tcdr`.`performing_status`,         `tcdr`.`pool_code` `POOL_CD`,         `tcdr`.`premium_current`,         `contp`.`attribute_1` `prod_cat_info`,         `tcdr`.`product_gl_criteria`,         `tcdr`.`product_gl_criteria_2`,         NVL(`tcdrp`.`tot_el`,0) `PROXY_EL`,         NVL(`tcdrp`.`lgd_used`,0) `PROXY_LGD`,         NVL(NVL(`txn`.`prr`, `sme_prr`.`product_recovery_rate`  ),0) `PRR`,    nvl(`inst`.`psgl_account_number`, `psgl`.`psgl_account`) `PSGL_ACCOUNT`,           nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_CD`,  nvl(nvl(`inst`.`psgl_customer_class`, `psgl`.`psgl_cust_class`), `txn`.`psgl_cust_class`) `PSGL_CUST_CLASS`,  nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_DEPARTMENT`,  nvl(nvl(`inst`.`psgl_operating_unit`, `psgl`.`psgl_operating_unit`), `txn`.`psgl_operating_unit`) `PSGL_OPERATING_UNIT`,  nvl(nvl(`inst`.`psgl_product_code`, `psgl`.`psgl_product`), `txn`.`psgl_product`) `PSGL_PRODUCT`,          `tcdr`.`qualifying_ccp`,         `tcdr`.`qualifying_transaction`,         `crsr`.`lt_rat_code` `RATING_CD`,         `txn`.`replacement_cost` `RC`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN (                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE (                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END         `rc_tcdr`,         `txn`.`replacement_cost` `REPLACEMENT_COST`,         `tcdr`.`residual_maturity`,         `tcdr`.`rgc`,         `tcdr`.`risk_bucket`,         `tcdr`.`risk_bucket_original`,         `tcdr`.`risk_country`,         `tcdr`.`risk_country_new`,         `tcdr`.`risk_country_original`,         `tcdr`.`risk_type`,         `crm`.`rw_expo` `rw_expo`,         `tcdr`.`rw_new`,         `tcdr`.`rw_original`,         `tcdr`.`rw_scaling_factor`,         `tcdr`.`rwa`,         NVL(`trfrsk`.`rwa_add_on`,0) `rwa_add_on`,         `tcdr`.`rwa` `rwa_after_scale`,         nvl(round(`tcdr`.`rwa`,10),0) / 1.06 `rwa_before_scale`,         `trfrsk`.`rwa_cpty` `rwa_cpty`,         `tcdr`.`rwa` `RWA_NET_SAVES`,         `tcdr`.`rwa_pre_cap`,         `tcdr`.`rwa_pre_crm`,         `tcdr`.`rwa_pre_floor_equity`,         'MFU needed - Pool_Ref_MONYY.txt' `rwa_saves`,         `tcdr`.`rwa_scaling_factor`,         `trfrsk`.`rwa_total` `rwa_total`,         `ccp`.`is_scb_clr_mem` `scb_clearing_mem`,         `tcdr`.`second_loss_treatment`,         `tcdr`.`secu_bank_role`,         `tcdr`.`secu_company_weight`,         `tcdr`.`secu_ea_controlled`,         `tcdr`.`secu_issue_date`,         `tcdr`.`secu_loss_position`,         `tcdr`.`secu_mode`,         `tcdr`.`secu_retail_line_fg`,         `tcdr`.`secu_spread_trapping_ratio`,         `tcdr`.`secu_uncommited_retail_fg`,         `txn`.`lgd` `SECURED_LGD`,         `tcdr`.`securitization_n`,         `tcdr`.`securitization_reference` `SECURITIZATION_REF_NO`,         `tcdr`.`securitized`,         `tcdr`.`security_positions_ref`,         `txn`.`segment_original`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code`                              AND `clrm`.`entity_code` = `clrm`.`clearing_house_code` THEN `clrm`.`clearing_member_conditions`                         ELSE NULL                     END                 ELSE NULL             END         `segregated`,         `tcdr`.`seniority_new`,         `tcdr`.`seniority_original`,         `tcdr`.`settlement_price`,         `reposr`.`sov_indicator` `sov_indicator`,         `tcdr`.`sovereign_risk_bucket_new`,         `tcdr`.`sovereign_risk_bucket_ori`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_wid`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_cd`,         `tcdr`.`standard_rw_new`,         `tcdr`.`standard_rw_original`,         `txn`.`start_date`,         null `std_rw_override_indicator`,         `inst`.`custom_attribute_16` `strategy`,         `tcdr`.`stress_testing_scenario_id`,         `txn`.`sub_limit_fac_reference` `sub_limit_fac_ref_no`,         `tcdr`.`sub_method_new`,         `tcdr`.`sub_method_original`,         `tcdr`.`sub_reference`,         `tcdr`.`supervisor_code` `SUPERVISOR_CD`,         CASE WHEN `enl`.`link_type` = 'SUPFIN' then `enl`.`mother_code` else 'UNMP SUPFIN' end `supfin_cd`,         `tcdr`.`table_name` `table_name`,         'SMC_PERIMETER required' `tbs_cd`,         `txn`.`maturity_range` `TENOR_BUCKETS`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`third_party_cp_flag`                 ELSE 'N/A'             END         `third_party_cp_flag`,         `tcdr`.`tier1_deduction`,         `tcdr`.`tier2_deduction`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`tot_pre_fund_con`                 ELSE NULL             END         `tot_pre_fund_con`,         `tcdr`.`total_annual_assets`,         `tcdr`.`total_annual_sales`,         `fac`.`amount` `total_facility_amount`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`total_initital_margin`                 ELSE NULL             END         `total_initital_margin`,         `inst`.`tp_portfolio_name` `tp_portfolio_name`,         'MFU needed - e_balances.txt' `tp_sys_scr_id`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / round(`t_cdr_temp`.`rwa`,10) ) )                 ELSE 0             END         `tr_addon_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN ( nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0) )                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / `t_cdr_temp`.`rwa` ) )                 ELSE 0             END         `tr_addon_rwa`,         nvl(`trfrsk`.`tr_el`,0) `tr_el`,         NVL(`trfrsk`.`tr_gua_ctry`, 'UNMP') `tr_gua_ctry`,         CASE                 WHEN `t_cdr_temp`.`el` != 0          THEN nvl(round(`t_cdr_temp`.`el`,10),0) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) )                 ELSE 0             END         `tr_pre_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN nvl(round(`t_cdr_temp`.`rwa`,10),0) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) ) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) )                 ELSE 0             END         `tr_pre_rwa`,         `tcdr`.`trade_date`,         `tcdr`.`trading_book_type`,         `tcdr`.`trading_book_type` `TRADING_IND`,         `tcdr`.`tranche_collateral_type`,         `tcdr`.`tranche_guarantee_type`,         `txn`.`tranche_lgd`,         NVL(`trfrsk`.`transfer_risk`,'N') `transfer_risk`,         `txn`.`limit_amount` `txn_limit_amount`,         `txn`.`rw_new` `txn_rw_new`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`uci`                 ELSE NULL             END         `uci`,         `tcdr`.`uncommited` `uncommited`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`nominal`             END         `uncommitted_amount`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`ead_pre_ccf`             END         `uncommitted_available_amunt`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 )                      AND `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_headroom`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 )                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_os`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`ead_pre_ccf`             END         `uncommitted_used_amount`,         `tcdr`.`unconditionnaly_cancelable`,         `tcdr`.`und_pool_ref`,         `txn`.`unmapped_ind`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                      AND `tcdr`.`tranche_guarantee_type` = 'NOT GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `unsecured_ead`,         `tcdr`.`used_amount_facility`,         `tcdr`.`value_date`,         `txn`.`waterfall_seniority`,         `cva`.`wi` `wi`,         case when `rat`.`row_owner` = 'C' AND `rat`.`agency_code` = 'INTERNAL' AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) >= nvl(round(`rat`.`pd_inf`,10),0)   AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) < nvl(round(`rat`.`pd_sup`,10),0)   THEN `rat`.`rating` ELSE `icr`.`long_term_rating` END `wt_crg`,         nvl(round(`tcdr`.`pd_new`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_final_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`k_maturity`,10) ) `wt_k_maturity`,         `txn`.`wt_lgd`,         (nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`k_maturity`,10),0)) `wt_mat_eff`,         nvl(round(`tcdr`.`pd_original`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_org_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_new`,10) ) `wt_pd_new`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_original`,10) ) `wt_pd_original`,         nvl(`txn`.`wt_residual_maturity`,0) `wt_residual_maturity`,         ( round(`tcdr`.`pd_new`,10) * round(`tcdr`.`nominal`,10) ) `wtpdlgd`,         ( round(`tcdr`.`pd_new`,10) * round(`txn`.`wt_lgd`,10) ) `wtpdnm`,         `tcdrp`.`xrc`,         `tcdr`.`zero_haircut_for_repo`,         `tcdr`.`zero_rw_for_equity`,         `tcdr`.`zone_a_new`,         `tcdr`.`zone_a_original`,  `tcdr`.`collateral_assigned_amount` `COLLATERAL_ASSIGNED_AMOUNT`,  '0' `collateral_unique_id`,  NVL(`smeprod`.`product_type`,`retail_exp`.`product_type`) `sme_product_type`,   CASE WHEN SUBSTR((case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END ), -2) = '-M'                   THEN                   substr( (case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END)         , 1         ,  length(trim(case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END ))-2                   )                     ELSE                  case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END          END `DERIVED_LIMIT_ID`,  `derived_lt`.`limit_id_trim` `DERIVED_LIMIT_ID_STP`,  CASE WHEN `tcdr`.`method_new` = 'ADV' THEN round(NVL(`tcdr`.`ead`, 0),5) *          (CASE WHEN ( (`tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') <> 'RW_LGD_UPDATE'                         ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`txn`.`lgd`,0),5)                 WHEN ( (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') = 'RW_LGD_UPDATE'                          ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`tcdr`.`exposure_attribute_7`,0),5)                 ELSE 0 END         ) ELSE 0 END `unsecured_lgd_dollar`,    case when `be`.`booking_loc_id` = 'SG'  then 'SG'  when `be`.`booking_loc_id` = 'MY'  then 'MY' when `be`.`booking_loc_id` = 'VN'  then 'VN' when `be`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end as `SECURITY_CTRY`,    case when `tcdr`.`dealbook` like '%CI%' OR `tcdr`.`dealbook` like '%CC%' then 'CICC'   when `tcdr`.`dealbook` like '%RT%' then 'RT'   when `tcdr`.`dealbook` like '%PB%' then 'PB'   when `tcdr`.`dealbook` like '%OB%' then 'OB'   else 'OTHERS' end AS `SECURITY_SEG`                          FROM         `sgmisitstg`.`stg_bcrs_t_cdr` `tcdr`           LEFT JOIN `sgmisit`.`sgmi_txn_rwa_f` `txn` ON `tcdr`.`id` = `txn`.`id`                                                             AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`txn`.`partition_key`,'UNM')            AND `txn`.`w_datasource_id` = 'BCRS_PRA'            AND `txn`.`w_snapshot_dt` = '2021-06-30'            AND `txn`.`w_country_cd` = 'ALL'            AND `txn`.`w_workspace` = 'WS7'            LEFT JOIN (select `tbl`.`netting_agreement_reference`, `tbl`.`partition_key`, `tbl`.`rnk`, `tbl`.`sum_mtm` from (select `sgmi_txn_rwa_f`.`netting_agreement_reference`,`sgmi_txn_rwa_f`.`partition_key`, row_number() over(partition by `sgmi_txn_rwa_f`.`netting_agreement_reference`,`sgmi_txn_rwa_f`.`partition_key`) `rnk`, sum(`sgmi_txn_rwa_f`.`mtm`) over(partition by netting_agreement_reference,partition_key) `sum_mtm`   from `sgmisit`.`sgmi_txn_rwa_f`    where    `sgmi_txn_rwa_f`.`w_snapshot_dt` = '2021-06-30' and   `sgmi_txn_rwa_f`.`w_workspace` in (   (case when instr('WS7','ADJ')>0 then substr('WS7',1,instr('WS7','_ADJ') - 1) else concat('WS7','_ADJ') end), 'WS7')  ) `tbl` where `tbl`.`rnk`=1  ) `txn2`  ON `txn`.`netting_agreement_reference` = `txn2`.`netting_agreement_reference`                                                               AND nvl(`txn`.`partition_key`,'UNM') = nvl(`txn2`.`partition_key`,'UNM')                   LEFT JOIN `sgmisitstg`.`stg_bcrs_facility` `fac` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`fac`.`contract_reference`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`fac`.`partition_key`,1,8)                                                       AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`fac`.`contract_type`,'UNM')             AND `fac`.`w_batch_id` = '2021102513163900521'          LEFT JOIN (select `stg_bcrs_scb_wb_addt_inst`.`partition_key`, `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`, `stg_bcrs_scb_wb_addt_inst`.`arm_code`, `stg_bcrs_scb_wb_addt_inst`.`arm_description`, `stg_bcrs_scb_wb_addt_inst`.`cost_center`, `stg_bcrs_scb_wb_addt_inst`.`cost_center_descriotion`,    `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_18`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_17`, `stg_bcrs_scb_wb_addt_inst`.`psgl_account_number`, `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`, `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`, `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_16`, `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`, `stg_bcrs_scb_wb_addt_inst`.`w_batch_id`,    ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ) AS `rnk`      FROM `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2021102513163900521' AND  NVL(`stg_bcrs_scb_wb_addt_inst`.`arm_code`,'') <> ''     ) `inst` ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`inst`.`contract_reference`),'UNM')                                                       AND trim(`tcdr`.`table_name`) = trim(`inst`.`table_name`)                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`inst`.`partition_key`,1,8)             AND `inst`.`rnk`=1   LEFT JOIN ( select `stg_bcrs_scb_wb_psgl`.`partition_key`, `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name`, `stg_bcrs_scb_wb_psgl`.`psgl_bu`, `stg_bcrs_scb_wb_psgl`.`psgl_account`, `stg_bcrs_scb_wb_psgl`.`psgl_product`, `stg_bcrs_scb_wb_psgl`.`psgl_department`, `stg_bcrs_scb_wb_psgl`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_psgl`.`psgl_cust_class`, `stg_bcrs_scb_wb_psgl`.`financial_book_code`, `stg_bcrs_scb_wb_psgl`.`booking_location`, `stg_bcrs_scb_wb_psgl`.`w_batch_id`, ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name` ) AS `rnk`       FROM `sgmisitstg`.`stg_bcrs_scb_wb_psgl`   WHERE `stg_bcrs_scb_wb_psgl`.`w_batch_id` = '2021102513163900521'     AND  NVL(`stg_bcrs_scb_wb_psgl`.`psgl_bu`,'') <> '') `psgl`   ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`psgl`.`contract_reference`),'UNM')    AND trim(`tcdr`.`table_name`) = trim(`psgl`.`fermat_table_name`)   AND substr(`tcdr`.`partition_key`,1,8) = substr(`psgl`.`partition_key`,1,8)               AND `psgl`.`rnk`=1                        LEFT JOIN ( select `stg_bcrs_t_crm`.`partition_key`, `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`,`stg_bcrs_t_crm`.`expo_table_name`,`stg_bcrs_t_crm`.`w_batch_id`,`stg_bcrs_t_crm`.`rw_expo`,`stg_bcrs_t_crm`.`attribute_6`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ORDER BY `stg_bcrs_t_crm`.`expo_contract_reference`,    `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ) AS `rnk`    FROM `sgmisitstg`.`stg_bcrs_t_crm`   WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_t_crm`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_t_crm`.`w_batch_id` = '2021102513163900521' END           ) `crm` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`crm`.`expo_contract_reference`,'UNM')          AND nvl(`tcdr`.`counterparty_original`, 'UMP') = nvl(`crm`.`expo_counterparty`, 'UMP')                                                    AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`crm`.`partition_key`,'UNM')          AND `crm`.`expo_table_name` = 'ON_OFF_BALANCE'          AND `crm`.`rw_expo` is not null          AND `crm`.`rnk` = 1            LEFT JOIN (             SELECT   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                                `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`avg_pre_funded_contribution`) `avg_pre_funded_contribution`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`beta`) `beta`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`clearing_house_name`) `ccp_name`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`pre_funded_financial`) `dfccp`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_prefunded_contribution`) `dfi`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`kccp`) `kccp`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`sum_pre_fund_contribution`) `tot_pre_fund_con`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`total_initial_margin`) `total_initital_margin`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_committed_contributions`) `uci`             FROM                 `sgmisitstg`.`stg_bcrs_scb_wb_ccp_static`   WHERE `stg_bcrs_scb_wb_ccp_static`.`w_batch_id` = '2021102513163900521'       AND `stg_bcrs_scb_wb_ccp_static`.`beta` is not null AND `stg_bcrs_scb_wb_ccp_static`.`beta` != ''             GROUP BY   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                 `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`         ) `ccp` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`ccp`.`clearing_house_code`,'UNM')                  AND substr(`tcdr`.`partition_key`,1,8) = substr(`ccp`.`partition_key`,1,8)          LEFT JOIN (             SELECT   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`,                 SUM(`stg_bcrs_t_cva`.`bi`) `bi`,                 SUM(`stg_bcrs_t_cva`.`cva_index_part`) `cva_index_part`,                 SUM(`stg_bcrs_t_cva`.`cva_capital_charge`) `cva_rwa_addon`,                 MAX(`stg_bcrs_t_cva`.`mi`) `mi`,                 SUM(`stg_bcrs_t_cva`.`mi_hedge`) `mi_hedge`,                 MAX(`stg_bcrs_t_cva`.`wi`) `wi`             FROM                 `sgmisitstg`.`stg_bcrs_t_cva`   WHERE `stg_bcrs_t_cva`.`w_batch_id` = '2021102513163900521'             GROUP BY   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`         ) `cva` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`cva`.`contract_reference`,'UNM')                  AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`cva`.`partition_key`,'UNM')                  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`cva`.`counterparty`,'UNM')          LEFT JOIN `sgmisit`.`sgmi_client_d` `client` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`client`.`client_id`,'UNM')    AND `client`.`w_datasource_id` = 'BCRS_PRA' AND `client`.`w_snapshot_dt` = '2021-06-30'    LEFT JOIN `sgmisit`.`sgmi_obi_pd_lookup_dat` `obi` ON substr(`tcdr`.`partition_key`,1,6) = nvl(`obi`.`partition_key`,'UNM')          LEFT JOIN `sgmisitstg`.`stg_bcrs_v_scb_gpr_ec_t_cdr_prx` `tcdrp` ON nvl(`tcdr`.`id`,'UNM') = nvl(`tcdrp`.`id`,'UNM')                                                                       AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`tcdrp`.`partition_key`,'UNM')               AND `tcdrp`.`w_batch_id` = '2021102513163900521'         LEFT JOIN (             SELECT   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`,                 MAX(`stg_bcrs_bis_clearing_house`.`df_cm`) `df_cm`,                 MAX(`stg_bcrs_bis_clearing_house`.`n`) `no_clear_mem_n`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_house`   WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2021102513163900521' END             GROUP BY   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`         ) `clrh` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`clrh`.`entity_code`,'UNM')                   AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrh`.`partition_key`,'UNM')          LEFT JOIN   (select `stg_bcrs_entity_links`.`partition_key`, `stg_bcrs_entity_links`.`child_code`, `stg_bcrs_entity_links`.`link_type`, `stg_bcrs_entity_links`.`mother_code`, `stg_bcrs_entity_links`.`w_batch_id`, ROW_NUMBER() OVER(ORDER BY `stg_bcrs_entity_links`.`mother_code` desc) AS `rnk`  FROM `sgmisitstg`.`stg_bcrs_entity_links` where `stg_bcrs_entity_links`.`w_batch_id` = '2021102513163900521' and `stg_bcrs_entity_links`.`link_type` = 'DLRFIN' ) `enl`   ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`enl`.`child_code`,'UNM')         AND substr(`tcdr`.`partition_key`,1,8) = substr(`enl`.`partition_key`,1,8)         AND `enl`.`rnk`=1           LEFT JOIN (select `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`, `stg_bcrs_csr`.`table_name`, `stg_bcrs_csr`.`imc_1`, `stg_bcrs_csr`.`w_batch_id`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ORDER BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ) AS `rnk`   from `sgmisitstg`.`stg_bcrs_csr`   where CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_csr`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_csr`.`w_batch_id` = '2021102513163900521' END ) `csr`     ON `tcdr`.`contract_reference` = `csr`.`contract_reference`    AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`csr`.`contract_type`,'UNM')    AND nvl(`tcdr`.`counterparty_new`,'UNM') = nvl(`csr`.`counterparty`,'UNM')    AND nvl(`tcdr`.`method_new`,'UNM') = nvl(`csr`.`method`,'UNM')    AND `tcdr`.`bs_type` = `csr`.`bs_type`    AND `tcdr`.`dealbook` = `csr`.`book_code`    AND (case when nvl(`tcdr`.`table_name`,'z') in ('BOND', 'EQUITY', 'TRANCHE', 'CONVERTIBLE', 'FUND') then 'SECURITY_POSITIONS'             else nvl(`tcdr`.`table_name`, 'z') end) = `csr`.`table_name`    AND `csr`.`imc_1` is not null    AND trim(`csr`.`imc_1`) != ''    AND `csr`.`rnk` = 1    LEFT JOIN ( select `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_cpty`),0) `EL_CPTY`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_total`),0) `EL_TOTAL`,      NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`),0) `rwa_add_on`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`),0) `rwa_cpty`,      NVL(NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_total`),SUM(NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`,0) +  NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`,0))),0) `RWA_TOTAL`,      NVL(sum(`stg_bcrs_scb_wb_tr_sr`.`tr_el`),0) `tr_el`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry` `TR_GUA_CTRY`, MAX(NVL(`stg_bcrs_scb_wb_tr_sr`.`is_tr`,'N')) `TRANSFER_RISK`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`   from `sgmisitstg`.`stg_bcrs_scb_wb_tr_sr`    where CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_scb_wb_tr_sr`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_scb_wb_tr_sr`.`w_batch_id` = '2021102513163900521' END    group by `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`  ) `trfrsk`  ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`trfrsk`.`contract_reference`,'UNM')  AND nvl(`tcdr`.`table_name`,'UNM') = nvl(`trfrsk`.`table_name`,'UNM')  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`trfrsk`.`pr_obligor`,'UNM')  AND `tcdr`.`contract_type` = `trfrsk`.`contract_type`  and `tcdr`.`bs_type` = `trfrsk`.`bs_type`    LEFT JOIN (   select  `tbl`.`contract_reference`, `tbl`.`und_pool_ref`, `tbl`.`bs_type`, `tbl`.`sub_reference`, `tbl`.`prr`, `tbl`.`rnk` from (     SELECT      `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,     `stg_bcrs_scb_wb_prr_sr`.`und_pool_ref`,     `stg_bcrs_scb_wb_prr_sr`.`bs_type`,     `stg_bcrs_scb_wb_prr_sr`.`sub_reference`,     `stg_bcrs_scb_wb_prr_sr`.`prr`,     row_number() over(partition by `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,`stg_bcrs_scb_wb_prr_sr`.`und_pool_ref`,`stg_bcrs_scb_wb_prr_sr`.`bs_type`,`stg_bcrs_scb_wb_prr_sr`.`sub_reference`,`stg_bcrs_scb_wb_prr_sr`.`prr`) `rnk`      FROM       `sgmisitstg`.`stg_bcrs_scb_wb_prr_sr`     WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2021102513163900521' END         AND  NVL(`stg_bcrs_scb_wb_prr_sr`.`prr`,'') <> ''    ) `tbl` where `tbl`.`rnk`=1   ) `prrsr` on `tcdr`.`contract_reference` = `prrsr`.`contract_reference` and nvl(`tcdr`.`und_pool_ref`,'UNM') = nvl(`prrsr`.`und_pool_ref`,'UNM')  and nvl(`tcdr`.`bs_type`,'UNM') = nvl(`prrsr`.`bs_type`,'UNM') and nvl(`tcdr`.`sub_reference`,'UNM') = nvl(`prrsr`.`sub_reference`,'UNM')      LEFT JOIN (select `stg_bcrs_scb_wb_repo_sr`.`partition_key`, `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`, `stg_bcrs_scb_wb_repo_sr`.`external_rating`, `stg_bcrs_scb_wb_repo_sr`.`sov_indicator`, `stg_bcrs_scb_wb_repo_sr`.`security_contract_ref`,     ROW_NUMBER() OVER(partition by `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref` order by `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`) as `rnk`   from `sgmisitstg`.`stg_bcrs_scb_wb_repo_sr`  WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2021102513163900521' END   AND `stg_bcrs_scb_wb_repo_sr`.`sov_indicator` IS NOT NULL ) `reposr`   ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`reposr`.`partition_key`,'UNM')  AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`reposr`.`repo_contract_ref`,'UNM')  AND `reposr`.`rnk`=1            LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `scrd` ON nvl(`scrd`.`org_scrd_g3_code`,'UNM') = nvl(`txn`.`scorecard_original`,'UNM')           LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`,                 MIN(`stg_bcrs_facility`.`dim3`) `facility_availability_end_date`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2021102513163900521'              GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`         ) `facagg` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`facagg`.`contract_reference`,'UNM')                     AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`facagg`.`counterparty_code`,'UNM')                     AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`facagg`.`partition_key`,'UNM')                   LEFT JOIN `sgmisitstg`.`stg_bcrs_credit_rating_sr` `crsr` ON nvl(`reposr`.`security_contract_ref`,'UNM') = nvl(`crsr`.`reference`,'UNM')                                                                AND `crsr`.`lt_rat_agency_code` IS NOT NULL               AND CASE WHEN 'WS7' like '%ADJ%' THEN `crsr`.`w_batch_id` = '2021102513163900521' ELSE `crsr`.`w_batch_id` = '2021102513163900521' END          LEFT JOIN `sgmisitstg`.`stg_bcrs_product` `prod` ON nvl(`tcdr`.`contract_type`,'UNM') = nvl(`prod`.`product`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`prod`.`partition_key`,1,8)             AND `prod`.`w_batch_id` = '2021102513163900521'          LEFT JOIN `sgmisitstg`.`stg_bcrs_entity` `ent` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`ent`.`entity_code`,'UNM')                                                     AND substr(`tcdr`.`partition_key`,1,8) = substr(`ent`.`partition_key`,1,8)            AND `ent`.`w_batch_id` = '2021102513163900521'          LEFT JOIN `sgmisitstg`.`stg_bcrs_deal_import` `deal` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`deal`.`contract_reference`,'UNM')                                                           AND substr(`tcdr`.`partition_key`,1,8) = substr(`deal`.`contract_reference`,1,8)          AND `deal`.`w_batch_id` = '2021102513163900521'          LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`,                 MAX(nvl(case when trim(`stg_bcrs_facility`.`attribute_4`) = '' then null else `stg_bcrs_facility`.`attribute_4` end,`stg_bcrs_facility`.`amount`) ) `original_limit_amount`,                 MIN(`stg_bcrs_facility`.`dim2`) `pce_flag`,                 MIN(`stg_bcrs_facility`.`dim1`) `third_party_cp_flag`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2021102513163900521'                GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`         ) `txnf` ON nvl(`txn`.`sub_limit_fac_reference`,'UNM') = nvl(`txnf`.`contract_reference`,'UNM')                   AND substr(`txn`.`partition_key`,1,8) = substr(`txnf`.`partition_key`,1,8)                   AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`txn`.`contract_reference`,'UNM')     AND `tcdr`.`import_source` like '%WB%'                                       AND `tcdr`.`id` = `txn`.`id`             LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`icr`.`entity_code`,'UNM')                                                                    AND substr(`tcdr`.`partition_key`,1,8) = substr(`icr`.`partition_key`,1,8)                                                                    AND `icr`.`agency_code` = 'INTERNAL'            AND `icr`.`w_batch_id` = '2021102513163900521'          LEFT JOIN `sgmisitstg`.`stg_bcrs_rating` `rat` ON nvl(`icr`.`long_term_rating`,'UNM') = nvl(`rat`.`rating`,'UNM')                                                     AND substr(`icr`.`partition_key`,1,8) = substr(`rat`.`partition_key`,1,8)                                                     AND `rat`.`agency_code` = 'INTERNAL'           AND `rat`.`w_batch_id` = '2021102513163900521'          LEFT JOIN (             SELECT    `stg_bcrs_bis_clearing_member`.`w_batch_id`,                 `stg_bcrs_bis_clearing_member`.`partition_key`,                 `stg_bcrs_bis_clearing_member`.`entity_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_house_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_member_conditions`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_bis_clearing_member`.`entity_code` ORDER BY `stg_bcrs_bis_clearing_member`.`entity_code` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_member`   WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2021102513163900521' END          ) `clrm` ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrm`.`partition_key`,'UNM')                   AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`clrm`.`entity_code`,'UNM')     AND `clrm`.`w_batch_id` = '2021102513163900521'     AND `clrm`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_currency` `cur` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`cur`.`partition_key`,'UNM')                                                       AND nvl(`fac`.`currency`,'UNM') = nvl(`cur`.`ccy_code`,'UNM')             AND `cur`.`w_batch_id` = '2021102513163900521'           LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `juris` ON nvl(`tcdr`.`incorporation_country`,'UNM') = nvl(`juris`.`country_cd`,'UNM')                                                                  AND `juris`.`etl_current_record_flag` = 'Y'          LEFT JOIN (             SELECT    `stg_bcrs_facility_products`.`w_batch_id`,                 `stg_bcrs_facility_products`.`partition_key`,                 `stg_bcrs_facility_products`.`facility_reference`,                 `stg_bcrs_facility_products`.`contract_type`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_facility_products`.`facility_reference` ORDER BY `stg_bcrs_facility_products`.`facility_reference` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_facility_products`   WHERE `stg_bcrs_facility_products`.`w_batch_id` = '2021102513163900521'         ) `facprod` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`facprod`.`partition_key`,'UNM')                      AND nvl(`facprod`.`facility_reference`,'UNM') = substr(`fac`.`contract_reference`,1,instr(`fac`.`contract_reference`,'-M') - 1)                      AND `fac`.`attribute_1` = 'MOTHER'        AND `facprod`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON substr(`tcdr`.`partition_key`,1,8) = substr(`contp`.`partition_key`,1,8)                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`facprod`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021102513163900521'          LEFT JOIN (             SELECT   w_batch_id,                 partition_key,                 nvl(`t_cdr`.`contract_reference`,'UNM') `contract_reference`,                 nvl(`t_cdr`.`table_name`,'UNM') `table_name`,                 nvl(`t_cdr`.`counterparty_original`,'UNM') `counterparty_original`,                 SUM(nvl(`t_cdr`.`rwa`,0) ) `rwa`,                 SUM(nvl(`t_cdr`.`el`,0) ) `el`             FROM                 `sgmisitstg`.`stg_bcrs_t_cdr` `t_cdr`   WHERE `t_cdr`.`w_batch_id` = '2021102513163900521'             GROUP BY   `t_cdr`.`w_batch_id`,                 `t_cdr`.`partition_key`,                 nvl(`t_cdr`.`contract_reference`,'UNM'),                 nvl(`t_cdr`.`table_name`,'UNM'),                 nvl(`t_cdr`.`counterparty_original`,'UNM')         ) `t_cdr_temp` ON nvl(`tcdr`.`partition_key`,'UNM') = `t_cdr_temp`.`partition_key`                         AND nvl(`tcdr`.`contract_reference`,'UNM') = `t_cdr_temp`.`contract_reference`                         AND nvl(`tcdr`.`table_name`,'UNM') = `t_cdr_temp`.`table_name`                         AND nvl(`tcdr`.`counterparty_original`,'UNM') = `t_cdr_temp`.`counterparty_original`     left join `sgmisitstg`.`stg_bcrs_facility_links` `facl`   on (CASE WHEN (length(`tcdr`.`contract_reference`) = 10 or length(`tcdr`.`contract_reference`) = 11 or length(`tcdr`.`contract_reference`) = 12) THEN substr(`tcdr`.`contract_reference`,1,instr(`tcdr`.`contract_reference`,'-M') - 1)          ELSE `tcdr`.`contract_reference` END) = `facl`.`contract_reference`   and substr(`tcdr`.`partition_key`,1,8) = substr(`facl`.`partition_key`,1,8)   and `facl`.`table_name` = `tcdr`.`table_name`   and `facl`.`w_batch_id` = '2021102513163900521'    left join (select `sgmi_client_bca_d`.`client_le_wid`, `sgmi_client_bca_d`.`client_le_id`, `sgmi_client_bca_d`.`bca_ref_no`, `sgmi_client_bca_d`.`bca_approval_dt`, `sgmi_client_bca_d`.`bca_review_dt`, `sgmi_client_bca_d`.`w_snapshot_dt`,   ROW_NUMBER() OVER( PARTITION BY `sgmi_client_bca_d`.`client_le_id` ORDER BY `sgmi_client_bca_d`.`client_le_id` ) AS `rnk`                 from `sgmisit`.`sgmi_client_bca_d` ) `bca`                 on substr(`tcdr`.`counterparty_original`,1,8) = `bca`.`client_le_id`                 and `tcdr`.`w_snapshot_dt` = `bca`.`w_snapshot_dt`   and `bca`.`rnk` = 1   left join `sgmisit`.`sgmi_collateral_type_dat` `coltp`   on `tcdr`.`collateral_contract_type` = `coltp`.`collateral_code`   and `coltp`.`etl_current_record_flag` = 'Y'   left join `sgmisit`.`sgmi_sme_product_dat` `smeprod`   on `tcdr`.`contract_type` = `smeprod`.`contract_type`   LEFT JOIN `sgmisit`.`SGMI_BOOK_CD_D` `BOOK`    ON `tcdr`.`dealbook`  =`book`.`book_wid` AND `tcdr`.`w_datasource_id` = `book`.`w_datasource_id` AND `tcdr`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE`    ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`    AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_sme_prr` `sme_prr`    ON `tcdr`.`contract_type` = regexp_replace(`sme_prr`.`product_code`,'S_','')                                                 and `be`.`booking_loc_id` = `sme_prr`.`country`                and `sme_prr`.`w_batch_id` = '2021102513163900521'     LEFT JOIN (SELECT `stg_bcrs_crm_sr`.`partition_key`, `stg_bcrs_crm_sr`.`crm_id`, `stg_bcrs_crm_sr`.`collateral_mode`, `stg_bcrs_crm_sr`.`beneficiary`, `stg_bcrs_crm_sr`.`group_link_type`, `stg_bcrs_crm_sr`.`currency`, `stg_bcrs_crm_sr`.`guarantee_percentage`, `stg_bcrs_crm_sr`.`market_value`, `stg_bcrs_crm_sr`.`market_value_ccy`, `stg_bcrs_crm_sr`.`evaluation_date`, `stg_bcrs_crm_sr`.`benef_table_name`, `stg_bcrs_crm_sr`.`benef_contract_ref`, `stg_bcrs_crm_sr`.`repartition_method`, `stg_bcrs_crm_sr`.`amount_prior_claims`, `stg_bcrs_crm_sr`.`pct_same_rank_claims`, `stg_bcrs_crm_sr`.`fdw_netting_agreement`, `stg_bcrs_crm_sr`.`parent_collateral`, `stg_bcrs_crm_sr`.`parent_nominal`, `stg_bcrs_crm_sr`.`parent_currency`, `stg_bcrs_crm_sr`.`parent_amount_prior_claims`, `stg_bcrs_crm_sr`.`parent_pct_same_rank_claims`, `stg_bcrs_crm_sr`.`parent_lgd`, `stg_bcrs_crm_sr`.`parent_maturity_date`, `stg_bcrs_crm_sr`.`own_estimated_haircut`, `stg_bcrs_crm_sr`.`flag_on_deposit`, `stg_bcrs_crm_sr`.`zero_haircut_eligible`, `stg_bcrs_crm_sr`.`securitization_only`, `stg_bcrs_crm_sr`.`repo_type`, `stg_bcrs_crm_sr`.`cardinality`, `stg_bcrs_crm_sr`.`restructuring`, `stg_bcrs_crm_sr`.`risk_type_mode`, `stg_bcrs_crm_sr`.`underlying_security_ref`, `stg_bcrs_crm_sr`.`flag_generic_2`, `stg_bcrs_crm_sr`.`materiality_threshold`, `stg_bcrs_crm_sr`.`rw_floor_generic_flag`, `stg_bcrs_crm_sr`.`flag_recognized_cre`, `stg_bcrs_crm_sr`.`floor2`, `stg_bcrs_crm_sr`.`guar_lgd_mitigation`, `stg_bcrs_crm_sr`.`overlapping_priority`, `stg_bcrs_crm_sr`.`scenario_id`, `stg_bcrs_crm_sr`.`crm_eligibility`, `stg_bcrs_crm_sr`.`crm_rank`, `stg_bcrs_crm_sr`.`col_family`, `stg_bcrs_crm_sr`.`rw`, `stg_bcrs_crm_sr`.`residual_maturity`, `stg_bcrs_crm_sr`.`contract_reference`, `stg_bcrs_crm_sr`.`sub_reference`, `stg_bcrs_crm_sr`.`table_name`, `stg_bcrs_crm_sr`.`method`, `stg_bcrs_crm_sr`.`bs_type`, `stg_bcrs_crm_sr`.`counterparty`, `stg_bcrs_crm_sr`.`contract_type`, `stg_bcrs_crm_sr`.`bis_product_type`, `stg_bcrs_crm_sr`.`bis_product_category`, `stg_bcrs_crm_sr`.`asset_class`, `stg_bcrs_crm_sr`.`pd`, `stg_bcrs_crm_sr`.`nominal`, `stg_bcrs_crm_sr`.`lgd`, `stg_bcrs_crm_sr`.`risk_bucket`, `stg_bcrs_crm_sr`.`risk_type`, `stg_bcrs_crm_sr`.`haircut_risk_bucket`, `stg_bcrs_crm_sr`.`eligibility_risk_bucket`, `stg_bcrs_crm_sr`.`revaluation_frequency`, `stg_bcrs_crm_sr`.`holding_period`, `stg_bcrs_crm_sr`.`underlying_maturity`, `stg_bcrs_crm_sr`.`maturity_date`, `stg_bcrs_crm_sr`.`start_date`, `stg_bcrs_crm_sr`.`book_code`, `stg_bcrs_crm_sr`.`family`, `stg_bcrs_crm_sr`.`exchange_rate`, `stg_bcrs_crm_sr`.`inter_company`, `stg_bcrs_crm_sr`.`attribute_1`, `stg_bcrs_crm_sr`.`attribute_2`, `stg_bcrs_crm_sr`.`attribute_3`, `stg_bcrs_crm_sr`.`attribute_4`, `stg_bcrs_crm_sr`.`attribute_5`, `stg_bcrs_crm_sr`.`attribute_6`, `stg_bcrs_crm_sr`.`attribute_7`, `stg_bcrs_crm_sr`.`attribute_8`, `stg_bcrs_crm_sr`.`attribute_9`, `stg_bcrs_crm_sr`.`amount_1`, `stg_bcrs_crm_sr`.`amount_2`, `stg_bcrs_crm_sr`.`hc_eff`, `stg_bcrs_crm_sr`.`guar_management`, `stg_bcrs_crm_sr`.`bis_key_analysis_id`, `stg_bcrs_crm_sr`.`cover_principal_only`, `stg_bcrs_crm_sr`.`flag_issued_by_the_bank`, `stg_bcrs_crm_sr`.`issuer_guarantor`, `stg_bcrs_crm_sr`.`import_source`, `stg_bcrs_crm_sr`.`allocable_amount`, `stg_bcrs_crm_sr`.`lgd_internal_rating`, `stg_bcrs_crm_sr`.`standard_rw`, `stg_bcrs_crm_sr`.`first_loss`, `stg_bcrs_crm_sr`.`seniority`, `stg_bcrs_crm_sr`.`flag_generic`, `stg_bcrs_crm_sr`.`crm_location`, `stg_bcrs_crm_sr`.`reference_seniority`, `stg_bcrs_crm_sr`.`first_lien`, `stg_bcrs_crm_sr`.`occupied_or_rented`, `stg_bcrs_crm_sr`.`completed`, `stg_bcrs_crm_sr`.`uncorelated_mv_borrower`, `stg_bcrs_crm_sr`.`uncorelated_borrower_mv`, `stg_bcrs_crm_sr`.`damage_insurance`, `stg_bcrs_crm_sr`.`legal_certainty`, `stg_bcrs_crm_sr`.`independant_valuer`, `stg_bcrs_crm_sr`.`mortgage_lending_value`, `stg_bcrs_crm_sr`.`assigned_amount`, `stg_bcrs_crm_sr`.`collateral_portion`, `stg_bcrs_crm_sr`.`asset_class_category`, `stg_bcrs_crm_sr`.`sub_type`, `stg_bcrs_crm_sr`.`mn_rank`, `stg_bcrs_crm_sr`.`mn_nominal`, `stg_bcrs_crm_sr`.`mn_prudential_apc`, `stg_bcrs_crm_sr`.`mn_external_deal`, `stg_bcrs_crm_sr`.`lgd_rating_agency`, `stg_bcrs_crm_sr`.`flag_fictive`, `stg_bcrs_crm_sr`.`elg_risk_bucket_int`, `stg_bcrs_crm_sr`.`benef_category`, `stg_bcrs_crm_sr`.`actual_rating_agency`, `stg_bcrs_crm_sr`.`actual_rating`, `stg_bcrs_crm_sr`.`flag_adjustment`, `stg_bcrs_crm_sr`.`guar_management_adv`, `stg_bcrs_crm_sr`.`guar_lgd_adv`, `stg_bcrs_crm_sr`.`guar_lgd_adv_pre_stress`, `stg_bcrs_crm_sr`.`k_function_used`, `stg_bcrs_crm_sr`.`re_recast`, `stg_bcrs_crm_sr`.`audit_crm_eligibility`, `stg_bcrs_crm_sr`.`booking_company`, `stg_bcrs_crm_sr`.`payout_option`, `stg_bcrs_crm_sr`.`crm_location_currency`, `stg_bcrs_crm_sr`.`std_risk_bucket`, `stg_bcrs_crm_sr`.`pd_pre_floor`, `stg_bcrs_crm_sr`.`lgd_pre_stress`, `stg_bcrs_crm_sr`.`fi_type`, `stg_bcrs_crm_sr`.`rw_floor`, `stg_bcrs_crm_sr`.`sov_rating_used`, `stg_bcrs_crm_sr`.`internal_rating_code`, `stg_bcrs_crm_sr`.`internal_rating_agency`, `stg_bcrs_crm_sr`.`external_rating_code`, `stg_bcrs_crm_sr`.`external_rating_agency`, `stg_bcrs_crm_sr`.`bankruptcy_remote`, `stg_bcrs_crm_sr`.`margin_type`, `stg_bcrs_crm_sr`.`margin_agreement`, `stg_bcrs_crm_sr`.`rw_pre_floor`, `stg_bcrs_crm_sr`.`sov_rw_floor`, `stg_bcrs_crm_sr`.`clearing_house_code`, `stg_bcrs_crm_sr`.`qualifying_ccp`, `stg_bcrs_crm_sr`.`qualifying_transaction`, `stg_bcrs_crm_sr`.`clearing_member`, `stg_bcrs_crm_sr`.`audit_crm_eligibility_sa`, `stg_bcrs_crm_sr`.`w_snapshot_dt`, `stg_bcrs_crm_sr`.`w_datasource_id`, `stg_bcrs_crm_sr`.`w_country_cd`, `stg_bcrs_crm_sr`.`w_batch_id`, ROW_NUMBER() OVER( partition by `stg_bcrs_crm_sr`.`contract_reference` ) AS `rnk`  FROM `sgmisitstg`.`stg_bcrs_crm_sr`   where CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_crm_sr`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_crm_sr`.`w_batch_id` = '2021102513163900521' END   ) `crmsr`  on (CASE WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' then `tcdr`.`collateral_reference`                 WHEN `tcdr`.`tranche_guarantee_type` = 'GUARANTEED' then `tcdr`.`guarantee_reference`                 ELSE Null End ) = `crmsr`.`contract_reference`         and `crmsr`.`rnk`=1   LEFT JOIN (select `tbl`.`contract_reference`, `tbl`.`product_type`, `tbl`.`rnk` from (  select `sgmi_retail_exposure_f`.`contract_reference`, `sgmi_retail_exposure_f`.`product_type`, row_number() over(partition by `sgmi_retail_exposure_f`.`contract_reference`) `rnk`   from `sgmisit`.`SGMI_RETAIL_EXPOSURE_F` where `sgmi_retail_exposure_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_retail_exposure_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_retail_exposure_f`.`w_country_cd`='ALL')   `tbl` where `tbl`.`rnk`=1) `RETAIL_EXP` ON `retail_exp`.`contract_reference`=`tcdr`.`contract_reference`        LEFT JOIN `sgmisit`.`SGMI_CTCODE_PRODUCT_LINKAGE_DAT` `PROD_LINK` ON `tcdr`.`contract_type`=`prod_link`.`ct_code_user`  LEFT JOIN (SELECT `lt`.`client_id` `CLIENT_ID`, `lt`.`limit_id` `LIMIT_ID`, `lt`.`limit_id_trim` `LIMIT_ID_TRIM`, `lt`.`product_cd` `PRODUCT_CD`,ROW_NUMBER() OVER (PARTITION BY `lt`.`client_id`, `lt`.`product_cd`) `RN` FROM (SELECT   CASE WHEN trim(`sgmi_client_limit_f`.`client_id`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})-(\\d{1,2})$' OR trim(`sgmi_client_limit_f`.`client_id`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})$' THEN   regexp_replace( regexp_replace(trim(`sgmi_client_limit_f`.`client_id`),'^(SME)(\\w{0,4})-','') ,'-(\\d{1,2})$','') WHEN `sgmi_client_limit_f`.`client_id` regexp '^(\\d{8})$' OR `sgmi_client_limit_f`.`client_id` regexp '^(\\d{8})-(\\d{1,2})$' THEN   regexp_replace(`sgmi_client_limit_f`.`client_id`,'-(\\d{1,2})$','') ELSE   trim(`sgmi_client_limit_f`.`client_id`) END `Client_id`, `sgmi_client_limit_f`.`limit_id`, `sgmi_client_limit_f`.`limit_id_trim`, `sgmi_client_limit_f`.`product_cd`  FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` WHERE `sgmi_client_limit_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_client_limit_f`.`w_datasource_id`='BCRS_PRA')`LT` ) `DERIVED_LT`   ON `derived_lt`.`client_id`=CASE WHEN trim(`tcdr`.`counterparty_original`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})-(\\d{1,2})$' OR trim(`tcdr`.`counterparty_original`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})$' THEN   regexp_replace( regexp_replace(trim(`tcdr`.`counterparty_original`),'^(SME)(\\w{0,4})-','') ,'-(\\d{1,2})$','') WHEN `tcdr`.`counterparty_original` regexp '^(\\d{8})$' OR `tcdr`.`counterparty_original` regexp '^(\\d{8})-(\\d{1,2})$' THEN   regexp_replace(`tcdr`.`counterparty_original`,'-(\\d{1,2})$','') ELSE   trim(`tcdr`.`counterparty_original`) END AND `derived_lt`.`product_cd`=`prod_link`.`lt_product_cd` and `derived_lt`.`rn` = 1       WHERE          `tcdr`.`w_batch_id` = '2021102513163900521'
CREATE VIEW `temp_src_query_2110252101230080287` AS SELECT distinct                      `t`.`partition_key`,     'SME' as `banking_type`,     `t`.`method_new`,     `t`.`method_original`,     `t`.`contract_reference`,     `t`.`tranche_collateral_type`,     `t`.`tranche_guarantee_type`,     `t`.`counterparty_original`,     `e`.`entity_desc` AS `counterparty_original_desc`,     `t`.`counterparty_new`,     `t`.`counterparty_new_desc`,     `t`.`table_name`,     `t`.`bis_past_due`,     `t`.`contract_type`,     `ct`.`ct_desc_user` AS `contract_desc`,     `e`.`cf_indicator`,     (         CASE             WHEN upper(`t`.`counterparty_original`) LIKE '%_CORPORATE%'                  OR upper(`t`.`counterparty_original`) LIKE '%_BANK%'                  OR `t`.`counterparty_original` = '9999999999-1'                  OR `t`.`counterparty_original` = '9999999998-1'       THEN 'Y'              ELSE 'N'         END     ) AS `unmapped_ind`,     (         CASE             WHEN upper(`e`.`attribute_4`) = 'CN' THEN 'Y'             ELSE 'N'         END     ) AS `non_borrowing_ind`,     (         CASE  WHEN `contracttype`.`ct_code_user` is not null THEN 'PURCHASED_RECEIVABLE'             WHEN `t`.`contract_type` IN ( 'GMGMKTPTEQ' ) THEN 'PRIVATE_EQUITY'             WHEN `t`.`contract_type` IN ( 'GMGMKTAINV', 'GMGMKTANPL'  ) THEN 'ALT_INVST'             WHEN `e`.`et_code_user` IN (  'BSC23'  ) THEN 'DEV_ORG'    WHEN `e`.`et_code_user` IN (  'BSC16'  ) THEN 'MDB'             WHEN `e`.`et_code_user` IN (  'BSC24' ) THEN 'PERSONAL'             WHEN `e`.`scorecard_segment_code` IN (  'CFSC'   ) THEN 'SME'             WHEN `e`.`scorecard_segment_category` IN (  'F1'  ) THEN 'BANK'             WHEN `e`.`scorecard_segment_category` IN (  'F2', 'F3'  ) THEN 'NBFI'             WHEN `e`.`scorecard_segment_category` IN (  'S1' ) THEN 'SOV'    WHEN `e`.`scorecard_segment_category` IN (  'CRE', 'PF', 'SF' ) THEN 'SPECIALISED LENDING'             WHEN `e`.`scorecard_segment_category` IN (  'C1', 'C2', 'C3', 'C4', 'C5' ) THEN 'CORP'             ELSE 'CORP'         END     ) AS `segment_original`,     (         CASE             WHEN `t`.`table_name` IN (                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP',                 'CREDIT_DERIVATIVE','REPO_NETTING_VOL','COLLATERAL'             ) THEN 'T'             ELSE 'F'         END     ) AS `derivative_ind`,     `t`.`incorporation_country_original`,     `c`.`country_name`,     `t`.`dealbook`,     `t`.`booking_company_desc`,     `e`.`attribute_1` AS `scorecard_original`,     `t`.`internal_rating_new`,     `t`.`pd_new`,     `t`.`internal_rating_original`,     `t`.`pd_original`,     (         CASE             WHEN nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`method_new` = 'ADV'                  AND `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED' THEN 0.45             WHEN `t`.`import_source` like 'NONTP-%'                  AND `t`.`method_new` = 'ADV' THEN cast(`t`.`exposure_attribute_7` as decimal(38,20))              WHEN (                 ( `t`.`tranche_collateral_type` = 'COLLATERALIZED' )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') <> 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`lgd`             WHEN (                 (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'GUARANTEED'                 )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') = 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN cast(`t`.`exposure_attribute_7` as decimal(38,20))              ELSE 0         END     ) AS `lgd`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY',   'RETAIL_EXPOSURE'                  ) THEN `t`.`outstanding`             ELSE 0         END     ) AS `outstanding`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY',     'RETAIL_EXPOSURE'             ) THEN `t`.`accrued_interest`             ELSE 0         END     ) AS `accrued_interest`,     (         CASE             WHEN `t`.`table_name` IN (                 'FACILITY'             )                  AND `t`.`bs_type` = 'OFB' THEN `t`.`outstanding`             ELSE 0         END     ) AS `headroom`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN `t`.`fair_value`             ELSE 0         END     ) AS `mtm`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN (                         CASE                             WHEN `t`.`fair_value` > 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                     ELSE (                         CASE                             WHEN `t`.`fair_value` < 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                 END             )             ELSE 0         END     ) AS `replacement_cost`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`t`.`nominal`) *-1                     ELSE abs(`t`.`nominal`)                 END             )             ELSE 0         END     ) AS `notional`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN `t`.`add_on`             ELSE 0         END     ) AS `add_on`,     `t`.`ead`,     `t`.`rwa`,     `t`.`rwa_pre_crm`,     `t`.`el`,     `t`.`rgc`,     `t`.`ead_original`,     `t`.`tier1_deduction`,     `t`.`tier2_deduction`,     `t`.`ead_pre_ccf`,     `t`.`nominal`,     `t`.`fair_value`,     `t`.`ead_pro`,     `t`.`ead_pro_gen`,     nvl(round(`prrsr`.`prr`,10),0) `prr`,     ( round(`t`.`ead`,10) * round(`t`.`pd_original`,10) ) AS `wt_pd_original`,     ( round(`t`.`ead`,10) * round(`t`.`pd_new`,10) ) AS `wt_pd_new`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45 * round(`t`.`ead`,10)             WHEN `t`.`method_new` = 'ADV' THEN round(`t`.`lgd`,10) * round(`t`.`ead`,10)             ELSE 0         END     ) AS `wt_lgd`,     ( round(`t`.`ead`,10) * round(`t`.`k_maturity`,10) ) AS `wt_k_maturity`,     ( round(`t`.`ead`,10) * round(`t`.`residual_maturity`,10) ) AS `wt_residual_maturity`,     `t`.`total_annual_sales`,     `t`.`hfx`,     `t`.`hc`,     `t`.`he`,     `t`.`k_maturity`,     `t`.`facility_reference`,     `t`.`performing_status`,     `t`.`securitization_reference`,     `t`.`days_after_contractual_date`,     `t`.`risk_bucket`,     `t`.`delivery_type`,     `t`.`funding_ccy`,     coalesce( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr`.`currency`             ELSE `t`.`currency`         END     ),`t`.`currency`) AS `currency`,     `t`.`residual_maturity`,     `t`.`original_maturity`,     `t`.`ead_method`,     `t`.`ccf`,     `t`.`inter_company`,     `t`.`trading_book_type`,     `e`.`attribute_7` AS `customer_segment_code`,     `e`.`customer_segment_desc`,     `e`.`attribute_8` AS `customer_subsegment_code`,     `e`.`customer_subsegment_desc`,     `t`.`id`,     `t`.`import_source`,     `t`.`product_gl_criteria`,     `t`.`bs_type`,     `t`.`securitized`,     `t`.`risk_type`,     `t`.`bis_product`,     `t`.`bis_product_category`,     `t`.`bis_entity_type_new`,     `t`.`bis_entity_type_original`,     `t`.`asset_class_new`,     `t`.`asset_class_original`,     `t`.`netting_agreement_reference`,     `t`.`collateral_reference`,     `t`.`collateral_contract_type`,     `t`.`collateral_bis_product`,     `t`.`collateral_product_category`,     `t`.`guarantee_reference`,     `t`.`guarantee_contract_type`,     `t`.`guarantee_bis_product`,     `t`.`counterparty_type_new`,     `t`.`sub_method_new`,     `t`.`rw_scaling_factor`,     `t`.`rwa_scaling_factor`,     `t`.`exposure_attribute_7`,     `t`.`exposure_attribute_8`,     `t`.`exposure_attribute_9`,     `t`.`rw_original`,     `t`.`rw_new`,     `t`.`securitization_n`,     `t`.`crm_method`,     `t`.`division_code`,     `t`.`secu_ea_controlled`,     `t`.`secu_company_weight`,     `t`.`secu_bank_role`,     `t`.`obligor_grade_new`,     `t`.`standard_rw_original`,     `t`.`standard_rw_new`,     `t`.`cpty_group`,     `t`.`cpty_group_original`,     `t`.`bis_industry_sector_new`,     `t`.`bis_industry_sector_original`,     `t`.`bis_risk_area_new`,     `t`.`bis_risk_area_original`,     `t`.`incorporation_country_new`,     `t`.`int_rating_agency_new`,     `t`.`risk_country`,     `t`.`used_amount_facility`,     `t`.`beel`,     `t`.`uncommited`,          case when `csr`.`start_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0) - nvl(`t`.`original_maturity`,0)) * 365.25) as INT)) as date)     else `csr`.`start_date` end as `start_date`,       case when `csr`.`maturity_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0)) * 365.25) as INT)) as date)      else `csr`.`maturity_date` end as `maturity_date`,          `t`.`value_date`,     (         CASE             WHEN nvl(`t`.`residual_maturity`,0) <= 1               THEN '<=1yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 3 and nvl(`t`.`residual_maturity`,0) > 1  THEN '1-3yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 5 and nvl(`t`.`residual_maturity`,0) > 3  THEN '3-5yrs'             ELSE '>5yrs'         END     ) AS `maturity_range`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd`             ELSE 0         END     ) AS `tranche_lgd`,         CASE WHEN (`complink`.`mother_code` = '999C' or `complink`.`mother_code` = '976C') and `complink`.`child_code` is not null then 'SOLO'          ELSE 'SUBS' END `company_type`,     nvl(`mru_bus`.`mru_desc`,'UNMAPPED') AS `business`,     `inst`.`psgl_operating_unit` AS `psgl_operating_unit`,     `psgl`.`psgl_cust_class`,     (         CASE             WHEN `t`.`table_name` = 'TRANCHE'                  AND `t`.`bs_type` IN(                 'VIF','VIR'             ) THEN 'TRANCHE_FILTER'             WHEN `t`.`inter_company` = 'T' THEN 'INTERCOMPANY_FILTER'             ELSE 'BCRS'         END     )   AS `filter_type`,     (         CASE             WHEN `t`.`securitized` = 'T'   THEN 'SECURITIZED'             WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'             WHEN `t`.`trading_book_type` = 'T'                  AND `t`.`bis_product_category` IN(                 'REPO','DERIVATIVE','DERIVATIVE_OTC','CREDIT_DERIVATIVE'             ) THEN 'CCR'             WHEN `t`.`tranche_collateral_type` = 'COLLATERALIZED'                  AND `t`.`collateral_bis_product` IN(                 'REP_NET_COL','OTC_NET_COL'             ) THEN 'NETTING_BENEFIT'             ELSE 'FSA'         END     )  AS `fsa_exclusion_type`,     (         CASE             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_past_due` = 'T' THEN 'PAST_DUE_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`asset_class_new` = 'CLAIM_OTH_150'                 OR (                     (                         (                             `t`.`rw_original` >= 1.5                             OR `t`.`standard_rw_original` >= 1.5                         )                         AND NOT (                             (                                 `t`.`tranche_collateral_type` = 'COLLATERALIZED'                                 AND `t`.`crm_method` = 'SIM'                                 AND `t`.`collateral_product_category` = 'FINANCIAL_COL'                             )                             OR `t`.`tranche_guarantee_type` = 'GUARANTEED'                         )                     )                     OR `t`.`rw_new` >= 1.5                 )             ) THEN 'HIGH_RISK_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 ( `t`.`asset_class_new` LIKE '%EQT' )                 OR (                     `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                     AND `t`.`sub_reference` = 'MULTI NAME'                 )                 OR ( `t`.`risk_type` = 'RVR' )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` IN (                 'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE',                 'CLAIM_SEC_CRE',                 'CLAIM_FULL_SEC_RRE'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`collateral_bis_product` IN (                 'RRE_COL',                 'LEASING_CRE_COL',                 'CRE_COL',                 'LEASING_RRE_COL'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_COVERED_BOND' THEN 'COVERED_BONDS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_CIU' THEN 'COLLECTIVE_INV_UNDERTAKINGS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF',                 'CORP',                 'INSURANCE',                 'CORP_CF',                 'CORP_HVCRE',                 'CORP_IPRE',                 'CORP_OF',                 'CORP_PF',                 'EX_RETAIL',                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'SPE',                 'CORP_INT_GRP'             )                  AND (                 `t`.`risk_bucket` IN (                     30,                     31,                     32,                     33,                     34                 )                 OR `t`.`risk_bucket_original` IN (                     30,                     31,                     32,                     33,                     34                 )             ) THEN 'SHORT_TERM_CLAIMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SOV'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'RGLA',                 'RGLA_SOV',                 'RGLA_SOV_EU'             ) THEN 'REGIONAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'PSE',                 'PSE_BANK',                 'PSE_SOV'             ) THEN 'ADMIN_BODIES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'MDB',                 'MDB_PREF_0',                 'MDB_PREF_20'             ) THEN 'MULTILATERAL_DEVT_BANKS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SUPRA',                 'EIF',                 'SUPRA_100'             ) THEN 'INTL_ORGANIZATIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`bis_entity_type_new` IN (                     'SME',                     'SME_CF',                     'SME_HVCRE',                     'SME_IPRE',                     'SME_OF',                     'SME_PF',                     'CORP',                     'INSURANCE',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'CORP_INT_GRP'                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'INDIV',                 'SME_RETAIL'             )                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL'             WHEN `t`.`method_new` = 'STD' THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`bis_entity_type_new` NOT IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` = 'CLAIM_OTH_100'                 )                 AND (                     `t`.`bis_product_category` NOT IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 ( `t`.`asset_class_new` = 'CLAIM%EQT' )                 OR ( `t`.`asset_class_new` = 'CLAIM_CIU' )             ) THEN 'EQUITY_CLAIMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`asset_class_new` IN (                         'CLAIM_FULL_SEC_RRE',                         'CLAIM_SEC_RRE_LEASE',                         'CRE_COL',                         'CLAIM_SEC_CRE',                         'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE'                     )                     OR `t`.`collateral_bis_product` IN (                         'RRE_COL',                         'LEASING_RRE_COL',                         'LEASING_CRE_COL',                         'CRE_COL'                     )                 )                 AND `t`.`bis_entity_type_new` IN (                     'INDIV',                     'SME_RETAIL'                 )             ) THEN 'RETAIL_MORTGAGES'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_RETAIL_QUALIFYING_REVOLVING' THEN 'RETAIL_QRRE'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'INDIV'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_OTHER'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'SME_RETAIL'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_SME'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'FOU'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'ADV'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             ELSE 'OTHER_ITEMS'         END     ) AS `fsa004_asset_class`,     `t`.`secu_mode`,     `t`.`risk_bucket_original`,     `t`.`waterfall_seniority`,     `e`.`origination_country` AS `ccr_original`,     `enew`.`origination_country` AS `ccr_new`,     `t`.`stress_testing_scenario_id`,     `t`.`collateral_attribute_1`,     `t`.`collateral_attribute_9`,     `t`.`exposure_attribute_1`,     `t`.`exposure_attribute_6`,     `t`.`counterparty_new_attribute_1`,     `t`.`sub_reference`,     `t`.`sub_method_original`,     `t`.`int_rating_agency_original`,     `t`.`ead_formula`,     `t`.`booking_company`,     `t`.`obligor_grade_inf_new`,     `t`.`obligor_grade_sup_new`,     `t`.`incorporation_ccy_original`,     `t`.`incorporation_ccy_new`,  nvl(case when `ctp`.`l7_code` is NULL or `ctp`.`l7_code` = '' then (case when `gl`.`l7_code` is NULL or `gl`.`l7_code` = '' then `t`.`management_product` else `gl`.`l7_code` end ) else `ctp`.`l7_code`  end,'UNMAPPED') as `management_product`,     `bus_ind`.`business_identifier_desc` AS `business_identifier`,       CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_w_filter_type`,              CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_filter_type`,          `ct`.`attribute_2` AS `balance_category`,     nvl( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr_exch`.`exch_rate`             ELSE `cer`.`exch_rate`         END     ),`cer`.`exch_rate`) AS `exchange_rate`,     `fac`.`holdco_ind` AS `holding_company_ind`,     `fac`.`non_gam_ind` AS `non_gam_ind`,     `egroup_orig`.`group_cust_segment_code`,     `egroup_orig`.`group_cust_segment_desc`,     `t`.`original_cost`,     `t`.`premium_current`,     `t`.`security_positions_ref`,     `t`.`pd_pre_floor_new`,     `t`.`exposure_attribute_3`,     `t`.`exposure_attribute_4`,     `t`.`exposure_attribute_5`,     `t`.`counterparty_new_attribute_3`,     `t`.`counterparty_new_attribute_4`,     `t`.`collateral_attribute_7`,     `t`.`collateral_attribute_8`,     `e`.`long_term_rating_local_ccy` AS `internal_rating_local_ccy_orig`,     `t`.`past_due_int`,     `t`.`ead_pro_discount`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`ltv`             ELSE 0         END     ) AS `ltv`,     (         CASE             WHEN `bf`.`domicile_country_code` IS NOT NULL                  AND nvl(`e`.`bf_link_type`,'z') = 'BUYER_FINANCE' THEN 'Y'             ELSE 'N'         END     ) AS `buyer_finance_ind`,     `t`.`counterparty_ext_rat_code`,     `t`.`counterparty_ext_rat_agency`,     `t`.`counterparty_int_rat_code`,     `t`.`counterparty_int_rat_agency`,     `t`.`maturity_eff`,     `psgl`.`psgl_department` AS `psgl_department`,     `psgl`.`psgl_product` AS `psgl_product`,      `net`.`netting_type` AS `netting_agreement_type`,     `fac`.`contract_reference` AS `sub_limit_fac_reference`,     `fac`.`amount` AS `limit_amount`,     `fac`.`attribute_1` AS `limit_attribute`,      CASE WHEN round(nvl(`t2`.`sum_rwa`,0),2)  <= 0 THEN nvl(`tcva`.`cva_rwa`,0) / nvl(`t2`.`count_contract_ref`,0)          ELSE (nvl(`t`.`rwa`,0) / `t2`.`sum_rwa`) * nvl(`tcva`.`cva_rwa`,0)     END `cva_rwa`,             `t`.`qualifying_ccp`,     `t`.`k_function_used`,     `t`.`k_function_used_original`,     `t`.`product_gl_criteria_2`,     `t`.`bis_past_due_original`,     `t`.`risk_country_new`,     `t`.`risk_country_original`,     `t`.`booking_company_incorp_country`,     `t`.`ccf_std`,     `t`.`past_due_days`,     `t`.`guarantee_method`,     `t`.`fde_alternative_method`,     `t`.`rwa_pre_cap`,     `t`.`asset_class_category_new`,     `t`.`asset_class_category_original`     FROM ( SELECT `stg_bcrs_t_cdr`.`partition_key`, `stg_bcrs_t_cdr`.`stress_testing_scenario_id`, `stg_bcrs_t_cdr`.`tranche_collateral_type`, `stg_bcrs_t_cdr`.`tranche_guarantee_type`, `stg_bcrs_t_cdr`.`bs_type`, `stg_bcrs_t_cdr`.`contract_reference`, `stg_bcrs_t_cdr`.`contract_type`, `stg_bcrs_t_cdr`.`bis_product`, `stg_bcrs_t_cdr`.`bis_product_category`, `stg_bcrs_t_cdr`.`unconditionnaly_cancelable`, `stg_bcrs_t_cdr`.`ead_original`, `stg_bcrs_t_cdr`.`ead_pre_ccf`, `stg_bcrs_t_cdr`.`ead`, `stg_bcrs_t_cdr`.`ead_pro`, `stg_bcrs_t_cdr`.`facility_reference`, `stg_bcrs_t_cdr`.`collateral_reference`, `stg_bcrs_t_cdr`.`collateral_contract_type`, `stg_bcrs_t_cdr`.`collateral_bis_product`, `stg_bcrs_t_cdr`.`guarantee_reference`, `stg_bcrs_t_cdr`.`guarantee_contract_type`, `stg_bcrs_t_cdr`.`guarantee_bis_product`, `stg_bcrs_t_cdr`.`netting_agreement_reference`, `stg_bcrs_t_cdr`.`netting_agreement_type`, `stg_bcrs_t_cdr`.`counterparty_original`, `stg_bcrs_t_cdr`.`counterparty_type_original`, `stg_bcrs_t_cdr`.`counterparty_new`, `stg_bcrs_t_cdr`.`counterparty_type_new`, `stg_bcrs_t_cdr`.`total_annual_sales`, `stg_bcrs_t_cdr`.`total_annual_assets`, `stg_bcrs_t_cdr`.`bis_entity_type_original`, `stg_bcrs_t_cdr`.`bis_entity_type_new`, `stg_bcrs_t_cdr`.`asset_class_original`, `stg_bcrs_t_cdr`.`asset_class_new`, `stg_bcrs_t_cdr`.`method_original`, `stg_bcrs_t_cdr`.`sub_method_original`, `stg_bcrs_t_cdr`.`method_new`, `stg_bcrs_t_cdr`.`sub_method_new`, `stg_bcrs_t_cdr`.`guarantee_method`, `stg_bcrs_t_cdr`.`he`, `stg_bcrs_t_cdr`.`maturity_eff`, `stg_bcrs_t_cdr`.`k_maturity`, `stg_bcrs_t_cdr`.`pd_original`, `stg_bcrs_t_cdr`.`internal_rating_original`, `stg_bcrs_t_cdr`.`pd_new`, `stg_bcrs_t_cdr`.`internal_rating_new`, `stg_bcrs_t_cdr`.`lgd`, `stg_bcrs_t_cdr`.`lgd_grade_agency`, `stg_bcrs_t_cdr`.`ccf`, `stg_bcrs_t_cdr`.`hfx`, `stg_bcrs_t_cdr`.`hc`, `stg_bcrs_t_cdr`.`mm`, `stg_bcrs_t_cdr`.`floor1`, `stg_bcrs_t_cdr`.`floor2`, `stg_bcrs_t_cdr`.`rwa`, `stg_bcrs_t_cdr`.`rgc`, `stg_bcrs_t_cdr`.`rwa_pre_crm`, `stg_bcrs_t_cdr`.`el`, `stg_bcrs_t_cdr`.`beel`, `stg_bcrs_t_cdr`.`bis_past_due`, `stg_bcrs_t_cdr`.`performing_status`, `stg_bcrs_t_cdr`.`rw_scaling_factor`, `stg_bcrs_t_cdr`.`rwa_scaling_factor`, `stg_bcrs_t_cdr`.`equity_scaling_factor`, `stg_bcrs_t_cdr`.`exemption_maturity_floor`, `stg_bcrs_t_cdr`.`grand_fathering_applied`, `stg_bcrs_t_cdr`.`legislated_program_applied`, `stg_bcrs_t_cdr`.`non_material_equity`, `stg_bcrs_t_cdr`.`zero_rw_for_equity`, `stg_bcrs_t_cdr`.`zero_haircut_for_repo`, `stg_bcrs_t_cdr`.`k_function_used`, `stg_bcrs_t_cdr`.`ead_formula`, `stg_bcrs_t_cdr`.`risk_type`, `stg_bcrs_t_cdr`.`trading_book_type`, `stg_bcrs_t_cdr`.`table_name`, `stg_bcrs_t_cdr`.`exposure_attribute_1`, `stg_bcrs_t_cdr`.`exposure_attribute_2`, `stg_bcrs_t_cdr`.`exposure_attribute_3`, `stg_bcrs_t_cdr`.`exposure_attribute_4`, `stg_bcrs_t_cdr`.`exposure_attribute_5`, `stg_bcrs_t_cdr`.`exposure_attribute_6`, `stg_bcrs_t_cdr`.`exposure_attribute_7`, `stg_bcrs_t_cdr`.`exposure_attribute_8`, `stg_bcrs_t_cdr`.`exposure_attribute_9`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_1`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_2`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_3`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_4`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_5`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_6`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_7`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_8`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_9`, `stg_bcrs_t_cdr`.`collateral_attribute_1`, `stg_bcrs_t_cdr`.`collateral_attribute_2`, `stg_bcrs_t_cdr`.`collateral_attribute_3`, `stg_bcrs_t_cdr`.`collateral_attribute_4`, `stg_bcrs_t_cdr`.`collateral_attribute_5`, `stg_bcrs_t_cdr`.`collateral_attribute_6`, `stg_bcrs_t_cdr`.`collateral_attribute_7`, `stg_bcrs_t_cdr`.`collateral_attribute_8`, `stg_bcrs_t_cdr`.`collateral_attribute_9`, `stg_bcrs_t_cdr`.`guarantee_attribute_1`, `stg_bcrs_t_cdr`.`guarantee_attribute_2`, `stg_bcrs_t_cdr`.`guarantee_attribute_3`, `stg_bcrs_t_cdr`.`guarantee_attribute_4`, `stg_bcrs_t_cdr`.`guarantee_attribute_5`, `stg_bcrs_t_cdr`.`guarantee_attribute_6`, `stg_bcrs_t_cdr`.`guarantee_attribute_7`, `stg_bcrs_t_cdr`.`guarantee_attribute_8`, `stg_bcrs_t_cdr`.`guarantee_attribute_9`, `stg_bcrs_t_cdr`.`inter_company`, `stg_bcrs_t_cdr`.`rwa_pre_cap`, `stg_bcrs_t_cdr`.`rw_original`, `stg_bcrs_t_cdr`.`rw_new`, `stg_bcrs_t_cdr`.`tier1_deduction`, `stg_bcrs_t_cdr`.`tier2_deduction`, `stg_bcrs_t_cdr`.`securitized`, `stg_bcrs_t_cdr`.`seniority_original`, `stg_bcrs_t_cdr`.`seniority_new`, `stg_bcrs_t_cdr`.`collateral_product_category`, `stg_bcrs_t_cdr`.`dealbook`, `stg_bcrs_t_cdr`.`deal_status`, `stg_bcrs_t_cdr`.`sub_reference`, `stg_bcrs_t_cdr`.`securitization_reference`, `stg_bcrs_t_cdr`.`securitization_n`, `stg_bcrs_t_cdr`.`waterfall_seniority`, `stg_bcrs_t_cdr`.`risk_country`, `stg_bcrs_t_cdr`.`zone_a_original`, `stg_bcrs_t_cdr`.`zone_a_new`, `stg_bcrs_t_cdr`.`lgd_mitigation`, `stg_bcrs_t_cdr`.`crm_method`, `stg_bcrs_t_cdr`.`look_through_treatment`, `stg_bcrs_t_cdr`.`second_loss_treatment`, `stg_bcrs_t_cdr`.`risk_bucket`, `stg_bcrs_t_cdr`.`pool_code`, `stg_bcrs_t_cdr`.`incorporation_country`, `stg_bcrs_t_cdr`.`division_code`, `stg_bcrs_t_cdr`.`secu_loss_position`, `stg_bcrs_t_cdr`.`secu_issue_date`, `stg_bcrs_t_cdr`.`secu_ea_controlled`, `stg_bcrs_t_cdr`.`secu_company_weight`, `stg_bcrs_t_cdr`.`secu_bank_role`, `stg_bcrs_t_cdr`.`secu_mode`, `stg_bcrs_t_cdr`.`import_source`, `stg_bcrs_t_cdr`.`company_code`, `stg_bcrs_t_cdr`.`supervisor_code`, `stg_bcrs_t_cdr`.`ccy_code`, `stg_bcrs_t_cdr`.`settlement_price`, `stg_bcrs_t_cdr`.`days_after_contractual_date`, `stg_bcrs_t_cdr`.`delivery_type`, `stg_bcrs_t_cdr`.`mortgage_alternative`, `stg_bcrs_t_cdr`.`booking_company`, `stg_bcrs_t_cdr`.`booking_company_desc`, `stg_bcrs_t_cdr`.`gaap_code`, `stg_bcrs_t_cdr`.`number_of_obligor`, `stg_bcrs_t_cdr`.`security_positions_ref`, `stg_bcrs_t_cdr`.`guar_sub_reference`, `stg_bcrs_t_cdr`.`flag_adjustment`, `stg_bcrs_t_cdr`.`internal_maturity_class`, `stg_bcrs_t_cdr`.`equity_floor_applied`, `stg_bcrs_t_cdr`.`equity_preferential_treatment`, `stg_bcrs_t_cdr`.`fde_alternative_method`, `stg_bcrs_t_cdr`.`collateral_table_name`, `stg_bcrs_t_cdr`.`collateral_mode`, `stg_bcrs_t_cdr`.`funding_ccy`, `stg_bcrs_t_cdr`.`currency`, `stg_bcrs_t_cdr`.`incorporation_ccy_original`, `stg_bcrs_t_cdr`.`incorporation_ccy_new`, `stg_bcrs_t_cdr`.`credit_substitute`, `stg_bcrs_t_cdr`.`value_date`, `stg_bcrs_t_cdr`.`original_maturity`, `stg_bcrs_t_cdr`.`residual_maturity`, `stg_bcrs_t_cdr`.`booking_company_incorp_country`, `stg_bcrs_t_cdr`.`business_line_code`, `stg_bcrs_t_cdr`.`family`, `stg_bcrs_t_cdr`.`standard_rw_new`, `stg_bcrs_t_cdr`.`standard_rw_original`, `stg_bcrs_t_cdr`.`risk_bucket_original`, `stg_bcrs_t_cdr`.`collateral_assigned_amount`, `stg_bcrs_t_cdr`.`used_amount_facility`, `stg_bcrs_t_cdr`.`rwa_pre_floor_equity`, `stg_bcrs_t_cdr`.`bis_past_due_original`, `stg_bcrs_t_cdr`.`ltv`, `stg_bcrs_t_cdr`.`ltv_current`, `stg_bcrs_t_cdr`.`hr`, `stg_bcrs_t_cdr`.`hcr`, `stg_bcrs_t_cdr`.`und_pool_ref`, `stg_bcrs_t_cdr`.`asset_class_category_original`, `stg_bcrs_t_cdr`.`asset_class_category_new`, `stg_bcrs_t_cdr`.`netting_agreement_amount_1`, `stg_bcrs_t_cdr`.`netting_agreement_amount_2`, `stg_bcrs_t_cdr`.`netting_agreement_amount_3`, `stg_bcrs_t_cdr`.`netting_agreement_amount_4`, `stg_bcrs_t_cdr`.`netting_agreement_amount_5`, `stg_bcrs_t_cdr`.`netting_agreement_amount_6`, `stg_bcrs_t_cdr`.`netting_agreement_amount_7`, `stg_bcrs_t_cdr`.`entity_type_category_original`, `stg_bcrs_t_cdr`.`entity_type_category_new`, `stg_bcrs_t_cdr`.`ead_pro_write_off`, `stg_bcrs_t_cdr`.`ead_pro_discount`, `stg_bcrs_t_cdr`.`cpty_group`, `stg_bcrs_t_cdr`.`counterparty_new_desc`, `stg_bcrs_t_cdr`.`internal_rating_new_rank`, `stg_bcrs_t_cdr`.`uncommited`, `stg_bcrs_t_cdr`.`capital_item`, `stg_bcrs_t_cdr`.`product_gl_criteria`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_ori`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_new`, `stg_bcrs_t_cdr`.`secu_retail_line_fg`, `stg_bcrs_t_cdr`.`secu_uncommited_retail_fg`, `stg_bcrs_t_cdr`.`secu_spread_trapping_ratio`, `stg_bcrs_t_cdr`.`collateral_issuer`, `stg_bcrs_t_cdr`.`coll_issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`collateral_haircut_risk_bucket`, `stg_bcrs_t_cdr`.`guarantor`, `stg_bcrs_t_cdr`.`guarantor_bis_entity_type`, `stg_bcrs_t_cdr`.`ead_pro_gen`, `stg_bcrs_t_cdr`.`pd_pre_floor_original`, `stg_bcrs_t_cdr`.`pd_pre_floor_new`, `stg_bcrs_t_cdr`.`lgd_pre_floor_original`, `stg_bcrs_t_cdr`.`lgd_pre_floor_new`, `stg_bcrs_t_cdr`.`int_rating_agency_original`, `stg_bcrs_t_cdr`.`int_rating_agency_new`, `stg_bcrs_t_cdr`.`cpty_group_original`, `stg_bcrs_t_cdr`.`nominal`, `stg_bcrs_t_cdr`.`add_on`, `stg_bcrs_t_cdr`.`fair_value`, `stg_bcrs_t_cdr`.`amortized_cost`, `stg_bcrs_t_cdr`.`accrued_interest`, `stg_bcrs_t_cdr`.`amortized_cost_no_ias`, `stg_bcrs_t_cdr`.`adjustment_amount`, `stg_bcrs_t_cdr`.`outstanding`, `stg_bcrs_t_cdr`.`original_cost`, `stg_bcrs_t_cdr`.`accrued_fees`, `stg_bcrs_t_cdr`.`past_due_ppal`, `stg_bcrs_t_cdr`.`past_due_int`, `stg_bcrs_t_cdr`.`premium_current`, `stg_bcrs_t_cdr`.`cpty_new_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`cpty_orig_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`effective_epe`, `stg_bcrs_t_cdr`.`ead_method`, `stg_bcrs_t_cdr`.`netting_class`, `stg_bcrs_t_cdr`.`bis_industry_sector_new`, `stg_bcrs_t_cdr`.`bis_industry_sector_original`, `stg_bcrs_t_cdr`.`bis_risk_area_new`, `stg_bcrs_t_cdr`.`bis_risk_area_original`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_new`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_original`, `stg_bcrs_t_cdr`.`risk_country_new`, `stg_bcrs_t_cdr`.`risk_country_original`, `stg_bcrs_t_cdr`.`incorporation_country_new`, `stg_bcrs_t_cdr`.`incorporation_country_original`, `stg_bcrs_t_cdr`.`bis_performing_status`, `stg_bcrs_t_cdr`.`rwa_cap_ratio`, `stg_bcrs_t_cdr`.`exposure_amount_1`, `stg_bcrs_t_cdr`.`exposure_amount_2`, `stg_bcrs_t_cdr`.`final_beneficiary`, `stg_bcrs_t_cdr`.`collateral_valuation_date`, `stg_bcrs_t_cdr`.`unrestricted_psia_pct`, `stg_bcrs_t_cdr`.`restricted_psia_pct`, `stg_bcrs_t_cdr`.`collateral_issued_by_the_bank`, `stg_bcrs_t_cdr`.`guarantee_issued_by_the_bank`, `stg_bcrs_t_cdr`.`rated_borrower`, `stg_bcrs_t_cdr`.`long_short`, `stg_bcrs_t_cdr`.`external_rating_new`, `stg_bcrs_t_cdr`.`external_rating_original`, `stg_bcrs_t_cdr`.`external_rating_agency_new`, `stg_bcrs_t_cdr`.`external_rating_agency_orig`, `stg_bcrs_t_cdr`.`collateral_country`, `stg_bcrs_t_cdr`.`issuer`, `stg_bcrs_t_cdr`.`issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`issuer_country`, `stg_bcrs_t_cdr`.`product_gl_criteria_2`, `stg_bcrs_t_cdr`.`positions_type`, `stg_bcrs_t_cdr`.`eligibility_risk_bucket`, `stg_bcrs_t_cdr`.`retail_purpose`, `stg_bcrs_t_cdr`.`color_id`, `stg_bcrs_t_cdr`.`past_due_days`, `stg_bcrs_t_cdr`.`collateral_asset_class`, `stg_bcrs_t_cdr`.`collateral_standard_rw`, `stg_bcrs_t_cdr`.`collateral_asset_class_cat`, `stg_bcrs_t_cdr`.`collateral_risk_bucket`, `stg_bcrs_t_cdr`.`coll_issuer_incorporation_ccy`, `stg_bcrs_t_cdr`.`fund_composition_ref`, `stg_bcrs_t_cdr`.`secu_retention_percentage`, `stg_bcrs_t_cdr`.`secu_retention_calc_method`, `stg_bcrs_t_cdr`.`rw_add_on`, `stg_bcrs_t_cdr`.`lgd_non_performing`, `stg_bcrs_t_cdr`.`ccf_std`, `stg_bcrs_t_cdr`.`concentration_ratio`, `stg_bcrs_t_cdr`.`ttc_lgd`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_code`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_agency`, `stg_bcrs_t_cdr`.`counterparty_int_rat_code`, `stg_bcrs_t_cdr`.`counterparty_int_rat_agency`, `stg_bcrs_t_cdr`.`gl_strategy_code`, `stg_bcrs_t_cdr`.`k_function_used_original`, `stg_bcrs_t_cdr`.`long_gross_position`, `stg_bcrs_t_cdr`.`short_gross_position`, `stg_bcrs_t_cdr`.`correlation_trading`, `stg_bcrs_t_cdr`.`ead_pro_pre_ccf`, `stg_bcrs_t_cdr`.`ead_pro_write_off_pre_ccf`, `stg_bcrs_t_cdr`.`sup_reg_vers_code`, `stg_bcrs_t_cdr`.`dataset_version`, `stg_bcrs_t_cdr`.`clearing_house_code`, `stg_bcrs_t_cdr`.`contract_maturity_eff`, `stg_bcrs_t_cdr`.`counterparty_code_2`, `stg_bcrs_t_cdr`.`qualifying_transaction`, `stg_bcrs_t_cdr`.`qualifying_ccp`, `stg_bcrs_t_cdr`.`sov_rating_used`, `stg_bcrs_t_cdr`.`sov_rating_used_ori`, `stg_bcrs_t_cdr`.`current_ead_imm`, `stg_bcrs_t_cdr`.`current_maturity_eff_imm`, `stg_bcrs_t_cdr`.`obligor_grade_original`, `stg_bcrs_t_cdr`.`obligor_grade_new`, `stg_bcrs_t_cdr`.`deduction_step`, `stg_bcrs_t_cdr`.`significant_investment`, `stg_bcrs_t_cdr`.`el_std`, `stg_bcrs_t_cdr`.`deduction_pct`, `stg_bcrs_t_cdr`.`indirect_position`, `stg_bcrs_t_cdr`.`std_risk_bucket_ori`, `stg_bcrs_t_cdr`.`std_risk_bucket_new`, `stg_bcrs_t_cdr`.`ccp_dfund_method`, `stg_bcrs_t_cdr`.`secu_underlying_asset_type`, `stg_bcrs_t_cdr`.`margin_period`, `stg_bcrs_t_cdr`.`ead_scalar`, `stg_bcrs_t_cdr`.`crm_first_lien`, `stg_bcrs_t_cdr`.`available_amount`, `stg_bcrs_t_cdr`.`accounting_adjustment_type`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_1`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_2`, `stg_bcrs_t_cdr`.`adjusted_value`, `stg_bcrs_t_cdr`.`ead_before_acc_adj`, `stg_bcrs_t_cdr`.`lgd_before_acc_adj`, `stg_bcrs_t_cdr`.`subset_code`, `stg_bcrs_t_cdr`.`el_rwa_part`, `stg_bcrs_t_cdr`.`industry_sector_original`, `stg_bcrs_t_cdr`.`cds_qualifying`, `stg_bcrs_t_cdr`.`default_date`, `stg_bcrs_t_cdr`.`credit_bureau_name_original`, `stg_bcrs_t_cdr`.`credit_bureau_name_refreshed`, `stg_bcrs_t_cdr`.`fico_original`, `stg_bcrs_t_cdr`.`fico_refreshed`, `stg_bcrs_t_cdr`.`pool_ead_formula`, `stg_bcrs_t_cdr`.`clearing_member`, `stg_bcrs_t_cdr`.`securitization_depth`, `stg_bcrs_t_cdr`.`securitization_loop`, `stg_bcrs_t_cdr`.`bankruptcy_remote`, `stg_bcrs_t_cdr`.`margin_type`, `stg_bcrs_t_cdr`.`collateral_bankruptcy_remote`, `stg_bcrs_t_cdr`.`collateral_margin_type`, `stg_bcrs_t_cdr`.`remargining_frequency`, `stg_bcrs_t_cdr`.`settlement_ccy`, `stg_bcrs_t_cdr`.`vm_extinguishes_mtm`, `stg_bcrs_t_cdr`.`margin_agreement`, `stg_bcrs_t_cdr`.`rw_pre_floor_new`, `stg_bcrs_t_cdr`.`rwa_pre_floor`, `stg_bcrs_t_cdr`.`ccp_exposure_type`, `stg_bcrs_t_cdr`.`carrying_amount`, `stg_bcrs_t_cdr`.`exchange_rate`, `stg_bcrs_t_cdr`.`policy_update`, `stg_bcrs_t_cdr`.`methodology_update`, `stg_bcrs_t_cdr`.`model_update`, `stg_bcrs_t_cdr`.`pd_model_update`, `stg_bcrs_t_cdr`.`lgd_model_update`, `stg_bcrs_t_cdr`.`ccf_model_update`, `stg_bcrs_t_cdr`.`ead_model_update`, `stg_bcrs_t_cdr`.`covered_ead`, `stg_bcrs_t_cdr`.`fi_type`, `stg_bcrs_t_cdr`.`maturity_date`, `stg_bcrs_t_cdr`.`policy_name`, `stg_bcrs_t_cdr`.`methodology_name`, `stg_bcrs_t_cdr`.`model_name`, `stg_bcrs_t_cdr`.`fund_reference`, `stg_bcrs_t_cdr`.`fund_method`, `stg_bcrs_t_cdr`.`fund_depth`, `stg_bcrs_t_cdr`.`fund_initial`, `stg_bcrs_t_cdr`.`rwa_pre_lvr`, `stg_bcrs_t_cdr`.`leverage`, `stg_bcrs_t_cdr`.`rw_el`, `stg_bcrs_t_cdr`.`use_beel`, `stg_bcrs_t_cdr`.`k_ratio`, `stg_bcrs_t_cdr`.`trade_date`, `stg_bcrs_t_cdr`.`sme_ceiling`, `stg_bcrs_t_cdr`.`sme_floor`, `stg_bcrs_t_cdr`.`sme_ceiling_indicator`, `stg_bcrs_t_cdr`.`fund_assets`, `stg_bcrs_t_cdr`.`obligor_grade_rank_original`, `stg_bcrs_t_cdr`.`obligor_grade_sup_original`, `stg_bcrs_t_cdr`.`obligor_grade_inf_original`, `stg_bcrs_t_cdr`.`obligor_grade_rank_new`, `stg_bcrs_t_cdr`.`obligor_grade_sup_new`, `stg_bcrs_t_cdr`.`obligor_grade_inf_new`, `stg_bcrs_t_cdr`.`lgd_grade_inf`, `stg_bcrs_t_cdr`.`lgd_grade_sup`, `stg_bcrs_t_cdr`.`lgd_grade_rank`, `stg_bcrs_t_cdr`.`lgd_grade`, `stg_bcrs_t_cdr`.`conservation_buffer`, `stg_bcrs_t_cdr`.`conservation_rgc`, `stg_bcrs_t_cdr`.`ctcycal_buffer`, `stg_bcrs_t_cdr`.`ctcycal_rgc`, `stg_bcrs_t_cdr`.`sifi_buffer`, `stg_bcrs_t_cdr`.`sifi_rgc`, `stg_bcrs_t_cdr`.`leverage_ead`, `stg_bcrs_t_cdr`.`at1_deduction`, `stg_bcrs_t_cdr`.`cet1_deduction`, `stg_bcrs_t_cdr`.`adjustment_tag`, `stg_bcrs_t_cdr`.`rw_new_grouping`, `stg_bcrs_t_cdr`.`nominal_at_rw_new`, `stg_bcrs_t_cdr`.`ead_at_rw_new`, `stg_bcrs_t_cdr`.`collateral_completed`, `stg_bcrs_t_cdr`.`rep_product`, `stg_bcrs_t_cdr`.`rep_collateral_product`, `stg_bcrs_t_cdr`.`ltv_indexed`, `stg_bcrs_t_cdr`.`origination_date`, `stg_bcrs_t_cdr`.`is_le`, `stg_bcrs_t_cdr`.`rep_industry_sector`, `stg_bcrs_t_cdr`.`scenario_process_step`, `stg_bcrs_t_cdr`.`period_id`, `stg_bcrs_t_cdr`.`period_start_date`, `stg_bcrs_t_cdr`.`period_end_date`, `stg_bcrs_t_cdr`.`scenario_process_name`, `stg_bcrs_t_cdr`.`scenario_process_id`, `stg_bcrs_t_cdr`.`regulatory_scenario_name`, `stg_bcrs_t_cdr`.`rep_asset_class`, `stg_bcrs_t_cdr`.`rep_sub_product`, `stg_bcrs_t_cdr`.`rep_arrears_band_mia`, `stg_bcrs_t_cdr`.`rep_arrears_band_pia`, `stg_bcrs_t_cdr`.`rep_payment_type`, `stg_bcrs_t_cdr`.`weighted_avg_rate`, `stg_bcrs_t_cdr`.`customer_field11`, `stg_bcrs_t_cdr`.`customer_field12`, `stg_bcrs_t_cdr`.`customer_field13`, `stg_bcrs_t_cdr`.`customer_field14`, `stg_bcrs_t_cdr`.`customer_field15`, `stg_bcrs_t_cdr`.`customer_field16`, `stg_bcrs_t_cdr`.`customer_field17`, `stg_bcrs_t_cdr`.`customer_field18`, `stg_bcrs_t_cdr`.`customer_field19`, `stg_bcrs_t_cdr`.`customer_field20`, `stg_bcrs_t_cdr`.`customer_field21`, `stg_bcrs_t_cdr`.`customer_number11`, `stg_bcrs_t_cdr`.`customer_number12`, `stg_bcrs_t_cdr`.`customer_number13`, `stg_bcrs_t_cdr`.`customer_number14`, `stg_bcrs_t_cdr`.`customer_number15`, `stg_bcrs_t_cdr`.`customer_number16`, `stg_bcrs_t_cdr`.`customer_number17`, `stg_bcrs_t_cdr`.`customer_number18`, `stg_bcrs_t_cdr`.`customer_date1`, `stg_bcrs_t_cdr`.`customer_date2`, `stg_bcrs_t_cdr`.`customer_date3`, `stg_bcrs_t_cdr`.`rep_major_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_major_asset_class_new`, `stg_bcrs_t_cdr`.`rep_asset_class_new`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_new`, `stg_bcrs_t_cdr`.`rep_maturity_band`, `stg_bcrs_t_cdr`.`rep_segmentation`, `stg_bcrs_t_cdr`.`src_reporting_date`, `stg_bcrs_t_cdr`.`src_wks_name`, `stg_bcrs_t_cdr`.`src_position`, `stg_bcrs_t_cdr`.`generic_reporting_date`, `stg_bcrs_t_cdr`.`generic_wks_name`, `stg_bcrs_t_cdr`.`generic_position`, `stg_bcrs_t_cdr`.`securitization_mm`, `stg_bcrs_t_cdr`.`securitization_mm_factor`, `stg_bcrs_t_cdr`.`is_eligible_cva`, `stg_bcrs_t_cdr`.`audit_cva_eligibility`, `stg_bcrs_t_cdr`.`ead_pro_cva`, `stg_bcrs_t_cdr`.`generic_field1`, `stg_bcrs_t_cdr`.`generic_field2`, `stg_bcrs_t_cdr`.`generic_field3`, `stg_bcrs_t_cdr`.`generic_field4`, `stg_bcrs_t_cdr`.`generic_field5`, `stg_bcrs_t_cdr`.`generic_field6`, `stg_bcrs_t_cdr`.`generic_field7`, `stg_bcrs_t_cdr`.`generic_field8`, `stg_bcrs_t_cdr`.`generic_field9`, `stg_bcrs_t_cdr`.`generic_field10`, `stg_bcrs_t_cdr`.`generic_number1`, `stg_bcrs_t_cdr`.`generic_number2`, `stg_bcrs_t_cdr`.`generic_number3`, `stg_bcrs_t_cdr`.`generic_number4`, `stg_bcrs_t_cdr`.`generic_number5`, `stg_bcrs_t_cdr`.`generic_number6`, `stg_bcrs_t_cdr`.`generic_number7`, `stg_bcrs_t_cdr`.`generic_number8`, `stg_bcrs_t_cdr`.`generic_number9`, `stg_bcrs_t_cdr`.`generic_number10`, `stg_bcrs_t_cdr`.`customer_field1`, `stg_bcrs_t_cdr`.`customer_field2`, `stg_bcrs_t_cdr`.`customer_field3`, `stg_bcrs_t_cdr`.`customer_field4`, `stg_bcrs_t_cdr`.`customer_field5`, `stg_bcrs_t_cdr`.`customer_field6`, `stg_bcrs_t_cdr`.`customer_field7`, `stg_bcrs_t_cdr`.`customer_field8`, `stg_bcrs_t_cdr`.`customer_field9`, `stg_bcrs_t_cdr`.`customer_field10`, `stg_bcrs_t_cdr`.`customer_number1`, `stg_bcrs_t_cdr`.`customer_number2`, `stg_bcrs_t_cdr`.`customer_number3`, `stg_bcrs_t_cdr`.`customer_number4`, `stg_bcrs_t_cdr`.`customer_number5`, `stg_bcrs_t_cdr`.`customer_number6`, `stg_bcrs_t_cdr`.`customer_number7`, `stg_bcrs_t_cdr`.`customer_number8`, `stg_bcrs_t_cdr`.`customer_number9`, `stg_bcrs_t_cdr`.`customer_number10`, `stg_bcrs_t_cdr`.`run_date`, `stg_bcrs_t_cdr`.`process_profile_sr_id`, `stg_bcrs_t_cdr`.`conso_perimeter`, `stg_bcrs_t_cdr`.`interco`, `stg_bcrs_t_cdr`.`interco_type`, `stg_bcrs_t_cdr`.`valid_cpy_perimeter`, `stg_bcrs_t_cdr`.`issuer_id`, `stg_bcrs_t_cdr`.`approver_id`, `stg_bcrs_t_cdr`.`upload_date`, `stg_bcrs_t_cdr`.`approval_date`, `stg_bcrs_t_cdr`.`adj_batch_date`, `stg_bcrs_t_cdr`.`source_file_name`, `stg_bcrs_t_cdr`.`adj_seq`, `stg_bcrs_t_cdr`.`dp_rule_log`, `stg_bcrs_t_cdr`.`staging_source`, `stg_bcrs_t_cdr`.`id`, `stg_bcrs_t_cdr`.`parent_id`, `stg_bcrs_t_cdr`.`child_id`, `stg_bcrs_t_cdr`.`multipurpose_audit`, `stg_bcrs_t_cdr`.`saccr_pfe`, `stg_bcrs_t_cdr`.`saccr_rc`, `stg_bcrs_t_cdr`.`flag_deduction`, `stg_bcrs_t_cdr`.`business`, `stg_bcrs_t_cdr`.`business_identifier`, `stg_bcrs_t_cdr`.`management_product`, `stg_bcrs_t_cdr`.`w_snapshot_dt`, `stg_bcrs_t_cdr`.`w_datasource_id`, `stg_bcrs_t_cdr`.`w_country_cd`, `stg_bcrs_t_cdr`.`w_batch_id`,          (                 CASE                     WHEN nvl(`stg_bcrs_t_cdr`.`table_name`,'z') IN (                         'BOND',                         'EQUITY',                         'TRANCHE',                         'CONVERTIBLE',                         'FUND'                     ) THEN 'SECURITY_POSITIONS'                     ELSE nvl(`stg_bcrs_t_cdr`.`table_name`,'z')                 END             ) AS `sec_table_name`        FROM             `sgmisitstg`.`stg_bcrs_t_cdr`   ) `t`   left join `sgmisit`.`sgmi_scb_l7_gl_map` `gl` on  (`t`.`dealbook`  = `gl`.`deal_book` and `t`.`contract_type` = `gl`.`contract_type`)  left join `sgmisit`.`sgmi_scb_l7_ct_map` `ctp` on (`t`.`dealbook`  = `ctp`.`deal_book_id` and `t`.`product_gl_criteria` = `ctp`.`product_gl_criteria`)  left join `sgmisitstg`.`stg_bcrs_companies_links` `complink` on `t`.`booking_company` = `complink`.`child_code` and `complink`.`w_batch_id` = '2021102513163900521'   left join (          SELECT `stg_bcrs_t_cdr`.`contract_reference`, SUM(`stg_bcrs_t_cdr`.`rwa`) AS `SUM_RWA`, COUNT(1) `count_contract_ref`         FROM `sgmisitstg`.`stg_bcrs_t_cdr`         WHERE `stg_bcrs_t_cdr`.`w_batch_id` = '2021102513163900521'         GROUP BY `stg_bcrs_t_cdr`.`contract_reference`         ) `t2` on `t`.`contract_reference` = `t2`.`contract_reference`          left join `sgmisitstg`.`stg_bcrs_scb_gpr_default_indicator` `grpdfind` on `t`.`contract_type` = `grpdfind`.`indicator_value` AND `grpdfind`.`w_batch_id` = '2021102513163900521'    LEFT JOIN (  select `csrt`.`contract_reference`, `csrt`.`start_date`, `csrt`.`maturity_date`, `csrt`.`import_source`, `csrt`.`value_date`, `csrt`.`w_batch_id`, `csrt`.`rnk` from ( SELECT DISTINCT             `stg_bcrs_csr`.`contract_reference`,             `stg_bcrs_csr`.`start_date`,             `stg_bcrs_csr`.`maturity_date`,             `stg_bcrs_csr`.`import_source`,             `stg_bcrs_csr`.`value_date`,             `stg_bcrs_csr`.`w_batch_id`,             ROW_NUMBER() OVER(ORDER BY `stg_bcrs_csr`.`start_date` asc) `rnk`         FROM `sgmisitstg`.`stg_bcrs_csr` ) `csrt`                   WHERE `csrt`.`import_source` NOT LIKE '%WB%'         AND `csrt`.`rnk` = 1 ) `csr` ON `t`.`contract_reference` = `csr`.`contract_reference`  AND CASE WHEN 'WS7' like '%ADJ%' THEN `csr`.`w_batch_id` = '2021102513163900521' ELSE `csr`.`w_batch_id` = '2021102513163900521' END         LEFT JOIN ( SELECT DISTINCT             `e`.`entity_code`,             `e`.`entity_desc`,             `e`.`attribute_4`,             `e`.`attribute_1`,             `e`.`incorporation_country`,             `e`.`origination_country`,             `cfi`.`scorecard_segment_code`,             `cfi`.`scorecard_segment_category`,             `cfi`.`cf_indicator`,             `e`.`attribute_7`,             `cd1`.`code_desc` AS `customer_segment_desc`,             `e`.`attribute_8`,             `cd2`.`code_desc` AS `customer_subsegment_desc`,             `e`.`et_code_user`,             `icr`.`long_term_rating`,             `icr`.`long_term_rating_local_ccy`,             `e`.`country_code`             , `el`.`bf_link_type`             , `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`  `e`                   LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON `e`.`entity_code` = `icr`.`entity_code`                                                    AND nvl(`icr`.`agency_code`,'z') = 'INTERNAL'                                                    AND `icr`.`w_batch_id` = '2021102513163900521'           LEFT JOIN ( SELECT DISTINCT  `links`.`child_code`,                          case when `linktype`.`link_type` is not null then 'BUYER_FINANCE' else null end `bf_link_type`                         FROM `sgmisitstg`.`stg_bcrs_entity_links` `links` left join (SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                 FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`) `linktype`                                  WHERE `links`.`link_type` IN ( SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                         FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`   ))  `el`              ON `e`.`entity_code` = `el`.`child_code`                      LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_co_fi` `cfi` ON `e`.`attribute_1` = `cfi`.`scorecard_segment`         AND `cfi`.`w_batch_id` = '2021102513163900521'                   LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')         AND `cd1`.`code_type` = 'CUST_SEG'         AND `cd1`.`w_batch_id` = '2021102513163900521'                   LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd2` ON nvl(`cd2`.`code`,'zz') = nvl(`e`.`attribute_8`,'zz')         AND `cd2`.`code_type` = 'CUST_SUB_SEG'         AND `cd2`.`w_batch_id` = '2021102513163900521'           ) `e` ON `t`.`counterparty_original` = `e`.`entity_code` AND `e`.`w_batch_id` = '2021102513163900521'  LEFT JOIN (         SELECT DISTINCT             `e`.`entity_code`,             `e`.`attribute_7` AS `group_cust_segment_code`,             `cd1`.`code_desc` AS `group_cust_segment_desc`,             `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity` `e`                           LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')                    AND `cd1`.`code_type` = 'CUST_SEG'                    AND `cd1`.`w_batch_id` = '2021102513163900521'    where `e`.`w_batch_id` = '2021102513163900521' ) `egroup_orig` ON `t`.`cpty_group_original` = `egroup_orig`.`entity_code`  and `egroup_orig`.`w_batch_id` = '2021102513163900521'  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_entity`.`entity_code`,             `stg_bcrs_entity`.`attribute_1`,             `stg_bcrs_entity`.`origination_country`,             `stg_bcrs_entity`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`         where `stg_bcrs_entity`.`w_batch_id` = '2021102513163900521' ) `enew` ON `t`.`counterparty_new` = `enew`.`entity_code`   LEFT JOIN ( SELECT             `stg_bcrs_companies`.`company_code`,             `stg_bcrs_companies`.`country_code`,             `stg_bcrs_companies`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_companies`         where `stg_bcrs_companies`.`w_batch_id` = '2021102513163900521' ) `cpies` ON `t`.`booking_company` = `cpies`.`company_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_scb_wb_bf_uns_recoveries`.`domicile_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`booking_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`contract_type`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`cf_ind`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`prr`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`         where `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2021102513163900521'      ) `bf` ON `bf`.`domicile_country_code` = `e`.`country_code`             AND `bf`.`booking_country_code` = `cpies`.`country_code`             AND `bf`.`contract_type` = `t`.`contract_type`             AND `bf`.`cf_ind` = `e`.`cf_indicator`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_contract_types`.`ct_code_user`,             `stg_bcrs_contract_types`.`ct_desc_user`,             `stg_bcrs_contract_types`.`attribute_2`,             `stg_bcrs_contract_types`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_contract_types`             where              `stg_bcrs_contract_types`.`w_batch_id` = '2021102513163900521'      ) `ct` ON `t`.`contract_type` = `ct`.`ct_code_user`  Left Join ( select distinct  `stg_bcrs_contract_types`.`ct_code_user`, `stg_bcrs_contract_types`.`contract_category`, `stg_bcrs_contract_types`.`w_batch_id` from  `sgmisitstg`.`stg_bcrs_contract_types` where   `stg_bcrs_contract_types`.`w_batch_id` = '2021102513163900521' and `stg_bcrs_contract_types`.`contract_category` = 'RECEIVABLE' ) `contracttype` on `t`.`contract_type` = `contracttype`.`ct_code_user`           LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`amount`,             `stg_bcrs_facility`.`attribute_1`,             `stg_bcrs_facility`.`attribute_2`,             `stg_bcrs_facility`.`attribute_3`,             `stg_bcrs_facility`.`attribute_4`,             `stg_bcrs_facility`.`attribute_7` AS `non_gam_ind`,             `stg_bcrs_facility`.`attribute_8` AS `holdco_ind`,             `stg_bcrs_facility`.`trade_date`,             `stg_bcrs_facility`.`maturity_date`         FROM             `sgmisitstg`.`stg_bcrs_facility`         WHERE              `stg_bcrs_facility`.`w_batch_id` = '2021102513163900521'      ) `fac` ON `t`.`contract_reference` = `fac`.`contract_reference`      LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_mkt_fx_input`.`booking_company_code`,             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL'             AND `stg_bcrs_mkt_fx_input`.`w_batch_id` = '2021102513163900521'      ) `cer` ON `t`.`booking_company` = `cer`.`booking_company_code`              AND `t`.`currency` = `cer`.`ccy_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_country`.`country_code`,             `stg_bcrs_country`.`country_name`         FROM             `sgmisitstg`.`stg_bcrs_country`         WHERE              `stg_bcrs_country`.`w_batch_id` = '2021102513163900521'      ) `c` ON `t`.`incorporation_country_original` = `c`.`country_code`      LEFT JOIN (     select `prrsrtmp`.`partition_key`, `prrsrtmp`.`cf_indicator`, `prrsrtmp`.`product_code`, `prrsrtmp`.`prr`, `prrsrtmp`.`country`, `prrsrtmp`.`banking_type`, `prrsrtmp`.`w_datasource_id`, `prrsrtmp`.`w_workspace`, `prrsrtmp`.`rnk` from (         SELECT             `sgmi_scb_prr_dat`.`partition_key`,             `sgmi_scb_prr_dat`.`cf_indicator`,              `sgmi_scb_prr_dat`.`product_code`,              `sgmi_scb_prr_dat`.`product_recovery_rate` `prr`,              `sgmi_scb_prr_dat`.`country`,             `sgmi_scb_prr_dat`.`banking_type`,             `sgmi_scb_prr_dat`.`w_datasource_id`,             `sgmi_scb_prr_dat`.`w_workspace`,             ROW_NUMBER() OVER( PARTITION BY `sgmi_scb_prr_dat`.`product_code`, `sgmi_scb_prr_dat`.`country` ORDER BY `sgmi_scb_prr_dat`.`partition_key`) AS `rnk`         FROM             `sgmisit`.`SGMI_SCB_PRR_DAT` ) `prrsrtmp`         where             `prrsrtmp`.`rnk` = 1     ) `prrsr` ON `t`.`contract_type` = `prrsr`.`product_code`              AND `t`.`incorporation_country` = `prrsr`.`country`              AND `t`.`table_name` in ('ON_OFF_BALANCE', 'FACILITY', 'DEAL_IMPORT', 'CAPFLOOR', 'COMMODITY_SWAP', 'EQUITY_SWAP', 'EXCHANGE_OPTION', 'FRA', 'FOREX', 'FUTURE', 'OPTIONS', 'SWAP', 'BOND', 'SECURITY_POSITION', 'LOANDEPO','REPO_NETTING_VOL','COLLATERAL')              AND nvl(`t`.`deal_status`,'') = ''              AND `t`.`risk_type` = 'CRE'               AND nvl(`t`.`sub_reference`,'') = ''              AND nvl(`t`.`guarantee_reference`, '') = ''              AND `t`.`method_original` = 'ADV'               AND `t`.`w_datasource_id` = `prrsr`.`w_datasource_id`              AND `prrsr`.`banking_type` = 'SME'              AND SUBSTR(`prrsr`.`partition_key`,-2,2) = SUBSTR(`t`.`partition_key`,-2,2)                     LEFT JOIN (             select `addtinst`.`contract_reference`, `addtinst`.`table_name`, `addtinst`.`tp_portfolio_name`, `addtinst`.`psgl_department_id`, `addtinst`.`psgl_product_code`, `addtinst`.`psgl_operating_unit`, `addtinst`.`psgl_customer_class`, `addtinst`.`rnk` from (                 SELECT                     `stg_bcrs_scb_wb_addt_inst`.`contract_reference`,                     `stg_bcrs_scb_wb_addt_inst`.`table_name`,                     `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`,                     ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ORDER BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`) AS `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2021102513163900521') `addtinst`                              WHERE                         `addtinst`.`rnk` = 1     ) `inst` ON `inst`.`contract_reference` = `t`.`contract_reference`               AND `inst`.`table_name` = `t`.`sec_table_name`                               LEFT JOIN (         SELECT             nvl(`split_ref`.`contract_reference`,`a`.`contract_reference`) `contract_reference`,             `a`.`psgl_cust_class`,             `a`.`psgl_product`,             TRIM(`a`.`psgl_department`) `psgl_department`,             `a`.`fermat_table_name`         FROM             (                 SELECT DISTINCT                     `b`.`contract_reference`,                     `b`.`fermat_table_name`,                     `b`.`psgl_cust_class`,                     `b`.`psgl_product`,                     `b`.`psgl_department`,                     `c`.`priority`,                     ROW_NUMBER() OVER(PARTITION BY `b`.`contract_reference`, `b`.`fermat_table_name` ORDER BY `c`.`priority`) `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_sme_psgl` `b`                     left join `sgmisitstg`.`stg_bcrs_scb_wb_amt_cat_priority` `c`                                         on `b`.`fermat_table_name` = `c`.`table_name`                      and `b`.`amount_category_dw_sorsa` = `c`.`amount_category_dw_sorsa`                     and `b`.`psgl_product` <> 'ZZZ'                     and `b`.`w_batch_id`='2021102513163900521'                      and `b`.`w_batch_id` = `c`.`w_batch_id`                                     ) `a`             left join             (                 SELECT DISTINCT                     `stg_bcrs_facility_links`.`contract_reference`,                     `stg_bcrs_facility_links`.`attribute_1` AS `orig_cont_ref`                 FROM                     `sgmisitstg`.`stg_bcrs_facility_links`                 WHERE                     `stg_bcrs_facility_links`.`attribute_1` IS NOT NULL and `stg_bcrs_facility_links`.`w_batch_id`='2021102513163900521'             ) `split_ref`         on             `a`.`contract_reference` = `split_ref`.`orig_cont_ref`             where   `a`.`rnk` = 1     ) `psgl` ON `t`.`contract_reference` = `psgl`.`contract_reference`               AND `t`.`sec_table_name` = `psgl`.`fermat_table_name`                                                 LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_mpdt_mru_map`.`mru_desc`,             `stg_bcrs_scb_wb_mpdt_mru_map`.`mpdt_code`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_mpdt_mru_map` where `stg_bcrs_scb_wb_mpdt_mru_map`.`w_batch_id`='2021102513163900521'     ) `mru_bus` ON `mru_bus`.`mpdt_code` = `t`.`management_product`                        LEFT JOIN `sgmisitstg`.`stg_bcrs_fdw_netting_agreement` `net` ON `net`.`agreement_reference` = `t`.`netting_agreement_reference`     and `net`.`w_batch_id`='2021102513163900521'          LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_fac_sub_limits`.`id`,             `stg_bcrs_scb_wb_fac_sub_limits`.`contract_reference`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_attribute`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_amount`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_fac_sub_limits` where `stg_bcrs_scb_wb_fac_sub_limits`.`w_batch_id`='2021102513163900521'     ) `sub` ON `t`.`id` = `sub`.`id`          LEFT JOIN (         SELECT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`book_code`,             `stg_bcrs_facility`.`currency`         FROM             `sgmisitstg`.`stg_bcrs_facility` where `stg_bcrs_facility`.`w_batch_id`='2021102513163900521'     ) `fac_curr` ON `sub`.`contract_reference` = `fac_curr`.`contract_reference`       LEFT JOIN (         SELECT             `stg_bcrs_deal_book`.`booking_company`,             `stg_bcrs_deal_book`.`book_code`         FROM             `sgmisitstg`.`stg_bcrs_deal_book` where `stg_bcrs_deal_book`.`w_batch_id`='2021102513163900521'     ) `dealbook` ON `dealbook`.`book_code` = `fac_curr`.`book_code`          LEFT JOIN (         SELECT             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`,             `stg_bcrs_mkt_fx_input`.`booking_company_code`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL' and `stg_bcrs_mkt_fx_input`.`w_batch_id`='2021102513163900521'     ) `fac_curr_exch` ON `fac_curr_exch`.`ccy_code` = `fac_curr`.`currency`                        AND `fac_curr_exch`.`booking_company_code` = `dealbook`.`booking_company`                               LEFT JOIN (         SELECT             `stg_bcrs_t_cva`.`contract_reference`,             count(`stg_bcrs_t_cva`.`contract_reference`) as `count_contract_ref`,             SUM(nvl(`stg_bcrs_t_cva`.`cva_rwa`,0) ) `cva_rwa`         FROM             `sgmisitstg`.`stg_bcrs_t_cva` where `stg_bcrs_t_cva`.`w_batch_id`='2021102513163900521'         GROUP BY             `stg_bcrs_t_cva`.`contract_reference`     ) `tcva` ON `tcva`.`contract_reference` = `t`.`contract_reference`              LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_mru_business_idntfr_map` `bus_ind`      ON `bus_ind`.`business_identifier` = `t`.`business_identifier` and `bus_ind`.`w_batch_id`='2021102513163900521'      where `t`.`w_batch_id` = '2021102513163900521'      and `t`.`import_source` NOT LIKE '%WB%'         and `t`.`w_snapshot_dt` = '2021-06-30'     and `t`.`w_datasource_id` = 'BCRS_PRA'     and `t`.`w_country_cd`='ALL'       union all  SELECT                       `t1`.`partition_key`,     'WB' as `banking_Type`,     `t1`.`method_new`,     `t1`.`method_original`,     `t1`.`contract_reference`,     `t1`.`tranche_collateral_type`,     `t1`.`tranche_guarantee_type`,     `t1`.`counterparty_original`,     `t1`.`counterparty_original_desc`,     `t1`.`counterparty_new`,     `t1`.`counterparty_new_desc`,     `t1`.`table_name`,     `t1`.`bis_past_due`,     `t1`.`contract_type`,     `t1`.`contract_desc`,     `t1`.`cf_indicator`,     `t1`.`unmapped_ind`,     `t1`.`non_borrowing_ind`,     `t1`.`segment_original`,     `t1`.`derivative_ind`,     `t1`.`incorporation_country_original`,     `t1`.`country_name`,     `t1`.`dealbook`,     `t1`.`booking_company_desc`,     `t1`.`scorecard_original`,     `t1`.`internal_rating_new`,     `t1`.`pd_new`,     `t1`.`internal_rating_original`,     `t1`.`pd_original`,     `t1`.`lgd`,     `t1`.`outstanding`,     `t1`.`accrued_interest`,     `t1`.`headroom`,     `t1`.`mtm`,     `t1`.`replacement_cost`,     `t1`.`notional`,     `t1`.`add_on`,     `t1`.`ead`,     `t1`.`rwa`,     `t1`.`rwa_pre_crm`,     `t1`.`el`,     `t1`.`rgc`,     `t1`.`ead_original`,     `t1`.`tier1_deduction`,     `t1`.`tier2_deduction`,     `t1`.`ead_pre_ccf`,     `t1`.`nominal`,     `t1`.`fair_value`,     `t1`.`ead_pro`,     `t1`.`ead_pro_gen`,     `t1`.`prr`,     `t1`.`wt_pd_original`,     `t1`.`wt_pd_new`,     `t1`.`wt_lgd`,     `t1`.`wt_k_maturity`,     `t1`.`wt_residual_maturity`,     `t1`.`total_annual_sales`,     `t1`.`hfx`,     `t1`.`hc`,     `t1`.`he`,     `t1`.`k_maturity`,     `t1`.`facility_reference`,     `t1`.`performing_status`,     `t1`.`securitization_reference`,     `t1`.`days_after_contractual_date`,     `t1`.`risk_bucket`,     `t1`.`delivery_type`,     `t1`.`funding_ccy`,     `t1`.`currency`,     `t1`.`residual_maturity`,     `t1`.`original_maturity`,     `t1`.`ead_method`,     `t1`.`ccf`,     `t1`.`inter_company`,     `t1`.`trading_book_type`,     `t1`.`customer_segment_code`,     `t1`.`customer_segment_desc`,     `t1`.`customer_subsegment_code`,     `t1`.`customer_subsegment_desc`,     `t1`.`id`,     `t1`.`import_source`,     `t1`.`product_gl_criteria`,     `t1`.`bs_type`,     `t1`.`securitized`,     `t1`.`risk_type`,     `t1`.`bis_product`,     `t1`.`bis_product_category`,     `t1`.`bis_entity_type_new`,     `t1`.`bis_entity_type_original`,     `t1`.`asset_class_new`,     `t1`.`asset_class_original`,     `t1`.`netting_agreement_reference`,     `t1`.`collateral_reference`,     `t1`.`collateral_contract_type`,     `t1`.`collateral_bis_product`,     `t1`.`collateral_product_category`,     `t1`.`guarantee_reference`,     `t1`.`guarantee_contract_type`,     `t1`.`guarantee_bis_product`,     `t1`.`counterparty_type_new`,     `t1`.`sub_method_new`,     `t1`.`rw_scaling_factor`,     `t1`.`rwa_scaling_factor`,     `t1`.`exposure_attribute_7`,     `t1`.`exposure_attribute_8`,     `t1`.`exposure_attribute_9`,     `t1`.`rw_original`,     `t1`.`rw_new`,     `t1`.`securitization_n`,     `t1`.`crm_method`,     `t1`.`division_code`,     `t1`.`secu_ea_controlled`,     `t1`.`secu_company_weight`,     `t1`.`secu_bank_role`,     `t1`.`obligor_grade_new`,     `t1`.`standard_rw_original`,     `t1`.`standard_rw_new`,     `t1`.`cpty_group`,     `t1`.`cpty_group_original`,     `t1`.`bis_industry_sector_new`,     `t1`.`bis_industry_sector_original`,     `t1`.`bis_risk_area_new`,     `t1`.`bis_risk_area_original`,     `t1`.`incorporation_country_new`,     `t1`.`int_rating_agency_new`,     `t1`.`risk_country`,     `t1`.`used_amount_facility`,     `t1`.`beel`,     `t1`.`uncommited`,     `t1`.`start_date`,     `t1`.`maturity_date`,     `t1`.`value_date`,     `t1`.`maturity_range`,     `t1`.`tranche_lgd`,     `t1`.`company_type`,     `t1`.`business`,     `t1`.`psgl_operating_unit`,     `t1`.`psgl_cust_class`,     `t1`.`filter_type`,     `t1`.`fsa_exclusion_type`,     `t1`.`fsa004_asset_class`,     `t1`.`secu_mode`,     `t1`.`risk_bucket_original`,     `t1`.`waterfall_seniority`,     `t1`.`ccr_original`,     `t1`.`ccr_new`,     `t1`.`stress_testing_scenario_id`,     `t1`.`collateral_attribute_1`,     `t1`.`collateral_attribute_9`,     `t1`.`exposure_attribute_1`,     `t1`.`exposure_attribute_6`,     `t1`.`counterparty_new_attribute_1`,     `t1`.`sub_reference`,     `t1`.`sub_method_original`,     `t1`.`int_rating_agency_original`,     `t1`.`ead_formula`,     `t1`.`booking_company`,     `t1`.`obligor_grade_inf_new`,     `t1`.`obligor_grade_sup_new`,     `t1`.`incorporation_ccy_original`,     `t1`.`incorporation_ccy_new`,     nvl(case when `force_map`.`l7_code` is null or `force_map`.`l7_code`='' then `t1`.`management_product` else `force_map`.`l7_code` end ,'UNMAPPED') AS `management_product`,     `t1`.`business_identifier`,     `t1`.`ec_w_filter_type`,     `t1`.`ec_filter_type`,     `t1`.`balance_category`,     `t1`.`exchange_rate`,     `t1`.`holding_company_ind`,     `t1`.`non_gam_ind`,     `t1`.`group_cust_segment_code`,     `t1`.`group_cust_segment_desc`,     `t1`.`original_cost`,     `t1`.`premium_current`,     `t1`.`security_positions_ref`,     `t1`.`pd_pre_floor_new`,     `t1`.`exposure_attribute_3`,     `t1`.`exposure_attribute_4`,     `t1`.`exposure_attribute_5`,     `t1`.`counterparty_new_attribute_3`,     `t1`.`counterparty_new_attribute_4`,     `t1`.`collateral_attribute_7`,     `t1`.`collateral_attribute_8`,     `t1`.`internal_rating_local_ccy_orig`,     `t1`.`past_due_int`,     `t1`.`ead_pro_discount`,     `t1`.`ltv`,     `t1`.`buyer_finance_ind`,     `t1`.`counterparty_ext_rat_code`,     `t1`.`counterparty_ext_rat_agency`,     `t1`.`counterparty_int_rat_code`,     `t1`.`counterparty_int_rat_agency`,     `t1`.`maturity_eff`,     `t1`.`psgl_department`,     `t1`.`psgl_product`,     `t1`.`netting_agreement_type`,     `t1`.`sub_limit_fac_reference`,     `t1`.`limit_amount`,     `t1`.`limit_attribute`,     `t1`.`cva_rwa`,     `t1`.`qualifying_ccp`,     `t1`.`k_function_used`,     `t1`.`k_function_used_original`,     `t1`.`product_gl_criteria_2`,     `t1`.`bis_past_due_original`,     `t1`.`risk_country_new`,     `t1`.`risk_country_original`,     `t1`.`booking_company_incorp_country`,     `t1`.`ccf_std`,     `t1`.`past_due_days`,     `t1`.`guarantee_method`,     `t1`.`fde_alternative_method`,     `t1`.`rwa_pre_cap`,     `t1`.`asset_class_category_new`,     `t1`.`asset_class_category_original`      FROM     `sgmisitstg`.`stg_bcrs_scb_wb_txn_rwa` `t1`              left join (SELECT distinct `stg_bcrs_scb_wb_mpdt_override`.`contract_reference` as `CTRF`,`stg_bcrs_scb_wb_mpdt_override`.`mpdt_code` as `L7_CODE`,`stg_bcrs_scb_wb_mpdt_override`.`w_batch_id`  FROM `sgmisitstg`.`STG_BCRS_SCB_WB_MPDT_OVERRIDE` where `stg_bcrs_scb_wb_mpdt_override`.`w_batch_id` = '2021102513163900521') `force_map` on `t1`.`contract_reference`=`force_map`.`ctrf` and `force_map`.`w_batch_id`=`t1`.`w_batch_id`  where `t1`.`w_batch_id` = '2021102513163900521'      and `t1`.`import_source` LIKE '%WB%'     and `t1`.`w_snapshot_dt` = '2021-06-30'     and `t1`.`w_datasource_id` = 'BCRS_PRA'     and `t1`.`w_country_cd`='ALL'
CREATE VIEW `temp_src_query_2110261818380030610` AS SELECT         NVL(`tcdr`.`accrued_fees`,0) `accrued_fees`,  CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(`tcdr`.`accrued_interest`, 0) ELSE 0 END `accrued_interest`,         NVL(`txn`.`accrued_interest`,0) `accrued_interest_dollar`,         NVL(`tcdr`.`add_on`,0) `add_on`,         `txn`.`add_on` AS `add_on_dollar`,         `txn`.`collateral_attribute_9`,         CASE                 WHEN `txn`.`collateral_attribute_9` IN (                     'Correct',                     'Reverse'                 ) THEN 'Y'                 ELSE 'N'             END         `adj_flag`,         NVL(`fac`.`amount`,0) `ADJUSTED_LIMIT_AMOUNT`,         `tcdr`.`adjustment_amount`,         `tcdr`.`id` `ais_id`,         `tcdr`.`amortized_cost`,         `tcdr`.`amortized_cost_no_ias`,         'MFU needed - RSK_LIMIT_STATIC.txt' `approved_lgd`,        'MFU needed - RSK_LIMIT_STATIC.txt' `approver_name`,         `inst`.`arm_code` `arm_cd`,         `inst`.`arm_description` `arm_description`,         `tcdr`.`asset_class_category_new`,         `tcdr`.`asset_class_category_original`,         `tcdr`.`asset_class_new`,         `tcdr`.`asset_class_original`,         `crm`.`attribute_6` `attribute_6`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`avg_pre_funded_contribution`                 ELSE NULL             END         `avg_prefunded_contribution`,         `txn`.`balance_category`,         `bca`.`bca_approval_dt` `BCA_APPROVAL_DATE`,         `bca`.`bca_review_dt` `BCA_REVIEW_DATE`,         `tcdr`.`beel`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`beta`                 ELSE NULL             END         `beta`,         nvl(`cva`.`bi`,0) `bi`,         `tcdr`.`method_new` `bii_calculation_method`,         `tcdr`.`bis_entity_type_new`,         `tcdr`.`bis_entity_type_original`,         `tcdr`.`bis_industry_sector_new`,         `tcdr`.`bis_industry_sector_original`,         `tcdr`.`bis_past_due`,         `tcdr`.`bis_past_due_original`,         `tcdr`.`bis_performing_status`,         `tcdr`.`bis_product` `BIS_PROD`,         `tcdr`.`bis_product_category` `BIS_PROD_CATEGORY`,         `txn`.`bis_risk_area_new`,         `txn`.`bis_risk_area_original`,        `tcdr`.`bis_risk_sub_area_new`,         `tcdr`.`bis_risk_sub_area_original`,         `tcdr`.`booking_company` `booking_entity_wid`,         `tcdr`.`booking_company` `booking_entity_id`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code` THEN `tcdr`.`counterparty_original`                         ELSE NULL                     END                 ELSE NULL             END `BROKER_ID`,         `tcdr`.`bs_type`,         `tcdr`.`business`,         `tcdr`.`business_line_code` `business_line_cd`,         `txn`.`customer_subsegment_code` `BUSINESS_SUB_SEGMENT`,         NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `BUSINESS_UNIT`,         `tcdr`.`capital_item`,         `tcdr`.`ccf`,         `tcdr`.`ccp_dfund_method`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`ccp_name`                 ELSE NULL             END         `ccp_name`,         `client`.`client_domicile_loc_id` `ccr_ctry`,         CASE                 WHEN `client`.`client_domicile_loc_id` IS NULL THEN `client`.`coi_loc_id`                 ELSE `client`.`client_domicile_loc_id`             END `CCR_EQ_CNTRY`,         `txn`.`ccr_new`,         `txn`.`ccr_original`,         `tcdr`.`ccy_code` `CCY_CD`,         `tcdrp`.`cec` `cec`,         CASE                 WHEN `tcdr`.`ead_method` IN (                     'CEM',                     'IMM'                 )                      AND                      CASE                         WHEN nvl(`txn`.`contract_type`,'UNMP') = 'GMGMKTLEAS' THEN 'F'                         ELSE `txn`.`derivative_ind`                     END                 = 'T' THEN `tcdr`.`ead_method`             END         `cem_imm_ind`,         `txn`.`cf_indicator`,         `tcdr`.`child_id`,         `tcdr`.`clearing_house_code` `CLEARING_HOUSE_CD`,         CASE                 WHEN `tcdr`.`contract_reference` NOT LIKE 'CCP_MARGIN%' THEN 'N'                 ELSE 'Y'             END         `client_trade`,         `tcdr`.`coll_issuer_bis_entity_type`,         `tcdr`.`collateral_bis_product` `COLLATERAL_BIS_PROD`,  `tcdr`.`collateral_contract_type` `COLLATERAL_CONTRACT_TYPE`,         `tcdr`.`collateral_issuer`,         `crm`.`attribute_6` `collateral_perfection_status`,         `txn`.`collateral_product_category` `collateral_prod_category`,         `tcdr`.`collateral_reference` `collateral_ref_no`,         `tcdr`.`collateral_valuation_date` `collateral_valuation_date`,         `tcdr`.`collateral_attribute_9` `collateral_adjusted_flag`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`nominal`                 ELSE NULL             END         `committed_amount`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`ead_pre_ccf`                 ELSE NULL             END         `committed_available_amunt`,         CASE                 WHEN `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'Y'                      AND `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END         `committed_headroom`,         `fac`.`commited` `committed_indicator`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 )                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`outstanding`                 ELSE 0             END         `committed_os`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`nominal`                 ELSE NULL             END         `committed_used_amount`,         '0' `committed_used_amt_temp`,         `tcdr`.`company_code` `company_cd`,         `txn`.`company_type`,         `tcdr`.`contract_reference` `contract_ref_no`,         `tcdr`.`contract_type`,         'null' `contract_desc`,         `tcdr`.`internal_rating_original` `correct_orig_crg`,         `inst`.`cost_center` `cost_center_cd`,         `inst`.`cost_center_descriotion` `cost_center_description`,         `tcdr`.`counterparty_new` `counterparty_new_wid`,         `tcdr`.`counterparty_new`,         `tcdr`.`counterparty_new_attribute_1`,         `tcdr`.`counterparty_new_attribute_2`,         `tcdr`.`counterparty_new_attribute_3`,         `tcdr`.`counterparty_new_attribute_4`,         `tcdr`.`counterparty_new_attribute_5`,         `tcdr`.`counterparty_new_attribute_6`,         `tcdr`.`counterparty_new_attribute_7`,         `tcdr`.`counterparty_new_attribute_8`,         `tcdr`.`counterparty_new_attribute_9`,         `tcdr`.`counterparty_new_desc`,         `tcdr`.`counterparty_original` `counterparty_original_wid`,         `tcdr`.`counterparty_original`,         `tcdr`.`counterparty_type_new`,         `tcdr`.`counterparty_type_original`,         `txn`.`country_name`,   CASE WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`collateral_bis_product` <>  'OTC_NET_COL' THEN `tcdr`.`ead` ELSE 0 END `covered_ead`,          `tcdr`.`cpty_group`,         `tcdr`.`cpty_group_original`,         `tcdr`.`cpty_new_sebc_not_qualifying`,         `tcdr`.`cpty_orig_sebc_not_qualifying`,         `tcdrp`.`crc`,         'MFU needed - CRE_CATEGORY.txt' `cre_category`,         'MFU needed - RSK_MAINPROF_CTC.txt' `cre_coverage`,         'MFU needed - CRE_CATEGORY.txt' `cre_property_type`,         `tcdr`.`credit_substitute`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_cd`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_name`,         `crmsr`.`currency` `crm_currency`,         `crmsr`.`crm_location` `crm_location`,         `txn`.`crm_method` `crm_method`,         `crmsr`.`residual_maturity` `crm_residual_maturity`,         `juris`.`csa` `csa_flg`,         `tcdr`.`currency`,         ( nvl(round(`tcdr`.`ead_pro_cva`,10),0) * nvl(round(`tcdr`.`rw_new`,10),0) ) `cva_ccr_rwa`,         `cva`.`cva_index_part` `cva_index_part`,         `txn`.`cva_rwa` `cva_rwa`,         (round(nvl(`cva`.`cva_rwa_addon`,0),10) * round(`obi`.`cva_static_val`,10)) `cva_rwa_addon`,         `txn`.`days_after_contractual_date`,         `tcdr`.`deal_status`,         `tcdr`.`dealbook` `book_wid`,         `tcdr`.`dealbook` `book_cd`,         `txn`.`delivery_type`,         `txn`.`derivative_ind`,         NVL(`clrh`.`df_cm`, 0) `df_cm`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfccp`                 ELSE NULL             END         `dfccp`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfi`                 ELSE NULL             END         `dfi`,         NVL(`enl`.`mother_code`, 'UNMP DLRFIN') `dlrfin_cd`,         `tcdr`.`ead`,         `tcdr`.`ead_formula`,         `tcdr`.`ead_method`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `ead_netting`,         `tcdr`.`ead_original`,         `tcdr`.`ead_pre_ccf`,         `tcdr`.`ead_pro`,         `tcdr`.`ead_pro_cva`,         `tcdr`.`ead_pro_discount`,         `tcdr`.`ead_pro_gen`,         `tcdr`.`ead_pro_write_off`,         nvl(round(`tcdr`.`ead`,10),0) * NVL(NVL(`prrsr`.`prr`,`sme_prr`.`product_recovery_rate`  ),0) `ead_prr`,         `tcdr`.`ead_scalar` `ead_scalar`,         nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `ead_square`,         `txn`.`ec_filter_type`,         `txn`.`ec_w_filter_type`,         `tcdr`.`effective_epe`,         nvl(`tcdr`.`k_maturity`,0) `effective_matirity`,         `tcdr`.`el`,         NVL(`trfrsk`.`el_cpty`,0) `el_cpty`,         NVL(`tcdr`.`el`,0) `el_net_saves`,         'MFU needed - Pool_Ref_MONYY.txt' `el_saves`,         NVL(`trfrsk`.`el_total`,0) `el_total`,         `tcdr`.`entity_type_category_new`,         `tcdr`.`entity_type_category_original`,         `tcdr`.`equity_floor_applied`,         `tcdr`.`equity_preferential_treatment`,         `tcdr`.`equity_scaling_factor`,         `txn`.`exchange_rate`,         `tcdr`.`exemption_maturity_floor`,         ( nvl(             CASE                 WHEN `tcdr`.`table_name` IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN(                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN(                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE(                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END,0) + nvl(             CASE                 WHEN `tcdr`.`table_name` NOT IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT','FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END,0) ) `exposure`,         `tcdr`.`exposure_attribute_1`,         `tcdr`.`exposure_attribute_2`,         `tcdr`.`exposure_attribute_3`,         `tcdr`.`exposure_attribute_4`,         `tcdr`.`exposure_attribute_5`,         `tcdr`.`exposure_attribute_6`,         `tcdr`.`exposure_attribute_7`,         CASE                 WHEN CAST(`tcdr`.`exposure_attribute_7` AS double) IS NOT NULL THEN 'Y'                 ELSE 'N'             END         `exposure_attribute_7d`,         `tcdr`.`exposure_attribute_8`,         `tcdr`.`exposure_attribute_9`,         CASE                 WHEN (                     `tcdr`.`table_name` = 'ON_OFF_BALANCE'                     OR `tcdr`.`table_name` = 'REPO'                     OR `tcdr`.`table_name` = 'RECEIVABLE'                     OR `tcdr`.`table_name` = 'TRANCHE'                     OR `tcdr`.`table_name` = 'BOND'                     OR `tcdr`.`table_name` = 'EQUITY'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END         `exposure_wo_mtm`,         `reposr`.`external_rating`,         `txn`.`customer_subsegment_desc` `F_BUSINESS_SUB_SEGMENT_NAME`,         nvl(`coltp`.`collateral_description`, 'Collateral Type Unmapped') `f_collatral_type_name`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `F_ORIGINAL_SCORECARD_NAME`,         `txn`.`contract_desc` `F_STANDARD_PROD_NAME`,         'MFU needed - ELIMIT' `facility_activated_flag`,         `facagg`.`facility_availability_end_date` `facility_availability_end_date`,         `tcdr`.`facility_reference` `FACILITY_REF_NO`,         `tcdr`.`used_amount_facility` `FACILITY_UTILIZATION_AMOUNT`,         `tcdr`.`fair_value`,         'PMI source needed' `fam_cd`,         `tcdr`.`family`,         `tcdr`.`fde_alternative_method`,         NVL(`txn`.`filter_type`,'NA') `filter_type`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_cd`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_name`,         `tcdr`.`internal_rating_new` `final_crg`,         nvl(`tcdr`.`pd_new`,0) `final_pd`,         `tcdr`.`flag_adjustment`,         `tcdr`.`floor1`,         `tcdr`.`floor2`,         `txn`.`fsa_exclusion_type`,         `txn`.`fsa004_asset_class`,         nvl(round(`tcdr`.`collateral_assigned_amount`,10),0) * ( 1 - nvl(round(`tcdr`.`hc`,10),0) ) `fsv`,         `tcdr`.`funding_ccy`,         `tcdr`.`gaap_code` `GAAP_CD`,         'CDW needed - RSK_BOE_LMT_PRO' `governing_law`,         `tcdr`.`grand_fathering_applied`,         `tcdr`.`guar_sub_reference` `GUARANTEE_SUB_REF_NO`,         `tcdr`.`guarantee_bis_product`,         CASE WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED' THEN 'Guarantee'   WHEN `tcdr`.`collateral_contract_type` = 'NET_AGR' THEN 'Netting'   WHEN NVL (round(`tcdr`.`ead`,10), 0) * NVL(NVL(`prrsr`.`prr`, `sme_prr`.`product_recovery_rate` ),0) > 0 THEN 'Product Recovery'    ELSE 'UNMP' END `guarantee_ead_flag`,         `tcdr`.`guarantee_method`,         `tcdr`.`guarantee_reference` `GUARANTEE_REF_NO`,         `tcdr`.`guarantor`,         `tcdr`.`guarantor_bis_entity_type`,         CASE                 WHEN `tcdr`.`tranche_guarantee_type` = 'GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `gurantee_ead`,         `tcdr`.`hc`,         `tcdr`.`hcr`,         `tcdr`.`he`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND `tcdr`.`bs_type` = 'OFB' THEN `tcdr`.`outstanding`                 ELSE 0             END         `headroom`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`ead`                 ELSE 0             END         `headroom_ead`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`rwa`                 ELSE 0             END         `headroom_rwa`,         `tcdr`.`hfx`,         `txn`.`holding_company_ind`,         `tcdr`.`hr`,         `tcdr`.`id`,         'MFU needed - mfu_ifrs_category.txt' `ifrs_category`,         CASE                 WHEN `fac`.`commited` = 'N'                      AND `tcdr`.`table_name` = 'FACILITY' THEN nvl(`tcdr`.`nominal`,0)                 ELSE 0             END         `iip`,         `csr`.`imc_1`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_alpha_factor`,         'RMI TABLE NEEDED - rsk_scb_wb_imm_collat, NVL(SUM(amount),0)' `imm_collat_amount`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_eepe`,         `tcdr`.`import_source`,         `tcdr`.`incorporation_country` `incorp_country`,         `txn`.`incorporation_ccy_new`,         `txn`.`incorporation_ccy_original`,         `tcdr`.`inter_company`,         `tcdr`.`internal_maturity_class`,         NVL(`juris`.`isda`, 'No') `isda_flg`,         `tcdr`.`k_function_used`,         `tcdr`.`k_maturity`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`kccp`                 ELSE NULL            END         `kccp`,         CASE                 WHEN `ccp`.`kccp` IS NOT NULL                      AND `ccp`.`kccp` != 0 THEN 'Y'                 ELSE 'N'             END         `kccp_calc`,         `tcdr`.`legislated_program_applied`,         `tcdr`.`lgd` `LGD`,        `txn`.`lgd` `lgd_dollar`,         `tcdr`.`lgd_grade`,         `tcdr`.`lgd_grade_agency`,         `tcdr`.`lgd_grade_inf`,         `tcdr`.`lgd_grade_rank`,         `tcdr`.`lgd_grade_sup`,         `tcdr`.`lgd_mitigation`,         `tcdr`.`lgd_pre_floor_new`,         `tcdr`.`lgd_pre_floor_original`,         CASE                 WHEN (                     (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0 )                     AND (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.05 )                 ) THEN '0% - 04.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.05                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.1                 ) THEN '05% - 09.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.1                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.15                 ) THEN '10% - 14.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.15                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.2                 ) THEN '15% - 19.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.2                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.25                 ) THEN '20% - 24.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.25                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.3                 ) THEN '25% - 29.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.3                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.35                 ) THEN '30% - 34.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.35                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.4                 ) THEN '35% - 39.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.4                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.45                 ) THEN '40% - 44.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.45                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.5                 ) THEN '45% - 49.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.5                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.55                 ) THEN '50% - 54.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.55                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.6                 ) THEN '55% - 59.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.6                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.65                 ) THEN '60% - 64.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.65                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.7                 ) THEN '65% - 69.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.70                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.75                 ) THEN '70% - 74.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.75                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.80                 ) THEN '75% - 79.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.80                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.85                 ) THEN '80% - 84.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.85                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.90                 ) THEN '85% - 89.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.90                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.95                 ) THEN '90% - 94.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.95                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     <= 1                 ) THEN '95% - 100%'                 WHEN (                     CASE                         WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                         ELSE `txn`.`lgd`                     END                 > 1 ) THEN '>100%'             END         `lgd_range`,         `tcdr`.`lgd` `lgd_tcdr`,         `txn`.`limit_attribute`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`contract_reference`                 ELSE NULL             END         `limit_id`,         CASE                 WHEN `tcdr`.`facility_reference` IS NOT NULL AND `tcdr`.`facility_reference` != ''  THEN 'Linked'                 ELSE 'Unlinked'             END         `linked_unlinked_ind`,         null `lmt_eff_dt`,         `tcdr`.`long_short`,         `tcdr`.`look_through_treatment`,         `crsr`.`lt_rat_agency_code` `lt_rat_agency_cd`,         NVL(`tcdr`.`ltv`,0) `LTV`,         `tcdr`.`ltv_current`,         CASE                 WHEN `prod`.`product_level` = 'Standard Product'                      AND `prod`.`description` LIKE 'Private Equity%' THEN concat('078||',substr(`tcdr`.`dealbook`,length(`tcdr`.`dealbook`) - 7,length(`tcdr`.`dealbook`) ) )                 ELSE `tcdr`.`dealbook`             END         `management_location_cd`,            NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `management_prod_wid`,  NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `management_prod_id`,                    `tcdr`.`margin_period`,         `tcdr`.`maturity_date`,         `tcdr`.`maturity_eff`,         'N' `maturity_limit_flag`,         `txn`.`maturity_range` `maturity_range`,         `tcdr`.`method_new`,         `tcdr`.`method_original`,         `cva`.`mi`,         `cva`.`mi_hedge`,         `tcdr`.`mm`,         `tcdr`.`mortgage_alternative`,         `tcdr`.`business_identifier` `MRU_IDENTIFIER`,  `tcdr`.`business_identifier` `BUSINESS_IDENTIFIER`,         `txn`.`mtm`,         `inst`.`custom_attribute_18` `nbv_currency`,         `inst`.`custom_attribute_17` `nbv_value`,         CASE                 WHEN trim(`ent`.`attribute_3`) = 'T' THEN 'TRUE'                 WHEN trim(`ent`.`attribute_3`) = 'F' THEN 'FALSE'                 ELSE `ent`.`attribute_3`         END         `negative_pledge_identifier`,          CASE                 WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)    WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm` ELSE 0         END         `net_mtm`,          ( (CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL')                             THEN NVL(round(`txn`.`outstanding`,10), 0)ELSE 0                        END) + nvl(round(`txn`.`accrued_interest`,10),0) +   ( CASE WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)   WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm`  ELSE 0 END) )   `net_nominal`,          nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         `netted_ead`,         ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) * ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) `netted_ead_square`,         '0' `netted_nominal`,         `tcdr`.`netting_agreement_reference` `NETTING_AGREEMENT_REF_NO`,         `tcdr`.`netting_class`,         NVL(`juris`.`isda`, 'No') `netting_flg`,         `clrh`.`no_clear_mem_n`,    ((CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX',           'FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(round(`tcdr`.`outstanding`,10), 0)                    ELSE 0                    END                   ) +                   NVL(round(`txn`.`accrued_interest`,10), 0) +                   (CASE WHEN `tcdr`.`table_name` IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX',               'FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN                        (CASE  WHEN UPPER(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN                              (CASE WHEN round(`tcdr`.`fair_value`,10) > 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                              )                         ELSE (CASE WHEN round(`tcdr`.`fair_value`,10) < 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                               )                         END                         )                     ELSE 0                     END                    )                  ) `nominal`,            `tcdr`.`nominal` `nominal_tcdr`,         `txn`.`non_borrowing_ind` `NON_BORROWING`,         substr(trim(`ent`.`attribute_17`), 1, 1) `non_contractual_parental_supt`,         substr(trim(`ent`.`attribute_17`), 3, 1) `non_financial_scorecard`,         `txn`.`non_gam_ind`,         `tcdr`.`non_material_equity`,         `txn`.`notional`,         `deal`.`nominal_2` `NOTIONAL_2`,         `deal`.`currency_2` `NOTIONAL_2CCY`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`tcdr`.`nominal`) *-1                         ELSE abs(`tcdr`.`nominal`)                     END                 )                 ELSE 0             END         `notional_tcdr`,         'CDW needed - cdw_txn_rmi_ddmmyyyy.txt' `obl_flg`,         `tcdr`.`obligor_grade_inf_new`,         `tcdr`.`obligor_grade_inf_original`,         `tcdr`.`obligor_grade_new`,         `tcdr`.`obligor_grade_original`,         `tcdr`.`obligor_grade_rank_new`,         `tcdr`.`obligor_grade_rank_original`,         `tcdr`.`obligor_grade_sup_new`,         `tcdr`.`obligor_grade_sup_original`,         CASE                 WHEN `inst`.`cost_center` IN (                     'FM ALM',                     'Principal Finance'                 ) THEN 'OCC_Own Account'                 ELSE nvl(`txn`.`customer_subsegment_code`,'UNMP')             END         `occ_sub_segment`,         `txn`.`bs_type` `ON_OFF_BALANCE_SHEET_FLAG`,         nvl(`tcdr`.`pd_original`,0) `org_pd`,         `tcdr`.`original_cost`,         nvl(`tcdr`.`internal_rating_original`,'CRG Original Unmapped') `original_crg`,          `txnf`.`original_limit_amount` `original_limit_amount`,          `tcdr`.`original_maturity`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `original_scorecard`,         `txn`.`outstanding` `os`,         `facprod`.`contract_type` `out_limit_product`,   CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(`tcdr`.`outstanding`, 0) ELSE 0 END `outstanding`,          `txn`.`outstanding` `outstanding_dollar`,         'MFU needed - cdw_BOEACBTXN_rmi_DDMMYYYY.txt' `overdue_days`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_1`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_2`,         `tcdr`.`parent_id`,         `tcdr`.`past_due_int`,         `tcdr`.`past_due_ppal`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`pce_flag`                 ELSE NULL             END         `pce_flag`,         `rat`.`one_year_pd` `pd_midpoint`,         `tcdr`.`pd_new`,         `tcdr`.`pd_original`,         `tcdr`.`pd_pre_floor_new`,         `tcdr`.`pd_pre_floor_original`,         `tcdr`.`performing_status`,         `tcdr`.`pool_code` `POOL_CD`,         `tcdr`.`premium_current`,         `contp`.`attribute_1` `prod_cat_info`,         `tcdr`.`product_gl_criteria`,         `tcdr`.`product_gl_criteria_2`,         NVL(`tcdrp`.`tot_el`,0) `PROXY_EL`,         NVL(`tcdrp`.`lgd_used`,0) `PROXY_LGD`,         NVL(NVL(`txn`.`prr`, `sme_prr`.`product_recovery_rate`  ),0) `PRR`,    nvl(`inst`.`psgl_account_number`, `psgl`.`psgl_account`) `PSGL_ACCOUNT`,           nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_CD`,  nvl(nvl(`inst`.`psgl_customer_class`, `psgl`.`psgl_cust_class`), `txn`.`psgl_cust_class`) `PSGL_CUST_CLASS`,  nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_DEPARTMENT`,  nvl(nvl(`inst`.`psgl_operating_unit`, `psgl`.`psgl_operating_unit`), `txn`.`psgl_operating_unit`) `PSGL_OPERATING_UNIT`,  nvl(nvl(`inst`.`psgl_product_code`, `psgl`.`psgl_product`), `txn`.`psgl_product`) `PSGL_PRODUCT`,          `tcdr`.`qualifying_ccp`,         `tcdr`.`qualifying_transaction`,         `crsr`.`lt_rat_code` `RATING_CD`,         `txn`.`replacement_cost` `RC`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN (                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE (                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END         `rc_tcdr`,         `txn`.`replacement_cost` `REPLACEMENT_COST`,         `tcdr`.`residual_maturity`,         `tcdr`.`rgc`,         `tcdr`.`risk_bucket`,         `tcdr`.`risk_bucket_original`,         `tcdr`.`risk_country`,         `tcdr`.`risk_country_new`,         `tcdr`.`risk_country_original`,         `tcdr`.`risk_type`,         `crm`.`rw_expo` `rw_expo`,         `tcdr`.`rw_new`,         `tcdr`.`rw_original`,         `tcdr`.`rw_scaling_factor`,         `tcdr`.`rwa`,         NVL(`trfrsk`.`rwa_add_on`,0) `rwa_add_on`,         `tcdr`.`rwa` `rwa_after_scale`,         nvl(round(`tcdr`.`rwa`,10),0) / 1.06 `rwa_before_scale`,         `trfrsk`.`rwa_cpty` `rwa_cpty`,         `tcdr`.`rwa` `RWA_NET_SAVES`,         `tcdr`.`rwa_pre_cap`,         `tcdr`.`rwa_pre_crm`,         `tcdr`.`rwa_pre_floor_equity`,         'MFU needed - Pool_Ref_MONYY.txt' `rwa_saves`,         `tcdr`.`rwa_scaling_factor`,         `trfrsk`.`rwa_total` `rwa_total`,         `ccp`.`is_scb_clr_mem` `scb_clearing_mem`,         `tcdr`.`second_loss_treatment`,         `tcdr`.`secu_bank_role`,         `tcdr`.`secu_company_weight`,         `tcdr`.`secu_ea_controlled`,         `tcdr`.`secu_issue_date`,         `tcdr`.`secu_loss_position`,         `tcdr`.`secu_mode`,         `tcdr`.`secu_retail_line_fg`,         `tcdr`.`secu_spread_trapping_ratio`,         `tcdr`.`secu_uncommited_retail_fg`,         `txn`.`lgd` `SECURED_LGD`,         `tcdr`.`securitization_n`,         `tcdr`.`securitization_reference` `SECURITIZATION_REF_NO`,         `tcdr`.`securitized`,         `tcdr`.`security_positions_ref`,         `txn`.`segment_original`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code`                              AND `clrm`.`entity_code` = `clrm`.`clearing_house_code` THEN `clrm`.`clearing_member_conditions`                         ELSE NULL                     END                 ELSE NULL             END         `segregated`,         `tcdr`.`seniority_new`,         `tcdr`.`seniority_original`,         `tcdr`.`settlement_price`,         `reposr`.`sov_indicator` `sov_indicator`,         `tcdr`.`sovereign_risk_bucket_new`,         `tcdr`.`sovereign_risk_bucket_ori`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_wid`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_cd`,         `tcdr`.`standard_rw_new`,         `tcdr`.`standard_rw_original`,         `txn`.`start_date`,         null `std_rw_override_indicator`,         `inst`.`custom_attribute_16` `strategy`,         `tcdr`.`stress_testing_scenario_id`,         `txn`.`sub_limit_fac_reference` `sub_limit_fac_ref_no`,         `tcdr`.`sub_method_new`,         `tcdr`.`sub_method_original`,         `tcdr`.`sub_reference`,         `tcdr`.`supervisor_code` `SUPERVISOR_CD`,         CASE WHEN `enl`.`link_type` = 'SUPFIN' then `enl`.`mother_code` else 'UNMP SUPFIN' end `supfin_cd`,         `tcdr`.`table_name` `table_name`,         'SMC_PERIMETER required' `tbs_cd`,         `txn`.`maturity_range` `TENOR_BUCKETS`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`third_party_cp_flag`                 ELSE 'N/A'             END         `third_party_cp_flag`,         `tcdr`.`tier1_deduction`,         `tcdr`.`tier2_deduction`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`tot_pre_fund_con`                 ELSE NULL             END         `tot_pre_fund_con`,         `tcdr`.`total_annual_assets`,         `tcdr`.`total_annual_sales`,         `fac`.`amount` `total_facility_amount`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`total_initital_margin`                 ELSE NULL             END         `total_initital_margin`,         `inst`.`tp_portfolio_name` `tp_portfolio_name`,         'MFU needed - e_balances.txt' `tp_sys_scr_id`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / round(`t_cdr_temp`.`rwa`,10) ) )                 ELSE 0             END         `tr_addon_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN ( nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0) )                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / `t_cdr_temp`.`rwa` ) )                 ELSE 0             END         `tr_addon_rwa`,         nvl(`trfrsk`.`tr_el`,0) `tr_el`,         NVL(`trfrsk`.`tr_gua_ctry`, 'UNMP') `tr_gua_ctry`,         CASE                 WHEN `t_cdr_temp`.`el` != 0          THEN nvl(round(`t_cdr_temp`.`el`,10),0) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) )                 ELSE 0             END         `tr_pre_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN nvl(round(`t_cdr_temp`.`rwa`,10),0) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) ) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) )                 ELSE 0             END         `tr_pre_rwa`,         `tcdr`.`trade_date`,         `tcdr`.`trading_book_type`,         `tcdr`.`trading_book_type` `TRADING_IND`,         `tcdr`.`tranche_collateral_type`,         `tcdr`.`tranche_guarantee_type`,         `txn`.`tranche_lgd`,         NVL(`trfrsk`.`transfer_risk`,'N') `transfer_risk`,         `txn`.`limit_amount` `txn_limit_amount`,         `txn`.`rw_new` `txn_rw_new`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`uci`                 ELSE NULL             END         `uci`,         `tcdr`.`uncommited` `uncommited`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`nominal`             END         `uncommitted_amount`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`ead_pre_ccf`             END         `uncommitted_available_amunt`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 )                      AND `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_headroom`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 )                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_os`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`ead_pre_ccf`             END         `uncommitted_used_amount`,         `tcdr`.`unconditionnaly_cancelable`,         `tcdr`.`und_pool_ref`,         `txn`.`unmapped_ind`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                      AND `tcdr`.`tranche_guarantee_type` = 'NOT GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `unsecured_ead`,         `tcdr`.`used_amount_facility`,         `tcdr`.`value_date`,         `txn`.`waterfall_seniority`,         `cva`.`wi` `wi`,         case when `rat`.`row_owner` = 'C' AND `rat`.`agency_code` = 'INTERNAL' AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) >= nvl(round(`rat`.`pd_inf`,10),0)   AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) < nvl(round(`rat`.`pd_sup`,10),0)   THEN `rat`.`rating` ELSE `icr`.`long_term_rating` END `wt_crg`,         nvl(round(`tcdr`.`pd_new`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_final_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`k_maturity`,10) ) `wt_k_maturity`,         `txn`.`wt_lgd`,         (nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`k_maturity`,10),0)) `wt_mat_eff`,         nvl(round(`tcdr`.`pd_original`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_org_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_new`,10) ) `wt_pd_new`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_original`,10) ) `wt_pd_original`,         nvl(`txn`.`wt_residual_maturity`,0) `wt_residual_maturity`,         ( round(`tcdr`.`pd_new`,10) * round(`tcdr`.`nominal`,10) ) `wtpdlgd`,         ( round(`tcdr`.`pd_new`,10) * round(`txn`.`wt_lgd`,10) ) `wtpdnm`,         `tcdrp`.`xrc`,         `tcdr`.`zero_haircut_for_repo`,         `tcdr`.`zero_rw_for_equity`,         `tcdr`.`zone_a_new`,         `tcdr`.`zone_a_original`,  `tcdr`.`collateral_assigned_amount` `COLLATERAL_ASSIGNED_AMOUNT`,  '0' `collateral_unique_id`,  NVL(`smeprod`.`product_type`,`retail_exp`.`product_type`) `sme_product_type`,   CASE WHEN SUBSTR((case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END ), -2) = '-M'                   THEN                   substr( (case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END)         , 1         ,  length(trim(case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END ))-2                   )                     ELSE                  case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END          END `DERIVED_LIMIT_ID`,  `derived_lt`.`limit_id_trim` `DERIVED_LIMIT_ID_STP`,  CASE WHEN `tcdr`.`method_new` = 'ADV' THEN round(NVL(`tcdr`.`ead`, 0),5) *          (CASE WHEN ( (`tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') <> 'RW_LGD_UPDATE'                         ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`txn`.`lgd`,0),5)                 WHEN ( (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') = 'RW_LGD_UPDATE'                          ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`tcdr`.`exposure_attribute_7`,0),5)                 ELSE 0 END         ) ELSE 0 END `unsecured_lgd_dollar`,    case when `be`.`booking_loc_id` = 'SG'  then 'SG'  when `be`.`booking_loc_id` = 'MY'  then 'MY' when `be`.`booking_loc_id` = 'VN'  then 'VN' when `be`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end as `SECURITY_CTRY`,    case when `tcdr`.`dealbook` like '%CI%' OR `tcdr`.`dealbook` like '%CC%' then 'CICC'   when `tcdr`.`dealbook` like '%RT%' then 'RT'   when `tcdr`.`dealbook` like '%PB%' then 'PB'   when `tcdr`.`dealbook` like '%OB%' then 'OB'   else 'OTHERS' end AS `SECURITY_SEG`                          FROM         `sgmisitstg`.`stg_bcrs_t_cdr` `tcdr`           LEFT JOIN `sgmisit`.`sgmi_txn_rwa_f` `txn` ON `tcdr`.`id` = `txn`.`id`                                                             AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`txn`.`partition_key`,'UNM')            AND `txn`.`w_datasource_id` = 'BCRS_PRA'            AND `txn`.`w_snapshot_dt` = '2021-06-30'            AND `txn`.`w_country_cd` = 'ALL'            AND `txn`.`w_workspace` = 'WS7'            LEFT JOIN (select `tbl`.`netting_agreement_reference`, `tbl`.`partition_key`, `tbl`.`rnk`, `tbl`.`sum_mtm` from (select `sgmi_txn_rwa_f`.`netting_agreement_reference`,`sgmi_txn_rwa_f`.`partition_key`, row_number() over(partition by `sgmi_txn_rwa_f`.`netting_agreement_reference`,`sgmi_txn_rwa_f`.`partition_key`) `rnk`, sum(`sgmi_txn_rwa_f`.`mtm`) over(partition by netting_agreement_reference,partition_key) `sum_mtm`   from `sgmisit`.`sgmi_txn_rwa_f`    where    `sgmi_txn_rwa_f`.`w_snapshot_dt` = '2021-06-30' and   `sgmi_txn_rwa_f`.`w_workspace` in (   (case when instr('WS7','ADJ')>0 then substr('WS7',1,instr('WS7','_ADJ') - 1) else concat('WS7','_ADJ') end), 'WS7')  ) `tbl` where `tbl`.`rnk`=1  ) `txn2`  ON `txn`.`netting_agreement_reference` = `txn2`.`netting_agreement_reference`                                                               AND nvl(`txn`.`partition_key`,'UNM') = nvl(`txn2`.`partition_key`,'UNM')                   LEFT JOIN `sgmisitstg`.`stg_bcrs_facility` `fac` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`fac`.`contract_reference`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`fac`.`partition_key`,1,8)                                                       AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`fac`.`contract_type`,'UNM')             AND `fac`.`w_batch_id` = '2021102513163900521'          LEFT JOIN (select `stg_bcrs_scb_wb_addt_inst`.`partition_key`, `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`, `stg_bcrs_scb_wb_addt_inst`.`arm_code`, `stg_bcrs_scb_wb_addt_inst`.`arm_description`, `stg_bcrs_scb_wb_addt_inst`.`cost_center`, `stg_bcrs_scb_wb_addt_inst`.`cost_center_descriotion`,    `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_18`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_17`, `stg_bcrs_scb_wb_addt_inst`.`psgl_account_number`, `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`, `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`, `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_16`, `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`, `stg_bcrs_scb_wb_addt_inst`.`w_batch_id`,    ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ) AS `rnk`      FROM `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2021102513163900521' AND  NVL(`stg_bcrs_scb_wb_addt_inst`.`arm_code`,'') <> ''     ) `inst` ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`inst`.`contract_reference`),'UNM')                                                       AND trim(`tcdr`.`table_name`) = trim(`inst`.`table_name`)                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`inst`.`partition_key`,1,8)             AND `inst`.`rnk`=1   LEFT JOIN ( select `stg_bcrs_scb_wb_psgl`.`partition_key`, `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name`, `stg_bcrs_scb_wb_psgl`.`psgl_bu`, `stg_bcrs_scb_wb_psgl`.`psgl_account`, `stg_bcrs_scb_wb_psgl`.`psgl_product`, `stg_bcrs_scb_wb_psgl`.`psgl_department`, `stg_bcrs_scb_wb_psgl`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_psgl`.`psgl_cust_class`, `stg_bcrs_scb_wb_psgl`.`financial_book_code`, `stg_bcrs_scb_wb_psgl`.`booking_location`, `stg_bcrs_scb_wb_psgl`.`w_batch_id`, ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name` ) AS `rnk`       FROM `sgmisitstg`.`stg_bcrs_scb_wb_psgl`   WHERE `stg_bcrs_scb_wb_psgl`.`w_batch_id` = '2021102513163900521'     AND  NVL(`stg_bcrs_scb_wb_psgl`.`psgl_bu`,'') <> '') `psgl`   ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`psgl`.`contract_reference`),'UNM')    AND trim(`tcdr`.`table_name`) = trim(`psgl`.`fermat_table_name`)   AND substr(`tcdr`.`partition_key`,1,8) = substr(`psgl`.`partition_key`,1,8)               AND `psgl`.`rnk`=1                        LEFT JOIN ( select `stg_bcrs_t_crm`.`partition_key`, `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`,`stg_bcrs_t_crm`.`expo_table_name`,`stg_bcrs_t_crm`.`w_batch_id`,`stg_bcrs_t_crm`.`rw_expo`,`stg_bcrs_t_crm`.`attribute_6`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ORDER BY `stg_bcrs_t_crm`.`expo_contract_reference`,    `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ) AS `rnk`    FROM `sgmisitstg`.`stg_bcrs_t_crm`   WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_t_crm`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_t_crm`.`w_batch_id` = '2021102513163900521' END           ) `crm` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`crm`.`expo_contract_reference`,'UNM')          AND nvl(`tcdr`.`counterparty_original`, 'UMP') = nvl(`crm`.`expo_counterparty`, 'UMP')                                                    AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`crm`.`partition_key`,'UNM')          AND `crm`.`expo_table_name` = 'ON_OFF_BALANCE'          AND `crm`.`rw_expo` is not null          AND `crm`.`rnk` = 1            LEFT JOIN (             SELECT   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                                `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`avg_pre_funded_contribution`) `avg_pre_funded_contribution`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`beta`) `beta`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`clearing_house_name`) `ccp_name`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`pre_funded_financial`) `dfccp`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_prefunded_contribution`) `dfi`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`kccp`) `kccp`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`sum_pre_fund_contribution`) `tot_pre_fund_con`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`total_initial_margin`) `total_initital_margin`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_committed_contributions`) `uci`             FROM                 `sgmisitstg`.`stg_bcrs_scb_wb_ccp_static`   WHERE `stg_bcrs_scb_wb_ccp_static`.`w_batch_id` = '2021102513163900521'       AND `stg_bcrs_scb_wb_ccp_static`.`beta` is not null AND `stg_bcrs_scb_wb_ccp_static`.`beta` != ''             GROUP BY   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                 `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`         ) `ccp` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`ccp`.`clearing_house_code`,'UNM')                  AND substr(`tcdr`.`partition_key`,1,8) = substr(`ccp`.`partition_key`,1,8)          LEFT JOIN (             SELECT   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`,                 SUM(`stg_bcrs_t_cva`.`bi`) `bi`,                 SUM(`stg_bcrs_t_cva`.`cva_index_part`) `cva_index_part`,                 SUM(`stg_bcrs_t_cva`.`cva_capital_charge`) `cva_rwa_addon`,                 MAX(`stg_bcrs_t_cva`.`mi`) `mi`,                 SUM(`stg_bcrs_t_cva`.`mi_hedge`) `mi_hedge`,                 MAX(`stg_bcrs_t_cva`.`wi`) `wi`             FROM                 `sgmisitstg`.`stg_bcrs_t_cva`   WHERE `stg_bcrs_t_cva`.`w_batch_id` = '2021102513163900521'             GROUP BY   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`         ) `cva` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`cva`.`contract_reference`,'UNM')                  AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`cva`.`partition_key`,'UNM')                  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`cva`.`counterparty`,'UNM')          LEFT JOIN `sgmisit`.`sgmi_client_d` `client` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`client`.`client_id`,'UNM')    AND `client`.`w_datasource_id` = 'BCRS_PRA' AND `client`.`w_snapshot_dt` = '2021-06-30'    LEFT JOIN `sgmisit`.`sgmi_obi_pd_lookup_dat` `obi` ON substr(`tcdr`.`partition_key`,1,6) = nvl(`obi`.`partition_key`,'UNM')          LEFT JOIN `sgmisitstg`.`stg_bcrs_v_scb_gpr_ec_t_cdr_prx` `tcdrp` ON nvl(`tcdr`.`id`,'UNM') = nvl(`tcdrp`.`id`,'UNM')                                                                       AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`tcdrp`.`partition_key`,'UNM')               AND `tcdrp`.`w_batch_id` = '2021102513163900521'         LEFT JOIN (             SELECT   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`,                 MAX(`stg_bcrs_bis_clearing_house`.`df_cm`) `df_cm`,                 MAX(`stg_bcrs_bis_clearing_house`.`n`) `no_clear_mem_n`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_house`   WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2021102513163900521' END             GROUP BY   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`         ) `clrh` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`clrh`.`entity_code`,'UNM')                   AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrh`.`partition_key`,'UNM')          LEFT JOIN   (select `stg_bcrs_entity_links`.`partition_key`, `stg_bcrs_entity_links`.`child_code`, `stg_bcrs_entity_links`.`link_type`, `stg_bcrs_entity_links`.`mother_code`, `stg_bcrs_entity_links`.`w_batch_id`, ROW_NUMBER() OVER(ORDER BY `stg_bcrs_entity_links`.`mother_code` desc) AS `rnk`  FROM `sgmisitstg`.`stg_bcrs_entity_links` where `stg_bcrs_entity_links`.`w_batch_id` = '2021102513163900521' and `stg_bcrs_entity_links`.`link_type` = 'DLRFIN' ) `enl`   ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`enl`.`child_code`,'UNM')         AND substr(`tcdr`.`partition_key`,1,8) = substr(`enl`.`partition_key`,1,8)         AND `enl`.`rnk`=1           LEFT JOIN (select `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`, `stg_bcrs_csr`.`table_name`, `stg_bcrs_csr`.`imc_1`, `stg_bcrs_csr`.`w_batch_id`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ORDER BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ) AS `rnk`   from `sgmisitstg`.`stg_bcrs_csr`   where CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_csr`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_csr`.`w_batch_id` = '2021102513163900521' END ) `csr`     ON `tcdr`.`contract_reference` = `csr`.`contract_reference`    AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`csr`.`contract_type`,'UNM')    AND nvl(`tcdr`.`counterparty_new`,'UNM') = nvl(`csr`.`counterparty`,'UNM')    AND nvl(`tcdr`.`method_new`,'UNM') = nvl(`csr`.`method`,'UNM')    AND `tcdr`.`bs_type` = `csr`.`bs_type`    AND `tcdr`.`dealbook` = `csr`.`book_code`    AND (case when nvl(`tcdr`.`table_name`,'z') in ('BOND', 'EQUITY', 'TRANCHE', 'CONVERTIBLE', 'FUND') then 'SECURITY_POSITIONS'             else nvl(`tcdr`.`table_name`, 'z') end) = `csr`.`table_name`    AND `csr`.`imc_1` is not null    AND trim(`csr`.`imc_1`) != ''    AND `csr`.`rnk` = 1    LEFT JOIN ( select `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_cpty`),0) `EL_CPTY`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_total`),0) `EL_TOTAL`,      NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`),0) `rwa_add_on`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`),0) `rwa_cpty`,      NVL(NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_total`),SUM(NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`,0) +  NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`,0))),0) `RWA_TOTAL`,      NVL(sum(`stg_bcrs_scb_wb_tr_sr`.`tr_el`),0) `tr_el`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry` `TR_GUA_CTRY`, MAX(NVL(`stg_bcrs_scb_wb_tr_sr`.`is_tr`,'N')) `TRANSFER_RISK`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`   from `sgmisitstg`.`stg_bcrs_scb_wb_tr_sr`    where CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_scb_wb_tr_sr`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_scb_wb_tr_sr`.`w_batch_id` = '2021102513163900521' END    group by `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`  ) `trfrsk`  ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`trfrsk`.`contract_reference`,'UNM')  AND nvl(`tcdr`.`table_name`,'UNM') = nvl(`trfrsk`.`table_name`,'UNM')  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`trfrsk`.`pr_obligor`,'UNM')  AND `tcdr`.`contract_type` = `trfrsk`.`contract_type`  and `tcdr`.`bs_type` = `trfrsk`.`bs_type`    LEFT JOIN (   select  `tbl`.`contract_reference`, `tbl`.`und_pool_ref`, `tbl`.`bs_type`, `tbl`.`sub_reference`, `tbl`.`prr`, `tbl`.`rnk` from (     SELECT      `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,     `stg_bcrs_scb_wb_prr_sr`.`und_pool_ref`,     `stg_bcrs_scb_wb_prr_sr`.`bs_type`,     `stg_bcrs_scb_wb_prr_sr`.`sub_reference`,     `stg_bcrs_scb_wb_prr_sr`.`prr`,     row_number() over(partition by `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,`stg_bcrs_scb_wb_prr_sr`.`und_pool_ref`,`stg_bcrs_scb_wb_prr_sr`.`bs_type`,`stg_bcrs_scb_wb_prr_sr`.`sub_reference`,`stg_bcrs_scb_wb_prr_sr`.`prr`) `rnk`      FROM       `sgmisitstg`.`stg_bcrs_scb_wb_prr_sr`     WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2021102513163900521' END         AND  NVL(`stg_bcrs_scb_wb_prr_sr`.`prr`,'') <> ''    ) `tbl` where `tbl`.`rnk`=1   ) `prrsr` on `tcdr`.`contract_reference` = `prrsr`.`contract_reference` and nvl(`tcdr`.`und_pool_ref`,'UNM') = nvl(`prrsr`.`und_pool_ref`,'UNM')  and nvl(`tcdr`.`bs_type`,'UNM') = nvl(`prrsr`.`bs_type`,'UNM') and nvl(`tcdr`.`sub_reference`,'UNM') = nvl(`prrsr`.`sub_reference`,'UNM')      LEFT JOIN (select `stg_bcrs_scb_wb_repo_sr`.`partition_key`, `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`, `stg_bcrs_scb_wb_repo_sr`.`external_rating`, `stg_bcrs_scb_wb_repo_sr`.`sov_indicator`, `stg_bcrs_scb_wb_repo_sr`.`security_contract_ref`,     ROW_NUMBER() OVER(partition by `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref` order by `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`) as `rnk`   from `sgmisitstg`.`stg_bcrs_scb_wb_repo_sr`  WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2021102513163900521' END   AND `stg_bcrs_scb_wb_repo_sr`.`sov_indicator` IS NOT NULL ) `reposr`   ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`reposr`.`partition_key`,'UNM')  AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`reposr`.`repo_contract_ref`,'UNM')  AND `reposr`.`rnk`=1            LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `scrd` ON nvl(`scrd`.`org_scrd_g3_code`,'UNM') = nvl(`txn`.`scorecard_original`,'UNM')           LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`,                 MIN(`stg_bcrs_facility`.`dim3`) `facility_availability_end_date`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2021102513163900521'              GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`         ) `facagg` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`facagg`.`contract_reference`,'UNM')                     AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`facagg`.`counterparty_code`,'UNM')                     AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`facagg`.`partition_key`,'UNM')                   LEFT JOIN `sgmisitstg`.`stg_bcrs_credit_rating_sr` `crsr` ON nvl(`reposr`.`security_contract_ref`,'UNM') = nvl(`crsr`.`reference`,'UNM')                                                                AND `crsr`.`lt_rat_agency_code` IS NOT NULL               AND CASE WHEN 'WS7' like '%ADJ%' THEN `crsr`.`w_batch_id` = '2021102513163900521' ELSE `crsr`.`w_batch_id` = '2021102513163900521' END          LEFT JOIN `sgmisitstg`.`stg_bcrs_product` `prod` ON nvl(`tcdr`.`contract_type`,'UNM') = nvl(`prod`.`product`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`prod`.`partition_key`,1,8)             AND `prod`.`w_batch_id` = '2021102513163900521'          LEFT JOIN `sgmisitstg`.`stg_bcrs_entity` `ent` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`ent`.`entity_code`,'UNM')                                                     AND substr(`tcdr`.`partition_key`,1,8) = substr(`ent`.`partition_key`,1,8)            AND `ent`.`w_batch_id` = '2021102513163900521'          LEFT JOIN `sgmisitstg`.`stg_bcrs_deal_import` `deal` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`deal`.`contract_reference`,'UNM')                                                           AND substr(`tcdr`.`partition_key`,1,8) = substr(`deal`.`contract_reference`,1,8)          AND `deal`.`w_batch_id` = '2021102513163900521'          LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`,                 MAX(nvl(case when trim(`stg_bcrs_facility`.`attribute_4`) = '' then null else `stg_bcrs_facility`.`attribute_4` end,`stg_bcrs_facility`.`amount`) ) `original_limit_amount`,                 MIN(`stg_bcrs_facility`.`dim2`) `pce_flag`,                 MIN(`stg_bcrs_facility`.`dim1`) `third_party_cp_flag`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2021102513163900521'                GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`         ) `txnf` ON nvl(`txn`.`sub_limit_fac_reference`,'UNM') = nvl(`txnf`.`contract_reference`,'UNM')                   AND substr(`txn`.`partition_key`,1,8) = substr(`txnf`.`partition_key`,1,8)                   AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`txn`.`contract_reference`,'UNM')     AND `tcdr`.`import_source` like '%WB%'                                       AND `tcdr`.`id` = `txn`.`id`             LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`icr`.`entity_code`,'UNM')                                                                    AND substr(`tcdr`.`partition_key`,1,8) = substr(`icr`.`partition_key`,1,8)                                                                    AND `icr`.`agency_code` = 'INTERNAL'            AND `icr`.`w_batch_id` = '2021102513163900521'          LEFT JOIN `sgmisitstg`.`stg_bcrs_rating` `rat` ON nvl(`icr`.`long_term_rating`,'UNM') = nvl(`rat`.`rating`,'UNM')                                                     AND substr(`icr`.`partition_key`,1,8) = substr(`rat`.`partition_key`,1,8)                                                     AND `rat`.`agency_code` = 'INTERNAL'           AND `rat`.`w_batch_id` = '2021102513163900521'          LEFT JOIN (             SELECT    `stg_bcrs_bis_clearing_member`.`w_batch_id`,                 `stg_bcrs_bis_clearing_member`.`partition_key`,                 `stg_bcrs_bis_clearing_member`.`entity_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_house_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_member_conditions`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_bis_clearing_member`.`entity_code` ORDER BY `stg_bcrs_bis_clearing_member`.`entity_code` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_member`   WHERE CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2021102513163900521' END          ) `clrm` ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrm`.`partition_key`,'UNM')                   AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`clrm`.`entity_code`,'UNM')     AND `clrm`.`w_batch_id` = '2021102513163900521'     AND `clrm`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_currency` `cur` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`cur`.`partition_key`,'UNM')                                                       AND nvl(`fac`.`currency`,'UNM') = nvl(`cur`.`ccy_code`,'UNM')             AND `cur`.`w_batch_id` = '2021102513163900521'           LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `juris` ON nvl(`tcdr`.`incorporation_country`,'UNM') = nvl(`juris`.`country_cd`,'UNM')                                                                  AND `juris`.`etl_current_record_flag` = 'Y'          LEFT JOIN (             SELECT    `stg_bcrs_facility_products`.`w_batch_id`,                 `stg_bcrs_facility_products`.`partition_key`,                 `stg_bcrs_facility_products`.`facility_reference`,                 `stg_bcrs_facility_products`.`contract_type`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_facility_products`.`facility_reference` ORDER BY `stg_bcrs_facility_products`.`facility_reference` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_facility_products`   WHERE `stg_bcrs_facility_products`.`w_batch_id` = '2021102513163900521'         ) `facprod` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`facprod`.`partition_key`,'UNM')                      AND nvl(`facprod`.`facility_reference`,'UNM') = substr(`fac`.`contract_reference`,1,instr(`fac`.`contract_reference`,'-M') - 1)                      AND `fac`.`attribute_1` = 'MOTHER'        AND `facprod`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON substr(`tcdr`.`partition_key`,1,8) = substr(`contp`.`partition_key`,1,8)                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`facprod`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021102513163900521'          LEFT JOIN (             SELECT   w_batch_id,                 partition_key,                 nvl(`t_cdr`.`contract_reference`,'UNM') `contract_reference`,                 nvl(`t_cdr`.`table_name`,'UNM') `table_name`,                 nvl(`t_cdr`.`counterparty_original`,'UNM') `counterparty_original`,                 SUM(nvl(`t_cdr`.`rwa`,0) ) `rwa`,                 SUM(nvl(`t_cdr`.`el`,0) ) `el`             FROM                 `sgmisitstg`.`stg_bcrs_t_cdr` `t_cdr`   WHERE `t_cdr`.`w_batch_id` = '2021102513163900521'             GROUP BY   `t_cdr`.`w_batch_id`,                 `t_cdr`.`partition_key`,                 nvl(`t_cdr`.`contract_reference`,'UNM'),                 nvl(`t_cdr`.`table_name`,'UNM'),                 nvl(`t_cdr`.`counterparty_original`,'UNM')         ) `t_cdr_temp` ON nvl(`tcdr`.`partition_key`,'UNM') = `t_cdr_temp`.`partition_key`                         AND nvl(`tcdr`.`contract_reference`,'UNM') = `t_cdr_temp`.`contract_reference`                         AND nvl(`tcdr`.`table_name`,'UNM') = `t_cdr_temp`.`table_name`                         AND nvl(`tcdr`.`counterparty_original`,'UNM') = `t_cdr_temp`.`counterparty_original`     left join `sgmisitstg`.`stg_bcrs_facility_links` `facl`   on (CASE WHEN (length(`tcdr`.`contract_reference`) = 10 or length(`tcdr`.`contract_reference`) = 11 or length(`tcdr`.`contract_reference`) = 12) THEN substr(`tcdr`.`contract_reference`,1,instr(`tcdr`.`contract_reference`,'-M') - 1)          ELSE `tcdr`.`contract_reference` END) = `facl`.`contract_reference`   and substr(`tcdr`.`partition_key`,1,8) = substr(`facl`.`partition_key`,1,8)   and `facl`.`table_name` = `tcdr`.`table_name`   and `facl`.`w_batch_id` = '2021102513163900521'    left join (select `sgmi_client_bca_d`.`client_le_wid`, `sgmi_client_bca_d`.`client_le_id`, `sgmi_client_bca_d`.`bca_ref_no`, `sgmi_client_bca_d`.`bca_approval_dt`, `sgmi_client_bca_d`.`bca_review_dt`, `sgmi_client_bca_d`.`w_snapshot_dt`,   ROW_NUMBER() OVER( PARTITION BY `sgmi_client_bca_d`.`client_le_id` ORDER BY `sgmi_client_bca_d`.`client_le_id` ) AS `rnk`                 from `sgmisit`.`sgmi_client_bca_d` ) `bca`                 on substr(`tcdr`.`counterparty_original`,1,8) = `bca`.`client_le_id`                 and `tcdr`.`w_snapshot_dt` = `bca`.`w_snapshot_dt`   and `bca`.`rnk` = 1   left join `sgmisit`.`sgmi_collateral_type_dat` `coltp`   on `tcdr`.`collateral_contract_type` = `coltp`.`collateral_code`   and `coltp`.`etl_current_record_flag` = 'Y'   left join `sgmisit`.`sgmi_sme_product_dat` `smeprod`   on `tcdr`.`contract_type` = `smeprod`.`contract_type`   LEFT JOIN `sgmisit`.`SGMI_BOOK_CD_D` `BOOK`    ON `tcdr`.`dealbook`  =`book`.`book_wid` AND `tcdr`.`w_datasource_id` = `book`.`w_datasource_id` AND `tcdr`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE`    ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`    AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_sme_prr` `sme_prr`    ON `tcdr`.`contract_type` = regexp_replace(`sme_prr`.`product_code`,'S_','')                                                 and `be`.`booking_loc_id` = `sme_prr`.`country`                and `sme_prr`.`w_batch_id` = '2021102513163900521'     LEFT JOIN (SELECT `stg_bcrs_crm_sr`.`partition_key`, `stg_bcrs_crm_sr`.`crm_id`, `stg_bcrs_crm_sr`.`collateral_mode`, `stg_bcrs_crm_sr`.`beneficiary`, `stg_bcrs_crm_sr`.`group_link_type`, `stg_bcrs_crm_sr`.`currency`, `stg_bcrs_crm_sr`.`guarantee_percentage`, `stg_bcrs_crm_sr`.`market_value`, `stg_bcrs_crm_sr`.`market_value_ccy`, `stg_bcrs_crm_sr`.`evaluation_date`, `stg_bcrs_crm_sr`.`benef_table_name`, `stg_bcrs_crm_sr`.`benef_contract_ref`, `stg_bcrs_crm_sr`.`repartition_method`, `stg_bcrs_crm_sr`.`amount_prior_claims`, `stg_bcrs_crm_sr`.`pct_same_rank_claims`, `stg_bcrs_crm_sr`.`fdw_netting_agreement`, `stg_bcrs_crm_sr`.`parent_collateral`, `stg_bcrs_crm_sr`.`parent_nominal`, `stg_bcrs_crm_sr`.`parent_currency`, `stg_bcrs_crm_sr`.`parent_amount_prior_claims`, `stg_bcrs_crm_sr`.`parent_pct_same_rank_claims`, `stg_bcrs_crm_sr`.`parent_lgd`, `stg_bcrs_crm_sr`.`parent_maturity_date`, `stg_bcrs_crm_sr`.`own_estimated_haircut`, `stg_bcrs_crm_sr`.`flag_on_deposit`, `stg_bcrs_crm_sr`.`zero_haircut_eligible`, `stg_bcrs_crm_sr`.`securitization_only`, `stg_bcrs_crm_sr`.`repo_type`, `stg_bcrs_crm_sr`.`cardinality`, `stg_bcrs_crm_sr`.`restructuring`, `stg_bcrs_crm_sr`.`risk_type_mode`, `stg_bcrs_crm_sr`.`underlying_security_ref`, `stg_bcrs_crm_sr`.`flag_generic_2`, `stg_bcrs_crm_sr`.`materiality_threshold`, `stg_bcrs_crm_sr`.`rw_floor_generic_flag`, `stg_bcrs_crm_sr`.`flag_recognized_cre`, `stg_bcrs_crm_sr`.`floor2`, `stg_bcrs_crm_sr`.`guar_lgd_mitigation`, `stg_bcrs_crm_sr`.`overlapping_priority`, `stg_bcrs_crm_sr`.`scenario_id`, `stg_bcrs_crm_sr`.`crm_eligibility`, `stg_bcrs_crm_sr`.`crm_rank`, `stg_bcrs_crm_sr`.`col_family`, `stg_bcrs_crm_sr`.`rw`, `stg_bcrs_crm_sr`.`residual_maturity`, `stg_bcrs_crm_sr`.`contract_reference`, `stg_bcrs_crm_sr`.`sub_reference`, `stg_bcrs_crm_sr`.`table_name`, `stg_bcrs_crm_sr`.`method`, `stg_bcrs_crm_sr`.`bs_type`, `stg_bcrs_crm_sr`.`counterparty`, `stg_bcrs_crm_sr`.`contract_type`, `stg_bcrs_crm_sr`.`bis_product_type`, `stg_bcrs_crm_sr`.`bis_product_category`, `stg_bcrs_crm_sr`.`asset_class`, `stg_bcrs_crm_sr`.`pd`, `stg_bcrs_crm_sr`.`nominal`, `stg_bcrs_crm_sr`.`lgd`, `stg_bcrs_crm_sr`.`risk_bucket`, `stg_bcrs_crm_sr`.`risk_type`, `stg_bcrs_crm_sr`.`haircut_risk_bucket`, `stg_bcrs_crm_sr`.`eligibility_risk_bucket`, `stg_bcrs_crm_sr`.`revaluation_frequency`, `stg_bcrs_crm_sr`.`holding_period`, `stg_bcrs_crm_sr`.`underlying_maturity`, `stg_bcrs_crm_sr`.`maturity_date`, `stg_bcrs_crm_sr`.`start_date`, `stg_bcrs_crm_sr`.`book_code`, `stg_bcrs_crm_sr`.`family`, `stg_bcrs_crm_sr`.`exchange_rate`, `stg_bcrs_crm_sr`.`inter_company`, `stg_bcrs_crm_sr`.`attribute_1`, `stg_bcrs_crm_sr`.`attribute_2`, `stg_bcrs_crm_sr`.`attribute_3`, `stg_bcrs_crm_sr`.`attribute_4`, `stg_bcrs_crm_sr`.`attribute_5`, `stg_bcrs_crm_sr`.`attribute_6`, `stg_bcrs_crm_sr`.`attribute_7`, `stg_bcrs_crm_sr`.`attribute_8`, `stg_bcrs_crm_sr`.`attribute_9`, `stg_bcrs_crm_sr`.`amount_1`, `stg_bcrs_crm_sr`.`amount_2`, `stg_bcrs_crm_sr`.`hc_eff`, `stg_bcrs_crm_sr`.`guar_management`, `stg_bcrs_crm_sr`.`bis_key_analysis_id`, `stg_bcrs_crm_sr`.`cover_principal_only`, `stg_bcrs_crm_sr`.`flag_issued_by_the_bank`, `stg_bcrs_crm_sr`.`issuer_guarantor`, `stg_bcrs_crm_sr`.`import_source`, `stg_bcrs_crm_sr`.`allocable_amount`, `stg_bcrs_crm_sr`.`lgd_internal_rating`, `stg_bcrs_crm_sr`.`standard_rw`, `stg_bcrs_crm_sr`.`first_loss`, `stg_bcrs_crm_sr`.`seniority`, `stg_bcrs_crm_sr`.`flag_generic`, `stg_bcrs_crm_sr`.`crm_location`, `stg_bcrs_crm_sr`.`reference_seniority`, `stg_bcrs_crm_sr`.`first_lien`, `stg_bcrs_crm_sr`.`occupied_or_rented`, `stg_bcrs_crm_sr`.`completed`, `stg_bcrs_crm_sr`.`uncorelated_mv_borrower`, `stg_bcrs_crm_sr`.`uncorelated_borrower_mv`, `stg_bcrs_crm_sr`.`damage_insurance`, `stg_bcrs_crm_sr`.`legal_certainty`, `stg_bcrs_crm_sr`.`independant_valuer`, `stg_bcrs_crm_sr`.`mortgage_lending_value`, `stg_bcrs_crm_sr`.`assigned_amount`, `stg_bcrs_crm_sr`.`collateral_portion`, `stg_bcrs_crm_sr`.`asset_class_category`, `stg_bcrs_crm_sr`.`sub_type`, `stg_bcrs_crm_sr`.`mn_rank`, `stg_bcrs_crm_sr`.`mn_nominal`, `stg_bcrs_crm_sr`.`mn_prudential_apc`, `stg_bcrs_crm_sr`.`mn_external_deal`, `stg_bcrs_crm_sr`.`lgd_rating_agency`, `stg_bcrs_crm_sr`.`flag_fictive`, `stg_bcrs_crm_sr`.`elg_risk_bucket_int`, `stg_bcrs_crm_sr`.`benef_category`, `stg_bcrs_crm_sr`.`actual_rating_agency`, `stg_bcrs_crm_sr`.`actual_rating`, `stg_bcrs_crm_sr`.`flag_adjustment`, `stg_bcrs_crm_sr`.`guar_management_adv`, `stg_bcrs_crm_sr`.`guar_lgd_adv`, `stg_bcrs_crm_sr`.`guar_lgd_adv_pre_stress`, `stg_bcrs_crm_sr`.`k_function_used`, `stg_bcrs_crm_sr`.`re_recast`, `stg_bcrs_crm_sr`.`audit_crm_eligibility`, `stg_bcrs_crm_sr`.`booking_company`, `stg_bcrs_crm_sr`.`payout_option`, `stg_bcrs_crm_sr`.`crm_location_currency`, `stg_bcrs_crm_sr`.`std_risk_bucket`, `stg_bcrs_crm_sr`.`pd_pre_floor`, `stg_bcrs_crm_sr`.`lgd_pre_stress`, `stg_bcrs_crm_sr`.`fi_type`, `stg_bcrs_crm_sr`.`rw_floor`, `stg_bcrs_crm_sr`.`sov_rating_used`, `stg_bcrs_crm_sr`.`internal_rating_code`, `stg_bcrs_crm_sr`.`internal_rating_agency`, `stg_bcrs_crm_sr`.`external_rating_code`, `stg_bcrs_crm_sr`.`external_rating_agency`, `stg_bcrs_crm_sr`.`bankruptcy_remote`, `stg_bcrs_crm_sr`.`margin_type`, `stg_bcrs_crm_sr`.`margin_agreement`, `stg_bcrs_crm_sr`.`rw_pre_floor`, `stg_bcrs_crm_sr`.`sov_rw_floor`, `stg_bcrs_crm_sr`.`clearing_house_code`, `stg_bcrs_crm_sr`.`qualifying_ccp`, `stg_bcrs_crm_sr`.`qualifying_transaction`, `stg_bcrs_crm_sr`.`clearing_member`, `stg_bcrs_crm_sr`.`audit_crm_eligibility_sa`, `stg_bcrs_crm_sr`.`w_snapshot_dt`, `stg_bcrs_crm_sr`.`w_datasource_id`, `stg_bcrs_crm_sr`.`w_country_cd`, `stg_bcrs_crm_sr`.`w_batch_id`, ROW_NUMBER() OVER( partition by `stg_bcrs_crm_sr`.`contract_reference` ) AS `rnk`  FROM `sgmisitstg`.`stg_bcrs_crm_sr`   where CASE WHEN 'WS7' like '%ADJ%' THEN `stg_bcrs_crm_sr`.`w_batch_id` = '2021102513163900521' ELSE `stg_bcrs_crm_sr`.`w_batch_id` = '2021102513163900521' END   ) `crmsr`  on (CASE WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' then `tcdr`.`collateral_reference`                 WHEN `tcdr`.`tranche_guarantee_type` = 'GUARANTEED' then `tcdr`.`guarantee_reference`                 ELSE Null End ) = `crmsr`.`contract_reference`         and `crmsr`.`rnk`=1   LEFT JOIN (select `tbl`.`contract_reference`, `tbl`.`product_type`, `tbl`.`rnk` from (  select `sgmi_retail_exposure_f`.`contract_reference`, `sgmi_retail_exposure_f`.`product_type`, row_number() over(partition by `sgmi_retail_exposure_f`.`contract_reference`) `rnk`   from `sgmisit`.`SGMI_RETAIL_EXPOSURE_F` where `sgmi_retail_exposure_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_retail_exposure_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_retail_exposure_f`.`w_country_cd`='ALL')   `tbl` where `tbl`.`rnk`=1) `RETAIL_EXP` ON `retail_exp`.`contract_reference`=`tcdr`.`contract_reference`        LEFT JOIN `sgmisit`.`SGMI_CTCODE_PRODUCT_LINKAGE_DAT` `PROD_LINK` ON `tcdr`.`contract_type`=`prod_link`.`ct_code_user`  LEFT JOIN (SELECT `lt`.`client_id` `CLIENT_ID`, `lt`.`limit_id` `LIMIT_ID`, `lt`.`limit_id_trim` `LIMIT_ID_TRIM`, `lt`.`product_cd` `PRODUCT_CD`,ROW_NUMBER() OVER (PARTITION BY `lt`.`client_id`, `lt`.`product_cd`) `RN` FROM (SELECT   CASE WHEN trim(`sgmi_client_limit_f`.`client_id`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})-(\\d{1,2})$' OR trim(`sgmi_client_limit_f`.`client_id`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})$' THEN   regexp_replace( regexp_replace(trim(`sgmi_client_limit_f`.`client_id`),'^(SME)(\\w{0,4})-','') ,'-(\\d{1,2})$','') WHEN `sgmi_client_limit_f`.`client_id` regexp '^(\\d{8})$' OR `sgmi_client_limit_f`.`client_id` regexp '^(\\d{8})-(\\d{1,2})$' THEN   regexp_replace(`sgmi_client_limit_f`.`client_id`,'-(\\d{1,2})$','') ELSE   trim(`sgmi_client_limit_f`.`client_id`) END `Client_id`, `sgmi_client_limit_f`.`limit_id`, `sgmi_client_limit_f`.`limit_id_trim`, `sgmi_client_limit_f`.`product_cd`  FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` WHERE `sgmi_client_limit_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_client_limit_f`.`w_datasource_id`='BCRS_PRA')`LT` ) `DERIVED_LT`   ON `derived_lt`.`client_id`=CASE WHEN trim(`tcdr`.`counterparty_original`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})-(\\d{1,2})$' OR trim(`tcdr`.`counterparty_original`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})$' THEN   regexp_replace( regexp_replace(trim(`tcdr`.`counterparty_original`),'^(SME)(\\w{0,4})-','') ,'-(\\d{1,2})$','') WHEN `tcdr`.`counterparty_original` regexp '^(\\d{8})$' OR `tcdr`.`counterparty_original` regexp '^(\\d{8})-(\\d{1,2})$' THEN   regexp_replace(`tcdr`.`counterparty_original`,'-(\\d{1,2})$','') ELSE   trim(`tcdr`.`counterparty_original`) END AND `derived_lt`.`product_cd`=`prod_link`.`lt_product_cd` and `derived_lt`.`rn` = 1       WHERE          `tcdr`.`w_batch_id` = '2021102513163900521'
CREATE VIEW `temp_src_query_2111081336200046418` AS SELECT         NVL(`tcdr`.`accrued_fees`,0) `accrued_fees`,  CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(`tcdr`.`accrued_interest`, 0) ELSE 0 END `accrued_interest`,         NVL(`txn`.`accrued_interest`,0) `accrued_interest_dollar`,         NVL(`tcdr`.`add_on`,0) `add_on`,         `txn`.`add_on` AS `add_on_dollar`,         `txn`.`collateral_attribute_9`,         CASE                 WHEN `txn`.`collateral_attribute_9` IN (                     'Correct',                     'Reverse'                 ) THEN 'Y'                 ELSE 'N'             END         `adj_flag`,         NVL(`fac`.`amount`,0) `ADJUSTED_LIMIT_AMOUNT`,         `tcdr`.`adjustment_amount`,         `tcdr`.`id` `ais_id`,         `tcdr`.`amortized_cost`,         `tcdr`.`amortized_cost_no_ias`,         'MFU needed - RSK_LIMIT_STATIC.txt' `approved_lgd`,        'MFU needed - RSK_LIMIT_STATIC.txt' `approver_name`,         `inst`.`arm_code` `arm_cd`,         `inst`.`arm_description` `arm_description`,         `tcdr`.`asset_class_category_new`,         `tcdr`.`asset_class_category_original`,         `tcdr`.`asset_class_new`,         `tcdr`.`asset_class_original`,         `crm`.`attribute_6` `attribute_6`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`avg_pre_funded_contribution`                 ELSE NULL             END         `avg_prefunded_contribution`,         `txn`.`balance_category`,         `bca`.`bca_approval_dt` `BCA_APPROVAL_DATE`,         `bca`.`bca_review_dt` `BCA_REVIEW_DATE`,         `tcdr`.`beel`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`beta`                 ELSE NULL             END         `beta`,         nvl(`cva`.`bi`,0) `bi`,         `tcdr`.`method_new` `bii_calculation_method`,         `tcdr`.`bis_entity_type_new`,         `tcdr`.`bis_entity_type_original`,         `tcdr`.`bis_industry_sector_new`,         `tcdr`.`bis_industry_sector_original`,         `tcdr`.`bis_past_due`,         `tcdr`.`bis_past_due_original`,         `tcdr`.`bis_performing_status`,         `tcdr`.`bis_product` `BIS_PROD`,         `tcdr`.`bis_product_category` `BIS_PROD_CATEGORY`,         `txn`.`bis_risk_area_new`,         `txn`.`bis_risk_area_original`,        `tcdr`.`bis_risk_sub_area_new`,         `tcdr`.`bis_risk_sub_area_original`,         `tcdr`.`booking_company` `booking_entity_wid`,         `tcdr`.`booking_company` `booking_entity_id`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code` THEN `tcdr`.`counterparty_original`                         ELSE NULL                     END                 ELSE NULL             END `BROKER_ID`,         `tcdr`.`bs_type`,         `tcdr`.`business`,         `tcdr`.`business_line_code` `business_line_cd`,         `txn`.`customer_subsegment_code` `BUSINESS_SUB_SEGMENT`,         NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `BUSINESS_UNIT`,         `tcdr`.`capital_item`,         `tcdr`.`ccf`,         `tcdr`.`ccp_dfund_method`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`ccp_name`                 ELSE NULL             END         `ccp_name`,         `client`.`client_domicile_loc_id` `ccr_ctry`,         CASE                 WHEN `client`.`client_domicile_loc_id` IS NULL THEN `client`.`coi_loc_id`                 ELSE `client`.`client_domicile_loc_id`             END `CCR_EQ_CNTRY`,         `txn`.`ccr_new`,         `txn`.`ccr_original`,         `tcdr`.`ccy_code` `CCY_CD`,         `tcdrp`.`cec` `cec`,         CASE                 WHEN `tcdr`.`ead_method` IN (                     'CEM',                     'IMM','SA'                 )                      AND                      CASE                         WHEN nvl(`txn`.`contract_type`,'UNMP') = 'GMGMKTLEAS' THEN 'F'                         ELSE `txn`.`derivative_ind`                     END                 = 'T' THEN `tcdr`.`ead_method`             END         `cem_imm_ind`,         `txn`.`cf_indicator`,         `tcdr`.`child_id`,         `tcdr`.`clearing_house_code` `CLEARING_HOUSE_CD`,         CASE                 WHEN `tcdr`.`contract_reference` NOT LIKE 'CCP_MARGIN%' THEN 'N'                 ELSE 'Y'             END         `client_trade`,         `tcdr`.`coll_issuer_bis_entity_type`,         `tcdr`.`collateral_bis_product` `COLLATERAL_BIS_PROD`,  `tcdr`.`collateral_contract_type` `COLLATERAL_CONTRACT_TYPE`,         `tcdr`.`collateral_issuer`,         `crm`.`attribute_6` `collateral_perfection_status`,         `txn`.`collateral_product_category` `collateral_prod_category`,         `tcdr`.`collateral_reference` `collateral_ref_no`,         `tcdr`.`collateral_valuation_date` `collateral_valuation_date`,         `tcdr`.`collateral_attribute_9` `collateral_adjusted_flag`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`nominal`                 ELSE NULL             END         `committed_amount`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`ead_pre_ccf`                 ELSE NULL             END         `committed_available_amunt`,         CASE                 WHEN `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'Y'                      AND `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END         `committed_headroom`,         `fac`.`commited` `committed_indicator`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 )                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`outstanding`                 ELSE 0             END         `committed_os`,         CASE                 WHEN `tcdr`.`bs_type` = 'ASS'                      AND `fac`.`commited` = 'Y' THEN `tcdr`.`nominal`                 ELSE NULL             END         `committed_used_amount`,         '0' `committed_used_amt_temp`,         `tcdr`.`company_code` `company_cd`,         `txn`.`company_type`,         `tcdr`.`contract_reference` `contract_ref_no`,         `tcdr`.`contract_type`,         'null' `contract_desc`,         `tcdr`.`internal_rating_original` `correct_orig_crg`,         `inst`.`cost_center` `cost_center_cd`,         `inst`.`cost_center_descriotion` `cost_center_description`,         `tcdr`.`counterparty_new` `counterparty_new_wid`,         `tcdr`.`counterparty_new`,         `tcdr`.`counterparty_new_attribute_1`,         `tcdr`.`counterparty_new_attribute_2`,         `tcdr`.`counterparty_new_attribute_3`,         `tcdr`.`counterparty_new_attribute_4`,         `tcdr`.`counterparty_new_attribute_5`,         `tcdr`.`counterparty_new_attribute_6`,         `tcdr`.`counterparty_new_attribute_7`,         `tcdr`.`counterparty_new_attribute_8`,         `tcdr`.`counterparty_new_attribute_9`,         `tcdr`.`counterparty_new_desc`,         `tcdr`.`counterparty_original` `counterparty_original_wid`,         `tcdr`.`counterparty_original`,         `tcdr`.`counterparty_type_new`,         `tcdr`.`counterparty_type_original`,         `txn`.`country_name`,   CASE WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`collateral_bis_product` <>  'OTC_NET_COL' THEN `tcdr`.`ead` ELSE 0 END `covered_ead`,          `tcdr`.`cpty_group`,         `tcdr`.`cpty_group_original`,         `tcdr`.`cpty_new_sebc_not_qualifying`,         `tcdr`.`cpty_orig_sebc_not_qualifying`,         `tcdrp`.`crc`,         'MFU needed - CRE_CATEGORY.txt' `cre_category`,         'MFU needed - RSK_MAINPROF_CTC.txt' `cre_coverage`,         'MFU needed - CRE_CATEGORY.txt' `cre_property_type`,         `tcdr`.`credit_substitute`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_cd`,         'MFU needed - RSK_MAINPROF_CTC.txt' `credit_team_name`,         `crmsr`.`currency` `crm_currency`,         `crmsr`.`crm_location` `crm_location`,         `txn`.`crm_method` `crm_method`,         `crmsr`.`residual_maturity` `crm_residual_maturity`,         `juris`.`csa` `csa_flg`,         `tcdr`.`currency`,         ( nvl(round(`tcdr`.`ead_pro_cva`,10),0) * nvl(round(`tcdr`.`rw_new`,10),0) ) `cva_ccr_rwa`,         `cva`.`cva_index_part` `cva_index_part`,         `txn`.`cva_rwa` `cva_rwa`,         (round(nvl(`cva`.`cva_rwa_addon`,0),10) * round(`obi`.`cva_static_val`,10)) `cva_rwa_addon`,         `txn`.`days_after_contractual_date`,         `tcdr`.`deal_status`,         `tcdr`.`dealbook` `book_wid`,         `tcdr`.`dealbook` `book_cd`,         `txn`.`delivery_type`,         `txn`.`derivative_ind`,         NVL(`clrh`.`df_cm`, 0) `df_cm`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfccp`                 ELSE NULL             END         `dfccp`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`dfi`                 ELSE NULL             END         `dfi`,         NVL(`enl`.`mother_code`, 'UNMP DLRFIN') `dlrfin_cd`,         `tcdr`.`ead`,         `tcdr`.`ead_formula`,         `tcdr`.`ead_method`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `ead_netting`,         `tcdr`.`ead_original`,         `tcdr`.`ead_pre_ccf`,         `tcdr`.`ead_pro`,         `tcdr`.`ead_pro_cva`,         `tcdr`.`ead_pro_discount`,         `tcdr`.`ead_pro_gen`,         `tcdr`.`ead_pro_write_off`,         nvl(round(`tcdr`.`ead`,10),0) * NVL(NVL(`prrsr`.`prr`,`sme_prr`.`product_recovery_rate`  ),0) `ead_prr`,         `tcdr`.`ead_scalar` `ead_scalar`,         nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `ead_square`,         `txn`.`ec_filter_type`,         `txn`.`ec_w_filter_type`,         `tcdr`.`effective_epe`,         nvl(`tcdr`.`k_maturity`,0) `effective_matirity`,         `tcdr`.`el`,         NVL(`trfrsk`.`el_cpty`,0) `el_cpty`,         NVL(`tcdr`.`el`,0) `el_net_saves`,         'MFU needed - Pool_Ref_MONYY.txt' `el_saves`,         NVL(`trfrsk`.`el_total`,0) `el_total`,         `tcdr`.`entity_type_category_new`,         `tcdr`.`entity_type_category_original`,         `tcdr`.`equity_floor_applied`,         `tcdr`.`equity_preferential_treatment`,         `tcdr`.`equity_scaling_factor`,         `txn`.`exchange_rate`,         `tcdr`.`exemption_maturity_floor`,         ( nvl(             CASE                 WHEN `tcdr`.`table_name` IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN(                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN(                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE(                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END,0) + nvl(             CASE                 WHEN `tcdr`.`table_name` NOT IN(                     'CREDIT_DERIVATIVE','DEAL_IMPORT','FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END,0) ) `exposure`,         `tcdr`.`exposure_attribute_1`,         `tcdr`.`exposure_attribute_2`,         `tcdr`.`exposure_attribute_3`,         `tcdr`.`exposure_attribute_4`,         `tcdr`.`exposure_attribute_5`,         `tcdr`.`exposure_attribute_6`,         `tcdr`.`exposure_attribute_7`,         CASE                 WHEN CAST(`tcdr`.`exposure_attribute_7` AS double) IS NOT NULL THEN 'Y'                 ELSE 'N'             END         `exposure_attribute_7d`,         `tcdr`.`exposure_attribute_8`,         `tcdr`.`exposure_attribute_9`,         CASE                 WHEN (                     `tcdr`.`table_name` = 'ON_OFF_BALANCE'                     OR `tcdr`.`table_name` = 'REPO'                     OR `tcdr`.`table_name` = 'RECEIVABLE'                     OR `tcdr`.`table_name` = 'TRANCHE'                     OR `tcdr`.`table_name` = 'BOND'                     OR `tcdr`.`table_name` = 'EQUITY'                 ) THEN `tcdr`.`outstanding`                 ELSE 0             END         `exposure_wo_mtm`,         `reposr`.`external_rating`,         `txn`.`customer_subsegment_desc` `F_BUSINESS_SUB_SEGMENT_NAME`,         nvl(`coltp`.`collateral_description`, 'Collateral Type Unmapped') `f_collatral_type_name`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `F_ORIGINAL_SCORECARD_NAME`,         `txn`.`contract_desc` `F_STANDARD_PROD_NAME`,         'MFU needed - ELIMIT' `facility_activated_flag`,         `facagg`.`facility_availability_end_date` `facility_availability_end_date`,         `tcdr`.`facility_reference` `FACILITY_REF_NO`,         `tcdr`.`used_amount_facility` `FACILITY_UTILIZATION_AMOUNT`,         `tcdr`.`fair_value`,         'PMI source needed' `fam_cd`,         `tcdr`.`family`,         `tcdr`.`fde_alternative_method`,         NVL(`txn`.`filter_type`,'NA') `filter_type`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_cd`,         'PMI source needed - EMPLOYEE, SMC_PERIMETER' `fin_name`,         `tcdr`.`internal_rating_new` `final_crg`,         nvl(`tcdr`.`pd_new`,0) `final_pd`,         `tcdr`.`flag_adjustment`,         `tcdr`.`floor1`,         `tcdr`.`floor2`,         `txn`.`fsa_exclusion_type`,         `txn`.`fsa004_asset_class`,         nvl(round(`tcdr`.`collateral_assigned_amount`,10),0) * ( 1 - nvl(round(`tcdr`.`hc`,10),0) ) `fsv`,         `tcdr`.`funding_ccy`,         `tcdr`.`gaap_code` `GAAP_CD`,         'CDW needed - RSK_BOE_LMT_PRO' `governing_law`,         `tcdr`.`grand_fathering_applied`,         `tcdr`.`guar_sub_reference` `GUARANTEE_SUB_REF_NO`,         `tcdr`.`guarantee_bis_product`,         CASE WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED' THEN 'Guarantee'   WHEN `tcdr`.`collateral_contract_type` = 'NET_AGR' THEN 'Netting'   WHEN NVL (round(`tcdr`.`ead`,10), 0) * NVL(NVL(`prrsr`.`prr`, `sme_prr`.`product_recovery_rate` ),0) > 0 THEN 'Product Recovery'    ELSE 'UNMP' END `guarantee_ead_flag`,         `tcdr`.`guarantee_method`,         `tcdr`.`guarantee_reference` `GUARANTEE_REF_NO`,         `tcdr`.`guarantor`,         `tcdr`.`guarantor_bis_entity_type`,         CASE                 WHEN `tcdr`.`tranche_guarantee_type` = 'GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `gurantee_ead`,         `tcdr`.`hc`,         `tcdr`.`hcr`,         `tcdr`.`he`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND `tcdr`.`bs_type` = 'OFB' THEN `tcdr`.`outstanding`                 ELSE 0             END         `headroom`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`ead`                 ELSE 0             END         `headroom_ead`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`rwa`                 ELSE 0             END         `headroom_rwa`,         `tcdr`.`hfx`,         `txn`.`holding_company_ind`,         `tcdr`.`hr`,         `tcdr`.`id`,         'MFU needed - mfu_ifrs_category.txt' `ifrs_category`,         CASE                 WHEN `fac`.`commited` = 'N'                      AND `tcdr`.`table_name` = 'FACILITY' THEN nvl(`tcdr`.`nominal`,0)                 ELSE 0             END         `iip`,         `csr`.`imc_1`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_alpha_factor`,         'RMI TABLE NEEDED - rsk_scb_wb_imm_collat, NVL(SUM(amount),0)' `imm_collat_amount`,         'RMI table rsk_scb_wb_def_ind needed, indicator_value' `imm_eepe`,         `tcdr`.`import_source`,         `tcdr`.`incorporation_country` `incorp_country`,         `txn`.`incorporation_ccy_new`,         `txn`.`incorporation_ccy_original`,         `tcdr`.`inter_company`,         `tcdr`.`internal_maturity_class`,         NVL(`juris`.`isda`, 'No') `isda_flg`,         `tcdr`.`k_function_used`,         `tcdr`.`k_maturity`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`kccp`                 ELSE NULL            END         `kccp`,         CASE                 WHEN `ccp`.`kccp` IS NOT NULL                      AND `ccp`.`kccp` != 0 THEN 'Y'                 ELSE 'N'             END         `kccp_calc`,         `tcdr`.`legislated_program_applied`,         `tcdr`.`lgd` `LGD`,        `txn`.`lgd` `lgd_dollar`,         `tcdr`.`lgd_grade`,         `tcdr`.`lgd_grade_agency`,         `tcdr`.`lgd_grade_inf`,         `tcdr`.`lgd_grade_rank`,         `tcdr`.`lgd_grade_sup`,         `tcdr`.`lgd_mitigation`,         `tcdr`.`lgd_pre_floor_new`,         `tcdr`.`lgd_pre_floor_original`,         CASE                 WHEN (                     (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0 )                     AND (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.05 )                 ) THEN '0% - 04.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.05                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.1                 ) THEN '05% - 09.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.1                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.15                 ) THEN '10% - 14.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.15                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.2                 ) THEN '15% - 19.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.2                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.25                 ) THEN '20% - 24.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.25                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.3                 ) THEN '25% - 29.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.3                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.35                 ) THEN '30% - 34.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.35                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.4                 ) THEN '35% - 39.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.4                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.45                 ) THEN '40% - 44.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.45                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.5                 ) THEN '45% - 49.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.5                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.55                 ) THEN '50% - 54.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.55                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.6                 ) THEN '55% - 59.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.6                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.65                 ) THEN '60% - 64.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.65                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.7                 ) THEN '65% - 69.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.70                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.75                 ) THEN '70% - 74.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.75                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.80                 ) THEN '75% - 79.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.80                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.85                 ) THEN '80% - 84.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.85                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.90                 ) THEN '85% - 89.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.90                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     < 0.95                 ) THEN '90% - 94.99%'                 WHEN (                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     >= 0.95                         AND                         CASE                             WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                             ELSE `txn`.`lgd`                         END                     <= 1                 ) THEN '95% - 100%'                 WHEN (                     CASE                         WHEN `txn`.`lgd` IS NOT NULL THEN `txn`.`lgd`                         ELSE `txn`.`lgd`                     END                 > 1 ) THEN '>100%'             END         `lgd_range`,         `tcdr`.`lgd` `lgd_tcdr`,         `txn`.`limit_attribute`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY' THEN `tcdr`.`contract_reference`                 ELSE NULL             END         `limit_id`,         CASE                 WHEN `tcdr`.`facility_reference` IS NOT NULL AND `tcdr`.`facility_reference` != ''  THEN 'Linked'                 ELSE 'Unlinked'             END         `linked_unlinked_ind`,         null `lmt_eff_dt`,         `tcdr`.`long_short`,         `tcdr`.`look_through_treatment`,         `crsr`.`lt_rat_agency_code` `lt_rat_agency_cd`,         NVL(`tcdr`.`ltv`,0) `LTV`,         `tcdr`.`ltv_current`,         CASE                 WHEN `prod`.`product_level` = 'Standard Product'                      AND `prod`.`description` LIKE 'Private Equity%' THEN concat('078||',substr(`tcdr`.`dealbook`,length(`tcdr`.`dealbook`) - 7,length(`tcdr`.`dealbook`) ) )                 ELSE `tcdr`.`dealbook`             END         `management_location_cd`,            NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `management_prod_wid`,  NVL(case when `txn`.`management_product` is NULL or `txn`.`management_product` ='' or `txn`.`management_product`='UNMP' or `txn`.`management_product`='UNMAPPED' then    'P1390'   else `txn`.`management_product` end,'P1390') `management_prod_id`,                    `tcdr`.`margin_period`,         `tcdr`.`maturity_date`,         `tcdr`.`maturity_eff`,         'N' `maturity_limit_flag`,         `txn`.`maturity_range` `maturity_range`,         `tcdr`.`method_new`,         `tcdr`.`method_original`,         `cva`.`mi`,         `cva`.`mi_hedge`,         `tcdr`.`mm`,         `tcdr`.`mortgage_alternative`,         `tcdr`.`business_identifier` `MRU_IDENTIFIER`,  `tcdr`.`business_identifier` `BUSINESS_IDENTIFIER`,         `txn`.`mtm`,         `inst`.`custom_attribute_18` `nbv_currency`,         `inst`.`custom_attribute_17` `nbv_value`,         CASE                 WHEN trim(`ent`.`attribute_3`) = 'T' THEN 'TRUE'                 WHEN trim(`ent`.`attribute_3`) = 'F' THEN 'FALSE'                 ELSE `ent`.`attribute_3`         END         `negative_pledge_identifier`,          CASE                 WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)    WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm` ELSE 0         END         `net_mtm`,          ( (CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL')                             THEN NVL(round(`txn`.`outstanding`,10), 0)ELSE 0                        END) + nvl(round(`txn`.`accrued_interest`,10),0) +   ( CASE WHEN NVL(`tcdr`.`netting_agreement_reference`,'') = '' THEN nvl(round(`txn`.`replacement_cost`,10),0)   WHEN NVL(`tcdr`.`netting_agreement_reference`,'') <> '' and `txn2`.`sum_mtm` > 0 Then `txn`.`mtm`  ELSE 0 END) )   `net_nominal`,          nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         `netted_ead`,         ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) * ( nvl(round(`tcdr`.`ead`,10),0) -             CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED'                      AND `tcdr`.`collateral_bis_product` = 'OTC_NET_COL' THEN nvl(round(`tcdr`.`ead`,10),0)                 ELSE 0             END         ) `netted_ead_square`,         '0' `netted_nominal`,         `tcdr`.`netting_agreement_reference` `NETTING_AGREEMENT_REF_NO`,         `tcdr`.`netting_class`,         NVL(`juris`.`isda`, 'No') `netting_flg`,         `clrh`.`no_clear_mem_n`,    ((CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX',           'FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(round(`tcdr`.`outstanding`,10), 0)                    ELSE 0                    END                   ) +                   NVL(round(`txn`.`accrued_interest`,10), 0) +                   (CASE WHEN `tcdr`.`table_name` IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX',               'FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN                        (CASE  WHEN UPPER(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN                              (CASE WHEN round(`tcdr`.`fair_value`,10) > 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                              )                         ELSE (CASE WHEN round(`tcdr`.`fair_value`,10) < 0 THEN 0                               ELSE round(`tcdr`.`fair_value`,10)                               END                               )                         END                         )                     ELSE 0                     END                    )                  ) `nominal`,            `tcdr`.`nominal` `nominal_tcdr`,         `txn`.`non_borrowing_ind` `NON_BORROWING`,         substr(trim(`ent`.`attribute_17`), 1, 1) `non_contractual_parental_supt`,         substr(trim(`ent`.`attribute_17`), 3, 1) `non_financial_scorecard`,         `txn`.`non_gam_ind`,         `tcdr`.`non_material_equity`,         `txn`.`notional`,         `deal`.`nominal_2` `NOTIONAL_2`,         `deal`.`currency_2` `NOTIONAL_2CCY`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`tcdr`.`nominal`) *-1                         ELSE abs(`tcdr`.`nominal`)                     END                 )                 ELSE 0             END         `notional_tcdr`,         'CDW needed - cdw_txn_rmi_ddmmyyyy.txt' `obl_flg`,         `tcdr`.`obligor_grade_inf_new`,         `tcdr`.`obligor_grade_inf_original`,         `tcdr`.`obligor_grade_new`,         `tcdr`.`obligor_grade_original`,         `tcdr`.`obligor_grade_rank_new`,         `tcdr`.`obligor_grade_rank_original`,         `tcdr`.`obligor_grade_sup_new`,         `tcdr`.`obligor_grade_sup_original`,         CASE                 WHEN `inst`.`cost_center` IN (                     'FM ALM',                     'Principal Finance'                 ) THEN 'OCC_Own Account'                 ELSE nvl(`txn`.`customer_subsegment_code`,'UNMP')             END         `occ_sub_segment`,         `txn`.`bs_type` `ON_OFF_BALANCE_SHEET_FLAG`,         nvl(`tcdr`.`pd_original`,0) `org_pd`,         `tcdr`.`original_cost`,         nvl(`tcdr`.`internal_rating_original`,'CRG Original Unmapped') `original_crg`,          `txnf`.`original_limit_amount` `original_limit_amount`,          `tcdr`.`original_maturity`,         nvl(initcap(`txn`.`scorecard_original`),'UNMP') `original_scorecard`,         `txn`.`outstanding` `os`,         `facprod`.`contract_type` `out_limit_product`,   CASE WHEN `tcdr`.`table_name` NOT IN ('CREDIT_DERIVATIVE', 'DEAL_IMPORT', 'FACILITY','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL') THEN NVL(`tcdr`.`outstanding`, 0) ELSE 0 END `outstanding`,          `txn`.`outstanding` `outstanding_dollar`,         'MFU needed - cdw_BOEACBTXN_rmi_DDMMYYYY.txt' `overdue_days`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_1`,         'MFU Needed - E_BLANACE.TXT' `pair_currency_2`,         `tcdr`.`parent_id`,         `tcdr`.`past_due_int`,         `tcdr`.`past_due_ppal`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`pce_flag`                 ELSE NULL             END         `pce_flag`,         `rat`.`one_year_pd` `pd_midpoint`,         `tcdr`.`pd_new`,         `tcdr`.`pd_original`,         `tcdr`.`pd_pre_floor_new`,         `tcdr`.`pd_pre_floor_original`,         `tcdr`.`performing_status`,         `tcdr`.`pool_code` `POOL_CD`,         `tcdr`.`premium_current`,         `contp`.`attribute_1` `prod_cat_info`,         `tcdr`.`product_gl_criteria`,         `tcdr`.`product_gl_criteria_2`,         NVL(`tcdrp`.`tot_el`,0) `PROXY_EL`,         NVL(`tcdrp`.`lgd_used`,0) `PROXY_LGD`,         NVL(NVL(`txn`.`prr`, `sme_prr`.`product_recovery_rate`  ),0) `PRR`,    nvl(`inst`.`psgl_account_number`, `psgl`.`psgl_account`) `PSGL_ACCOUNT`,           nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_CD`,  nvl(nvl(`inst`.`psgl_customer_class`, `psgl`.`psgl_cust_class`), `txn`.`psgl_cust_class`) `PSGL_CUST_CLASS`,  nvl(nvl(`inst`.`psgl_department_id`, `psgl`.`psgl_department`), `txn`.`psgl_department`) `PSGL_DEPARTMENT`,  nvl(nvl(`inst`.`psgl_operating_unit`, `psgl`.`psgl_operating_unit`), `txn`.`psgl_operating_unit`) `PSGL_OPERATING_UNIT`,  nvl(nvl(`inst`.`psgl_product_code`, `psgl`.`psgl_product`), `txn`.`psgl_product`) `PSGL_PRODUCT`,          `tcdr`.`qualifying_ccp`,         `tcdr`.`qualifying_transaction`,         `crsr`.`lt_rat_code` `RATING_CD`,         `txn`.`replacement_cost` `RC`,         CASE                 WHEN `tcdr`.`table_name` IN (                     'CREDIT_DERIVATIVE',                     'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 ) THEN (                     CASE                         WHEN upper(`tcdr`.`collateral_attribute_9`) = 'REVERSE' THEN (                             CASE                                 WHEN `tcdr`.`fair_value` > 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                         ELSE (                             CASE                                 WHEN `tcdr`.`fair_value` < 0 THEN 0                                 ELSE `tcdr`.`fair_value`                             END                         )                     END                 )                 ELSE 0             END         `rc_tcdr`,         `txn`.`replacement_cost` `REPLACEMENT_COST`,         `tcdr`.`residual_maturity`,         `tcdr`.`rgc`,         `tcdr`.`risk_bucket`,         `tcdr`.`risk_bucket_original`,         `tcdr`.`risk_country`,         `tcdr`.`risk_country_new`,         `tcdr`.`risk_country_original`,         `tcdr`.`risk_type`,         `crm`.`rw_expo` `rw_expo`,         `tcdr`.`rw_new`,         `tcdr`.`rw_original`,         `tcdr`.`rw_scaling_factor`,         `tcdr`.`rwa`,         NVL(`trfrsk`.`rwa_add_on`,0) `rwa_add_on`,         `tcdr`.`rwa` `rwa_after_scale`,         nvl(round(`tcdr`.`rwa`,10),0) / 1.06 `rwa_before_scale`,         `trfrsk`.`rwa_cpty` `rwa_cpty`,         `tcdr`.`rwa` `RWA_NET_SAVES`,         `tcdr`.`rwa_pre_cap`,         `tcdr`.`rwa_pre_crm`,         `tcdr`.`rwa_pre_floor_equity`,         'MFU needed - Pool_Ref_MONYY.txt' `rwa_saves`,         `tcdr`.`rwa_scaling_factor`,         `trfrsk`.`rwa_total` `rwa_total`,         `ccp`.`is_scb_clr_mem` `scb_clearing_mem`,         `tcdr`.`second_loss_treatment`,         `tcdr`.`secu_bank_role`,         `tcdr`.`secu_company_weight`,         `tcdr`.`secu_ea_controlled`,         `tcdr`.`secu_issue_date`,         `tcdr`.`secu_loss_position`,         `tcdr`.`secu_mode`,         `tcdr`.`secu_retail_line_fg`,         `tcdr`.`secu_spread_trapping_ratio`,         `tcdr`.`secu_uncommited_retail_fg`,         `txn`.`lgd` `SECURED_LGD`,         `tcdr`.`securitization_n`,         `tcdr`.`securitization_reference` `SECURITIZATION_REF_NO`,         `tcdr`.`securitized`,         `tcdr`.`security_positions_ref`,         `txn`.`segment_original`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN                     CASE                         WHEN `tcdr`.`counterparty_original` != `tcdr`.`clearing_house_code`                              AND `clrm`.`entity_code` = `clrm`.`clearing_house_code` THEN `clrm`.`clearing_member_conditions`                         ELSE NULL                     END                 ELSE NULL             END         `segregated`,         `tcdr`.`seniority_new`,         `tcdr`.`seniority_original`,         `tcdr`.`settlement_price`,         `reposr`.`sov_indicator` `sov_indicator`,         `tcdr`.`sovereign_risk_bucket_new`,         `tcdr`.`sovereign_risk_bucket_ori`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_wid`,         nvl(`txn`.`contract_type`,'UNMP') `standard_prod_cd`,         `tcdr`.`standard_rw_new`,         `tcdr`.`standard_rw_original`,         `txn`.`start_date`,         null `std_rw_override_indicator`,         `inst`.`custom_attribute_16` `strategy`,         `tcdr`.`stress_testing_scenario_id`,         `txn`.`sub_limit_fac_reference` `sub_limit_fac_ref_no`,         `tcdr`.`sub_method_new`,         `tcdr`.`sub_method_original`,         `tcdr`.`sub_reference`,         `tcdr`.`supervisor_code` `SUPERVISOR_CD`,         CASE WHEN `enl`.`link_type` = 'SUPFIN' then `enl`.`mother_code` else 'UNMP SUPFIN' end `supfin_cd`,         `tcdr`.`table_name` `table_name`,         'SMC_PERIMETER required' `tbs_cd`,         `txn`.`maturity_range` `TENOR_BUCKETS`,         CASE                 WHEN `tcdr`.`import_source` LIKE '%WB%'                      AND (                     `tcdr`.`dealbook` LIKE '%CI%'                     OR `tcdr`.`dealbook` LIKE '%CC%'                 ) THEN `txnf`.`third_party_cp_flag`                 ELSE 'N/A'             END         `third_party_cp_flag`,         `tcdr`.`tier1_deduction`,         `tcdr`.`tier2_deduction`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`tot_pre_fund_con`                 ELSE NULL             END         `tot_pre_fund_con`,         `tcdr`.`total_annual_assets`,         `tcdr`.`total_annual_sales`,         `fac`.`amount` `total_facility_amount`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`total_initital_margin`                 ELSE NULL             END         `total_initital_margin`,         `inst`.`tp_portfolio_name` `tp_portfolio_name`,         'MFU needed - e_balances.txt' `tp_sys_scr_id`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / round(`t_cdr_temp`.`rwa`,10) ) )                 ELSE 0             END         `tr_addon_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN ( nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0) )                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / `t_cdr_temp`.`rwa` ) )                 ELSE 0             END         `tr_addon_rwa`,         nvl(`trfrsk`.`tr_el`,0) `tr_el`,         NVL(`trfrsk`.`tr_gua_ctry`, 'UNMP') `tr_gua_ctry`,         CASE                 WHEN `t_cdr_temp`.`el` != 0          THEN nvl(round(`t_cdr_temp`.`el`,10),0) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(round(`trfrsk`.`el_total`,10),0) - nvl(round(`trfrsk`.`el_cpty`,10),0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`el`,10),0) / nvl(round(`t_cdr_temp`.`el`,10),0) ) )                 ELSE 0             END         `tr_pre_el`,         CASE                 WHEN `t_cdr_temp`.`rwa` != 0         THEN nvl(round(`t_cdr_temp`.`rwa`,10),0) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) - ( (                     CASE                         WHEN nvl(`trfrsk`.`transfer_risk`,'N') = 'Y' THEN nvl(nvl(round(`trfrsk`.`rwa_total`,10), (nvl(round(`trfrsk`.`rwa_add_on`,10),0) ) + nvl(round(`trfrsk`.`rwa_cpty`,10),0) ),0) - nvl(round(`trfrsk`.`rwa_cpty`,10) ,0)                         ELSE 0                     END                 ) * ( nvl(round(`tcdr`.`rwa`,10),0) / nvl(round(`t_cdr_temp`.`rwa`,10),0) ) )                 ELSE 0             END         `tr_pre_rwa`,         `tcdr`.`trade_date`,         `tcdr`.`trading_book_type`,         `tcdr`.`trading_book_type` `TRADING_IND`,         `tcdr`.`tranche_collateral_type`,         `tcdr`.`tranche_guarantee_type`,         `txn`.`tranche_lgd`,         NVL(`trfrsk`.`transfer_risk`,'N') `transfer_risk`,         `txn`.`limit_amount` `txn_limit_amount`,         `txn`.`rw_new` `txn_rw_new`,         CASE                 WHEN `tcdr`.`clearing_house_code` IS NOT NULL THEN `ccp`.`uci`                 ELSE NULL             END         `uci`,         `tcdr`.`uncommited` `uncommited`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`nominal`             END         `uncommitted_amount`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`ead_pre_ccf`             END         `uncommitted_available_amunt`,         CASE                 WHEN `tcdr`.`table_name` = 'FACILITY'                      AND NOT (                     `tcdr`.`contract_type` = 'FAC'                     AND `tcdr`.`bs_type` = 'ASS'                 )                      AND `fac`.`attribute_1` = 'MOTHER'                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_headroom`,         CASE                 WHEN `tcdr`.`table_name` NOT IN (                     'DEAL_IMPORT',                     'CREDIT_DERIVATIVE','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'                 )                      AND `fac`.`commited` = 'N' THEN `tcdr`.`outstanding`                 ELSE 0             END         `uncommitted_os`,         CASE                 WHEN `fac`.`commited` = 'N' THEN `tcdr`.`ead_pre_ccf`             END         `uncommitted_used_amount`,         `tcdr`.`unconditionnaly_cancelable`,         `tcdr`.`und_pool_ref`,         `txn`.`unmapped_ind`,         CASE                 WHEN `tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                      AND `tcdr`.`tranche_guarantee_type` = 'NOT GUARANTEED' THEN nvl(`tcdr`.`ead`,0)                 ELSE 0             END         `unsecured_ead`,         `tcdr`.`used_amount_facility`,         `tcdr`.`value_date`,         `txn`.`waterfall_seniority`,         `cva`.`wi` `wi`,         case when `rat`.`row_owner` = 'C' AND `rat`.`agency_code` = 'INTERNAL' AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) >= nvl(round(`rat`.`pd_inf`,10),0)   AND ((nvl(round(`tcdr`.`pd_original`,10),0) / nvl(round(`tcdr`.`ead`,10),0)) * 100) < nvl(round(`rat`.`pd_sup`,10),0)   THEN `rat`.`rating` ELSE `icr`.`long_term_rating` END `wt_crg`,         nvl(round(`tcdr`.`pd_new`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_final_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`k_maturity`,10) ) `wt_k_maturity`,         `txn`.`wt_lgd`,         (nvl(round(`tcdr`.`ead`,10),0) * nvl(round(`tcdr`.`k_maturity`,10),0)) `wt_mat_eff`,         nvl(round(`tcdr`.`pd_original`,10),0) * nvl(round(`tcdr`.`ead`,10),0) `wt_org_pd`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_new`,10) ) `wt_pd_new`,         ( round(`tcdr`.`ead`,10) * round(`tcdr`.`pd_original`,10) ) `wt_pd_original`,         nvl(`txn`.`wt_residual_maturity`,0) `wt_residual_maturity`,         ( round(`tcdr`.`pd_new`,10) * round(`tcdr`.`nominal`,10) ) `wtpdlgd`,         ( round(`tcdr`.`pd_new`,10) * round(`txn`.`wt_lgd`,10) ) `wtpdnm`,         `tcdrp`.`xrc`,         `tcdr`.`zero_haircut_for_repo`,         `tcdr`.`zero_rw_for_equity`,         `tcdr`.`zone_a_new`,         `tcdr`.`zone_a_original`,  `tcdr`.`collateral_assigned_amount` `COLLATERAL_ASSIGNED_AMOUNT`,  '0' `collateral_unique_id`,  NVL(`smeprod`.`product_type`,`retail_exp`.`product_type`) `sme_product_type`,   CASE WHEN SUBSTR((case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END ), -2) = '-M'                   THEN                   substr( (case          when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)         when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)         when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)         else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end          END)         , 1         ,  length(trim(case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END ))-2                   )                     ELSE                  case   when NVL(trim(`facl`.`attribute_3`),'') <> '' then trim(`facl`.`attribute_3`)  when NVL(trim(`facl`.`facility_reference`),'') <> '' then trim(`facl`.`facility_reference`)  when NVL(trim(`tcdr`.`facility_reference`),'') <> '' then trim(`tcdr`.`facility_reference`)  else case when `tcdr`.`table_name` = 'FACILITY' THEN trim(`tcdr`.`contract_reference`) else '' end   END          END `DERIVED_LIMIT_ID`,  `derived_lt`.`limit_id_trim` `DERIVED_LIMIT_ID_STP`,  CASE WHEN `tcdr`.`method_new` = 'ADV' THEN round(NVL(`tcdr`.`ead`, 0),5) *          (CASE WHEN ( (`tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') <> 'RW_LGD_UPDATE'                         ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`txn`.`lgd`,0),5)                 WHEN ( (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'GUARANTEED')                          OR (`tcdr`.`tranche_collateral_type` = 'NOT COLLATERALIZED' AND `tcdr`.`tranche_guarantee_type`  = 'NOT GUARANTEED'                          AND NVL(`tcdr`.`collateral_attribute_8`,'z') = 'RW_LGD_UPDATE'                          ))                          AND `tcdr`.`method_new` = 'ADV' THEN round(nvl(`tcdr`.`exposure_attribute_7`,0),5)                 ELSE 0 END         ) ELSE 0 END `unsecured_lgd_dollar`,    case when `be`.`booking_loc_id` = 'SG'  then 'SG'  when `be`.`booking_loc_id` = 'MY'  then 'MY' when `be`.`booking_loc_id` = 'VN'  then 'VN' when `be`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end as `SECURITY_CTRY`,    case when `tcdr`.`dealbook` like '%CI%' OR `tcdr`.`dealbook` like '%CC%' then 'CICC'   when `tcdr`.`dealbook` like '%RT%' then 'RT'   when `tcdr`.`dealbook` like '%PB%' then 'PB'   when `tcdr`.`dealbook` like '%OB%' then 'OB'   else 'OTHERS' end AS `SECURITY_SEG`                          FROM         `sgmisitstg`.`stg_bcrs_t_cdr` `tcdr`           LEFT JOIN `sgmisit`.`sgmi_txn_rwa_f` `txn` ON `tcdr`.`id` = `txn`.`id`                                                             AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`txn`.`partition_key`,'UNM')            AND `txn`.`w_datasource_id` = 'BCRS_PRA'            AND `txn`.`w_snapshot_dt` = '2021-06-30'            AND `txn`.`w_country_cd` = 'ALL'            AND `txn`.`w_workspace` = 'WS9'            LEFT JOIN (select `tbl`.`netting_agreement_reference`, `tbl`.`partition_key`, `tbl`.`rnk`, `tbl`.`sum_mtm` from (select `sgmi_txn_rwa_f`.`netting_agreement_reference`,`sgmi_txn_rwa_f`.`partition_key`, row_number() over(partition by `sgmi_txn_rwa_f`.`netting_agreement_reference`,`sgmi_txn_rwa_f`.`partition_key`) `rnk`, sum(`sgmi_txn_rwa_f`.`mtm`) over(partition by netting_agreement_reference,partition_key) `sum_mtm`   from `sgmisit`.`sgmi_txn_rwa_f`    where    `sgmi_txn_rwa_f`.`w_snapshot_dt` = '2021-06-30' and   `sgmi_txn_rwa_f`.`w_workspace` in (   (case when instr('WS9','ADJ')>0 then substr('WS9',1,instr('WS9','_ADJ') - 1) else concat('WS9','_ADJ') end), 'WS9')  ) `tbl` where `tbl`.`rnk`=1  ) `txn2`  ON `txn`.`netting_agreement_reference` = `txn2`.`netting_agreement_reference`                                                               AND nvl(`txn`.`partition_key`,'UNM') = nvl(`txn2`.`partition_key`,'UNM')                   LEFT JOIN `sgmisitstg`.`stg_bcrs_facility` `fac` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`fac`.`contract_reference`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`fac`.`partition_key`,1,8)                                                       AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`fac`.`contract_type`,'UNM')             AND `fac`.`w_batch_id` = '2021110220352300104'          LEFT JOIN (select `stg_bcrs_scb_wb_addt_inst`.`partition_key`, `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`, `stg_bcrs_scb_wb_addt_inst`.`arm_code`, `stg_bcrs_scb_wb_addt_inst`.`arm_description`, `stg_bcrs_scb_wb_addt_inst`.`cost_center`, `stg_bcrs_scb_wb_addt_inst`.`cost_center_descriotion`,    `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_18`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_17`, `stg_bcrs_scb_wb_addt_inst`.`psgl_account_number`, `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`, `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`, `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`, `stg_bcrs_scb_wb_addt_inst`.`custom_attribute_16`, `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`, `stg_bcrs_scb_wb_addt_inst`.`w_batch_id`,    ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ) AS `rnk`      FROM `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2021110220352300104' AND  NVL(`stg_bcrs_scb_wb_addt_inst`.`arm_code`,'') <> ''     ) `inst` ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`inst`.`contract_reference`),'UNM')                                                       AND trim(`tcdr`.`table_name`) = trim(`inst`.`table_name`)                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`inst`.`partition_key`,1,8)             AND `inst`.`rnk`=1   LEFT JOIN ( select `stg_bcrs_scb_wb_psgl`.`partition_key`, `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name`, `stg_bcrs_scb_wb_psgl`.`psgl_bu`, `stg_bcrs_scb_wb_psgl`.`psgl_account`, `stg_bcrs_scb_wb_psgl`.`psgl_product`, `stg_bcrs_scb_wb_psgl`.`psgl_department`, `stg_bcrs_scb_wb_psgl`.`psgl_operating_unit`,    `stg_bcrs_scb_wb_psgl`.`psgl_cust_class`, `stg_bcrs_scb_wb_psgl`.`financial_book_code`, `stg_bcrs_scb_wb_psgl`.`booking_location`, `stg_bcrs_scb_wb_psgl`.`w_batch_id`, ROW_NUMBER() OVER( partition by `stg_bcrs_scb_wb_psgl`.`contract_reference`, `stg_bcrs_scb_wb_psgl`.`fermat_table_name` ) AS `rnk`       FROM `sgmisitstg`.`stg_bcrs_scb_wb_psgl`   WHERE `stg_bcrs_scb_wb_psgl`.`w_batch_id` = '2021110220352300104'     AND  NVL(`stg_bcrs_scb_wb_psgl`.`psgl_bu`,'') <> '') `psgl`   ON nvl(trim(`tcdr`.`contract_reference`),'UNM') = nvl(trim(`psgl`.`contract_reference`),'UNM')    AND trim(`tcdr`.`table_name`) = trim(`psgl`.`fermat_table_name`)   AND substr(`tcdr`.`partition_key`,1,8) = substr(`psgl`.`partition_key`,1,8)               AND `psgl`.`rnk`=1                        LEFT JOIN ( select `stg_bcrs_t_crm`.`partition_key`, `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`,`stg_bcrs_t_crm`.`expo_table_name`,`stg_bcrs_t_crm`.`w_batch_id`,`stg_bcrs_t_crm`.`rw_expo`,`stg_bcrs_t_crm`.`attribute_6`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_t_crm`.`expo_contract_reference`, `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ORDER BY `stg_bcrs_t_crm`.`expo_contract_reference`,    `stg_bcrs_t_crm`.`expo_counterparty`, `stg_bcrs_t_crm`.`expo_table_name` ) AS `rnk`    FROM `sgmisitstg`.`stg_bcrs_t_crm`   WHERE CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_t_crm`.`w_batch_id` = '2021110220352300104' ELSE `stg_bcrs_t_crm`.`w_batch_id` = '2021110812475100333' END           ) `crm` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`crm`.`expo_contract_reference`,'UNM')          AND nvl(`tcdr`.`counterparty_original`, 'UMP') = nvl(`crm`.`expo_counterparty`, 'UMP')                                                    AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`crm`.`partition_key`,'UNM')          AND `crm`.`expo_table_name` = 'ON_OFF_BALANCE'          AND `crm`.`rw_expo` is not null          AND `crm`.`rnk` = 1            LEFT JOIN (             SELECT   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                                `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`avg_pre_funded_contribution`) `avg_pre_funded_contribution`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`beta`) `beta`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`clearing_house_name`) `ccp_name`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`pre_funded_financial`) `dfccp`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_prefunded_contribution`) `dfi`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`kccp`) `kccp`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`sum_pre_fund_contribution`) `tot_pre_fund_con`,                 MAX(`stg_bcrs_scb_wb_ccp_static`.`total_initial_margin`) `total_initital_margin`,                 SUM(`stg_bcrs_scb_wb_ccp_static`.`scb_committed_contributions`) `uci`             FROM                 `sgmisitstg`.`stg_bcrs_scb_wb_ccp_static`   WHERE `stg_bcrs_scb_wb_ccp_static`.`w_batch_id` = '2021110220352300104'       AND `stg_bcrs_scb_wb_ccp_static`.`beta` is not null AND `stg_bcrs_scb_wb_ccp_static`.`beta` != ''             GROUP BY   `stg_bcrs_scb_wb_ccp_static`.`w_batch_id`,                 `stg_bcrs_scb_wb_ccp_static`.`clearing_house_code`,                 `stg_bcrs_scb_wb_ccp_static`.`is_scb_clr_mem`,                 `stg_bcrs_scb_wb_ccp_static`.`partition_key`         ) `ccp` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`ccp`.`clearing_house_code`,'UNM')                  AND substr(`tcdr`.`partition_key`,1,8) = substr(`ccp`.`partition_key`,1,8)          LEFT JOIN (             SELECT   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`,                 SUM(`stg_bcrs_t_cva`.`bi`) `bi`,                 SUM(`stg_bcrs_t_cva`.`cva_index_part`) `cva_index_part`,                 SUM(`stg_bcrs_t_cva`.`cva_capital_charge`) `cva_rwa_addon`,                 MAX(`stg_bcrs_t_cva`.`mi`) `mi`,                 SUM(`stg_bcrs_t_cva`.`mi_hedge`) `mi_hedge`,                 MAX(`stg_bcrs_t_cva`.`wi`) `wi`             FROM                 `sgmisitstg`.`stg_bcrs_t_cva`   WHERE `stg_bcrs_t_cva`.`w_batch_id` = '2021110812475100333'             GROUP BY   `stg_bcrs_t_cva`.`w_batch_id`,                 `stg_bcrs_t_cva`.`counterparty`,                 `stg_bcrs_t_cva`.`contract_reference`,                 `stg_bcrs_t_cva`.`partition_key`         ) `cva` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`cva`.`contract_reference`,'UNM')                  AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`cva`.`partition_key`,'UNM')                  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`cva`.`counterparty`,'UNM')          LEFT JOIN `sgmisit`.`sgmi_client_d` `client` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`client`.`client_id`,'UNM')    AND `client`.`w_datasource_id` = 'BCRS_PRA' AND `client`.`w_snapshot_dt` = '2021-06-30'    LEFT JOIN `sgmisit`.`sgmi_obi_pd_lookup_dat` `obi` ON substr(`tcdr`.`partition_key`,1,6) = nvl(`obi`.`partition_key`,'UNM')          LEFT JOIN `sgmisitstg`.`stg_bcrs_v_scb_gpr_ec_t_cdr_prx` `tcdrp` ON nvl(`tcdr`.`id`,'UNM') = nvl(`tcdrp`.`id`,'UNM')                                                                       AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`tcdrp`.`partition_key`,'UNM')               AND `tcdrp`.`w_batch_id` = '2021110220352300104'         LEFT JOIN (             SELECT   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`,                 MAX(`stg_bcrs_bis_clearing_house`.`df_cm`) `df_cm`,                 MAX(`stg_bcrs_bis_clearing_house`.`n`) `no_clear_mem_n`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_house`   WHERE CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2021110220352300104' ELSE `stg_bcrs_bis_clearing_house`.`w_batch_id` = '2021110812475100333' END             GROUP BY   `stg_bcrs_bis_clearing_house`.`w_batch_id`,                 `stg_bcrs_bis_clearing_house`.`partition_key`,                 `stg_bcrs_bis_clearing_house`.`entity_code`         ) `clrh` ON nvl(`tcdr`.`clearing_house_code`,'UNM') = nvl(`clrh`.`entity_code`,'UNM')                   AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrh`.`partition_key`,'UNM')          LEFT JOIN   (select `stg_bcrs_entity_links`.`partition_key`, `stg_bcrs_entity_links`.`child_code`, `stg_bcrs_entity_links`.`link_type`, `stg_bcrs_entity_links`.`mother_code`, `stg_bcrs_entity_links`.`w_batch_id`, ROW_NUMBER() OVER(ORDER BY `stg_bcrs_entity_links`.`mother_code` desc) AS `rnk`  FROM `sgmisitstg`.`stg_bcrs_entity_links` where `stg_bcrs_entity_links`.`w_batch_id` = '2021110220352300104' and `stg_bcrs_entity_links`.`link_type` = 'DLRFIN' ) `enl`   ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`enl`.`child_code`,'UNM')         AND substr(`tcdr`.`partition_key`,1,8) = substr(`enl`.`partition_key`,1,8)         AND `enl`.`rnk`=1           LEFT JOIN (select `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`, `stg_bcrs_csr`.`table_name`, `stg_bcrs_csr`.`imc_1`, `stg_bcrs_csr`.`w_batch_id`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ORDER BY `stg_bcrs_csr`.`contract_reference`, `stg_bcrs_csr`.`contract_type`, `stg_bcrs_csr`.`counterparty`, `stg_bcrs_csr`.`method`, `stg_bcrs_csr`.`bs_type`, `stg_bcrs_csr`.`book_code`,           `stg_bcrs_csr`.`table_name` ) AS `rnk`   from `sgmisitstg`.`stg_bcrs_csr`   where CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_csr`.`w_batch_id` = '2021110220352300104' ELSE `stg_bcrs_csr`.`w_batch_id` = '2021110812475100333' END ) `csr`     ON `tcdr`.`contract_reference` = `csr`.`contract_reference`    AND nvl(`tcdr`.`contract_type`,'UNM') = nvl(`csr`.`contract_type`,'UNM')    AND nvl(`tcdr`.`counterparty_new`,'UNM') = nvl(`csr`.`counterparty`,'UNM')    AND nvl(`tcdr`.`method_new`,'UNM') = nvl(`csr`.`method`,'UNM')    AND `tcdr`.`bs_type` = `csr`.`bs_type`    AND `tcdr`.`dealbook` = `csr`.`book_code`    AND (case when nvl(`tcdr`.`table_name`,'z') in ('BOND', 'EQUITY', 'TRANCHE', 'CONVERTIBLE', 'FUND') then 'SECURITY_POSITIONS'             else nvl(`tcdr`.`table_name`, 'z') end) = `csr`.`table_name`    AND `csr`.`imc_1` is not null    AND trim(`csr`.`imc_1`) != ''    AND `csr`.`rnk` = 1    LEFT JOIN ( select `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_cpty`),0) `EL_CPTY`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`el_total`),0) `EL_TOTAL`,      NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`),0) `rwa_add_on`, NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`),0) `rwa_cpty`,      NVL(NVL(SUM(`stg_bcrs_scb_wb_tr_sr`.`rwa_total`),SUM(NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_add_on`,0) +  NVL(`stg_bcrs_scb_wb_tr_sr`.`rwa_cpty`,0))),0) `RWA_TOTAL`,      NVL(sum(`stg_bcrs_scb_wb_tr_sr`.`tr_el`),0) `tr_el`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry` `TR_GUA_CTRY`, MAX(NVL(`stg_bcrs_scb_wb_tr_sr`.`is_tr`,'N')) `TRANSFER_RISK`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`   from `sgmisitstg`.`stg_bcrs_scb_wb_tr_sr`    where CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_scb_wb_tr_sr`.`w_batch_id` = '2021110220352300104' ELSE `stg_bcrs_scb_wb_tr_sr`.`w_batch_id` = '2021110812475100333' END    group by `stg_bcrs_scb_wb_tr_sr`.`contract_reference`, `stg_bcrs_scb_wb_tr_sr`.`table_name`, `stg_bcrs_scb_wb_tr_sr`.`pr_obligor`, `stg_bcrs_scb_wb_tr_sr`.`contract_type`, `stg_bcrs_scb_wb_tr_sr`.`bs_type`, `stg_bcrs_scb_wb_tr_sr`.`tr_ctry`, `stg_bcrs_scb_wb_tr_sr`.`w_batch_id`  ) `trfrsk`  ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`trfrsk`.`contract_reference`,'UNM')  AND nvl(`tcdr`.`table_name`,'UNM') = nvl(`trfrsk`.`table_name`,'UNM')  AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`trfrsk`.`pr_obligor`,'UNM')  AND `tcdr`.`contract_type` = `trfrsk`.`contract_type`  and `tcdr`.`bs_type` = `trfrsk`.`bs_type`    LEFT JOIN (   select  `tbl`.`contract_reference`, `tbl`.`und_pool_ref`, `tbl`.`bs_type`, `tbl`.`sub_reference`, `tbl`.`prr`, `tbl`.`rnk` from (     SELECT      `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,     `stg_bcrs_scb_wb_prr_sr`.`und_pool_ref`,     `stg_bcrs_scb_wb_prr_sr`.`bs_type`,     `stg_bcrs_scb_wb_prr_sr`.`sub_reference`,     `stg_bcrs_scb_wb_prr_sr`.`prr`,     row_number() over(partition by `stg_bcrs_scb_wb_prr_sr`.`contract_reference`,`stg_bcrs_scb_wb_prr_sr`.`und_pool_ref`,`stg_bcrs_scb_wb_prr_sr`.`bs_type`,`stg_bcrs_scb_wb_prr_sr`.`sub_reference`,`stg_bcrs_scb_wb_prr_sr`.`prr`) `rnk`      FROM       `sgmisitstg`.`stg_bcrs_scb_wb_prr_sr`     WHERE CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2021110220352300104' ELSE `stg_bcrs_scb_wb_prr_sr`.`w_batch_id` = '2021110812475100333' END         AND  NVL(`stg_bcrs_scb_wb_prr_sr`.`prr`,'') <> ''    ) `tbl` where `tbl`.`rnk`=1   ) `prrsr` on `tcdr`.`contract_reference` = `prrsr`.`contract_reference` and nvl(`tcdr`.`und_pool_ref`,'UNM') = nvl(`prrsr`.`und_pool_ref`,'UNM')  and nvl(`tcdr`.`bs_type`,'UNM') = nvl(`prrsr`.`bs_type`,'UNM') and nvl(`tcdr`.`sub_reference`,'UNM') = nvl(`prrsr`.`sub_reference`,'UNM')      LEFT JOIN (select `stg_bcrs_scb_wb_repo_sr`.`partition_key`, `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`, `stg_bcrs_scb_wb_repo_sr`.`external_rating`, `stg_bcrs_scb_wb_repo_sr`.`sov_indicator`, `stg_bcrs_scb_wb_repo_sr`.`security_contract_ref`,     ROW_NUMBER() OVER(partition by `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref` order by `stg_bcrs_scb_wb_repo_sr`.`repo_contract_ref`) as `rnk`   from `sgmisitstg`.`stg_bcrs_scb_wb_repo_sr`  WHERE CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2021110220352300104' ELSE `stg_bcrs_scb_wb_repo_sr`.`w_batch_id` = '2021110812475100333' END   AND `stg_bcrs_scb_wb_repo_sr`.`sov_indicator` IS NOT NULL ) `reposr`   ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`reposr`.`partition_key`,'UNM')  AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`reposr`.`repo_contract_ref`,'UNM')  AND `reposr`.`rnk`=1            LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `scrd` ON nvl(`scrd`.`org_scrd_g3_code`,'UNM') = nvl(`txn`.`scorecard_original`,'UNM')           LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`,                 MIN(`stg_bcrs_facility`.`dim3`) `facility_availability_end_date`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2021110220352300104'              GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`partition_key`,                 `stg_bcrs_facility`.`counterparty_code`,                 `stg_bcrs_facility`.`contract_reference`         ) `facagg` ON nvl(`tcdr`.`facility_reference`,'UNM') = nvl(`facagg`.`contract_reference`,'UNM')                     AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`facagg`.`counterparty_code`,'UNM')                     AND nvl(`tcdr`.`partition_key`,'UNM') = nvl(`facagg`.`partition_key`,'UNM')                   LEFT JOIN `sgmisitstg`.`stg_bcrs_credit_rating_sr` `crsr` ON nvl(`reposr`.`security_contract_ref`,'UNM') = nvl(`crsr`.`reference`,'UNM')                                                                AND `crsr`.`lt_rat_agency_code` IS NOT NULL               AND CASE WHEN 'WS9' like '%ADJ%' THEN `crsr`.`w_batch_id` = '2021110220352300104' ELSE `crsr`.`w_batch_id` = '2021110812475100333' END          LEFT JOIN `sgmisitstg`.`stg_bcrs_product` `prod` ON nvl(`tcdr`.`contract_type`,'UNM') = nvl(`prod`.`product`,'UNM')                                                       AND substr(`tcdr`.`partition_key`,1,8) = substr(`prod`.`partition_key`,1,8)             AND `prod`.`w_batch_id` = '2021110220352300104'          LEFT JOIN `sgmisitstg`.`stg_bcrs_entity` `ent` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`ent`.`entity_code`,'UNM')                                                     AND substr(`tcdr`.`partition_key`,1,8) = substr(`ent`.`partition_key`,1,8)            AND `ent`.`w_batch_id` = '2021110220352300104'          LEFT JOIN `sgmisitstg`.`stg_bcrs_deal_import` `deal` ON nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`deal`.`contract_reference`,'UNM')                                                           AND substr(`tcdr`.`partition_key`,1,8) = substr(`deal`.`contract_reference`,1,8)          AND `deal`.`w_batch_id` = '2021110220352300104'          LEFT JOIN (             SELECT   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`,                 MAX(nvl(case when trim(`stg_bcrs_facility`.`attribute_4`) = '' then null else `stg_bcrs_facility`.`attribute_4` end,`stg_bcrs_facility`.`amount`) ) `original_limit_amount`,                 MIN(`stg_bcrs_facility`.`dim2`) `pce_flag`,                 MIN(`stg_bcrs_facility`.`dim1`) `third_party_cp_flag`             FROM                 `sgmisitstg`.`stg_bcrs_facility`   WHERE `stg_bcrs_facility`.`w_batch_id` = '2021110220352300104'                GROUP BY   `stg_bcrs_facility`.`w_batch_id`,                 `stg_bcrs_facility`.`contract_reference`,                 `stg_bcrs_facility`.`partition_key`         ) `txnf` ON nvl(`txn`.`sub_limit_fac_reference`,'UNM') = nvl(`txnf`.`contract_reference`,'UNM')                   AND substr(`txn`.`partition_key`,1,8) = substr(`txnf`.`partition_key`,1,8)                   AND nvl(`tcdr`.`contract_reference`,'UNM') = nvl(`txn`.`contract_reference`,'UNM')     AND `tcdr`.`import_source` like '%WB%'                                       AND `tcdr`.`id` = `txn`.`id`             LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`icr`.`entity_code`,'UNM')                                                                    AND substr(`tcdr`.`partition_key`,1,8) = substr(`icr`.`partition_key`,1,8)                                                                    AND `icr`.`agency_code` = 'INTERNAL'            AND `icr`.`w_batch_id` = '2021110220352300104'          LEFT JOIN `sgmisitstg`.`stg_bcrs_rating` `rat` ON nvl(`icr`.`long_term_rating`,'UNM') = nvl(`rat`.`rating`,'UNM')                                                     AND substr(`icr`.`partition_key`,1,8) = substr(`rat`.`partition_key`,1,8)                                                     AND `rat`.`agency_code` = 'INTERNAL'           AND `rat`.`w_batch_id` = '2021110220352300104'          LEFT JOIN (             SELECT    `stg_bcrs_bis_clearing_member`.`w_batch_id`,                 `stg_bcrs_bis_clearing_member`.`partition_key`,                 `stg_bcrs_bis_clearing_member`.`entity_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_house_code`,                 `stg_bcrs_bis_clearing_member`.`clearing_member_conditions`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_bis_clearing_member`.`entity_code` ORDER BY `stg_bcrs_bis_clearing_member`.`entity_code` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_bis_clearing_member`   WHERE CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2021110220352300104' ELSE `stg_bcrs_bis_clearing_member`.`w_batch_id` = '2021110812475100333' END          ) `clrm` ON nvl(`tcdr`.`partition_key`,'UNM') = nvl(`clrm`.`partition_key`,'UNM')                   AND nvl(`tcdr`.`counterparty_original`,'UNM') = nvl(`clrm`.`entity_code`,'UNM')     AND `clrm`.`w_batch_id` = '2021110812475100333'     AND `clrm`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_currency` `cur` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`cur`.`partition_key`,'UNM')                                                       AND nvl(`fac`.`currency`,'UNM') = nvl(`cur`.`ccy_code`,'UNM')             AND `cur`.`w_batch_id` = '2021110220352300104'           LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `juris` ON nvl(`tcdr`.`incorporation_country`,'UNM') = nvl(`juris`.`country_cd`,'UNM')                                                                  AND `juris`.`etl_current_record_flag` = 'Y'          LEFT JOIN (             SELECT    `stg_bcrs_facility_products`.`w_batch_id`,                 `stg_bcrs_facility_products`.`partition_key`,                 `stg_bcrs_facility_products`.`facility_reference`,                 `stg_bcrs_facility_products`.`contract_type`,   ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_facility_products`.`facility_reference` ORDER BY `stg_bcrs_facility_products`.`facility_reference` ) AS `rnk`             FROM                 `sgmisitstg`.`stg_bcrs_facility_products`   WHERE `stg_bcrs_facility_products`.`w_batch_id` = '2021110220352300104'         ) `facprod` ON nvl(`fac`.`partition_key`,'UNM') = nvl(`facprod`.`partition_key`,'UNM')                      AND nvl(`facprod`.`facility_reference`,'UNM') = substr(`fac`.`contract_reference`,1,instr(`fac`.`contract_reference`,'-M') - 1)                      AND `fac`.`attribute_1` = 'MOTHER'        AND `facprod`.`rnk` = 1          LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON substr(`tcdr`.`partition_key`,1,8) = substr(`contp`.`partition_key`,1,8)                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`facprod`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021110220352300104'          LEFT JOIN (             SELECT   w_batch_id,                 partition_key,                 nvl(`t_cdr`.`contract_reference`,'UNM') `contract_reference`,                 nvl(`t_cdr`.`table_name`,'UNM') `table_name`,                 nvl(`t_cdr`.`counterparty_original`,'UNM') `counterparty_original`,                 SUM(nvl(`t_cdr`.`rwa`,0) ) `rwa`,                 SUM(nvl(`t_cdr`.`el`,0) ) `el`             FROM                 `sgmisitstg`.`stg_bcrs_t_cdr` `t_cdr`   WHERE `t_cdr`.`w_batch_id` = '2021110812475100333'             GROUP BY   `t_cdr`.`w_batch_id`,                 `t_cdr`.`partition_key`,                 nvl(`t_cdr`.`contract_reference`,'UNM'),                 nvl(`t_cdr`.`table_name`,'UNM'),                 nvl(`t_cdr`.`counterparty_original`,'UNM')         ) `t_cdr_temp` ON nvl(`tcdr`.`partition_key`,'UNM') = `t_cdr_temp`.`partition_key`                         AND nvl(`tcdr`.`contract_reference`,'UNM') = `t_cdr_temp`.`contract_reference`                         AND nvl(`tcdr`.`table_name`,'UNM') = `t_cdr_temp`.`table_name`                         AND nvl(`tcdr`.`counterparty_original`,'UNM') = `t_cdr_temp`.`counterparty_original`     left join `sgmisitstg`.`stg_bcrs_facility_links` `facl`   on (CASE WHEN (length(`tcdr`.`contract_reference`) = 10 or length(`tcdr`.`contract_reference`) = 11 or length(`tcdr`.`contract_reference`) = 12) THEN substr(`tcdr`.`contract_reference`,1,instr(`tcdr`.`contract_reference`,'-M') - 1)          ELSE `tcdr`.`contract_reference` END) = `facl`.`contract_reference`   and substr(`tcdr`.`partition_key`,1,8) = substr(`facl`.`partition_key`,1,8)   and `facl`.`table_name` = `tcdr`.`table_name`   and `facl`.`w_batch_id` = '2021110220352300104'    left join (select `sgmi_client_bca_d`.`client_le_wid`, `sgmi_client_bca_d`.`client_le_id`, `sgmi_client_bca_d`.`bca_ref_no`, `sgmi_client_bca_d`.`bca_approval_dt`, `sgmi_client_bca_d`.`bca_review_dt`, `sgmi_client_bca_d`.`w_snapshot_dt`,   ROW_NUMBER() OVER( PARTITION BY `sgmi_client_bca_d`.`client_le_id` ORDER BY `sgmi_client_bca_d`.`client_le_id` ) AS `rnk`                 from `sgmisit`.`sgmi_client_bca_d` ) `bca`                 on substr(`tcdr`.`counterparty_original`,1,8) = `bca`.`client_le_id`                 and `tcdr`.`w_snapshot_dt` = `bca`.`w_snapshot_dt`   and `bca`.`rnk` = 1   left join `sgmisit`.`sgmi_collateral_type_dat` `coltp`   on `tcdr`.`collateral_contract_type` = `coltp`.`collateral_code`   and `coltp`.`etl_current_record_flag` = 'Y'   left join `sgmisit`.`sgmi_sme_product_dat` `smeprod`   on `tcdr`.`contract_type` = `smeprod`.`contract_type`   LEFT JOIN `sgmisit`.`SGMI_BOOK_CD_D` `BOOK`    ON `tcdr`.`dealbook`  =`book`.`book_wid` AND `tcdr`.`w_datasource_id` = `book`.`w_datasource_id` AND `tcdr`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE`    ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`    AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_sme_prr` `sme_prr`    ON `tcdr`.`contract_type` = regexp_replace(`sme_prr`.`product_code`,'S_','')                                                 and `be`.`booking_loc_id` = `sme_prr`.`country`                and `sme_prr`.`w_batch_id` = '2021110812475100333'     LEFT JOIN (SELECT `stg_bcrs_crm_sr`.`partition_key`, `stg_bcrs_crm_sr`.`crm_id`, `stg_bcrs_crm_sr`.`collateral_mode`, `stg_bcrs_crm_sr`.`beneficiary`, `stg_bcrs_crm_sr`.`group_link_type`, `stg_bcrs_crm_sr`.`currency`, `stg_bcrs_crm_sr`.`guarantee_percentage`, `stg_bcrs_crm_sr`.`market_value`, `stg_bcrs_crm_sr`.`market_value_ccy`, `stg_bcrs_crm_sr`.`evaluation_date`, `stg_bcrs_crm_sr`.`benef_table_name`, `stg_bcrs_crm_sr`.`benef_contract_ref`, `stg_bcrs_crm_sr`.`repartition_method`, `stg_bcrs_crm_sr`.`amount_prior_claims`, `stg_bcrs_crm_sr`.`pct_same_rank_claims`, `stg_bcrs_crm_sr`.`fdw_netting_agreement`, `stg_bcrs_crm_sr`.`parent_collateral`, `stg_bcrs_crm_sr`.`parent_nominal`, `stg_bcrs_crm_sr`.`parent_currency`, `stg_bcrs_crm_sr`.`parent_amount_prior_claims`, `stg_bcrs_crm_sr`.`parent_pct_same_rank_claims`, `stg_bcrs_crm_sr`.`parent_lgd`, `stg_bcrs_crm_sr`.`parent_maturity_date`, `stg_bcrs_crm_sr`.`own_estimated_haircut`, `stg_bcrs_crm_sr`.`flag_on_deposit`, `stg_bcrs_crm_sr`.`zero_haircut_eligible`, `stg_bcrs_crm_sr`.`securitization_only`, `stg_bcrs_crm_sr`.`repo_type`, `stg_bcrs_crm_sr`.`cardinality`, `stg_bcrs_crm_sr`.`restructuring`, `stg_bcrs_crm_sr`.`risk_type_mode`, `stg_bcrs_crm_sr`.`underlying_security_ref`, `stg_bcrs_crm_sr`.`flag_generic_2`, `stg_bcrs_crm_sr`.`materiality_threshold`, `stg_bcrs_crm_sr`.`rw_floor_generic_flag`, `stg_bcrs_crm_sr`.`flag_recognized_cre`, `stg_bcrs_crm_sr`.`floor2`, `stg_bcrs_crm_sr`.`guar_lgd_mitigation`, `stg_bcrs_crm_sr`.`overlapping_priority`, `stg_bcrs_crm_sr`.`scenario_id`, `stg_bcrs_crm_sr`.`crm_eligibility`, `stg_bcrs_crm_sr`.`crm_rank`, `stg_bcrs_crm_sr`.`col_family`, `stg_bcrs_crm_sr`.`rw`, `stg_bcrs_crm_sr`.`residual_maturity`, `stg_bcrs_crm_sr`.`contract_reference`, `stg_bcrs_crm_sr`.`sub_reference`, `stg_bcrs_crm_sr`.`table_name`, `stg_bcrs_crm_sr`.`method`, `stg_bcrs_crm_sr`.`bs_type`, `stg_bcrs_crm_sr`.`counterparty`, `stg_bcrs_crm_sr`.`contract_type`, `stg_bcrs_crm_sr`.`bis_product_type`, `stg_bcrs_crm_sr`.`bis_product_category`, `stg_bcrs_crm_sr`.`asset_class`, `stg_bcrs_crm_sr`.`pd`, `stg_bcrs_crm_sr`.`nominal`, `stg_bcrs_crm_sr`.`lgd`, `stg_bcrs_crm_sr`.`risk_bucket`, `stg_bcrs_crm_sr`.`risk_type`, `stg_bcrs_crm_sr`.`haircut_risk_bucket`, `stg_bcrs_crm_sr`.`eligibility_risk_bucket`, `stg_bcrs_crm_sr`.`revaluation_frequency`, `stg_bcrs_crm_sr`.`holding_period`, `stg_bcrs_crm_sr`.`underlying_maturity`, `stg_bcrs_crm_sr`.`maturity_date`, `stg_bcrs_crm_sr`.`start_date`, `stg_bcrs_crm_sr`.`book_code`, `stg_bcrs_crm_sr`.`family`, `stg_bcrs_crm_sr`.`exchange_rate`, `stg_bcrs_crm_sr`.`inter_company`, `stg_bcrs_crm_sr`.`attribute_1`, `stg_bcrs_crm_sr`.`attribute_2`, `stg_bcrs_crm_sr`.`attribute_3`, `stg_bcrs_crm_sr`.`attribute_4`, `stg_bcrs_crm_sr`.`attribute_5`, `stg_bcrs_crm_sr`.`attribute_6`, `stg_bcrs_crm_sr`.`attribute_7`, `stg_bcrs_crm_sr`.`attribute_8`, `stg_bcrs_crm_sr`.`attribute_9`, `stg_bcrs_crm_sr`.`amount_1`, `stg_bcrs_crm_sr`.`amount_2`, `stg_bcrs_crm_sr`.`hc_eff`, `stg_bcrs_crm_sr`.`guar_management`, `stg_bcrs_crm_sr`.`bis_key_analysis_id`, `stg_bcrs_crm_sr`.`cover_principal_only`, `stg_bcrs_crm_sr`.`flag_issued_by_the_bank`, `stg_bcrs_crm_sr`.`issuer_guarantor`, `stg_bcrs_crm_sr`.`import_source`, `stg_bcrs_crm_sr`.`allocable_amount`, `stg_bcrs_crm_sr`.`lgd_internal_rating`, `stg_bcrs_crm_sr`.`standard_rw`, `stg_bcrs_crm_sr`.`first_loss`, `stg_bcrs_crm_sr`.`seniority`, `stg_bcrs_crm_sr`.`flag_generic`, `stg_bcrs_crm_sr`.`crm_location`, `stg_bcrs_crm_sr`.`reference_seniority`, `stg_bcrs_crm_sr`.`first_lien`, `stg_bcrs_crm_sr`.`occupied_or_rented`, `stg_bcrs_crm_sr`.`completed`, `stg_bcrs_crm_sr`.`uncorelated_mv_borrower`, `stg_bcrs_crm_sr`.`uncorelated_borrower_mv`, `stg_bcrs_crm_sr`.`damage_insurance`, `stg_bcrs_crm_sr`.`legal_certainty`, `stg_bcrs_crm_sr`.`independant_valuer`, `stg_bcrs_crm_sr`.`mortgage_lending_value`, `stg_bcrs_crm_sr`.`assigned_amount`, `stg_bcrs_crm_sr`.`collateral_portion`, `stg_bcrs_crm_sr`.`asset_class_category`, `stg_bcrs_crm_sr`.`sub_type`, `stg_bcrs_crm_sr`.`mn_rank`, `stg_bcrs_crm_sr`.`mn_nominal`, `stg_bcrs_crm_sr`.`mn_prudential_apc`, `stg_bcrs_crm_sr`.`mn_external_deal`, `stg_bcrs_crm_sr`.`lgd_rating_agency`, `stg_bcrs_crm_sr`.`flag_fictive`, `stg_bcrs_crm_sr`.`elg_risk_bucket_int`, `stg_bcrs_crm_sr`.`benef_category`, `stg_bcrs_crm_sr`.`actual_rating_agency`, `stg_bcrs_crm_sr`.`actual_rating`, `stg_bcrs_crm_sr`.`flag_adjustment`, `stg_bcrs_crm_sr`.`guar_management_adv`, `stg_bcrs_crm_sr`.`guar_lgd_adv`, `stg_bcrs_crm_sr`.`guar_lgd_adv_pre_stress`, `stg_bcrs_crm_sr`.`k_function_used`, `stg_bcrs_crm_sr`.`re_recast`, `stg_bcrs_crm_sr`.`audit_crm_eligibility`, `stg_bcrs_crm_sr`.`booking_company`, `stg_bcrs_crm_sr`.`payout_option`, `stg_bcrs_crm_sr`.`crm_location_currency`, `stg_bcrs_crm_sr`.`std_risk_bucket`, `stg_bcrs_crm_sr`.`pd_pre_floor`, `stg_bcrs_crm_sr`.`lgd_pre_stress`, `stg_bcrs_crm_sr`.`fi_type`, `stg_bcrs_crm_sr`.`rw_floor`, `stg_bcrs_crm_sr`.`sov_rating_used`, `stg_bcrs_crm_sr`.`internal_rating_code`, `stg_bcrs_crm_sr`.`internal_rating_agency`, `stg_bcrs_crm_sr`.`external_rating_code`, `stg_bcrs_crm_sr`.`external_rating_agency`, `stg_bcrs_crm_sr`.`bankruptcy_remote`, `stg_bcrs_crm_sr`.`margin_type`, `stg_bcrs_crm_sr`.`margin_agreement`, `stg_bcrs_crm_sr`.`rw_pre_floor`, `stg_bcrs_crm_sr`.`sov_rw_floor`, `stg_bcrs_crm_sr`.`clearing_house_code`, `stg_bcrs_crm_sr`.`qualifying_ccp`, `stg_bcrs_crm_sr`.`qualifying_transaction`, `stg_bcrs_crm_sr`.`clearing_member`, `stg_bcrs_crm_sr`.`audit_crm_eligibility_sa`, `stg_bcrs_crm_sr`.`w_snapshot_dt`, `stg_bcrs_crm_sr`.`w_datasource_id`, `stg_bcrs_crm_sr`.`w_country_cd`, `stg_bcrs_crm_sr`.`w_batch_id`, ROW_NUMBER() OVER( partition by `stg_bcrs_crm_sr`.`contract_reference` ) AS `rnk`  FROM `sgmisitstg`.`stg_bcrs_crm_sr`   where CASE WHEN 'WS9' like '%ADJ%' THEN `stg_bcrs_crm_sr`.`w_batch_id` = '2021110220352300104' ELSE `stg_bcrs_crm_sr`.`w_batch_id` = '2021110812475100333' END   ) `crmsr`  on (CASE WHEN `tcdr`.`tranche_collateral_type` = 'COLLATERALIZED' then `tcdr`.`collateral_reference`                 WHEN `tcdr`.`tranche_guarantee_type` = 'GUARANTEED' then `tcdr`.`guarantee_reference`                 ELSE Null End ) = `crmsr`.`contract_reference`         and `crmsr`.`rnk`=1   LEFT JOIN (select `tbl`.`contract_reference`, `tbl`.`product_type`, `tbl`.`rnk` from (  select `sgmi_retail_exposure_f`.`contract_reference`, `sgmi_retail_exposure_f`.`product_type`, row_number() over(partition by `sgmi_retail_exposure_f`.`contract_reference`) `rnk`   from `sgmisit`.`SGMI_RETAIL_EXPOSURE_F` where `sgmi_retail_exposure_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_retail_exposure_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_retail_exposure_f`.`w_country_cd`='ALL')   `tbl` where `tbl`.`rnk`=1) `RETAIL_EXP` ON `retail_exp`.`contract_reference`=`tcdr`.`contract_reference`        LEFT JOIN `sgmisit`.`SGMI_CTCODE_PRODUCT_LINKAGE_DAT` `PROD_LINK` ON `tcdr`.`contract_type`=`prod_link`.`ct_code_user`  LEFT JOIN (SELECT `lt`.`client_id` `CLIENT_ID`, `lt`.`limit_id` `LIMIT_ID`, `lt`.`limit_id_trim` `LIMIT_ID_TRIM`, `lt`.`product_cd` `PRODUCT_CD`,ROW_NUMBER() OVER (PARTITION BY `lt`.`client_id`, `lt`.`product_cd`) `RN` FROM (SELECT   CASE WHEN trim(`sgmi_client_limit_f`.`client_id`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})-(\\d{1,2})$' OR trim(`sgmi_client_limit_f`.`client_id`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})$' THEN   regexp_replace( regexp_replace(trim(`sgmi_client_limit_f`.`client_id`),'^(SME)(\\w{0,4})-','') ,'-(\\d{1,2})$','') WHEN `sgmi_client_limit_f`.`client_id` regexp '^(\\d{8})$' OR `sgmi_client_limit_f`.`client_id` regexp '^(\\d{8})-(\\d{1,2})$' THEN   regexp_replace(`sgmi_client_limit_f`.`client_id`,'-(\\d{1,2})$','') ELSE   trim(`sgmi_client_limit_f`.`client_id`) END `Client_id`, `sgmi_client_limit_f`.`limit_id`, `sgmi_client_limit_f`.`limit_id_trim`, `sgmi_client_limit_f`.`product_cd`  FROM `sgmisit`.`SGMI_CLIENT_LIMIT_F` WHERE `sgmi_client_limit_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_client_limit_f`.`w_datasource_id`='BCRS_PRA')`LT` ) `DERIVED_LT`   ON `derived_lt`.`client_id`=CASE WHEN trim(`tcdr`.`counterparty_original`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})-(\\d{1,2})$' OR trim(`tcdr`.`counterparty_original`) regexp '^(SME)(\\w{0,4})-(\\d{1,8})$' THEN   regexp_replace( regexp_replace(trim(`tcdr`.`counterparty_original`),'^(SME)(\\w{0,4})-','') ,'-(\\d{1,2})$','') WHEN `tcdr`.`counterparty_original` regexp '^(\\d{8})$' OR `tcdr`.`counterparty_original` regexp '^(\\d{8})-(\\d{1,2})$' THEN   regexp_replace(`tcdr`.`counterparty_original`,'-(\\d{1,2})$','') ELSE   trim(`tcdr`.`counterparty_original`) END AND `derived_lt`.`product_cd`=`prod_link`.`lt_product_cd` and `derived_lt`.`rn` = 1       WHERE          `tcdr`.`w_batch_id` = '2021110812475100333'
CREATE VIEW `temp_src_query_2111091743430093395` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`, case when `comb`.`booking_loc_id`='SG' OR   IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`) in ('SG','UNMAPPED') OR   `lmt_ref`.`edm_limit_booking_loc` ='SG' then 'SG' else 'OTHERS' end AS `SECURITY_CTRY`, case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`) `ccr_eq_cntry`,  `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-06-30' AND `exp_f`.`w_datasource_id` = 'BCRS_ND' AND `exp_f`.`w_country_cd` =  'SG' AND `exp_f`.`w_workspace` = 'WS36'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-06-30' AND `lmt_f`.`w_datasource_id` = 'BCRS_ND' AND `lmt_f`.`w_country_cd` =  'SG'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-06-30' AND `col_f`.`w_datasource_id` = 'BCRS_ND' AND `col_f`.`w_country_cd` =  'SG' AND `col_f`.`w_workspace` = split('WS36','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-06-30' AND `lmt_ref`.`w_datasource_id` = 'BCRS_ND' AND `lmt_ref`.`w_country_cd` =  'SG'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-06-30' AND `col_ref`.`w_datasource_id` = 'BCRS_ND' AND `col_ref`.`w_country_cd` =  'SG' AND `col_ref`.`w_workspace` = split('WS36','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-06-30' AND `obl`.`w_datasource_id`='BCRS_ND' AND `obl`.`w_country_cd`='SG'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-06-30' AND `gua`.`w_datasource_id`='BCRS_ND' AND `obl`.`w_country_cd`='SG'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-06-30' AND `client`.`w_datasource_id`='BCRS_ND' AND `client`.`w_country_cd`='SG'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-06-30' AND `limit_cl`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-06-30' AND `coll_owner`.`w_datasource_id` = 'BCRS_ND'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-06-30' AND `br`.`w_datasource_id` = 'BCRS_ND'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_ND'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-06-30' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-06-30' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-06-30' and `exc_rate_usd`.`w_datasource_id`='BCRS_ND' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_ND' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_ND' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='SG'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-06-30'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-06-30' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-06-30' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-06-30'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021110820244600494'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-06-30' AND `comb`.`w_datasource_id` = 'BCRS_ND' AND `comb`.`w_country_cd` =  'SG' AND `comb`.`w_workspace`='WS36'     AND (`comb`.`booking_loc_id`='SG' OR  IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`)  IN ('SG') OR    `lmt_ref`.`edm_limit_booking_loc` ='SG')
CREATE VIEW `temp_src_query_2111100652170074509` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`,  case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `SECURITY_CTRY`,  case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `ccr_eq_cntry`, `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-06-30' AND `exp_f`.`w_datasource_id` = 'BCRS_RC' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS42'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-06-30' AND `lmt_f`.`w_datasource_id` = 'BCRS_RC' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-06-30' AND `col_f`.`w_datasource_id` = 'BCRS_RC' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS42','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-06-30' AND `lmt_ref`.`w_datasource_id` = 'BCRS_RC' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-06-30' AND `col_ref`.`w_datasource_id` = 'BCRS_RC' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS42','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-06-30' AND `obl`.`w_datasource_id`='BCRS_RC' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-06-30' AND `gua`.`w_datasource_id`='BCRS_RC' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-06-30' AND `client`.`w_datasource_id`='BCRS_RC' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-06-30' AND `limit_cl`.`w_datasource_id` = 'BCRS_RC'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-06-30' AND `coll_owner`.`w_datasource_id` = 'BCRS_RC'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-06-30' AND `br`.`w_datasource_id` = 'BCRS_RC'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_RC'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-06-30' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_RC'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-06-30' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_RC'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-06-30' and `exc_rate_usd`.`w_datasource_id`='BCRS_RC' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_RC' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_RC' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-06-30'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-06-30' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-06-30' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-06-30'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021110920231500477'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-06-30' AND `comb`.`w_datasource_id` = 'BCRS_RC' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS42'
CREATE VIEW `temp_src_query_2111110732320088844` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`,  case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `SECURITY_CTRY`,  case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `ccr_eq_cntry`, `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-06-30' AND `exp_f`.`w_datasource_id` = 'BCRS_RC' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS43'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-06-30' AND `lmt_f`.`w_datasource_id` = 'BCRS_RC' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-06-30' AND `col_f`.`w_datasource_id` = 'BCRS_RC' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS43','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-06-30' AND `lmt_ref`.`w_datasource_id` = 'BCRS_RC' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-06-30' AND `col_ref`.`w_datasource_id` = 'BCRS_RC' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS43','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-06-30' AND `obl`.`w_datasource_id`='BCRS_RC' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-06-30' AND `gua`.`w_datasource_id`='BCRS_RC' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-06-30' AND `client`.`w_datasource_id`='BCRS_RC' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-06-30' AND `limit_cl`.`w_datasource_id` = 'BCRS_RC'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-06-30' AND `coll_owner`.`w_datasource_id` = 'BCRS_RC'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-06-30' AND `br`.`w_datasource_id` = 'BCRS_RC'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_RC'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-06-30' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_RC'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-06-30' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_RC'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-06-30' and `exc_rate_usd`.`w_datasource_id`='BCRS_RC' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_RC' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_RC' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-06-30'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-06-30' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-06-30' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-06-30'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021110920231500477'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-06-30' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-06-30' AND `comb`.`w_datasource_id` = 'BCRS_RC' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS43'
CREATE VIEW `temp_src_query_2111260001520054848` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`,  case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `SECURITY_CTRY`,  case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `ccr_eq_cntry`, `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-08-31' AND `exp_f`.`w_datasource_id` = 'BCRS_PRA' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS7'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-08-31' AND `lmt_f`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-08-31' AND `col_f`.`w_datasource_id` = 'BCRS_PRA' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS7','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-08-31' AND `lmt_ref`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-08-31' AND `col_ref`.`w_datasource_id` = 'BCRS_PRA' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS7','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-08-31' AND `obl`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-08-31' AND `gua`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-08-31' AND `client`.`w_datasource_id`='BCRS_PRA' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-08-31' AND `limit_cl`.`w_datasource_id` = 'BCRS_PRA'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-08-31' AND `coll_owner`.`w_datasource_id` = 'BCRS_PRA'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-08-31' AND `br`.`w_datasource_id` = 'BCRS_PRA'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_PRA'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-08-31' and `exc_rate_usd`.`w_datasource_id`='BCRS_PRA' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_PRA' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-08-31'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-08-31'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021112515482800734'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-08-31' AND `comb`.`w_datasource_id` = 'BCRS_PRA' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS7'
CREATE VIEW `temp_src_query_2111291616080055466` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`,  case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `SECURITY_CTRY`,  case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `ccr_eq_cntry`, `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-08-31' AND `exp_f`.`w_datasource_id` = 'BCRS_PRA' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS9'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-08-31' AND `lmt_f`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-08-31' AND `col_f`.`w_datasource_id` = 'BCRS_PRA' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS9','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-08-31' AND `lmt_ref`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-08-31' AND `col_ref`.`w_datasource_id` = 'BCRS_PRA' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS9','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-08-31' AND `obl`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-08-31' AND `gua`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-08-31' AND `client`.`w_datasource_id`='BCRS_PRA' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-08-31' AND `limit_cl`.`w_datasource_id` = 'BCRS_PRA'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-08-31' AND `coll_owner`.`w_datasource_id` = 'BCRS_PRA'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-08-31' AND `br`.`w_datasource_id` = 'BCRS_PRA'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_PRA'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-08-31' and `exc_rate_usd`.`w_datasource_id`='BCRS_PRA' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_PRA' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-08-31'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-08-31'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021112515482800734'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-08-31' AND `comb`.`w_datasource_id` = 'BCRS_PRA' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS9'
CREATE VIEW `temp_src_query_2111291820410088087` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`,  case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `SECURITY_CTRY`,  case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `ccr_eq_cntry`, `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-08-31' AND `exp_f`.`w_datasource_id` = 'BCRS_PRA' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS9'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-08-31' AND `lmt_f`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-08-31' AND `col_f`.`w_datasource_id` = 'BCRS_PRA' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS9','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-08-31' AND `lmt_ref`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-08-31' AND `col_ref`.`w_datasource_id` = 'BCRS_PRA' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS9','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-08-31' AND `obl`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-08-31' AND `gua`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-08-31' AND `client`.`w_datasource_id`='BCRS_PRA' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-08-31' AND `limit_cl`.`w_datasource_id` = 'BCRS_PRA'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-08-31' AND `coll_owner`.`w_datasource_id` = 'BCRS_PRA'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-08-31' AND `br`.`w_datasource_id` = 'BCRS_PRA'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_PRA'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-08-31' and `exc_rate_usd`.`w_datasource_id`='BCRS_PRA' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_PRA' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-08-31'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-08-31'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021112515482800734'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-08-31' AND `comb`.`w_datasource_id` = 'BCRS_PRA' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS9'
CREATE VIEW `temp_src_query_2112020418460082434` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`,  case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `SECURITY_CTRY`,  case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `ccr_eq_cntry`, `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-08-31' AND `exp_f`.`w_datasource_id` = 'BCRS_RC' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS42'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-08-31' AND `lmt_f`.`w_datasource_id` = 'BCRS_RC' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-08-31' AND `col_f`.`w_datasource_id` = 'BCRS_RC' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS42','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-08-31' AND `lmt_ref`.`w_datasource_id` = 'BCRS_RC' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-08-31' AND `col_ref`.`w_datasource_id` = 'BCRS_RC' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS42','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-08-31' AND `obl`.`w_datasource_id`='BCRS_RC' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-08-31' AND `gua`.`w_datasource_id`='BCRS_RC' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-08-31' AND `client`.`w_datasource_id`='BCRS_RC' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-08-31' AND `limit_cl`.`w_datasource_id` = 'BCRS_RC'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-08-31' AND `coll_owner`.`w_datasource_id` = 'BCRS_RC'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-08-31' AND `br`.`w_datasource_id` = 'BCRS_RC'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_RC'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_RC'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_RC'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-08-31' and `exc_rate_usd`.`w_datasource_id`='BCRS_RC' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_RC' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_RC' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-08-31'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-08-31'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021112512205200371'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-08-31' AND `comb`.`w_datasource_id` = 'BCRS_RC' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS42'
CREATE VIEW `temp_src_query_2112102003500000568` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`,  case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `SECURITY_CTRY`,  case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `ccr_eq_cntry`, `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-08-31' AND `exp_f`.`w_datasource_id` = 'BCRS_PRA' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS7'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-08-31' AND `lmt_f`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-08-31' AND `col_f`.`w_datasource_id` = 'BCRS_PRA' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS7','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-08-31' AND `lmt_ref`.`w_datasource_id` = 'BCRS_PRA' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-08-31' AND `col_ref`.`w_datasource_id` = 'BCRS_PRA' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS7','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-08-31' AND `obl`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-08-31' AND `gua`.`w_datasource_id`='BCRS_PRA' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-08-31' AND `client`.`w_datasource_id`='BCRS_PRA' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-08-31' AND `limit_cl`.`w_datasource_id` = 'BCRS_PRA'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-08-31' AND `coll_owner`.`w_datasource_id` = 'BCRS_PRA'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-08-31' AND `br`.`w_datasource_id` = 'BCRS_PRA'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_PRA'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_PRA'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-08-31' and `exc_rate_usd`.`w_datasource_id`='BCRS_PRA' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_PRA' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_PRA' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-08-31'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-08-31'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021121013364400613'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-08-31' AND `comb`.`w_datasource_id` = 'BCRS_PRA' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS7'
CREATE VIEW `temp_src_query_2112132256320059180` AS SELECT distinct                      `t`.`partition_key`,     'SME' as `banking_type`,     `t`.`method_new`,     `t`.`method_original`,     `t`.`contract_reference`,     `t`.`tranche_collateral_type`,     `t`.`tranche_guarantee_type`,     `t`.`counterparty_original`,     `e`.`entity_desc` AS `counterparty_original_desc`,     `t`.`counterparty_new`,     `t`.`counterparty_new_desc`,     `t`.`table_name`,     `t`.`bis_past_due`,     `t`.`contract_type`,     `ct`.`ct_desc_user` AS `contract_desc`,     `e`.`cf_indicator`,     (         CASE             WHEN upper(`t`.`counterparty_original`) LIKE '%_CORPORATE%'                  OR upper(`t`.`counterparty_original`) LIKE '%_BANK%'                  OR `t`.`counterparty_original` = '9999999999-1'                  OR `t`.`counterparty_original` = '9999999998-1'      THEN 'Y'             ELSE 'N'         END     ) AS `unmapped_ind`,     (         CASE             WHEN upper(`e`.`attribute_4`) = 'CN' THEN 'Y'             ELSE 'N'         END     ) AS `non_borrowing_ind`,     (         CASE  WHEN `contracttype`.`ct_code_user` is not null THEN 'PURCHASED_RECEIVABLE'             WHEN `t`.`contract_type` IN ( 'GMGMKTPTEQ' ) THEN 'PRIVATE_EQUITY'             WHEN `t`.`contract_type` IN ( 'GMGMKTAINV', 'GMGMKTANPL'  ) THEN 'ALT_INVST'             WHEN `e`.`et_code_user` IN (  'BSC23'  ) THEN 'DEV_ORG'    WHEN `e`.`et_code_user` IN (  'BSC16'  ) THEN 'MDB'             WHEN `e`.`et_code_user` IN (  'BSC24' ) THEN 'PERSONAL'             WHEN `e`.`scorecard_segment_code` IN (  'CFSC'   ) THEN 'SME'             WHEN `e`.`scorecard_segment_category` IN (  'F1'  ) THEN 'BANK'             WHEN `e`.`scorecard_segment_category` IN (  'F2', 'F3'  ) THEN 'NBFI'             WHEN `e`.`scorecard_segment_category` IN (  'S1' ) THEN 'SOV'    WHEN `e`.`scorecard_segment_category` IN (  'CRE', 'PF', 'SF' ) THEN 'SPECIALISED LENDING'             WHEN `e`.`scorecard_segment_category` IN (  'C1', 'C2', 'C3', 'C4', 'C5' ) THEN 'CORP'             ELSE 'CORP'         END     ) AS `segment_original`,     (         CASE             WHEN `t`.`table_name` IN (                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP',                 'CREDIT_DERIVATIVE','REPO_NETTING_VOL','COLLATERAL'             ) THEN 'T'             ELSE 'F'         END     ) AS `derivative_ind`,     `t`.`incorporation_country_original`,     `c`.`country_name`,     `t`.`dealbook`,     `t`.`booking_company_desc`,     `e`.`attribute_1` AS `scorecard_original`,     `t`.`internal_rating_new`,     `t`.`pd_new`,     `t`.`internal_rating_original`,     `t`.`pd_original`,     (         CASE             WHEN nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`method_new` = 'ADV'                  AND `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED' THEN 0.45             WHEN `t`.`import_source` like 'NONTP-%'                  AND `t`.`method_new` = 'ADV' THEN `t`.`exposure_attribute_7`              WHEN (                 ( `t`.`tranche_collateral_type` = 'COLLATERALIZED' )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') <> 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`lgd`             WHEN (                 (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'GUARANTEED'                 )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') = 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN cast(`t`.`exposure_attribute_7` as decimal(38,20))              ELSE 0         END     ) AS `lgd`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY',   'RETAIL_EXPOSURE'                  ) THEN `t`.`outstanding`             ELSE 0         END     ) AS `outstanding`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY',     'RETAIL_EXPOSURE'             ) THEN `t`.`accrued_interest`             ELSE 0         END     ) AS `accrued_interest`,     (         CASE             WHEN `t`.`table_name` IN (                 'FACILITY'             )                  AND `t`.`bs_type` = 'OFB' THEN `t`.`outstanding`             ELSE 0         END     ) AS `headroom`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN `t`.`fair_value`             ELSE 0         END     ) AS `mtm`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN (                         CASE                             WHEN `t`.`fair_value` > 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                     ELSE (                         CASE                             WHEN `t`.`fair_value` < 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                 END             )             ELSE 0         END     ) AS `replacement_cost`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`t`.`nominal`) *-1                     ELSE abs(`t`.`nominal`)                 END             )             ELSE 0         END     ) AS `notional`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN `t`.`add_on`             ELSE 0         END     ) AS `add_on`,     `t`.`ead`,     `t`.`rwa`,     `t`.`rwa_pre_crm`,     `t`.`el`,     `t`.`rgc`,     `t`.`ead_original`,     `t`.`tier1_deduction`,     `t`.`tier2_deduction`,     `t`.`ead_pre_ccf`,     `t`.`nominal`,     `t`.`fair_value`,     `t`.`ead_pro`,     `t`.`ead_pro_gen`,     nvl(`prrsr`.`prr`,0) `prr`,     ( round(`t`.`ead`,10) * round(`t`.`pd_original`,10) ) AS `wt_pd_original`,     ( round(`t`.`ead`,10) * round(`t`.`pd_new`,10) ) AS `wt_pd_new`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45 * round(`t`.`ead`,10)             WHEN `t`.`method_new` = 'ADV' THEN round(`t`.`lgd`,10) * round(`t`.`ead`,10)             ELSE 0         END     ) AS `wt_lgd`,     ( round(`t`.`ead`,10) * round(`t`.`k_maturity`,10) ) AS `wt_k_maturity`,     ( round(`t`.`ead`,10) * round(`t`.`residual_maturity`,10) ) AS `wt_residual_maturity`,     `t`.`total_annual_sales`,     `t`.`hfx`,     `t`.`hc`,     `t`.`he`,     `t`.`k_maturity`,     `t`.`facility_reference`,     `t`.`performing_status`,     `t`.`securitization_reference`,     `t`.`days_after_contractual_date`,     `t`.`risk_bucket`,     `t`.`delivery_type`,     `t`.`funding_ccy`,     coalesce( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr`.`currency`             ELSE `t`.`currency`         END     ),`t`.`currency`) AS `currency`,     `t`.`residual_maturity`,     `t`.`original_maturity`,     `t`.`ead_method`,     `t`.`ccf`,     `t`.`inter_company`,     `t`.`trading_book_type`,     `e`.`attribute_7` AS `customer_segment_code`,     `e`.`customer_segment_desc`,     `e`.`attribute_8` AS `customer_subsegment_code`,     `e`.`customer_subsegment_desc`,     `t`.`id`,     `t`.`import_source`,     `t`.`product_gl_criteria`,     `t`.`bs_type`,     `t`.`securitized`,     `t`.`risk_type`,     `t`.`bis_product`,     `t`.`bis_product_category`,     `t`.`bis_entity_type_new`,     `t`.`bis_entity_type_original`,     `t`.`asset_class_new`,     `t`.`asset_class_original`,     `t`.`netting_agreement_reference`,     `t`.`collateral_reference`,     `t`.`collateral_contract_type`,     `t`.`collateral_bis_product`,     `t`.`collateral_product_category`,     `t`.`guarantee_reference`,     `t`.`guarantee_contract_type`,     `t`.`guarantee_bis_product`,     `t`.`counterparty_type_new`,     `t`.`sub_method_new`,     `t`.`rw_scaling_factor`,     `t`.`rwa_scaling_factor`,     `t`.`exposure_attribute_7`,     `t`.`exposure_attribute_8`,     `t`.`exposure_attribute_9`,     `t`.`rw_original`,     `t`.`rw_new`,     `t`.`securitization_n`,     `t`.`crm_method`,     `t`.`division_code`,     `t`.`secu_ea_controlled`,     `t`.`secu_company_weight`,     `t`.`secu_bank_role`,     `t`.`obligor_grade_new`,     `t`.`standard_rw_original`,     `t`.`standard_rw_new`,     `t`.`cpty_group`,     `t`.`cpty_group_original`,     `t`.`bis_industry_sector_new`,     `t`.`bis_industry_sector_original`,     `t`.`bis_risk_area_new`,     `t`.`bis_risk_area_original`,     `t`.`incorporation_country_new`,     `t`.`int_rating_agency_new`,     `t`.`risk_country`,     `t`.`used_amount_facility`,     `t`.`beel`,     `t`.`uncommited`,          case when `csr`.`start_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0) - nvl(`t`.`original_maturity`,0)) * 365.25) as INT)) as date)     else `csr`.`start_date` end as `start_date`,       case when `csr`.`maturity_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0)) * 365.25) as INT)) as date)      else `csr`.`maturity_date` end as `maturity_date`,          `t`.`value_date`,     (         CASE             WHEN nvl(`t`.`residual_maturity`,0) <= 1               THEN '<=1yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 3 and nvl(`t`.`residual_maturity`,0) > 1  THEN '1-3yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 5 and nvl(`t`.`residual_maturity`,0) > 3  THEN '3-5yrs'             ELSE '>5yrs'         END     ) AS `maturity_range`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd`             ELSE 0         END     ) AS `tranche_lgd`,         CASE WHEN (`complink`.`mother_code` = '999C' or `complink`.`mother_code` = '976C') and `complink`.`child_code` is not null then 'SOLO'          ELSE 'SUBS' END `company_type`,     nvl(`mru_bus`.`mru_desc`,'UNMAPPED') AS `business`,     `inst`.`psgl_operating_unit` AS `psgl_operating_unit`,     `psgl`.`psgl_cust_class`,     (         CASE             WHEN `t`.`table_name` = 'TRANCHE'                  AND `t`.`bs_type` IN(                 'VIF','VIR'             ) THEN 'TRANCHE_FILTER'             WHEN `t`.`inter_company` = 'T' THEN 'INTERCOMPANY_FILTER'             ELSE 'BCRS'         END     )   AS `filter_type`,     (         CASE             WHEN `t`.`securitized` = 'T'   THEN 'SECURITIZED'             WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'             WHEN `t`.`trading_book_type` = 'T'                  AND `t`.`bis_product_category` IN(                 'REPO','DERIVATIVE','DERIVATIVE_OTC','CREDIT_DERIVATIVE'             ) THEN 'CCR'             WHEN `t`.`tranche_collateral_type` = 'COLLATERALIZED'                  AND `t`.`collateral_bis_product` IN(                 'REP_NET_COL','OTC_NET_COL'             ) THEN 'NETTING_BENEFIT'             ELSE 'FSA'         END     )  AS `fsa_exclusion_type`,     (         CASE             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_past_due` = 'T' THEN 'PAST_DUE_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`asset_class_new` = 'CLAIM_OTH_150'                 OR (                     (                         (                             `t`.`rw_original` >= 1.5                             OR `t`.`standard_rw_original` >= 1.5                         )                         AND NOT (                             (                                 `t`.`tranche_collateral_type` = 'COLLATERALIZED'                                 AND `t`.`crm_method` = 'SIM'                                 AND `t`.`collateral_product_category` = 'FINANCIAL_COL'                             )                             OR `t`.`tranche_guarantee_type` = 'GUARANTEED'                         )                     )                     OR `t`.`rw_new` >= 1.5                 )             ) THEN 'HIGH_RISK_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 ( `t`.`asset_class_new` LIKE '%EQT' )                 OR (                     `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                     AND `t`.`sub_reference` = 'MULTI NAME'                 )                 OR ( `t`.`risk_type` = 'RVR' )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` IN (                 'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE',                 'CLAIM_SEC_CRE',                 'CLAIM_FULL_SEC_RRE'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`collateral_bis_product` IN (                 'RRE_COL',                 'LEASING_CRE_COL',                 'CRE_COL',                 'LEASING_RRE_COL'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_COVERED_BOND' THEN 'COVERED_BONDS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_CIU' THEN 'COLLECTIVE_INV_UNDERTAKINGS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF',                 'CORP',                 'INSURANCE',                 'CORP_CF',                 'CORP_HVCRE',                 'CORP_IPRE',                 'CORP_OF',                 'CORP_PF',                 'EX_RETAIL',                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'SPE',                 'CORP_INT_GRP'             )                  AND (                 `t`.`risk_bucket` IN (                     30,                     31,                     32,                     33,                     34                 )                 OR `t`.`risk_bucket_original` IN (                     30,                     31,                     32,                     33,                     34                 )             ) THEN 'SHORT_TERM_CLAIMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SOV'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'RGLA',                 'RGLA_SOV',                 'RGLA_SOV_EU'             ) THEN 'REGIONAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'PSE',                 'PSE_BANK',                 'PSE_SOV'             ) THEN 'ADMIN_BODIES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'MDB',                 'MDB_PREF_0',                 'MDB_PREF_20'             ) THEN 'MULTILATERAL_DEVT_BANKS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SUPRA',                 'EIF',                 'SUPRA_100'             ) THEN 'INTL_ORGANIZATIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`bis_entity_type_new` IN (                     'SME',                     'SME_CF',                     'SME_HVCRE',                     'SME_IPRE',                     'SME_OF',                     'SME_PF',                     'CORP',                     'INSURANCE',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'CORP_INT_GRP'                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'INDIV',                 'SME_RETAIL'             )                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL'             WHEN `t`.`method_new` = 'STD' THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`bis_entity_type_new` NOT IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` = 'CLAIM_OTH_100'                 )                 AND (                     `t`.`bis_product_category` NOT IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 ( `t`.`asset_class_new` = 'CLAIM%EQT' )                 OR ( `t`.`asset_class_new` = 'CLAIM_CIU' )             ) THEN 'EQUITY_CLAIMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`asset_class_new` IN (                         'CLAIM_FULL_SEC_RRE',                         'CLAIM_SEC_RRE_LEASE',                         'CRE_COL',                         'CLAIM_SEC_CRE',                         'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE'                     )                     OR `t`.`collateral_bis_product` IN (                         'RRE_COL',                         'LEASING_RRE_COL',                         'LEASING_CRE_COL',                         'CRE_COL'                     )                 )                 AND `t`.`bis_entity_type_new` IN (                     'INDIV',                     'SME_RETAIL'                 )             ) THEN 'RETAIL_MORTGAGES'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_RETAIL_QUALIFYING_REVOLVING' THEN 'RETAIL_QRRE'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'INDIV'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_OTHER'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'SME_RETAIL'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_SME'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'FOU'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'ADV'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             ELSE 'OTHER_ITEMS'         END     ) AS `fsa004_asset_class`,     `t`.`secu_mode`,     `t`.`risk_bucket_original`,     `t`.`waterfall_seniority`,     `e`.`origination_country` AS `ccr_original`,     `enew`.`origination_country` AS `ccr_new`,     `t`.`stress_testing_scenario_id`,     `t`.`collateral_attribute_1`,     `t`.`collateral_attribute_9`,     `t`.`exposure_attribute_1`,     `t`.`exposure_attribute_6`,     `t`.`counterparty_new_attribute_1`,     `t`.`sub_reference`,     `t`.`sub_method_original`,     `t`.`int_rating_agency_original`,     `t`.`ead_formula`,     `t`.`booking_company`,     `t`.`obligor_grade_inf_new`,     `t`.`obligor_grade_sup_new`,     `t`.`incorporation_ccy_original`,     `t`.`incorporation_ccy_new`,  nvl(case when `ctp`.`l7_code` is NULL or `ctp`.`l7_code` = '' then (case when `gl`.`l7_code` is NULL or `gl`.`l7_code` = '' then `t`.`management_product` else `gl`.`l7_code` end ) else `ctp`.`l7_code`  end,'UNMAPPED') as `management_product`,      `bus_ind`.`business_identifier_desc` AS `business_identifier`,       CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_w_filter_type`,              CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_filter_type`,          `ct`.`attribute_2` AS `balance_category`,     nvl( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr_exch`.`exch_rate`             ELSE `cer`.`exch_rate`         END     ),`cer`.`exch_rate`) AS `exchange_rate`,     `fac`.`holdco_ind` AS `holding_company_ind`,     `fac`.`non_gam_ind` AS `non_gam_ind`,     `egroup_orig`.`group_cust_segment_code`,     `egroup_orig`.`group_cust_segment_desc`,     `t`.`original_cost`,     `t`.`premium_current`,     `t`.`security_positions_ref`,     `t`.`pd_pre_floor_new`,     `t`.`exposure_attribute_3`,     `t`.`exposure_attribute_4`,     `t`.`exposure_attribute_5`,     `t`.`counterparty_new_attribute_3`,     `t`.`counterparty_new_attribute_4`,     `t`.`collateral_attribute_7`,     `t`.`collateral_attribute_8`,     `e`.`long_term_rating_local_ccy` AS `internal_rating_local_ccy_orig`,     `t`.`past_due_int`,     `t`.`ead_pro_discount`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`ltv`             ELSE 0         END     ) AS `ltv`,     (         CASE             WHEN `bf`.`domicile_country_code` IS NOT NULL                  AND nvl(`e`.`bf_link_type`,'z') = 'BUYER_FINANCE' THEN 'Y'             ELSE 'N'         END     ) AS `buyer_finance_ind`,     `t`.`counterparty_ext_rat_code`,     `t`.`counterparty_ext_rat_agency`,     `t`.`counterparty_int_rat_code`,     `t`.`counterparty_int_rat_agency`,     `t`.`maturity_eff`,     `psgl`.`psgl_department` AS `psgl_department`,     `psgl`.`psgl_product` AS `psgl_product`,      `net`.`netting_type` AS `netting_agreement_type`,     `fac`.`contract_reference` AS `sub_limit_fac_reference`,     `fac`.`amount` AS `limit_amount`,     `fac`.`attribute_1` AS `limit_attribute`,      CASE WHEN round(nvl(`t2`.`sum_rwa`,0),2)  <= 0 THEN nvl(`tcva`.`cva_rwa`,0) / nvl(`t2`.`count_contract_ref`,0)          ELSE (nvl(`t`.`rwa`,0) / `t2`.`sum_rwa`) * nvl(`tcva`.`cva_rwa`,0)     END `cva_rwa`,             `t`.`qualifying_ccp`,     `t`.`k_function_used`,     `t`.`k_function_used_original`,     `t`.`product_gl_criteria_2`,     `t`.`bis_past_due_original`,     `t`.`risk_country_new`,     `t`.`risk_country_original`,     `t`.`booking_company_incorp_country`,     `t`.`ccf_std`,     `t`.`past_due_days`,     `t`.`guarantee_method`,     `t`.`fde_alternative_method`,     `t`.`rwa_pre_cap`,     `t`.`asset_class_category_new`,     `t`.`asset_class_category_original`        FROM ( SELECT `stg_bcrs_t_cdr`.`partition_key`, `stg_bcrs_t_cdr`.`stress_testing_scenario_id`, `stg_bcrs_t_cdr`.`tranche_collateral_type`, `stg_bcrs_t_cdr`.`tranche_guarantee_type`, `stg_bcrs_t_cdr`.`bs_type`, `stg_bcrs_t_cdr`.`contract_reference`, `stg_bcrs_t_cdr`.`contract_type`, `stg_bcrs_t_cdr`.`bis_product`, `stg_bcrs_t_cdr`.`bis_product_category`, `stg_bcrs_t_cdr`.`unconditionnaly_cancelable`, `stg_bcrs_t_cdr`.`ead_original`, `stg_bcrs_t_cdr`.`ead_pre_ccf`, `stg_bcrs_t_cdr`.`ead`, `stg_bcrs_t_cdr`.`ead_pro`, `stg_bcrs_t_cdr`.`facility_reference`, `stg_bcrs_t_cdr`.`collateral_reference`, `stg_bcrs_t_cdr`.`collateral_contract_type`, `stg_bcrs_t_cdr`.`collateral_bis_product`, `stg_bcrs_t_cdr`.`guarantee_reference`, `stg_bcrs_t_cdr`.`guarantee_contract_type`, `stg_bcrs_t_cdr`.`guarantee_bis_product`, `stg_bcrs_t_cdr`.`netting_agreement_reference`, `stg_bcrs_t_cdr`.`netting_agreement_type`, `stg_bcrs_t_cdr`.`counterparty_original`, `stg_bcrs_t_cdr`.`counterparty_type_original`, `stg_bcrs_t_cdr`.`counterparty_new`, `stg_bcrs_t_cdr`.`counterparty_type_new`, `stg_bcrs_t_cdr`.`total_annual_sales`, `stg_bcrs_t_cdr`.`total_annual_assets`, `stg_bcrs_t_cdr`.`bis_entity_type_original`, `stg_bcrs_t_cdr`.`bis_entity_type_new`, `stg_bcrs_t_cdr`.`asset_class_original`, `stg_bcrs_t_cdr`.`asset_class_new`, `stg_bcrs_t_cdr`.`method_original`, `stg_bcrs_t_cdr`.`sub_method_original`, `stg_bcrs_t_cdr`.`method_new`, `stg_bcrs_t_cdr`.`sub_method_new`, `stg_bcrs_t_cdr`.`guarantee_method`, `stg_bcrs_t_cdr`.`he`, `stg_bcrs_t_cdr`.`maturity_eff`, `stg_bcrs_t_cdr`.`k_maturity`, `stg_bcrs_t_cdr`.`pd_original`, `stg_bcrs_t_cdr`.`internal_rating_original`, `stg_bcrs_t_cdr`.`pd_new`, `stg_bcrs_t_cdr`.`internal_rating_new`, `stg_bcrs_t_cdr`.`lgd`, `stg_bcrs_t_cdr`.`lgd_grade_agency`, `stg_bcrs_t_cdr`.`ccf`, `stg_bcrs_t_cdr`.`hfx`, `stg_bcrs_t_cdr`.`hc`, `stg_bcrs_t_cdr`.`mm`, `stg_bcrs_t_cdr`.`floor1`, `stg_bcrs_t_cdr`.`floor2`, `stg_bcrs_t_cdr`.`rwa`, `stg_bcrs_t_cdr`.`rgc`, `stg_bcrs_t_cdr`.`rwa_pre_crm`, `stg_bcrs_t_cdr`.`el`, `stg_bcrs_t_cdr`.`beel`, `stg_bcrs_t_cdr`.`bis_past_due`, `stg_bcrs_t_cdr`.`performing_status`, `stg_bcrs_t_cdr`.`rw_scaling_factor`, `stg_bcrs_t_cdr`.`rwa_scaling_factor`, `stg_bcrs_t_cdr`.`equity_scaling_factor`, `stg_bcrs_t_cdr`.`exemption_maturity_floor`, `stg_bcrs_t_cdr`.`grand_fathering_applied`, `stg_bcrs_t_cdr`.`legislated_program_applied`, `stg_bcrs_t_cdr`.`non_material_equity`, `stg_bcrs_t_cdr`.`zero_rw_for_equity`, `stg_bcrs_t_cdr`.`zero_haircut_for_repo`, `stg_bcrs_t_cdr`.`k_function_used`, `stg_bcrs_t_cdr`.`ead_formula`, `stg_bcrs_t_cdr`.`risk_type`, `stg_bcrs_t_cdr`.`trading_book_type`, `stg_bcrs_t_cdr`.`table_name`, `stg_bcrs_t_cdr`.`exposure_attribute_1`, `stg_bcrs_t_cdr`.`exposure_attribute_2`, `stg_bcrs_t_cdr`.`exposure_attribute_3`, `stg_bcrs_t_cdr`.`exposure_attribute_4`, `stg_bcrs_t_cdr`.`exposure_attribute_5`, `stg_bcrs_t_cdr`.`exposure_attribute_6`, `stg_bcrs_t_cdr`.`exposure_attribute_7`, `stg_bcrs_t_cdr`.`exposure_attribute_8`, `stg_bcrs_t_cdr`.`exposure_attribute_9`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_1`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_2`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_3`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_4`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_5`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_6`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_7`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_8`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_9`, `stg_bcrs_t_cdr`.`collateral_attribute_1`, `stg_bcrs_t_cdr`.`collateral_attribute_2`, `stg_bcrs_t_cdr`.`collateral_attribute_3`, `stg_bcrs_t_cdr`.`collateral_attribute_4`, `stg_bcrs_t_cdr`.`collateral_attribute_5`, `stg_bcrs_t_cdr`.`collateral_attribute_6`, `stg_bcrs_t_cdr`.`collateral_attribute_7`, `stg_bcrs_t_cdr`.`collateral_attribute_8`, `stg_bcrs_t_cdr`.`collateral_attribute_9`, `stg_bcrs_t_cdr`.`guarantee_attribute_1`, `stg_bcrs_t_cdr`.`guarantee_attribute_2`, `stg_bcrs_t_cdr`.`guarantee_attribute_3`, `stg_bcrs_t_cdr`.`guarantee_attribute_4`, `stg_bcrs_t_cdr`.`guarantee_attribute_5`, `stg_bcrs_t_cdr`.`guarantee_attribute_6`, `stg_bcrs_t_cdr`.`guarantee_attribute_7`, `stg_bcrs_t_cdr`.`guarantee_attribute_8`, `stg_bcrs_t_cdr`.`guarantee_attribute_9`, `stg_bcrs_t_cdr`.`inter_company`, `stg_bcrs_t_cdr`.`rwa_pre_cap`, `stg_bcrs_t_cdr`.`rw_original`, `stg_bcrs_t_cdr`.`rw_new`, `stg_bcrs_t_cdr`.`tier1_deduction`, `stg_bcrs_t_cdr`.`tier2_deduction`, `stg_bcrs_t_cdr`.`securitized`, `stg_bcrs_t_cdr`.`seniority_original`, `stg_bcrs_t_cdr`.`seniority_new`, `stg_bcrs_t_cdr`.`collateral_product_category`, `stg_bcrs_t_cdr`.`dealbook`, `stg_bcrs_t_cdr`.`deal_status`, `stg_bcrs_t_cdr`.`sub_reference`, `stg_bcrs_t_cdr`.`securitization_reference`, `stg_bcrs_t_cdr`.`securitization_n`, `stg_bcrs_t_cdr`.`waterfall_seniority`, `stg_bcrs_t_cdr`.`risk_country`, `stg_bcrs_t_cdr`.`zone_a_original`, `stg_bcrs_t_cdr`.`zone_a_new`, `stg_bcrs_t_cdr`.`lgd_mitigation`, `stg_bcrs_t_cdr`.`crm_method`, `stg_bcrs_t_cdr`.`look_through_treatment`, `stg_bcrs_t_cdr`.`second_loss_treatment`, `stg_bcrs_t_cdr`.`risk_bucket`, `stg_bcrs_t_cdr`.`pool_code`, `stg_bcrs_t_cdr`.`incorporation_country`, `stg_bcrs_t_cdr`.`division_code`, `stg_bcrs_t_cdr`.`secu_loss_position`, `stg_bcrs_t_cdr`.`secu_issue_date`, `stg_bcrs_t_cdr`.`secu_ea_controlled`, `stg_bcrs_t_cdr`.`secu_company_weight`, `stg_bcrs_t_cdr`.`secu_bank_role`, `stg_bcrs_t_cdr`.`secu_mode`, `stg_bcrs_t_cdr`.`import_source`, `stg_bcrs_t_cdr`.`company_code`, `stg_bcrs_t_cdr`.`supervisor_code`, `stg_bcrs_t_cdr`.`ccy_code`, `stg_bcrs_t_cdr`.`settlement_price`, `stg_bcrs_t_cdr`.`days_after_contractual_date`, `stg_bcrs_t_cdr`.`delivery_type`, `stg_bcrs_t_cdr`.`mortgage_alternative`, `stg_bcrs_t_cdr`.`booking_company`, `stg_bcrs_t_cdr`.`booking_company_desc`, `stg_bcrs_t_cdr`.`gaap_code`, `stg_bcrs_t_cdr`.`number_of_obligor`, `stg_bcrs_t_cdr`.`security_positions_ref`, `stg_bcrs_t_cdr`.`guar_sub_reference`, `stg_bcrs_t_cdr`.`flag_adjustment`, `stg_bcrs_t_cdr`.`internal_maturity_class`, `stg_bcrs_t_cdr`.`equity_floor_applied`, `stg_bcrs_t_cdr`.`equity_preferential_treatment`, `stg_bcrs_t_cdr`.`fde_alternative_method`, `stg_bcrs_t_cdr`.`collateral_table_name`, `stg_bcrs_t_cdr`.`collateral_mode`, `stg_bcrs_t_cdr`.`funding_ccy`, `stg_bcrs_t_cdr`.`currency`, `stg_bcrs_t_cdr`.`incorporation_ccy_original`, `stg_bcrs_t_cdr`.`incorporation_ccy_new`, `stg_bcrs_t_cdr`.`credit_substitute`, `stg_bcrs_t_cdr`.`value_date`, `stg_bcrs_t_cdr`.`original_maturity`, `stg_bcrs_t_cdr`.`residual_maturity`, `stg_bcrs_t_cdr`.`booking_company_incorp_country`, `stg_bcrs_t_cdr`.`business_line_code`, `stg_bcrs_t_cdr`.`family`, `stg_bcrs_t_cdr`.`standard_rw_new`, `stg_bcrs_t_cdr`.`standard_rw_original`, `stg_bcrs_t_cdr`.`risk_bucket_original`, `stg_bcrs_t_cdr`.`collateral_assigned_amount`, `stg_bcrs_t_cdr`.`used_amount_facility`, `stg_bcrs_t_cdr`.`rwa_pre_floor_equity`, `stg_bcrs_t_cdr`.`bis_past_due_original`, `stg_bcrs_t_cdr`.`ltv`, `stg_bcrs_t_cdr`.`ltv_current`, `stg_bcrs_t_cdr`.`hr`, `stg_bcrs_t_cdr`.`hcr`, `stg_bcrs_t_cdr`.`und_pool_ref`, `stg_bcrs_t_cdr`.`asset_class_category_original`, `stg_bcrs_t_cdr`.`asset_class_category_new`, `stg_bcrs_t_cdr`.`netting_agreement_amount_1`, `stg_bcrs_t_cdr`.`netting_agreement_amount_2`, `stg_bcrs_t_cdr`.`netting_agreement_amount_3`, `stg_bcrs_t_cdr`.`netting_agreement_amount_4`, `stg_bcrs_t_cdr`.`netting_agreement_amount_5`, `stg_bcrs_t_cdr`.`netting_agreement_amount_6`, `stg_bcrs_t_cdr`.`netting_agreement_amount_7`, `stg_bcrs_t_cdr`.`entity_type_category_original`, `stg_bcrs_t_cdr`.`entity_type_category_new`, `stg_bcrs_t_cdr`.`ead_pro_write_off`, `stg_bcrs_t_cdr`.`ead_pro_discount`, `stg_bcrs_t_cdr`.`cpty_group`, `stg_bcrs_t_cdr`.`counterparty_new_desc`, `stg_bcrs_t_cdr`.`internal_rating_new_rank`, `stg_bcrs_t_cdr`.`uncommited`, `stg_bcrs_t_cdr`.`capital_item`, `stg_bcrs_t_cdr`.`product_gl_criteria`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_ori`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_new`, `stg_bcrs_t_cdr`.`secu_retail_line_fg`, `stg_bcrs_t_cdr`.`secu_uncommited_retail_fg`, `stg_bcrs_t_cdr`.`secu_spread_trapping_ratio`, `stg_bcrs_t_cdr`.`collateral_issuer`, `stg_bcrs_t_cdr`.`coll_issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`collateral_haircut_risk_bucket`, `stg_bcrs_t_cdr`.`guarantor`, `stg_bcrs_t_cdr`.`guarantor_bis_entity_type`, `stg_bcrs_t_cdr`.`ead_pro_gen`, `stg_bcrs_t_cdr`.`pd_pre_floor_original`, `stg_bcrs_t_cdr`.`pd_pre_floor_new`, `stg_bcrs_t_cdr`.`lgd_pre_floor_original`, `stg_bcrs_t_cdr`.`lgd_pre_floor_new`, `stg_bcrs_t_cdr`.`int_rating_agency_original`, `stg_bcrs_t_cdr`.`int_rating_agency_new`, `stg_bcrs_t_cdr`.`cpty_group_original`, `stg_bcrs_t_cdr`.`nominal`, `stg_bcrs_t_cdr`.`add_on`, `stg_bcrs_t_cdr`.`fair_value`, `stg_bcrs_t_cdr`.`amortized_cost`, `stg_bcrs_t_cdr`.`accrued_interest`, `stg_bcrs_t_cdr`.`amortized_cost_no_ias`, `stg_bcrs_t_cdr`.`adjustment_amount`, `stg_bcrs_t_cdr`.`outstanding`, `stg_bcrs_t_cdr`.`original_cost`, `stg_bcrs_t_cdr`.`accrued_fees`, `stg_bcrs_t_cdr`.`past_due_ppal`, `stg_bcrs_t_cdr`.`past_due_int`, `stg_bcrs_t_cdr`.`premium_current`, `stg_bcrs_t_cdr`.`cpty_new_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`cpty_orig_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`effective_epe`, `stg_bcrs_t_cdr`.`ead_method`, `stg_bcrs_t_cdr`.`netting_class`, `stg_bcrs_t_cdr`.`bis_industry_sector_new`, `stg_bcrs_t_cdr`.`bis_industry_sector_original`, `stg_bcrs_t_cdr`.`bis_risk_area_new`, `stg_bcrs_t_cdr`.`bis_risk_area_original`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_new`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_original`, `stg_bcrs_t_cdr`.`risk_country_new`, `stg_bcrs_t_cdr`.`risk_country_original`, `stg_bcrs_t_cdr`.`incorporation_country_new`, `stg_bcrs_t_cdr`.`incorporation_country_original`, `stg_bcrs_t_cdr`.`bis_performing_status`, `stg_bcrs_t_cdr`.`rwa_cap_ratio`, `stg_bcrs_t_cdr`.`exposure_amount_1`, `stg_bcrs_t_cdr`.`exposure_amount_2`, `stg_bcrs_t_cdr`.`final_beneficiary`, `stg_bcrs_t_cdr`.`collateral_valuation_date`, `stg_bcrs_t_cdr`.`unrestricted_psia_pct`, `stg_bcrs_t_cdr`.`restricted_psia_pct`, `stg_bcrs_t_cdr`.`collateral_issued_by_the_bank`, `stg_bcrs_t_cdr`.`guarantee_issued_by_the_bank`, `stg_bcrs_t_cdr`.`rated_borrower`, `stg_bcrs_t_cdr`.`long_short`, `stg_bcrs_t_cdr`.`external_rating_new`, `stg_bcrs_t_cdr`.`external_rating_original`, `stg_bcrs_t_cdr`.`external_rating_agency_new`, `stg_bcrs_t_cdr`.`external_rating_agency_orig`, `stg_bcrs_t_cdr`.`collateral_country`, `stg_bcrs_t_cdr`.`issuer`, `stg_bcrs_t_cdr`.`issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`issuer_country`, `stg_bcrs_t_cdr`.`product_gl_criteria_2`, `stg_bcrs_t_cdr`.`positions_type`, `stg_bcrs_t_cdr`.`eligibility_risk_bucket`, `stg_bcrs_t_cdr`.`retail_purpose`, `stg_bcrs_t_cdr`.`color_id`, `stg_bcrs_t_cdr`.`past_due_days`, `stg_bcrs_t_cdr`.`collateral_asset_class`, `stg_bcrs_t_cdr`.`collateral_standard_rw`, `stg_bcrs_t_cdr`.`collateral_asset_class_cat`, `stg_bcrs_t_cdr`.`collateral_risk_bucket`, `stg_bcrs_t_cdr`.`coll_issuer_incorporation_ccy`, `stg_bcrs_t_cdr`.`fund_composition_ref`, `stg_bcrs_t_cdr`.`secu_retention_percentage`, `stg_bcrs_t_cdr`.`secu_retention_calc_method`, `stg_bcrs_t_cdr`.`rw_add_on`, `stg_bcrs_t_cdr`.`lgd_non_performing`, `stg_bcrs_t_cdr`.`ccf_std`, `stg_bcrs_t_cdr`.`concentration_ratio`, `stg_bcrs_t_cdr`.`ttc_lgd`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_code`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_agency`, `stg_bcrs_t_cdr`.`counterparty_int_rat_code`, `stg_bcrs_t_cdr`.`counterparty_int_rat_agency`, `stg_bcrs_t_cdr`.`gl_strategy_code`, `stg_bcrs_t_cdr`.`k_function_used_original`, `stg_bcrs_t_cdr`.`long_gross_position`, `stg_bcrs_t_cdr`.`short_gross_position`, `stg_bcrs_t_cdr`.`correlation_trading`, `stg_bcrs_t_cdr`.`ead_pro_pre_ccf`, `stg_bcrs_t_cdr`.`ead_pro_write_off_pre_ccf`, `stg_bcrs_t_cdr`.`sup_reg_vers_code`, `stg_bcrs_t_cdr`.`dataset_version`, `stg_bcrs_t_cdr`.`clearing_house_code`, `stg_bcrs_t_cdr`.`contract_maturity_eff`, `stg_bcrs_t_cdr`.`counterparty_code_2`, `stg_bcrs_t_cdr`.`qualifying_transaction`, `stg_bcrs_t_cdr`.`qualifying_ccp`, `stg_bcrs_t_cdr`.`sov_rating_used`, `stg_bcrs_t_cdr`.`sov_rating_used_ori`, `stg_bcrs_t_cdr`.`current_ead_imm`, `stg_bcrs_t_cdr`.`current_maturity_eff_imm`, `stg_bcrs_t_cdr`.`obligor_grade_original`, `stg_bcrs_t_cdr`.`obligor_grade_new`, `stg_bcrs_t_cdr`.`deduction_step`, `stg_bcrs_t_cdr`.`significant_investment`, `stg_bcrs_t_cdr`.`el_std`, `stg_bcrs_t_cdr`.`deduction_pct`, `stg_bcrs_t_cdr`.`indirect_position`, `stg_bcrs_t_cdr`.`std_risk_bucket_ori`, `stg_bcrs_t_cdr`.`std_risk_bucket_new`, `stg_bcrs_t_cdr`.`ccp_dfund_method`, `stg_bcrs_t_cdr`.`secu_underlying_asset_type`, `stg_bcrs_t_cdr`.`margin_period`, `stg_bcrs_t_cdr`.`ead_scalar`, `stg_bcrs_t_cdr`.`crm_first_lien`, `stg_bcrs_t_cdr`.`available_amount`, `stg_bcrs_t_cdr`.`accounting_adjustment_type`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_1`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_2`, `stg_bcrs_t_cdr`.`adjusted_value`, `stg_bcrs_t_cdr`.`ead_before_acc_adj`, `stg_bcrs_t_cdr`.`lgd_before_acc_adj`, `stg_bcrs_t_cdr`.`subset_code`, `stg_bcrs_t_cdr`.`el_rwa_part`, `stg_bcrs_t_cdr`.`industry_sector_original`, `stg_bcrs_t_cdr`.`cds_qualifying`, `stg_bcrs_t_cdr`.`default_date`, `stg_bcrs_t_cdr`.`credit_bureau_name_original`, `stg_bcrs_t_cdr`.`credit_bureau_name_refreshed`, `stg_bcrs_t_cdr`.`fico_original`, `stg_bcrs_t_cdr`.`fico_refreshed`, `stg_bcrs_t_cdr`.`pool_ead_formula`, `stg_bcrs_t_cdr`.`clearing_member`, `stg_bcrs_t_cdr`.`securitization_depth`, `stg_bcrs_t_cdr`.`securitization_loop`, `stg_bcrs_t_cdr`.`bankruptcy_remote`, `stg_bcrs_t_cdr`.`margin_type`, `stg_bcrs_t_cdr`.`collateral_bankruptcy_remote`, `stg_bcrs_t_cdr`.`collateral_margin_type`, `stg_bcrs_t_cdr`.`remargining_frequency`, `stg_bcrs_t_cdr`.`settlement_ccy`, `stg_bcrs_t_cdr`.`vm_extinguishes_mtm`, `stg_bcrs_t_cdr`.`margin_agreement`, `stg_bcrs_t_cdr`.`rw_pre_floor_new`, `stg_bcrs_t_cdr`.`rwa_pre_floor`, `stg_bcrs_t_cdr`.`ccp_exposure_type`, `stg_bcrs_t_cdr`.`carrying_amount`, `stg_bcrs_t_cdr`.`exchange_rate`, `stg_bcrs_t_cdr`.`policy_update`, `stg_bcrs_t_cdr`.`methodology_update`, `stg_bcrs_t_cdr`.`model_update`, `stg_bcrs_t_cdr`.`pd_model_update`, `stg_bcrs_t_cdr`.`lgd_model_update`, `stg_bcrs_t_cdr`.`ccf_model_update`, `stg_bcrs_t_cdr`.`ead_model_update`, `stg_bcrs_t_cdr`.`covered_ead`, `stg_bcrs_t_cdr`.`fi_type`, `stg_bcrs_t_cdr`.`maturity_date`, `stg_bcrs_t_cdr`.`policy_name`, `stg_bcrs_t_cdr`.`methodology_name`, `stg_bcrs_t_cdr`.`model_name`, `stg_bcrs_t_cdr`.`fund_reference`, `stg_bcrs_t_cdr`.`fund_method`, `stg_bcrs_t_cdr`.`fund_depth`, `stg_bcrs_t_cdr`.`fund_initial`, `stg_bcrs_t_cdr`.`rwa_pre_lvr`, `stg_bcrs_t_cdr`.`leverage`, `stg_bcrs_t_cdr`.`rw_el`, `stg_bcrs_t_cdr`.`use_beel`, `stg_bcrs_t_cdr`.`k_ratio`, `stg_bcrs_t_cdr`.`trade_date`, `stg_bcrs_t_cdr`.`sme_ceiling`, `stg_bcrs_t_cdr`.`sme_floor`, `stg_bcrs_t_cdr`.`sme_ceiling_indicator`, `stg_bcrs_t_cdr`.`fund_assets`, `stg_bcrs_t_cdr`.`obligor_grade_rank_original`, `stg_bcrs_t_cdr`.`obligor_grade_sup_original`, `stg_bcrs_t_cdr`.`obligor_grade_inf_original`, `stg_bcrs_t_cdr`.`obligor_grade_rank_new`, `stg_bcrs_t_cdr`.`obligor_grade_sup_new`, `stg_bcrs_t_cdr`.`obligor_grade_inf_new`, `stg_bcrs_t_cdr`.`lgd_grade_inf`, `stg_bcrs_t_cdr`.`lgd_grade_sup`, `stg_bcrs_t_cdr`.`lgd_grade_rank`, `stg_bcrs_t_cdr`.`lgd_grade`, `stg_bcrs_t_cdr`.`conservation_buffer`, `stg_bcrs_t_cdr`.`conservation_rgc`, `stg_bcrs_t_cdr`.`ctcycal_buffer`, `stg_bcrs_t_cdr`.`ctcycal_rgc`, `stg_bcrs_t_cdr`.`sifi_buffer`, `stg_bcrs_t_cdr`.`sifi_rgc`, `stg_bcrs_t_cdr`.`leverage_ead`, `stg_bcrs_t_cdr`.`at1_deduction`, `stg_bcrs_t_cdr`.`cet1_deduction`, `stg_bcrs_t_cdr`.`adjustment_tag`, `stg_bcrs_t_cdr`.`rw_new_grouping`, `stg_bcrs_t_cdr`.`nominal_at_rw_new`, `stg_bcrs_t_cdr`.`ead_at_rw_new`, `stg_bcrs_t_cdr`.`collateral_completed`, `stg_bcrs_t_cdr`.`rep_product`, `stg_bcrs_t_cdr`.`rep_collateral_product`, `stg_bcrs_t_cdr`.`ltv_indexed`, `stg_bcrs_t_cdr`.`origination_date`, `stg_bcrs_t_cdr`.`is_le`, `stg_bcrs_t_cdr`.`rep_industry_sector`, `stg_bcrs_t_cdr`.`scenario_process_step`, `stg_bcrs_t_cdr`.`period_id`, `stg_bcrs_t_cdr`.`period_start_date`, `stg_bcrs_t_cdr`.`period_end_date`, `stg_bcrs_t_cdr`.`scenario_process_name`, `stg_bcrs_t_cdr`.`scenario_process_id`, `stg_bcrs_t_cdr`.`regulatory_scenario_name`, `stg_bcrs_t_cdr`.`rep_asset_class`, `stg_bcrs_t_cdr`.`rep_sub_product`, `stg_bcrs_t_cdr`.`rep_arrears_band_mia`, `stg_bcrs_t_cdr`.`rep_arrears_band_pia`, `stg_bcrs_t_cdr`.`rep_payment_type`, `stg_bcrs_t_cdr`.`weighted_avg_rate`, `stg_bcrs_t_cdr`.`customer_field11`, `stg_bcrs_t_cdr`.`customer_field12`, `stg_bcrs_t_cdr`.`customer_field13`, `stg_bcrs_t_cdr`.`customer_field14`, `stg_bcrs_t_cdr`.`customer_field15`, `stg_bcrs_t_cdr`.`customer_field16`, `stg_bcrs_t_cdr`.`customer_field17`, `stg_bcrs_t_cdr`.`customer_field18`, `stg_bcrs_t_cdr`.`customer_field19`, `stg_bcrs_t_cdr`.`customer_field20`, `stg_bcrs_t_cdr`.`customer_field21`, `stg_bcrs_t_cdr`.`customer_number11`, `stg_bcrs_t_cdr`.`customer_number12`, `stg_bcrs_t_cdr`.`customer_number13`, `stg_bcrs_t_cdr`.`customer_number14`, `stg_bcrs_t_cdr`.`customer_number15`, `stg_bcrs_t_cdr`.`customer_number16`, `stg_bcrs_t_cdr`.`customer_number17`, `stg_bcrs_t_cdr`.`customer_number18`, `stg_bcrs_t_cdr`.`customer_date1`, `stg_bcrs_t_cdr`.`customer_date2`, `stg_bcrs_t_cdr`.`customer_date3`, `stg_bcrs_t_cdr`.`rep_major_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_major_asset_class_new`, `stg_bcrs_t_cdr`.`rep_asset_class_new`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_new`, `stg_bcrs_t_cdr`.`rep_maturity_band`, `stg_bcrs_t_cdr`.`rep_segmentation`, `stg_bcrs_t_cdr`.`src_reporting_date`, `stg_bcrs_t_cdr`.`src_wks_name`, `stg_bcrs_t_cdr`.`src_position`, `stg_bcrs_t_cdr`.`generic_reporting_date`, `stg_bcrs_t_cdr`.`generic_wks_name`, `stg_bcrs_t_cdr`.`generic_position`, `stg_bcrs_t_cdr`.`securitization_mm`, `stg_bcrs_t_cdr`.`securitization_mm_factor`, `stg_bcrs_t_cdr`.`is_eligible_cva`, `stg_bcrs_t_cdr`.`audit_cva_eligibility`, `stg_bcrs_t_cdr`.`ead_pro_cva`, `stg_bcrs_t_cdr`.`generic_field1`, `stg_bcrs_t_cdr`.`generic_field2`, `stg_bcrs_t_cdr`.`generic_field3`, `stg_bcrs_t_cdr`.`generic_field4`, `stg_bcrs_t_cdr`.`generic_field5`, `stg_bcrs_t_cdr`.`generic_field6`, `stg_bcrs_t_cdr`.`generic_field7`, `stg_bcrs_t_cdr`.`generic_field8`, `stg_bcrs_t_cdr`.`generic_field9`, `stg_bcrs_t_cdr`.`generic_field10`, `stg_bcrs_t_cdr`.`generic_number1`, `stg_bcrs_t_cdr`.`generic_number2`, `stg_bcrs_t_cdr`.`generic_number3`, `stg_bcrs_t_cdr`.`generic_number4`, `stg_bcrs_t_cdr`.`generic_number5`, `stg_bcrs_t_cdr`.`generic_number6`, `stg_bcrs_t_cdr`.`generic_number7`, `stg_bcrs_t_cdr`.`generic_number8`, `stg_bcrs_t_cdr`.`generic_number9`, `stg_bcrs_t_cdr`.`generic_number10`, `stg_bcrs_t_cdr`.`customer_field1`, `stg_bcrs_t_cdr`.`customer_field2`, `stg_bcrs_t_cdr`.`customer_field3`, `stg_bcrs_t_cdr`.`customer_field4`, `stg_bcrs_t_cdr`.`customer_field5`, `stg_bcrs_t_cdr`.`customer_field6`, `stg_bcrs_t_cdr`.`customer_field7`, `stg_bcrs_t_cdr`.`customer_field8`, `stg_bcrs_t_cdr`.`customer_field9`, `stg_bcrs_t_cdr`.`customer_field10`, `stg_bcrs_t_cdr`.`customer_number1`, `stg_bcrs_t_cdr`.`customer_number2`, `stg_bcrs_t_cdr`.`customer_number3`, `stg_bcrs_t_cdr`.`customer_number4`, `stg_bcrs_t_cdr`.`customer_number5`, `stg_bcrs_t_cdr`.`customer_number6`, `stg_bcrs_t_cdr`.`customer_number7`, `stg_bcrs_t_cdr`.`customer_number8`, `stg_bcrs_t_cdr`.`customer_number9`, `stg_bcrs_t_cdr`.`customer_number10`, `stg_bcrs_t_cdr`.`run_date`, `stg_bcrs_t_cdr`.`process_profile_sr_id`, `stg_bcrs_t_cdr`.`conso_perimeter`, `stg_bcrs_t_cdr`.`interco`, `stg_bcrs_t_cdr`.`interco_type`, `stg_bcrs_t_cdr`.`valid_cpy_perimeter`, `stg_bcrs_t_cdr`.`issuer_id`, `stg_bcrs_t_cdr`.`approver_id`, `stg_bcrs_t_cdr`.`upload_date`, `stg_bcrs_t_cdr`.`approval_date`, `stg_bcrs_t_cdr`.`adj_batch_date`, `stg_bcrs_t_cdr`.`source_file_name`, `stg_bcrs_t_cdr`.`adj_seq`, `stg_bcrs_t_cdr`.`dp_rule_log`, `stg_bcrs_t_cdr`.`staging_source`, `stg_bcrs_t_cdr`.`id`, `stg_bcrs_t_cdr`.`parent_id`, `stg_bcrs_t_cdr`.`child_id`, `stg_bcrs_t_cdr`.`multipurpose_audit`, `stg_bcrs_t_cdr`.`saccr_pfe`, `stg_bcrs_t_cdr`.`saccr_rc`, `stg_bcrs_t_cdr`.`flag_deduction`, `stg_bcrs_t_cdr`.`business`, `stg_bcrs_t_cdr`.`business_identifier`, `stg_bcrs_t_cdr`.`management_product`, `stg_bcrs_t_cdr`.`w_snapshot_dt`, `stg_bcrs_t_cdr`.`w_datasource_id`, `stg_bcrs_t_cdr`.`w_country_cd`, `stg_bcrs_t_cdr`.`w_batch_id`,          (                 CASE                     WHEN nvl(`stg_bcrs_t_cdr`.`table_name`,'z') IN (                         'BOND',                         'EQUITY',                         'TRANCHE',                         'CONVERTIBLE',                         'FUND'                     ) THEN 'SECURITY_POSITIONS'                     ELSE nvl(`stg_bcrs_t_cdr`.`table_name`,'z')                 END             ) AS `sec_table_name`        FROM             `sgmisitstg`.`stg_bcrs_t_cdr`   ) `t`  left join `sgmisit`.`sgmi_scb_l7_gl_map` `gl` on  (`t`.`dealbook`  = `gl`.`deal_book` and `t`.`contract_type` = `gl`.`contract_type`)  left join `sgmisit`.`sgmi_scb_l7_ct_map` `ctp` on (`t`.`dealbook`  = `ctp`.`deal_book_id` and `t`.`product_gl_criteria` = `ctp`.`product_gl_criteria`)   left join `sgmisitstg`.`stg_bcrs_companies_links` `complink` on `t`.`booking_company` = `complink`.`child_code` AND `complink`.`w_batch_id` = '2021121322042700331'   left join (          SELECT `stg_bcrs_t_cdr`.`contract_reference`, SUM(`stg_bcrs_t_cdr`.`rwa`) AS `SUM_RWA`,count(`stg_bcrs_t_cdr`.`contract_reference`) as `count_contract_ref`         FROM `sgmisitstg`.`stg_bcrs_t_cdr`         WHERE `stg_bcrs_t_cdr`.`w_batch_id` = '2021121322042700331'         GROUP BY `stg_bcrs_t_cdr`.`contract_reference`         ) `t2` on `t`.`contract_reference` = `t2`.`contract_reference`          left join `sgmisitstg`.`stg_bcrs_scb_gpr_default_indicator` `grpdfind` on `t`.`contract_type` = `grpdfind`.`indicator_value` AND `grpdfind`.`w_batch_id` = '2021121322042700331'   LEFT JOIN (  select `csrt`.`contract_reference`, `csrt`.`start_date`, `csrt`.`maturity_date`, `csrt`.`import_source`, `csrt`.`value_date`, `csrt`.`w_batch_id`, `csrt`.`rnk` from ( SELECT DISTINCT             `stg_bcrs_csr`.`contract_reference`,             `stg_bcrs_csr`.`start_date`,             `stg_bcrs_csr`.`maturity_date`,             `stg_bcrs_csr`.`import_source`,             `stg_bcrs_csr`.`value_date`,             `stg_bcrs_csr`.`w_batch_id`,             ROW_NUMBER() OVER(ORDER BY `stg_bcrs_csr`.`start_date` asc) `rnk`         FROM `sgmisitstg`.`stg_bcrs_csr` ) `csrt`                   WHERE `csrt`.`import_source` NOT LIKE '%WB%'         AND `csrt`.`rnk` = 1 ) `csr` ON `t`.`contract_reference` = `csr`.`contract_reference`  AND CASE WHEN 'WS29' like '%ADJ%' THEN `csr`.`w_batch_id` = '2021121322042700331' ELSE `csr`.`w_batch_id` = '2021121322042700331' END       LEFT JOIN ( SELECT DISTINCT             `e`.`entity_code`,             `e`.`entity_desc`,             `e`.`attribute_4`,             `e`.`attribute_1`,             `e`.`incorporation_country`,             `e`.`origination_country`,             `cfi`.`scorecard_segment_code`,             `cfi`.`scorecard_segment_category`,             `cfi`.`cf_indicator`,             `e`.`attribute_7`,             `cd1`.`code_desc` AS `customer_segment_desc`,             `e`.`attribute_8`,             `cd2`.`code_desc` AS `customer_subsegment_desc`,             `e`.`et_code_user`,             `icr`.`long_term_rating`,             `icr`.`long_term_rating_local_ccy`,             `e`.`country_code`             , `el`.`bf_link_type`             , `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`  `e`                   LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON `e`.`entity_code` = `icr`.`entity_code`                                                    AND nvl(`icr`.`agency_code`,'z') = 'INTERNAL'                                                    AND `icr`.`w_batch_id` = '2021121322042700331'           LEFT JOIN ( SELECT DISTINCT  `links`.`child_code`,                          case when `linktype`.`link_type` is not null then 'BUYER_FINANCE' else null end `bf_link_type`                         FROM `sgmisitstg`.`stg_bcrs_entity_links` `links` left join (SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                 FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`) `linktype`                                  WHERE `links`.`link_type` IN ( SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                         FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`   ))  `el`              ON `e`.`entity_code` = `el`.`child_code`                      LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_co_fi` `cfi` ON `e`.`attribute_1` = `cfi`.`scorecard_segment`         AND `cfi`.`w_batch_id` = '2021121322042700331'                   LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')         AND `cd1`.`code_type` = 'CUST_SEG'         AND `cd1`.`w_batch_id` = '2021121322042700331'                   LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd2` ON nvl(`cd2`.`code`,'zz') = nvl(`e`.`attribute_8`,'zz')         AND `cd2`.`code_type` = 'CUST_SUB_SEG'         AND `cd2`.`w_batch_id` = '2021121322042700331'           ) `e` ON `t`.`counterparty_original` = `e`.`entity_code` AND `e`.`w_batch_id` = '2021121322042700331'  LEFT JOIN (         SELECT DISTINCT             `e`.`entity_code`,             `e`.`attribute_7` AS `group_cust_segment_code`,             `cd1`.`code_desc` AS `group_cust_segment_desc`,             `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity` `e`                           LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')                    AND `cd1`.`code_type` = 'CUST_SEG'                    AND `cd1`.`w_batch_id` = '2021121322042700331'   where `e`.`w_batch_id` = '2021121322042700331' ) `egroup_orig` ON `t`.`cpty_group_original` = `egroup_orig`.`entity_code`  and `egroup_orig`.`w_batch_id` = '2021121322042700331'  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_entity`.`entity_code`,             `stg_bcrs_entity`.`attribute_1`,             `stg_bcrs_entity`.`origination_country`,             `stg_bcrs_entity`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`         where `stg_bcrs_entity`.`w_batch_id` = '2021121322042700331' ) `enew` ON `t`.`counterparty_new` = `enew`.`entity_code`   LEFT JOIN ( SELECT             `stg_bcrs_companies`.`company_code`,             `stg_bcrs_companies`.`country_code`,             `stg_bcrs_companies`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_companies`         where `stg_bcrs_companies`.`w_batch_id` = '2021121322042700331' ) `cpies` ON `t`.`booking_company` = `cpies`.`company_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_scb_wb_bf_uns_recoveries`.`domicile_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`booking_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`contract_type`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`cf_ind`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`prr`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`         where `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2021121322042700331'      ) `bf` ON `bf`.`domicile_country_code` = `e`.`country_code`             AND `bf`.`booking_country_code` = `cpies`.`country_code`             AND `bf`.`contract_type` = `t`.`contract_type`             AND `bf`.`cf_ind` = `e`.`cf_indicator`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_contract_types`.`ct_code_user`,             `stg_bcrs_contract_types`.`ct_desc_user`,             `stg_bcrs_contract_types`.`attribute_2`,             `stg_bcrs_contract_types`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_contract_types`             where              `stg_bcrs_contract_types`.`w_batch_id` = '2021121322042700331'      ) `ct` ON `t`.`contract_type` = `ct`.`ct_code_user`  Left Join ( select distinct  `stg_bcrs_contract_types`.`ct_code_user`, `stg_bcrs_contract_types`.`contract_category`, `stg_bcrs_contract_types`.`w_batch_id` from  `sgmisitstg`.`stg_bcrs_contract_types` where   `stg_bcrs_contract_types`.`w_batch_id` = '2021121322042700331' and `stg_bcrs_contract_types`.`contract_category` = 'RECEIVABLE' ) `contracttype` on `t`.`contract_type` = `contracttype`.`ct_code_user`           LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`amount`,             `stg_bcrs_facility`.`attribute_1`,             `stg_bcrs_facility`.`attribute_2`,             `stg_bcrs_facility`.`attribute_3`,             `stg_bcrs_facility`.`attribute_4`,             `stg_bcrs_facility`.`attribute_7` AS `non_gam_ind`,             `stg_bcrs_facility`.`attribute_8` AS `holdco_ind`,             `stg_bcrs_facility`.`trade_date`,             `stg_bcrs_facility`.`maturity_date`         FROM             `sgmisitstg`.`stg_bcrs_facility`         WHERE              `stg_bcrs_facility`.`w_batch_id` = '2021121322042700331'      ) `fac` ON `t`.`contract_reference` = `fac`.`contract_reference`      LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_mkt_fx_input`.`booking_company_code`,             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL'             AND `stg_bcrs_mkt_fx_input`.`w_batch_id` = '2021121322042700331'      ) `cer` ON `t`.`booking_company` = `cer`.`booking_company_code`              AND `t`.`currency` = `cer`.`ccy_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_country`.`country_code`,             `stg_bcrs_country`.`country_name`         FROM             `sgmisitstg`.`stg_bcrs_country`         WHERE              `stg_bcrs_country`.`w_batch_id` = '2021121322042700331'      ) `c` ON `t`.`incorporation_country_original` = `c`.`country_code`      LEFT JOIN (     select `prrsrtmp`.`partition_key`, `prrsrtmp`.`cf_indicator`, `prrsrtmp`.`product_code`, `prrsrtmp`.`prr`, `prrsrtmp`.`country`, `prrsrtmp`.`banking_type`, `prrsrtmp`.`w_datasource_id`, `prrsrtmp`.`w_workspace`, `prrsrtmp`.`rnk` from (         SELECT             `sgmi_scb_prr_dat`.`partition_key`,             `sgmi_scb_prr_dat`.`cf_indicator`,              `sgmi_scb_prr_dat`.`product_code`,              `sgmi_scb_prr_dat`.`product_recovery_rate` `prr`,              `sgmi_scb_prr_dat`.`country`,             `sgmi_scb_prr_dat`.`banking_type`,             `sgmi_scb_prr_dat`.`w_datasource_id`,             `sgmi_scb_prr_dat`.`w_workspace`,             ROW_NUMBER() OVER( PARTITION BY `sgmi_scb_prr_dat`.`product_code`, `sgmi_scb_prr_dat`.`country` ORDER BY `sgmi_scb_prr_dat`.`partition_key`) AS `rnk`         FROM             `sgmisit`.`SGMI_SCB_PRR_DAT` ) `prrsrtmp`         where             `prrsrtmp`.`rnk` = 1     ) `prrsr` ON `t`.`contract_type` = `prrsr`.`product_code`              AND `t`.`incorporation_country` = `prrsr`.`country`              AND `t`.`table_name` in ('ON_OFF_BALANCE', 'FACILITY', 'DEAL_IMPORT', 'CAPFLOOR', 'COMMODITY_SWAP', 'EQUITY_SWAP', 'EXCHANGE_OPTION', 'FRA', 'FOREX', 'FUTURE', 'OPTIONS', 'SWAP', 'BOND', 'SECURITY_POSITION', 'LOANDEPO','REPO_NETTING_VOL','COLLATERAL')              AND nvl(`t`.`deal_status`,'') = ''              AND `t`.`risk_type` = 'CRE'               AND nvl(`t`.`sub_reference`,'') = ''              AND nvl(`t`.`guarantee_reference`, '') = ''              AND `t`.`method_original` = 'ADV'               AND `t`.`w_datasource_id` = `prrsr`.`w_datasource_id`              AND `prrsr`.`banking_type` = 'SME'              AND SUBSTR(`prrsr`.`partition_key`,-2,2) = SUBSTR(`t`.`partition_key`,-2,2)            LEFT JOIN (             select `addtinst`.`contract_reference`, `addtinst`.`table_name`, `addtinst`.`tp_portfolio_name`, `addtinst`.`psgl_department_id`, `addtinst`.`psgl_product_code`, `addtinst`.`psgl_operating_unit`, `addtinst`.`psgl_customer_class`, `addtinst`.`rnk` from (                 SELECT                     `stg_bcrs_scb_wb_addt_inst`.`contract_reference`,                     `stg_bcrs_scb_wb_addt_inst`.`table_name`,                     `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`,                     ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ORDER BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`) AS `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2021121322042700331') `addtinst`                              WHERE                         `addtinst`.`rnk` = 1     ) `inst` ON `inst`.`contract_reference` = `t`.`contract_reference`               AND `inst`.`table_name` = `t`.`sec_table_name`                               LEFT JOIN (         SELECT             nvl(`split_ref`.`contract_reference`,`a`.`contract_reference`) `contract_reference`,             `a`.`psgl_cust_class`,             `a`.`psgl_product`,             TRIM(`a`.`psgl_department`) `psgl_department`,             `a`.`fermat_table_name`         FROM             (                 SELECT DISTINCT                     `b`.`contract_reference`,                     `b`.`fermat_table_name`,                     `b`.`psgl_cust_class`,                     `b`.`psgl_product`,                     `b`.`psgl_department`,                     `c`.`priority`,                     ROW_NUMBER() OVER(PARTITION BY `b`.`contract_reference`, `b`.`fermat_table_name` ORDER BY `c`.`priority`) `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_sme_psgl` `b`                     left join `sgmisitstg`.`stg_bcrs_scb_wb_amt_cat_priority` `c`                                         on `b`.`fermat_table_name` = `c`.`table_name`                      and `b`.`amount_category_dw_sorsa` = `c`.`amount_category_dw_sorsa`                     and `b`.`psgl_product` <> 'ZZZ'                     and `b`.`w_batch_id`='2021121322042700331'                      and `b`.`w_batch_id` = `c`.`w_batch_id`                                     ) `a`             left join             (                 SELECT DISTINCT                     `stg_bcrs_facility_links`.`contract_reference`,                     `stg_bcrs_facility_links`.`attribute_1` AS `orig_cont_ref`                 FROM                     `sgmisitstg`.`stg_bcrs_facility_links`                 WHERE                     `stg_bcrs_facility_links`.`attribute_1` IS NOT NULL and `stg_bcrs_facility_links`.`w_batch_id`='2021121322042700331'             ) `split_ref`         on             `a`.`contract_reference` = `split_ref`.`orig_cont_ref`             where   `a`.`rnk` = 1     ) `psgl` ON `t`.`contract_reference` = `psgl`.`contract_reference`               AND `t`.`sec_table_name` = `psgl`.`fermat_table_name`                                                 LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_mpdt_mru_map`.`mru_desc`,             `stg_bcrs_scb_wb_mpdt_mru_map`.`mpdt_code`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_mpdt_mru_map` where `stg_bcrs_scb_wb_mpdt_mru_map`.`w_batch_id`='2021121322042700331'     ) `mru_bus` ON `mru_bus`.`mpdt_code` = `t`.`management_product`                        LEFT JOIN `sgmisitstg`.`stg_bcrs_fdw_netting_agreement` `net` ON `net`.`agreement_reference` = `t`.`netting_agreement_reference`     and `net`.`w_batch_id`='2021121322042700331'          LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_fac_sub_limits`.`id`,             `stg_bcrs_scb_wb_fac_sub_limits`.`contract_reference`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_attribute`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_amount`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_fac_sub_limits` where `stg_bcrs_scb_wb_fac_sub_limits`.`w_batch_id`='2021121322042700331'     ) `sub` ON `t`.`id` = `sub`.`id`          LEFT JOIN (         SELECT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`book_code`,             `stg_bcrs_facility`.`currency`         FROM             `sgmisitstg`.`stg_bcrs_facility` where `stg_bcrs_facility`.`w_batch_id`='2021121322042700331'     ) `fac_curr` ON `sub`.`contract_reference` = `fac_curr`.`contract_reference`       LEFT JOIN (         SELECT             `stg_bcrs_deal_book`.`booking_company`,             `stg_bcrs_deal_book`.`book_code`         FROM             `sgmisitstg`.`stg_bcrs_deal_book` where `stg_bcrs_deal_book`.`w_batch_id`='2021121322042700331'     ) `dealbook` ON `dealbook`.`book_code` = `fac_curr`.`book_code`          LEFT JOIN (         SELECT             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`,             `stg_bcrs_mkt_fx_input`.`booking_company_code`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL' and `stg_bcrs_mkt_fx_input`.`w_batch_id`='2021121322042700331'     ) `fac_curr_exch` ON `fac_curr_exch`.`ccy_code` = `fac_curr`.`currency`                        AND `fac_curr_exch`.`booking_company_code` = `dealbook`.`booking_company`                               LEFT JOIN (         SELECT             `stg_bcrs_t_cva`.`contract_reference`,             count(`stg_bcrs_t_cva`.`contract_reference`) as `count_contract_ref`,             SUM(nvl(`stg_bcrs_t_cva`.`cva_rwa`,0) ) `cva_rwa`         FROM             `sgmisitstg`.`stg_bcrs_t_cva` where `stg_bcrs_t_cva`.`w_batch_id`='2021121322042700331'         GROUP BY             `stg_bcrs_t_cva`.`contract_reference`     ) `tcva` ON `tcva`.`contract_reference` = `t`.`contract_reference`              LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_mru_business_idntfr_map` `bus_ind`      ON `bus_ind`.`business_identifier` = `t`.`business_identifier` and `bus_ind`.`w_batch_id`='2021121322042700331'      where `t`.`w_batch_id` = '2021121322042700331'      and `t`.`import_source` NOT LIKE '%WB%'         and `t`.`w_snapshot_dt` = '2021-08-31'     and `t`.`w_datasource_id` = 'BCRS_ND'     and `t`.`w_country_cd`='SG'       union all  SELECT distinct                      `t`.`partition_key`,     'WB' as `banking_type`,     `t`.`method_new`,     `t`.`method_original`,     `t`.`contract_reference`,     `t`.`tranche_collateral_type`,     `t`.`tranche_guarantee_type`,     `t`.`counterparty_original`,     `e`.`entity_desc` AS `counterparty_original_desc`,     `t`.`counterparty_new`,     `t`.`counterparty_new_desc`,     `t`.`table_name`,     `t`.`bis_past_due`,     `t`.`contract_type`,     `ct`.`ct_desc_user` AS `contract_desc`,     `e`.`cf_indicator`,     (         CASE             WHEN upper(`t`.`counterparty_original`) LIKE '%_CORPORATE%'                  OR upper(`t`.`counterparty_original`) LIKE '%_BANK%'                  OR `t`.`counterparty_original` = '9999999999-1'                  OR `t`.`counterparty_original` = '9999999998-1'      THEN 'Y'               ELSE 'N'         END     ) AS `unmapped_ind`,     (         CASE             WHEN upper(`e`.`attribute_4`) = 'CN' THEN 'Y'             ELSE 'N'         END     ) AS `non_borrowing_ind`,     (         CASE  WHEN `contracttype`.`ct_code_user` is not null THEN 'PURCHASED_RECEIVABLE'             WHEN `t`.`contract_type` IN ( 'GMGMKTPTEQ' ) THEN 'PRIVATE_EQUITY'             WHEN `t`.`contract_type` IN ( 'GMGMKTAINV', 'GMGMKTANPL'  ) THEN 'ALT_INVST'             WHEN `e`.`et_code_user` IN (  'BSC23'  ) THEN 'DEV_ORG'    WHEN `e`.`et_code_user` IN (  'BSC16'  ) THEN 'MDB'             WHEN `e`.`et_code_user` IN (  'BSC24' ) THEN 'PERSONAL'             WHEN `e`.`scorecard_segment_code` IN (  'CFSC'   ) THEN 'SME'             WHEN `e`.`scorecard_segment_category` IN (  'F1'  ) THEN 'BANK'             WHEN `e`.`scorecard_segment_category` IN (  'F2', 'F3'  ) THEN 'NBFI'             WHEN `e`.`scorecard_segment_category` IN (  'S1' ) THEN 'SOV'    WHEN `e`.`scorecard_segment_category` IN (  'CRE', 'PF', 'SF' ) THEN 'SPECIALISED LENDING'             WHEN `e`.`scorecard_segment_category` IN (  'C1', 'C2', 'C3', 'C4', 'C5' ) THEN 'CORP'             ELSE 'CORP'         END     ) AS `segment_original`,     (         CASE             WHEN `t`.`table_name` IN (                 'DEAL_IMPORT',                 'CREDIT_DERIVATIVE','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN 'T'             ELSE 'F'         END     ) AS `derivative_ind`,     `t`.`incorporation_country_original`,     `c`.`country_name`,     `t`.`dealbook`,     `t`.`booking_company_desc`,     `e`.`attribute_1` AS `scorecard_original`,     `t`.`internal_rating_new`,     `t`.`pd_new`,     `t`.`internal_rating_original`,     `t`.`pd_original`,     (         CASE             WHEN nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`method_new` = 'ADV'                  AND `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED' THEN 0.45             WHEN `t`.`import_source` = 'NONTP-WBAJ'                  AND `t`.`method_new` = 'ADV' THEN `t`.`exposure_attribute_7`              WHEN (                 ( `t`.`tranche_collateral_type` = 'COLLATERALIZED' )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') <> 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN `t`.`lgd`             WHEN (                 (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'GUARANTEED'                 )                 OR (                     `t`.`tranche_collateral_type` = 'NOT COLLATERALIZED'                     AND `t`.`tranche_guarantee_type` = 'NOT GUARANTEED'                     AND nvl(`t`.`exposure_attribute_9`,'z') = 'RW_LGD_UPDATE'                 )             )                  AND `t`.`method_new` = 'ADV' THEN cast(`t`.`exposure_attribute_7` as decimal(38,20))               ELSE 0         END     ) AS `lgd`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY'             ) THEN `t`.`outstanding`             ELSE 0         END     ) AS `outstanding`,     (         CASE             WHEN `t`.`table_name` IN (                 'ON_OFF_BALANCE',                 'REPO',                 'RECEIVABLE',                 'TRANCHE',                 'BOND',                 'EQUITY'             ) THEN `t`.`accrued_interest`             ELSE 0         END     ) AS `accrued_interest`,     (         CASE             WHEN `t`.`table_name` IN (                 'FACILITY'             )                  AND `t`.`bs_type` = 'OFB' THEN `t`.`outstanding`             ELSE 0         END     ) AS `headroom`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN `t`.`fair_value`             ELSE 0         END     ) AS `mtm`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN (                         CASE                             WHEN `t`.`fair_value` > 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                     ELSE (                         CASE                             WHEN `t`.`fair_value` < 0 THEN 0                             ELSE `t`.`fair_value`                         END                     )                 END             )             ELSE 0         END     ) AS `replacement_cost`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN (                 CASE                     WHEN upper(`t`.`collateral_attribute_9`) = 'REVERSE' THEN abs(`t`.`nominal`) *-1                     ELSE abs(`t`.`nominal`)                 END             )             ELSE 0         END     ) AS `notional`,     (         CASE             WHEN `t`.`table_name` IN (                 'CREDIT_DERIVATIVE',                 'DEAL_IMPORT','CAPFLOOR','COMMODITY_SWAP','EQUITY_SWAP','EXCHANGE_OPTION','FOREX','FRA','FUTURE','OPTIONS','SWAP','REPO_NETTING_VOL','COLLATERAL'             ) THEN `t`.`add_on`             ELSE 0         END     ) AS `add_on`,     `t`.`ead`,     `t`.`rwa`,     `t`.`rwa_pre_crm`,     `t`.`el`,     `t`.`rgc`,     `t`.`ead_original`,     `t`.`tier1_deduction`,     `t`.`tier2_deduction`,     `t`.`ead_pre_ccf`,     `t`.`nominal`,     `t`.`fair_value`,     `t`.`ead_pro`,     `t`.`ead_pro_gen`,     nvl(`prrsr`.`prr`,0) `prr`,     ( round(`t`.`ead`,10) * round(`t`.`pd_original`,10) ) AS `wt_pd_original`,     ( round(`t`.`ead`,10) * round(`t`.`pd_new`,10) ) AS `wt_pd_new`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45 * round(`t`.`ead`,10)             WHEN `t`.`method_new` = 'ADV' THEN round(`t`.`lgd`,10) * round(`t`.`ead`,10)             ELSE 0         END     ) AS `wt_lgd`,     ( round(`t`.`ead`,10) * round(`t`.`k_maturity`,10) ) AS `wt_k_maturity`,     ( round(`t`.`ead`,10) * round(`t`.`residual_maturity`,10) ) AS `wt_residual_maturity`,     `t`.`total_annual_sales`,     `t`.`hfx`,     `t`.`hc`,     `t`.`he`,     `t`.`k_maturity`,     `t`.`facility_reference`,     `t`.`performing_status`,     `t`.`securitization_reference`,     `t`.`days_after_contractual_date`,     `t`.`risk_bucket`,     `t`.`delivery_type`,     `t`.`funding_ccy`,     coalesce( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr`.`currency`             ELSE `t`.`currency`         END     ),`t`.`currency`) AS `currency`,     `t`.`residual_maturity`,     `t`.`original_maturity`,     `t`.`ead_method`,     `t`.`ccf`,     `t`.`inter_company`,     `t`.`trading_book_type`,     `e`.`attribute_7` AS `customer_segment_code`,     `e`.`customer_segment_desc`,     `e`.`attribute_8` AS `customer_subsegment_code`,     `e`.`customer_subsegment_desc`,     `t`.`id`,     `t`.`import_source`,     `t`.`product_gl_criteria`,     `t`.`bs_type`,     `t`.`securitized`,     `t`.`risk_type`,     `t`.`bis_product`,     `t`.`bis_product_category`,     `t`.`bis_entity_type_new`,     `t`.`bis_entity_type_original`,     `t`.`asset_class_new`,     `t`.`asset_class_original`,     `t`.`netting_agreement_reference`,     `t`.`collateral_reference`,     `t`.`collateral_contract_type`,     `t`.`collateral_bis_product`,     `t`.`collateral_product_category`,     `t`.`guarantee_reference`,     `t`.`guarantee_contract_type`,     `t`.`guarantee_bis_product`,     `t`.`counterparty_type_new`,     `t`.`sub_method_new`,     `t`.`rw_scaling_factor`,     `t`.`rwa_scaling_factor`,     `t`.`exposure_attribute_7`,     `t`.`exposure_attribute_8`,     `t`.`exposure_attribute_9`,     `t`.`rw_original`,     `t`.`rw_new`,     `t`.`securitization_n`,     `t`.`crm_method`,     `t`.`division_code`,     `t`.`secu_ea_controlled`,     `t`.`secu_company_weight`,     `t`.`secu_bank_role`,     `t`.`obligor_grade_new`,     `t`.`standard_rw_original`,     `t`.`standard_rw_new`,     `t`.`cpty_group`,     `t`.`cpty_group_original`,     `t`.`bis_industry_sector_new`,     `t`.`bis_industry_sector_original`,     `t`.`bis_risk_area_new`,     `t`.`bis_risk_area_original`,     `t`.`incorporation_country_new`,     `t`.`int_rating_agency_new`,     `t`.`risk_country`,     `t`.`used_amount_facility`,     `t`.`beel`,     `t`.`uncommited`,          case when `csr`.`start_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0) - nvl(`t`.`original_maturity`,0)) * 365.25) as INT)) as date)     else `csr`.`start_date` end as `start_date`,       case when `csr`.`maturity_date` is null then         cast(date_add(to_date(CONCAT(substr(nvl(`t`.`partition_key`,0),1,4),'-',substr(nvl(`t`.`partition_key`,0),5,2),'-',substr(nvl(`t`.`partition_key`,0),7,2))),cast(floor((nvl(`t`.`residual_maturity`,0)) * 365.25) as INT)) as date)      else `csr`.`maturity_date` end as `maturity_date`,          `t`.`value_date`,     (         CASE             WHEN nvl(`t`.`residual_maturity`,0) <= 1               THEN '<=1yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 3 and nvl(`t`.`residual_maturity`,0) > 1  THEN '1-3yrs'             WHEN nvl(`t`.`residual_maturity`,0) <= 5 and nvl(`t`.`residual_maturity`,0) > 3  THEN '3-5yrs'             ELSE '>5yrs'         END     ) AS `maturity_range`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`lgd`             ELSE 0         END     ) AS `tranche_lgd`,         CASE WHEN (`complink`.`mother_code` = '999C' or `complink`.`mother_code` = '976C') and `complink`.`child_code` is not null then 'SOLO'          ELSE 'SUBS' END `company_type`,     nvl(`mru_bus`.`mru_desc`,'UNMAPPED') AS `business`,     `inst`.`psgl_operating_unit` AS `psgl_operating_unit`,     `psgl`.`psgl_cust_class`,     (         CASE             WHEN `t`.`table_name` = 'TRANCHE'                  AND `t`.`bs_type` IN(                 'VIF','VIR'             ) THEN 'TRANCHE_FILTER'             WHEN `t`.`inter_company` = 'T' THEN 'INTERCOMPANY_FILTER'             ELSE 'BCRS'         END     )   AS `filter_type`,     (         CASE             WHEN `t`.`securitized` = 'T'   THEN 'SECURITIZED'             WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'             WHEN `t`.`trading_book_type` = 'T'                  AND `t`.`bis_product_category` IN(                 'REPO','DERIVATIVE','DERIVATIVE_OTC','CREDIT_DERIVATIVE'             ) THEN 'CCR'             WHEN `t`.`tranche_collateral_type` = 'COLLATERALIZED'                  AND `t`.`collateral_bis_product` IN(                 'REP_NET_COL','OTC_NET_COL'             ) THEN 'NETTING_BENEFIT'             ELSE 'FSA'         END     )  AS `fsa_exclusion_type`,     (         CASE             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_past_due` = 'T' THEN 'PAST_DUE_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`asset_class_new` = 'CLAIM_OTH_150'                 OR (                     (                         (                             `t`.`rw_original` >= 1.5                             OR `t`.`standard_rw_original` >= 1.5                         )                         AND NOT (                             (                                 `t`.`tranche_collateral_type` = 'COLLATERALIZED'                                 AND `t`.`crm_method` = 'SIM'                                 AND `t`.`collateral_product_category` = 'FINANCIAL_COL'                             )                             OR `t`.`tranche_guarantee_type` = 'GUARANTEED'                         )                     )                     OR `t`.`rw_new` >= 1.5                 )             ) THEN 'HIGH_RISK_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND (                 ( `t`.`asset_class_new` LIKE '%EQT' )                 OR (                     `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                     AND `t`.`sub_reference` = 'MULTI NAME'                 )                 OR ( `t`.`risk_type` = 'RVR' )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` IN (                 'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE',                 'CLAIM_SEC_CRE',                 'CLAIM_FULL_SEC_RRE'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`collateral_bis_product` IN (                 'RRE_COL',                 'LEASING_CRE_COL',                 'CRE_COL',                 'LEASING_RRE_COL'             ) THEN 'SECURED_ON_REAL_ESTATE_PROPERTY'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_COVERED_BOND' THEN 'COVERED_BONDS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`asset_class_new` = 'CLAIM_CIU' THEN 'COLLECTIVE_INV_UNDERTAKINGS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF',                 'CORP',                 'INSURANCE',                 'CORP_CF',                 'CORP_HVCRE',                 'CORP_IPRE',                 'CORP_OF',                 'CORP_PF',                 'EX_RETAIL',                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'SPE',                 'CORP_INT_GRP'             )                  AND (                 `t`.`risk_bucket` IN (                     30,                     31,                     32,                     33,                     34                 )                 OR `t`.`risk_bucket_original` IN (                     30,                     31,                     32,                     33,                     34                 )             ) THEN 'SHORT_TERM_CLAIMS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SOV'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'RGLA',                 'RGLA_SOV',                 'RGLA_SOV_EU'             ) THEN 'REGIONAL_GOVTS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'PSE',                 'PSE_BANK',                 'PSE_SOV'             ) THEN 'ADMIN_BODIES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'MDB',                 'MDB_PREF_0',                 'MDB_PREF_20'             ) THEN 'MULTILATERAL_DEVT_BANKS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'SUPRA',                 'EIF',                 'SUPRA_100'             ) THEN 'INTL_ORGANIZATIONS'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'SF',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'STD'                  AND (                 `t`.`bis_entity_type_new` IN (                     'SME',                     'SME_CF',                     'SME_HVCRE',                     'SME_IPRE',                     'SME_OF',                     'SME_PF',                     'CORP',                     'INSURANCE',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'CORP_INT_GRP'                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'STD'                  AND `t`.`bis_entity_type_new` IN (                 'INDIV',                 'SME_RETAIL'             )                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL'             WHEN `t`.`method_new` = 'STD' THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`bis_entity_type_new` NOT IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` = 'CLAIM_OTH_100'                 )                 AND (                     `t`.`bis_product_category` NOT IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR ( `t`.`bis_product_category` = 'FINANCIAL' )             ) THEN 'OTHER_ITEMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_SECURITIZATION' THEN 'SECURITIZATION_POSITIONS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 ( `t`.`asset_class_new` = 'CLAIM%EQT' )                 OR ( `t`.`asset_class_new` = 'CLAIM_CIU' )             ) THEN 'EQUITY_CLAIMS'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND (                 (                     `t`.`asset_class_new` IN (                         'CLAIM_FULL_SEC_RRE',                         'CLAIM_SEC_RRE_LEASE',                         'CRE_COL',                         'CLAIM_SEC_CRE',                         'CLAIM_RETAIL_RESIDENTIAL_MORTGAGE'                     )                     OR `t`.`collateral_bis_product` IN (                         'RRE_COL',                         'LEASING_RRE_COL',                         'LEASING_CRE_COL',                         'CRE_COL'                     )                 )                 AND `t`.`bis_entity_type_new` IN (                     'INDIV',                     'SME_RETAIL'                 )             ) THEN 'RETAIL_MORTGAGES'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`asset_class_new` = 'CLAIM_RETAIL_QUALIFYING_REVOLVING' THEN 'RETAIL_QRRE'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'INDIV'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_OTHER'             WHEN `t`.`method_new` IN (                 'ADV',                 'FOU'             )                  AND `t`.`bis_entity_type_new` = 'SME_RETAIL'                  AND `t`.`asset_class_new` NOT IN (                 'CLAIM_OTH_100'             ) THEN 'RETAIL_SME'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'FOU'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'FOU'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SOV',                 'MDB_PREF_0',                 'SUPRA',                 'RGLA_SOV',                 'PSE_SOV',                 'EIF',                 'RGLA_SOV_EU',                 'SUPRA_100'             ) THEN 'CENTRAL_GOVTS'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'BANK',                 'BANK_INT_GRP',                 'BANK_IBPDM',                 'RGLA',                 'MDB',                 'MDB_PREF_20',                 'SF',                 'PSE_BANK',                 'FINAN_FIRM',                 'BANK_SOV'             ) THEN 'INSTITUTIONS'             WHEN `t`.`method_new` = 'ADV'                  AND (                 ( `t`.`bis_entity_type_new` IN (                     'CORP',                     'CORP_CF',                     'CORP_HVCRE',                     'CORP_IPRE',                     'CORP_OF',                     'CORP_PF',                     'EX_RETAIL',                     'SPE',                     'PSE',                     'INSURANCE',                     'CORP_INT_GRP'                 ) )                 OR (                     `t`.`asset_class_new` = 'CLAIM_OTH_100'                     AND `t`.`bis_product_category` IN (                         'CREDIT_DERIVATIVE',                         'CRE_DER_CLN'                     )                     AND `t`.`bs_type` IN (                         'OFB',                         'ASS'                     )                 )                 OR (                     `t`.`bis_entity_type_new` IN (                         'INDIV',                         'SME_RETAIL'                     )                     AND `t`.`asset_class_new` IN (                         'CLAIM_OTH_100'                     )                 )             ) THEN 'CORPORATES'             WHEN `t`.`method_new` = 'ADV'                  AND `t`.`bis_entity_type_new` IN (                 'SME',                 'SME_CF',                 'SME_HVCRE',                 'SME_IPRE',                 'SME_OF',                 'SME_PF'             ) THEN 'SME'             ELSE 'OTHER_ITEMS'         END     ) AS `fsa004_asset_class`,     `t`.`secu_mode`,     `t`.`risk_bucket_original`,     `t`.`waterfall_seniority`,     `e`.`origination_country` AS `ccr_original`,     `enew`.`origination_country` AS `ccr_new`,     `t`.`stress_testing_scenario_id`,     `t`.`collateral_attribute_1`,     `t`.`collateral_attribute_9`,     `t`.`exposure_attribute_1`,     `t`.`exposure_attribute_6`,     `t`.`counterparty_new_attribute_1`,     `t`.`sub_reference`,     `t`.`sub_method_original`,     `t`.`int_rating_agency_original`,     `t`.`ead_formula`,     `t`.`booking_company`,     `t`.`obligor_grade_inf_new`,     `t`.`obligor_grade_sup_new`,     `t`.`incorporation_ccy_original`,     `t`.`incorporation_ccy_new`,  nvl(case when `force_map`.`l7_code` is null or `force_map`.`l7_code`='' then `t`.`management_product` else `force_map`.`l7_code` end ,'UNMAPPED') AS `management_product`,     `bus_ind`.`business_identifier_desc` AS `business_identifier`,      CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_w_filter_type`,              CASE WHEN `t`.`bis_past_due` = 'T' AND upper(`grpdfind`.`indicator`) = 'ALT_INVST' and  `grpdfind`.`indicator_value` is null                 THEN 'PAST_DUE'      WHEN `t`.`inter_company` = 'T' THEN 'INTER_COMPANY'      WHEN `t`.`table_name` = 'TRANCHE' AND `t`.`bs_type` IN('VIR','VIF') THEN 'SECURITIZATION'     ELSE 'EC_BCRS' END `ec_filter_type`,          `ct`.`attribute_2` AS `balance_category`,     nvl( (         CASE             WHEN `t`.`table_name` = 'FACILITY' THEN `fac_curr_exch`.`exch_rate`             ELSE `cer`.`exch_rate`         END     ),`cer`.`exch_rate`) AS `exchange_rate`,     `fac`.`holdco_ind` AS `holding_company_ind`,     `fac`.`non_gam_ind` AS `non_gam_ind`,     `egroup_orig`.`group_cust_segment_code`,     `egroup_orig`.`group_cust_segment_desc`,     `t`.`original_cost`,     `t`.`premium_current`,     `t`.`security_positions_ref`,     `t`.`pd_pre_floor_new`,     `t`.`exposure_attribute_3`,     `t`.`exposure_attribute_4`,     `t`.`exposure_attribute_5`,     `t`.`counterparty_new_attribute_3`,     `t`.`counterparty_new_attribute_4`,     `t`.`collateral_attribute_7`,     `t`.`collateral_attribute_8`,     `e`.`long_term_rating_local_ccy` AS `internal_rating_local_ccy_orig`,     `t`.`past_due_int`,     `t`.`ead_pro_discount`,     (         CASE             WHEN `t`.`method_new` = 'ADV'                  AND nvl(`enew`.`attribute_1`,'z') = 'CRE Investment Loans'                  AND `t`.`tranche_collateral_type` <> 'COLLATERALIZED' THEN 0.45             WHEN `t`.`method_new` = 'ADV' THEN `t`.`ltv`             ELSE 0         END     ) AS `ltv`,     (         CASE             WHEN `bf`.`domicile_country_code` IS NOT NULL                  AND nvl(`e`.`bf_link_type`,'z') = 'BUYER_FINANCE' THEN 'Y'             ELSE 'N'         END     ) AS `buyer_finance_ind`,     `t`.`counterparty_ext_rat_code`,     `t`.`counterparty_ext_rat_agency`,     `t`.`counterparty_int_rat_code`,     `t`.`counterparty_int_rat_agency`,     `t`.`maturity_eff`,     `psgl`.`psgl_department` AS `psgl_department_id`,     `psgl`.`psgl_product` AS `psgl_product_code`,     `net`.`netting_type` AS `netting_agreement_type`,     `fac`.`contract_reference` AS `sub_limit_fac_reference`,     `fac`.`amount` AS `limit_amount`,     `fac`.`attribute_1` AS `limit_attribute`,      CASE WHEN round(nvl(`t2`.`sum_rwa`,0),2)  <= 0 THEN nvl(`tcva`.`cva_rwa`,0) / nvl(`t2`.`count_contract_ref`,0)          ELSE (nvl(`t`.`rwa`,0) / `t2`.`sum_rwa`) * nvl(`tcva`.`cva_rwa`,0)     END `cva_rwa`,             `t`.`qualifying_ccp`,     `t`.`k_function_used`,     `t`.`k_function_used_original`,     `t`.`product_gl_criteria_2`,     `t`.`bis_past_due_original`,     `t`.`risk_country_new`,     `t`.`risk_country_original`,     `t`.`booking_company_incorp_country`,     `t`.`ccf_std`,     `t`.`past_due_days`,     `t`.`guarantee_method`,     `t`.`fde_alternative_method`,     `t`.`rwa_pre_cap`,     `t`.`asset_class_category_new`,     `t`.`asset_class_category_original`      FROM ( SELECT `stg_bcrs_t_cdr`.`partition_key`, `stg_bcrs_t_cdr`.`stress_testing_scenario_id`, `stg_bcrs_t_cdr`.`tranche_collateral_type`, `stg_bcrs_t_cdr`.`tranche_guarantee_type`, `stg_bcrs_t_cdr`.`bs_type`, `stg_bcrs_t_cdr`.`contract_reference`, `stg_bcrs_t_cdr`.`contract_type`, `stg_bcrs_t_cdr`.`bis_product`, `stg_bcrs_t_cdr`.`bis_product_category`, `stg_bcrs_t_cdr`.`unconditionnaly_cancelable`, `stg_bcrs_t_cdr`.`ead_original`, `stg_bcrs_t_cdr`.`ead_pre_ccf`, `stg_bcrs_t_cdr`.`ead`, `stg_bcrs_t_cdr`.`ead_pro`, `stg_bcrs_t_cdr`.`facility_reference`, `stg_bcrs_t_cdr`.`collateral_reference`, `stg_bcrs_t_cdr`.`collateral_contract_type`, `stg_bcrs_t_cdr`.`collateral_bis_product`, `stg_bcrs_t_cdr`.`guarantee_reference`, `stg_bcrs_t_cdr`.`guarantee_contract_type`, `stg_bcrs_t_cdr`.`guarantee_bis_product`, `stg_bcrs_t_cdr`.`netting_agreement_reference`, `stg_bcrs_t_cdr`.`netting_agreement_type`, `stg_bcrs_t_cdr`.`counterparty_original`, `stg_bcrs_t_cdr`.`counterparty_type_original`, `stg_bcrs_t_cdr`.`counterparty_new`, `stg_bcrs_t_cdr`.`counterparty_type_new`, `stg_bcrs_t_cdr`.`total_annual_sales`, `stg_bcrs_t_cdr`.`total_annual_assets`, `stg_bcrs_t_cdr`.`bis_entity_type_original`, `stg_bcrs_t_cdr`.`bis_entity_type_new`, `stg_bcrs_t_cdr`.`asset_class_original`, `stg_bcrs_t_cdr`.`asset_class_new`, `stg_bcrs_t_cdr`.`method_original`, `stg_bcrs_t_cdr`.`sub_method_original`, `stg_bcrs_t_cdr`.`method_new`, `stg_bcrs_t_cdr`.`sub_method_new`, `stg_bcrs_t_cdr`.`guarantee_method`, `stg_bcrs_t_cdr`.`he`, `stg_bcrs_t_cdr`.`maturity_eff`, `stg_bcrs_t_cdr`.`k_maturity`, `stg_bcrs_t_cdr`.`pd_original`, `stg_bcrs_t_cdr`.`internal_rating_original`, `stg_bcrs_t_cdr`.`pd_new`, `stg_bcrs_t_cdr`.`internal_rating_new`, `stg_bcrs_t_cdr`.`lgd`, `stg_bcrs_t_cdr`.`lgd_grade_agency`, `stg_bcrs_t_cdr`.`ccf`, `stg_bcrs_t_cdr`.`hfx`, `stg_bcrs_t_cdr`.`hc`, `stg_bcrs_t_cdr`.`mm`, `stg_bcrs_t_cdr`.`floor1`, `stg_bcrs_t_cdr`.`floor2`, `stg_bcrs_t_cdr`.`rwa`, `stg_bcrs_t_cdr`.`rgc`, `stg_bcrs_t_cdr`.`rwa_pre_crm`, `stg_bcrs_t_cdr`.`el`, `stg_bcrs_t_cdr`.`beel`, `stg_bcrs_t_cdr`.`bis_past_due`, `stg_bcrs_t_cdr`.`performing_status`, `stg_bcrs_t_cdr`.`rw_scaling_factor`, `stg_bcrs_t_cdr`.`rwa_scaling_factor`, `stg_bcrs_t_cdr`.`equity_scaling_factor`, `stg_bcrs_t_cdr`.`exemption_maturity_floor`, `stg_bcrs_t_cdr`.`grand_fathering_applied`, `stg_bcrs_t_cdr`.`legislated_program_applied`, `stg_bcrs_t_cdr`.`non_material_equity`, `stg_bcrs_t_cdr`.`zero_rw_for_equity`, `stg_bcrs_t_cdr`.`zero_haircut_for_repo`, `stg_bcrs_t_cdr`.`k_function_used`, `stg_bcrs_t_cdr`.`ead_formula`, `stg_bcrs_t_cdr`.`risk_type`, `stg_bcrs_t_cdr`.`trading_book_type`, `stg_bcrs_t_cdr`.`table_name`, `stg_bcrs_t_cdr`.`exposure_attribute_1`, `stg_bcrs_t_cdr`.`exposure_attribute_2`, `stg_bcrs_t_cdr`.`exposure_attribute_3`, `stg_bcrs_t_cdr`.`exposure_attribute_4`, `stg_bcrs_t_cdr`.`exposure_attribute_5`, `stg_bcrs_t_cdr`.`exposure_attribute_6`, `stg_bcrs_t_cdr`.`exposure_attribute_7`, `stg_bcrs_t_cdr`.`exposure_attribute_8`, `stg_bcrs_t_cdr`.`exposure_attribute_9`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_1`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_2`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_3`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_4`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_5`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_6`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_7`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_8`, `stg_bcrs_t_cdr`.`counterparty_new_attribute_9`, `stg_bcrs_t_cdr`.`collateral_attribute_1`, `stg_bcrs_t_cdr`.`collateral_attribute_2`, `stg_bcrs_t_cdr`.`collateral_attribute_3`, `stg_bcrs_t_cdr`.`collateral_attribute_4`, `stg_bcrs_t_cdr`.`collateral_attribute_5`, `stg_bcrs_t_cdr`.`collateral_attribute_6`, `stg_bcrs_t_cdr`.`collateral_attribute_7`, `stg_bcrs_t_cdr`.`collateral_attribute_8`, `stg_bcrs_t_cdr`.`collateral_attribute_9`, `stg_bcrs_t_cdr`.`guarantee_attribute_1`, `stg_bcrs_t_cdr`.`guarantee_attribute_2`, `stg_bcrs_t_cdr`.`guarantee_attribute_3`, `stg_bcrs_t_cdr`.`guarantee_attribute_4`, `stg_bcrs_t_cdr`.`guarantee_attribute_5`, `stg_bcrs_t_cdr`.`guarantee_attribute_6`, `stg_bcrs_t_cdr`.`guarantee_attribute_7`, `stg_bcrs_t_cdr`.`guarantee_attribute_8`, `stg_bcrs_t_cdr`.`guarantee_attribute_9`, `stg_bcrs_t_cdr`.`inter_company`, `stg_bcrs_t_cdr`.`rwa_pre_cap`, `stg_bcrs_t_cdr`.`rw_original`, `stg_bcrs_t_cdr`.`rw_new`, `stg_bcrs_t_cdr`.`tier1_deduction`, `stg_bcrs_t_cdr`.`tier2_deduction`, `stg_bcrs_t_cdr`.`securitized`, `stg_bcrs_t_cdr`.`seniority_original`, `stg_bcrs_t_cdr`.`seniority_new`, `stg_bcrs_t_cdr`.`collateral_product_category`, `stg_bcrs_t_cdr`.`dealbook`, `stg_bcrs_t_cdr`.`deal_status`, `stg_bcrs_t_cdr`.`sub_reference`, `stg_bcrs_t_cdr`.`securitization_reference`, `stg_bcrs_t_cdr`.`securitization_n`, `stg_bcrs_t_cdr`.`waterfall_seniority`, `stg_bcrs_t_cdr`.`risk_country`, `stg_bcrs_t_cdr`.`zone_a_original`, `stg_bcrs_t_cdr`.`zone_a_new`, `stg_bcrs_t_cdr`.`lgd_mitigation`, `stg_bcrs_t_cdr`.`crm_method`, `stg_bcrs_t_cdr`.`look_through_treatment`, `stg_bcrs_t_cdr`.`second_loss_treatment`, `stg_bcrs_t_cdr`.`risk_bucket`, `stg_bcrs_t_cdr`.`pool_code`, `stg_bcrs_t_cdr`.`incorporation_country`, `stg_bcrs_t_cdr`.`division_code`, `stg_bcrs_t_cdr`.`secu_loss_position`, `stg_bcrs_t_cdr`.`secu_issue_date`, `stg_bcrs_t_cdr`.`secu_ea_controlled`, `stg_bcrs_t_cdr`.`secu_company_weight`, `stg_bcrs_t_cdr`.`secu_bank_role`, `stg_bcrs_t_cdr`.`secu_mode`, `stg_bcrs_t_cdr`.`import_source`, `stg_bcrs_t_cdr`.`company_code`, `stg_bcrs_t_cdr`.`supervisor_code`, `stg_bcrs_t_cdr`.`ccy_code`, `stg_bcrs_t_cdr`.`settlement_price`, `stg_bcrs_t_cdr`.`days_after_contractual_date`, `stg_bcrs_t_cdr`.`delivery_type`, `stg_bcrs_t_cdr`.`mortgage_alternative`, `stg_bcrs_t_cdr`.`booking_company`, `stg_bcrs_t_cdr`.`booking_company_desc`, `stg_bcrs_t_cdr`.`gaap_code`, `stg_bcrs_t_cdr`.`number_of_obligor`, `stg_bcrs_t_cdr`.`security_positions_ref`, `stg_bcrs_t_cdr`.`guar_sub_reference`, `stg_bcrs_t_cdr`.`flag_adjustment`, `stg_bcrs_t_cdr`.`internal_maturity_class`, `stg_bcrs_t_cdr`.`equity_floor_applied`, `stg_bcrs_t_cdr`.`equity_preferential_treatment`, `stg_bcrs_t_cdr`.`fde_alternative_method`, `stg_bcrs_t_cdr`.`collateral_table_name`, `stg_bcrs_t_cdr`.`collateral_mode`, `stg_bcrs_t_cdr`.`funding_ccy`, `stg_bcrs_t_cdr`.`currency`, `stg_bcrs_t_cdr`.`incorporation_ccy_original`, `stg_bcrs_t_cdr`.`incorporation_ccy_new`, `stg_bcrs_t_cdr`.`credit_substitute`, `stg_bcrs_t_cdr`.`value_date`, `stg_bcrs_t_cdr`.`original_maturity`, `stg_bcrs_t_cdr`.`residual_maturity`, `stg_bcrs_t_cdr`.`booking_company_incorp_country`, `stg_bcrs_t_cdr`.`business_line_code`, `stg_bcrs_t_cdr`.`family`, `stg_bcrs_t_cdr`.`standard_rw_new`, `stg_bcrs_t_cdr`.`standard_rw_original`, `stg_bcrs_t_cdr`.`risk_bucket_original`, `stg_bcrs_t_cdr`.`collateral_assigned_amount`, `stg_bcrs_t_cdr`.`used_amount_facility`, `stg_bcrs_t_cdr`.`rwa_pre_floor_equity`, `stg_bcrs_t_cdr`.`bis_past_due_original`, `stg_bcrs_t_cdr`.`ltv`, `stg_bcrs_t_cdr`.`ltv_current`, `stg_bcrs_t_cdr`.`hr`, `stg_bcrs_t_cdr`.`hcr`, `stg_bcrs_t_cdr`.`und_pool_ref`, `stg_bcrs_t_cdr`.`asset_class_category_original`, `stg_bcrs_t_cdr`.`asset_class_category_new`, `stg_bcrs_t_cdr`.`netting_agreement_amount_1`, `stg_bcrs_t_cdr`.`netting_agreement_amount_2`, `stg_bcrs_t_cdr`.`netting_agreement_amount_3`, `stg_bcrs_t_cdr`.`netting_agreement_amount_4`, `stg_bcrs_t_cdr`.`netting_agreement_amount_5`, `stg_bcrs_t_cdr`.`netting_agreement_amount_6`, `stg_bcrs_t_cdr`.`netting_agreement_amount_7`, `stg_bcrs_t_cdr`.`entity_type_category_original`, `stg_bcrs_t_cdr`.`entity_type_category_new`, `stg_bcrs_t_cdr`.`ead_pro_write_off`, `stg_bcrs_t_cdr`.`ead_pro_discount`, `stg_bcrs_t_cdr`.`cpty_group`, `stg_bcrs_t_cdr`.`counterparty_new_desc`, `stg_bcrs_t_cdr`.`internal_rating_new_rank`, `stg_bcrs_t_cdr`.`uncommited`, `stg_bcrs_t_cdr`.`capital_item`, `stg_bcrs_t_cdr`.`product_gl_criteria`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_ori`, `stg_bcrs_t_cdr`.`sovereign_risk_bucket_new`, `stg_bcrs_t_cdr`.`secu_retail_line_fg`, `stg_bcrs_t_cdr`.`secu_uncommited_retail_fg`, `stg_bcrs_t_cdr`.`secu_spread_trapping_ratio`, `stg_bcrs_t_cdr`.`collateral_issuer`, `stg_bcrs_t_cdr`.`coll_issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`collateral_haircut_risk_bucket`, `stg_bcrs_t_cdr`.`guarantor`, `stg_bcrs_t_cdr`.`guarantor_bis_entity_type`, `stg_bcrs_t_cdr`.`ead_pro_gen`, `stg_bcrs_t_cdr`.`pd_pre_floor_original`, `stg_bcrs_t_cdr`.`pd_pre_floor_new`, `stg_bcrs_t_cdr`.`lgd_pre_floor_original`, `stg_bcrs_t_cdr`.`lgd_pre_floor_new`, `stg_bcrs_t_cdr`.`int_rating_agency_original`, `stg_bcrs_t_cdr`.`int_rating_agency_new`, `stg_bcrs_t_cdr`.`cpty_group_original`, `stg_bcrs_t_cdr`.`nominal`, `stg_bcrs_t_cdr`.`add_on`, `stg_bcrs_t_cdr`.`fair_value`, `stg_bcrs_t_cdr`.`amortized_cost`, `stg_bcrs_t_cdr`.`accrued_interest`, `stg_bcrs_t_cdr`.`amortized_cost_no_ias`, `stg_bcrs_t_cdr`.`adjustment_amount`, `stg_bcrs_t_cdr`.`outstanding`, `stg_bcrs_t_cdr`.`original_cost`, `stg_bcrs_t_cdr`.`accrued_fees`, `stg_bcrs_t_cdr`.`past_due_ppal`, `stg_bcrs_t_cdr`.`past_due_int`, `stg_bcrs_t_cdr`.`premium_current`, `stg_bcrs_t_cdr`.`cpty_new_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`cpty_orig_sebc_not_qualifying`, `stg_bcrs_t_cdr`.`effective_epe`, `stg_bcrs_t_cdr`.`ead_method`, `stg_bcrs_t_cdr`.`netting_class`, `stg_bcrs_t_cdr`.`bis_industry_sector_new`, `stg_bcrs_t_cdr`.`bis_industry_sector_original`, `stg_bcrs_t_cdr`.`bis_risk_area_new`, `stg_bcrs_t_cdr`.`bis_risk_area_original`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_new`, `stg_bcrs_t_cdr`.`bis_risk_sub_area_original`, `stg_bcrs_t_cdr`.`risk_country_new`, `stg_bcrs_t_cdr`.`risk_country_original`, `stg_bcrs_t_cdr`.`incorporation_country_new`, `stg_bcrs_t_cdr`.`incorporation_country_original`, `stg_bcrs_t_cdr`.`bis_performing_status`, `stg_bcrs_t_cdr`.`rwa_cap_ratio`, `stg_bcrs_t_cdr`.`exposure_amount_1`, `stg_bcrs_t_cdr`.`exposure_amount_2`, `stg_bcrs_t_cdr`.`final_beneficiary`, `stg_bcrs_t_cdr`.`collateral_valuation_date`, `stg_bcrs_t_cdr`.`unrestricted_psia_pct`, `stg_bcrs_t_cdr`.`restricted_psia_pct`, `stg_bcrs_t_cdr`.`collateral_issued_by_the_bank`, `stg_bcrs_t_cdr`.`guarantee_issued_by_the_bank`, `stg_bcrs_t_cdr`.`rated_borrower`, `stg_bcrs_t_cdr`.`long_short`, `stg_bcrs_t_cdr`.`external_rating_new`, `stg_bcrs_t_cdr`.`external_rating_original`, `stg_bcrs_t_cdr`.`external_rating_agency_new`, `stg_bcrs_t_cdr`.`external_rating_agency_orig`, `stg_bcrs_t_cdr`.`collateral_country`, `stg_bcrs_t_cdr`.`issuer`, `stg_bcrs_t_cdr`.`issuer_bis_entity_type`, `stg_bcrs_t_cdr`.`issuer_country`, `stg_bcrs_t_cdr`.`product_gl_criteria_2`, `stg_bcrs_t_cdr`.`positions_type`, `stg_bcrs_t_cdr`.`eligibility_risk_bucket`, `stg_bcrs_t_cdr`.`retail_purpose`, `stg_bcrs_t_cdr`.`color_id`, `stg_bcrs_t_cdr`.`past_due_days`, `stg_bcrs_t_cdr`.`collateral_asset_class`, `stg_bcrs_t_cdr`.`collateral_standard_rw`, `stg_bcrs_t_cdr`.`collateral_asset_class_cat`, `stg_bcrs_t_cdr`.`collateral_risk_bucket`, `stg_bcrs_t_cdr`.`coll_issuer_incorporation_ccy`, `stg_bcrs_t_cdr`.`fund_composition_ref`, `stg_bcrs_t_cdr`.`secu_retention_percentage`, `stg_bcrs_t_cdr`.`secu_retention_calc_method`, `stg_bcrs_t_cdr`.`rw_add_on`, `stg_bcrs_t_cdr`.`lgd_non_performing`, `stg_bcrs_t_cdr`.`ccf_std`, `stg_bcrs_t_cdr`.`concentration_ratio`, `stg_bcrs_t_cdr`.`ttc_lgd`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_code`, `stg_bcrs_t_cdr`.`counterparty_ext_rat_agency`, `stg_bcrs_t_cdr`.`counterparty_int_rat_code`, `stg_bcrs_t_cdr`.`counterparty_int_rat_agency`, `stg_bcrs_t_cdr`.`gl_strategy_code`, `stg_bcrs_t_cdr`.`k_function_used_original`, `stg_bcrs_t_cdr`.`long_gross_position`, `stg_bcrs_t_cdr`.`short_gross_position`, `stg_bcrs_t_cdr`.`correlation_trading`, `stg_bcrs_t_cdr`.`ead_pro_pre_ccf`, `stg_bcrs_t_cdr`.`ead_pro_write_off_pre_ccf`, `stg_bcrs_t_cdr`.`sup_reg_vers_code`, `stg_bcrs_t_cdr`.`dataset_version`, `stg_bcrs_t_cdr`.`clearing_house_code`, `stg_bcrs_t_cdr`.`contract_maturity_eff`, `stg_bcrs_t_cdr`.`counterparty_code_2`, `stg_bcrs_t_cdr`.`qualifying_transaction`, `stg_bcrs_t_cdr`.`qualifying_ccp`, `stg_bcrs_t_cdr`.`sov_rating_used`, `stg_bcrs_t_cdr`.`sov_rating_used_ori`, `stg_bcrs_t_cdr`.`current_ead_imm`, `stg_bcrs_t_cdr`.`current_maturity_eff_imm`, `stg_bcrs_t_cdr`.`obligor_grade_original`, `stg_bcrs_t_cdr`.`obligor_grade_new`, `stg_bcrs_t_cdr`.`deduction_step`, `stg_bcrs_t_cdr`.`significant_investment`, `stg_bcrs_t_cdr`.`el_std`, `stg_bcrs_t_cdr`.`deduction_pct`, `stg_bcrs_t_cdr`.`indirect_position`, `stg_bcrs_t_cdr`.`std_risk_bucket_ori`, `stg_bcrs_t_cdr`.`std_risk_bucket_new`, `stg_bcrs_t_cdr`.`ccp_dfund_method`, `stg_bcrs_t_cdr`.`secu_underlying_asset_type`, `stg_bcrs_t_cdr`.`margin_period`, `stg_bcrs_t_cdr`.`ead_scalar`, `stg_bcrs_t_cdr`.`crm_first_lien`, `stg_bcrs_t_cdr`.`available_amount`, `stg_bcrs_t_cdr`.`accounting_adjustment_type`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_1`, `stg_bcrs_t_cdr`.`acc_adjustment_amount_2`, `stg_bcrs_t_cdr`.`adjusted_value`, `stg_bcrs_t_cdr`.`ead_before_acc_adj`, `stg_bcrs_t_cdr`.`lgd_before_acc_adj`, `stg_bcrs_t_cdr`.`subset_code`, `stg_bcrs_t_cdr`.`el_rwa_part`, `stg_bcrs_t_cdr`.`industry_sector_original`, `stg_bcrs_t_cdr`.`cds_qualifying`, `stg_bcrs_t_cdr`.`default_date`, `stg_bcrs_t_cdr`.`credit_bureau_name_original`, `stg_bcrs_t_cdr`.`credit_bureau_name_refreshed`, `stg_bcrs_t_cdr`.`fico_original`, `stg_bcrs_t_cdr`.`fico_refreshed`, `stg_bcrs_t_cdr`.`pool_ead_formula`, `stg_bcrs_t_cdr`.`clearing_member`, `stg_bcrs_t_cdr`.`securitization_depth`, `stg_bcrs_t_cdr`.`securitization_loop`, `stg_bcrs_t_cdr`.`bankruptcy_remote`, `stg_bcrs_t_cdr`.`margin_type`, `stg_bcrs_t_cdr`.`collateral_bankruptcy_remote`, `stg_bcrs_t_cdr`.`collateral_margin_type`, `stg_bcrs_t_cdr`.`remargining_frequency`, `stg_bcrs_t_cdr`.`settlement_ccy`, `stg_bcrs_t_cdr`.`vm_extinguishes_mtm`, `stg_bcrs_t_cdr`.`margin_agreement`, `stg_bcrs_t_cdr`.`rw_pre_floor_new`, `stg_bcrs_t_cdr`.`rwa_pre_floor`, `stg_bcrs_t_cdr`.`ccp_exposure_type`, `stg_bcrs_t_cdr`.`carrying_amount`, `stg_bcrs_t_cdr`.`exchange_rate`, `stg_bcrs_t_cdr`.`policy_update`, `stg_bcrs_t_cdr`.`methodology_update`, `stg_bcrs_t_cdr`.`model_update`, `stg_bcrs_t_cdr`.`pd_model_update`, `stg_bcrs_t_cdr`.`lgd_model_update`, `stg_bcrs_t_cdr`.`ccf_model_update`, `stg_bcrs_t_cdr`.`ead_model_update`, `stg_bcrs_t_cdr`.`covered_ead`, `stg_bcrs_t_cdr`.`fi_type`, `stg_bcrs_t_cdr`.`maturity_date`, `stg_bcrs_t_cdr`.`policy_name`, `stg_bcrs_t_cdr`.`methodology_name`, `stg_bcrs_t_cdr`.`model_name`, `stg_bcrs_t_cdr`.`fund_reference`, `stg_bcrs_t_cdr`.`fund_method`, `stg_bcrs_t_cdr`.`fund_depth`, `stg_bcrs_t_cdr`.`fund_initial`, `stg_bcrs_t_cdr`.`rwa_pre_lvr`, `stg_bcrs_t_cdr`.`leverage`, `stg_bcrs_t_cdr`.`rw_el`, `stg_bcrs_t_cdr`.`use_beel`, `stg_bcrs_t_cdr`.`k_ratio`, `stg_bcrs_t_cdr`.`trade_date`, `stg_bcrs_t_cdr`.`sme_ceiling`, `stg_bcrs_t_cdr`.`sme_floor`, `stg_bcrs_t_cdr`.`sme_ceiling_indicator`, `stg_bcrs_t_cdr`.`fund_assets`, `stg_bcrs_t_cdr`.`obligor_grade_rank_original`, `stg_bcrs_t_cdr`.`obligor_grade_sup_original`, `stg_bcrs_t_cdr`.`obligor_grade_inf_original`, `stg_bcrs_t_cdr`.`obligor_grade_rank_new`, `stg_bcrs_t_cdr`.`obligor_grade_sup_new`, `stg_bcrs_t_cdr`.`obligor_grade_inf_new`, `stg_bcrs_t_cdr`.`lgd_grade_inf`, `stg_bcrs_t_cdr`.`lgd_grade_sup`, `stg_bcrs_t_cdr`.`lgd_grade_rank`, `stg_bcrs_t_cdr`.`lgd_grade`, `stg_bcrs_t_cdr`.`conservation_buffer`, `stg_bcrs_t_cdr`.`conservation_rgc`, `stg_bcrs_t_cdr`.`ctcycal_buffer`, `stg_bcrs_t_cdr`.`ctcycal_rgc`, `stg_bcrs_t_cdr`.`sifi_buffer`, `stg_bcrs_t_cdr`.`sifi_rgc`, `stg_bcrs_t_cdr`.`leverage_ead`, `stg_bcrs_t_cdr`.`at1_deduction`, `stg_bcrs_t_cdr`.`cet1_deduction`, `stg_bcrs_t_cdr`.`adjustment_tag`, `stg_bcrs_t_cdr`.`rw_new_grouping`, `stg_bcrs_t_cdr`.`nominal_at_rw_new`, `stg_bcrs_t_cdr`.`ead_at_rw_new`, `stg_bcrs_t_cdr`.`collateral_completed`, `stg_bcrs_t_cdr`.`rep_product`, `stg_bcrs_t_cdr`.`rep_collateral_product`, `stg_bcrs_t_cdr`.`ltv_indexed`, `stg_bcrs_t_cdr`.`origination_date`, `stg_bcrs_t_cdr`.`is_le`, `stg_bcrs_t_cdr`.`rep_industry_sector`, `stg_bcrs_t_cdr`.`scenario_process_step`, `stg_bcrs_t_cdr`.`period_id`, `stg_bcrs_t_cdr`.`period_start_date`, `stg_bcrs_t_cdr`.`period_end_date`, `stg_bcrs_t_cdr`.`scenario_process_name`, `stg_bcrs_t_cdr`.`scenario_process_id`, `stg_bcrs_t_cdr`.`regulatory_scenario_name`, `stg_bcrs_t_cdr`.`rep_asset_class`, `stg_bcrs_t_cdr`.`rep_sub_product`, `stg_bcrs_t_cdr`.`rep_arrears_band_mia`, `stg_bcrs_t_cdr`.`rep_arrears_band_pia`, `stg_bcrs_t_cdr`.`rep_payment_type`, `stg_bcrs_t_cdr`.`weighted_avg_rate`, `stg_bcrs_t_cdr`.`customer_field11`, `stg_bcrs_t_cdr`.`customer_field12`, `stg_bcrs_t_cdr`.`customer_field13`, `stg_bcrs_t_cdr`.`customer_field14`, `stg_bcrs_t_cdr`.`customer_field15`, `stg_bcrs_t_cdr`.`customer_field16`, `stg_bcrs_t_cdr`.`customer_field17`, `stg_bcrs_t_cdr`.`customer_field18`, `stg_bcrs_t_cdr`.`customer_field19`, `stg_bcrs_t_cdr`.`customer_field20`, `stg_bcrs_t_cdr`.`customer_field21`, `stg_bcrs_t_cdr`.`customer_number11`, `stg_bcrs_t_cdr`.`customer_number12`, `stg_bcrs_t_cdr`.`customer_number13`, `stg_bcrs_t_cdr`.`customer_number14`, `stg_bcrs_t_cdr`.`customer_number15`, `stg_bcrs_t_cdr`.`customer_number16`, `stg_bcrs_t_cdr`.`customer_number17`, `stg_bcrs_t_cdr`.`customer_number18`, `stg_bcrs_t_cdr`.`customer_date1`, `stg_bcrs_t_cdr`.`customer_date2`, `stg_bcrs_t_cdr`.`customer_date3`, `stg_bcrs_t_cdr`.`rep_major_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_ori`, `stg_bcrs_t_cdr`.`rep_major_asset_class_new`, `stg_bcrs_t_cdr`.`rep_asset_class_new`, `stg_bcrs_t_cdr`.`rep_sub_asset_class_new`, `stg_bcrs_t_cdr`.`rep_maturity_band`, `stg_bcrs_t_cdr`.`rep_segmentation`, `stg_bcrs_t_cdr`.`src_reporting_date`, `stg_bcrs_t_cdr`.`src_wks_name`, `stg_bcrs_t_cdr`.`src_position`, `stg_bcrs_t_cdr`.`generic_reporting_date`, `stg_bcrs_t_cdr`.`generic_wks_name`, `stg_bcrs_t_cdr`.`generic_position`, `stg_bcrs_t_cdr`.`securitization_mm`, `stg_bcrs_t_cdr`.`securitization_mm_factor`, `stg_bcrs_t_cdr`.`is_eligible_cva`, `stg_bcrs_t_cdr`.`audit_cva_eligibility`, `stg_bcrs_t_cdr`.`ead_pro_cva`, `stg_bcrs_t_cdr`.`generic_field1`, `stg_bcrs_t_cdr`.`generic_field2`, `stg_bcrs_t_cdr`.`generic_field3`, `stg_bcrs_t_cdr`.`generic_field4`, `stg_bcrs_t_cdr`.`generic_field5`, `stg_bcrs_t_cdr`.`generic_field6`, `stg_bcrs_t_cdr`.`generic_field7`, `stg_bcrs_t_cdr`.`generic_field8`, `stg_bcrs_t_cdr`.`generic_field9`, `stg_bcrs_t_cdr`.`generic_field10`, `stg_bcrs_t_cdr`.`generic_number1`, `stg_bcrs_t_cdr`.`generic_number2`, `stg_bcrs_t_cdr`.`generic_number3`, `stg_bcrs_t_cdr`.`generic_number4`, `stg_bcrs_t_cdr`.`generic_number5`, `stg_bcrs_t_cdr`.`generic_number6`, `stg_bcrs_t_cdr`.`generic_number7`, `stg_bcrs_t_cdr`.`generic_number8`, `stg_bcrs_t_cdr`.`generic_number9`, `stg_bcrs_t_cdr`.`generic_number10`, `stg_bcrs_t_cdr`.`customer_field1`, `stg_bcrs_t_cdr`.`customer_field2`, `stg_bcrs_t_cdr`.`customer_field3`, `stg_bcrs_t_cdr`.`customer_field4`, `stg_bcrs_t_cdr`.`customer_field5`, `stg_bcrs_t_cdr`.`customer_field6`, `stg_bcrs_t_cdr`.`customer_field7`, `stg_bcrs_t_cdr`.`customer_field8`, `stg_bcrs_t_cdr`.`customer_field9`, `stg_bcrs_t_cdr`.`customer_field10`, `stg_bcrs_t_cdr`.`customer_number1`, `stg_bcrs_t_cdr`.`customer_number2`, `stg_bcrs_t_cdr`.`customer_number3`, `stg_bcrs_t_cdr`.`customer_number4`, `stg_bcrs_t_cdr`.`customer_number5`, `stg_bcrs_t_cdr`.`customer_number6`, `stg_bcrs_t_cdr`.`customer_number7`, `stg_bcrs_t_cdr`.`customer_number8`, `stg_bcrs_t_cdr`.`customer_number9`, `stg_bcrs_t_cdr`.`customer_number10`, `stg_bcrs_t_cdr`.`run_date`, `stg_bcrs_t_cdr`.`process_profile_sr_id`, `stg_bcrs_t_cdr`.`conso_perimeter`, `stg_bcrs_t_cdr`.`interco`, `stg_bcrs_t_cdr`.`interco_type`, `stg_bcrs_t_cdr`.`valid_cpy_perimeter`, `stg_bcrs_t_cdr`.`issuer_id`, `stg_bcrs_t_cdr`.`approver_id`, `stg_bcrs_t_cdr`.`upload_date`, `stg_bcrs_t_cdr`.`approval_date`, `stg_bcrs_t_cdr`.`adj_batch_date`, `stg_bcrs_t_cdr`.`source_file_name`, `stg_bcrs_t_cdr`.`adj_seq`, `stg_bcrs_t_cdr`.`dp_rule_log`, `stg_bcrs_t_cdr`.`staging_source`, `stg_bcrs_t_cdr`.`id`, `stg_bcrs_t_cdr`.`parent_id`, `stg_bcrs_t_cdr`.`child_id`, `stg_bcrs_t_cdr`.`multipurpose_audit`, `stg_bcrs_t_cdr`.`saccr_pfe`, `stg_bcrs_t_cdr`.`saccr_rc`, `stg_bcrs_t_cdr`.`flag_deduction`, `stg_bcrs_t_cdr`.`business`, `stg_bcrs_t_cdr`.`business_identifier`, `stg_bcrs_t_cdr`.`management_product`, `stg_bcrs_t_cdr`.`w_snapshot_dt`, `stg_bcrs_t_cdr`.`w_datasource_id`, `stg_bcrs_t_cdr`.`w_country_cd`, `stg_bcrs_t_cdr`.`w_batch_id`,          (                 CASE                     WHEN nvl(`stg_bcrs_t_cdr`.`table_name`,'z') IN (                         'BOND',                         'EQUITY',                         'TRANCHE',                         'CONVERTIBLE',                         'FUND'                     ) THEN 'SECURITY_POSITIONS'                     ELSE nvl(`stg_bcrs_t_cdr`.`table_name`,'z')                 END             ) AS `sec_table_name`        FROM             `sgmisitstg`.`stg_bcrs_t_cdr`   ) `t`   left join (SELECT distinct `stg_bcrs_scb_wb_mpdt_override`.`contract_reference` as `CTRF`,`stg_bcrs_scb_wb_mpdt_override`.`mpdt_code` as `L7_CODE`,`stg_bcrs_scb_wb_mpdt_override`.`w_batch_id`  FROM `sgmisitstg`.`STG_BCRS_SCB_WB_MPDT_OVERRIDE` where w_batch_id in (SELECT max(`jbs_batch`.`batch_id`) FROM `sgmisitetl`.`jbs_batch` WHERE `jbs_batch`.`reporting_dt` =  '2021-08-31' AND `jbs_batch`.`regime` = 'WS7')) `force_map` on `t`.`contract_reference`=`force_map`.`ctrf`   left join `sgmisitstg`.`stg_bcrs_companies_links` `complink` on `t`.`booking_company` = `complink`.`child_code` AND `complink`.`w_batch_id` = '2021121322042700331'   left join (          SELECT `stg_bcrs_t_cdr`.`contract_reference`, SUM(`stg_bcrs_t_cdr`.`rwa`) AS `SUM_RWA`,count(`stg_bcrs_t_cdr`.`contract_reference`) as `count_contract_ref`         FROM `sgmisitstg`.`stg_bcrs_t_cdr`         WHERE `stg_bcrs_t_cdr`.`w_batch_id` = '2021121322042700331'         GROUP BY `stg_bcrs_t_cdr`.`contract_reference`         ) `t2` on `t`.`contract_reference` = `t2`.`contract_reference`          left join `sgmisitstg`.`stg_bcrs_scb_gpr_default_indicator` `grpdfind` on `t`.`contract_type` = `grpdfind`.`indicator_value` AND `grpdfind`.`w_batch_id` = '2021121322042700331'   LEFT JOIN (  select `csrt`.`contract_reference`, `csrt`.`start_date`, `csrt`.`maturity_date`, `csrt`.`import_source`, `csrt`.`value_date`, `csrt`.`w_batch_id`, `csrt`.`rnk` from ( SELECT DISTINCT             `stg_bcrs_csr`.`contract_reference`,             `stg_bcrs_csr`.`start_date`,             `stg_bcrs_csr`.`maturity_date`,             `stg_bcrs_csr`.`import_source`,             `stg_bcrs_csr`.`value_date`,             `stg_bcrs_csr`.`w_batch_id`,             ROW_NUMBER() OVER(ORDER BY `stg_bcrs_csr`.`start_date` asc) `rnk`         FROM `sgmisitstg`.`stg_bcrs_csr` ) `csrt`                   WHERE `csrt`.`import_source` NOT LIKE '%WB%'         AND `csrt`.`rnk` = 1 ) `csr` ON `t`.`contract_reference` = `csr`.`contract_reference`  AND CASE WHEN 'WS29' like '%ADJ%' THEN `csr`.`w_batch_id` = '2021121322042700331' ELSE `csr`.`w_batch_id` = '2021121322042700331' END       LEFT JOIN ( SELECT DISTINCT             `e`.`entity_code`,             `e`.`entity_desc`,             `e`.`attribute_4`,             `e`.`attribute_1`,             `e`.`incorporation_country`,             `e`.`origination_country`,             `cfi`.`scorecard_segment_code`,             `cfi`.`scorecard_segment_category`,             `cfi`.`cf_indicator`,             `e`.`attribute_7`,             `cd1`.`code_desc` AS `customer_segment_desc`,             `e`.`attribute_8`,             `cd2`.`code_desc` AS `customer_subsegment_desc`,             `e`.`et_code_user`,             `icr`.`long_term_rating`,             `icr`.`long_term_rating_local_ccy`,             `e`.`country_code`             , `el`.`bf_link_type`             , `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`  `e`                   LEFT JOIN `sgmisitstg`.`stg_bcrs_issuer_credit_ratings` `icr` ON `e`.`entity_code` = `icr`.`entity_code`                                                    AND nvl(`icr`.`agency_code`,'z') = 'INTERNAL'                                                    AND `icr`.`w_batch_id` = '2021121322042700331'           LEFT JOIN ( SELECT DISTINCT  `links`.`child_code`,                          case when `linktype`.`link_type` is not null then 'BUYER_FINANCE' else null end `bf_link_type`                         FROM `sgmisitstg`.`stg_bcrs_entity_links` `links` left join (SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                 FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`) `linktype`                                  WHERE `links`.`link_type` IN ( SELECT DISTINCT `stg_bcrs_scb_wb_bf_uns_recoveries`.`link_type`                                         FROM `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`   ))  `el`              ON `e`.`entity_code` = `el`.`child_code`                      LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_co_fi` `cfi` ON `e`.`attribute_1` = `cfi`.`scorecard_segment`         AND `cfi`.`w_batch_id` = '2021121322042700331'                   LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')         AND `cd1`.`code_type` = 'CUST_SEG'         AND `cd1`.`w_batch_id` = '2021121322042700331'                   LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd2` ON nvl(`cd2`.`code`,'zz') = nvl(`e`.`attribute_8`,'zz')         AND `cd2`.`code_type` = 'CUST_SUB_SEG'         AND `cd2`.`w_batch_id` = '2021121322042700331'           ) `e` ON `t`.`counterparty_original` = `e`.`entity_code` AND `e`.`w_batch_id` = '2021121322042700331'  LEFT JOIN (         SELECT DISTINCT             `e`.`entity_code`,             `e`.`attribute_7` AS `group_cust_segment_code`,             `cd1`.`code_desc` AS `group_cust_segment_desc`,             `e`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity` `e`                           LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_wb_code_desc` `cd1` ON nvl(`cd1`.`code`,'z') = nvl(`e`.`attribute_7`,'z')                    AND `cd1`.`code_type` = 'CUST_SEG'                    AND `cd1`.`w_batch_id` = '2021121322042700331'    where `e`.`w_batch_id` = '2021121322042700331' ) `egroup_orig` ON `t`.`cpty_group_original` = `egroup_orig`.`entity_code`  and `egroup_orig`.`w_batch_id` = '2021121322042700331'  LEFT JOIN ( SELECT DISTINCT             `stg_bcrs_entity`.`entity_code`,             `stg_bcrs_entity`.`attribute_1`,             `stg_bcrs_entity`.`origination_country`,             `stg_bcrs_entity`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_entity`         where `stg_bcrs_entity`.`w_batch_id` = '2021121322042700331' ) `enew` ON `t`.`counterparty_new` = `enew`.`entity_code`   LEFT JOIN ( SELECT             `stg_bcrs_companies`.`company_code`,             `stg_bcrs_companies`.`country_code`,             `stg_bcrs_companies`.`w_batch_id`         FROM `sgmisitstg`.`stg_bcrs_companies`         where `stg_bcrs_companies`.`w_batch_id` = '2021121322042700331' ) `cpies` ON `t`.`booking_company` = `cpies`.`company_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_scb_wb_bf_uns_recoveries`.`domicile_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`booking_country_code`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`contract_type`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`cf_ind`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`prr`,             `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_bf_uns_recoveries`         where `stg_bcrs_scb_wb_bf_uns_recoveries`.`w_batch_id` = '2021121322042700331'      ) `bf` ON `bf`.`domicile_country_code` = `e`.`country_code`             AND `bf`.`booking_country_code` = `cpies`.`country_code`             AND `bf`.`contract_type` = `t`.`contract_type`             AND `bf`.`cf_ind` = `e`.`cf_indicator`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_contract_types`.`ct_code_user`,             `stg_bcrs_contract_types`.`ct_desc_user`,             `stg_bcrs_contract_types`.`attribute_2`,             `stg_bcrs_contract_types`.`w_batch_id`         FROM             `sgmisitstg`.`stg_bcrs_contract_types`             where              `stg_bcrs_contract_types`.`w_batch_id` = '2021121322042700331'      ) `ct` ON `t`.`contract_type` = `ct`.`ct_code_user`  Left Join ( select distinct  `stg_bcrs_contract_types`.`ct_code_user`, `stg_bcrs_contract_types`.`contract_category`, `stg_bcrs_contract_types`.`w_batch_id` from  `sgmisitstg`.`stg_bcrs_contract_types` where   `stg_bcrs_contract_types`.`w_batch_id` = '2021121322042700331' and `stg_bcrs_contract_types`.`contract_category` = 'RECEIVABLE' ) `contracttype` on `t`.`contract_type` = `contracttype`.`ct_code_user`           LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`amount`,             `stg_bcrs_facility`.`attribute_1`,             `stg_bcrs_facility`.`attribute_2`,             `stg_bcrs_facility`.`attribute_3`,             `stg_bcrs_facility`.`attribute_4`,             `stg_bcrs_facility`.`attribute_7` AS `non_gam_ind`,             `stg_bcrs_facility`.`attribute_8` AS `holdco_ind`,             `stg_bcrs_facility`.`trade_date`,             `stg_bcrs_facility`.`maturity_date`         FROM             `sgmisitstg`.`stg_bcrs_facility`         WHERE              `stg_bcrs_facility`.`w_batch_id` = '2021121322042700331'      ) `fac` ON `t`.`contract_reference` = `fac`.`contract_reference`      LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_mkt_fx_input`.`booking_company_code`,             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL'             AND `stg_bcrs_mkt_fx_input`.`w_batch_id` = '2021121322042700331'      ) `cer` ON `t`.`booking_company` = `cer`.`booking_company_code`              AND `t`.`currency` = `cer`.`ccy_code`  LEFT JOIN (         SELECT DISTINCT             `stg_bcrs_country`.`country_code`,             `stg_bcrs_country`.`country_name`         FROM             `sgmisitstg`.`stg_bcrs_country`         WHERE              `stg_bcrs_country`.`w_batch_id` = '2021121322042700331'      ) `c` ON `t`.`incorporation_country_original` = `c`.`country_code`     LEFT JOIN (     select `prrsrtmp`.`partition_key`, `prrsrtmp`.`cf_indicator`, `prrsrtmp`.`product_code`, `prrsrtmp`.`prr`, `prrsrtmp`.`country`, `prrsrtmp`.`banking_type`, `prrsrtmp`.`w_datasource_id`, `prrsrtmp`.`w_workspace`, `prrsrtmp`.`rnk` from (         SELECT             `sgmi_scb_prr_dat`.`partition_key`,             `sgmi_scb_prr_dat`.`cf_indicator`,              `sgmi_scb_prr_dat`.`product_code`,              `sgmi_scb_prr_dat`.`product_recovery_rate` `prr`,              `sgmi_scb_prr_dat`.`country`,             `sgmi_scb_prr_dat`.`banking_type`,             `sgmi_scb_prr_dat`.`w_datasource_id`,             `sgmi_scb_prr_dat`.`w_workspace`,             ROW_NUMBER() OVER( PARTITION BY `sgmi_scb_prr_dat`.`product_code`, `sgmi_scb_prr_dat`.`country` ORDER BY `sgmi_scb_prr_dat`.`partition_key`) AS `rnk`         FROM             `sgmisit`.`SGMI_SCB_PRR_DAT` ) `prrsrtmp`         where             `prrsrtmp`.`rnk` = 1     ) `prrsr` ON `t`.`contract_type` = `prrsr`.`product_code`              AND `t`.`incorporation_country` = `prrsr`.`country`              AND `t`.`table_name` in ('ON_OFF_BALANCE', 'FACILITY', 'DEAL_IMPORT', 'CAPFLOOR', 'COMMODITY_SWAP', 'EQUITY_SWAP', 'EXCHANGE_OPTION', 'FRA', 'FOREX', 'FUTURE', 'OPTIONS', 'SWAP', 'BOND', 'SECURITY_POSITION', 'LOANDEPO','REPO_NETTING_VOL','COLLATERAL')              AND nvl(`t`.`deal_status`,'') = ''              AND `t`.`risk_type` = 'CRE'               AND nvl(`t`.`sub_reference`,'') = ''              AND nvl(`t`.`guarantee_reference`, '') = ''              AND `t`.`method_original` = 'ADV'               AND `t`.`w_datasource_id` = `prrsr`.`w_datasource_id`              AND `prrsr`.`banking_type` = 'WB'              AND SUBSTR(`prrsr`.`partition_key`,-2,2) = SUBSTR(`t`.`partition_key`,-2,2)                               LEFT JOIN (             select `addtinst`.`contract_reference`, `addtinst`.`table_name`, `addtinst`.`tp_portfolio_name`, `addtinst`.`psgl_department_id`, `addtinst`.`psgl_product_code`, `addtinst`.`psgl_operating_unit`, `addtinst`.`psgl_customer_class`, `addtinst`.`rnk` from (                 SELECT                     `stg_bcrs_scb_wb_addt_inst`.`contract_reference`,                     `stg_bcrs_scb_wb_addt_inst`.`table_name`,                     `stg_bcrs_scb_wb_addt_inst`.`tp_portfolio_name`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_department_id`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_product_code`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_operating_unit`,                     `stg_bcrs_scb_wb_addt_inst`.`psgl_customer_class`,                     ROW_NUMBER() OVER( PARTITION BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name` ORDER BY `stg_bcrs_scb_wb_addt_inst`.`contract_reference`, `stg_bcrs_scb_wb_addt_inst`.`table_name`) AS `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_addt_inst` where `stg_bcrs_scb_wb_addt_inst`.`w_batch_id` = '2021121322042700331') `addtinst`                              WHERE                         `addtinst`.`rnk` = 1     ) `inst` ON `inst`.`contract_reference` = `t`.`contract_reference`               AND `inst`.`table_name` = `t`.`sec_table_name`                               LEFT JOIN (         SELECT             nvl(`split_ref`.`contract_reference`,`a`.`contract_reference`) `contract_reference`,             `a`.`psgl_cust_class`,             `a`.`psgl_product`,             TRIM(`a`.`psgl_department`) `psgl_department`,             `a`.`fermat_table_name`         FROM             (                 SELECT DISTINCT                     `b`.`contract_reference`,                     `b`.`fermat_table_name`,                     `b`.`psgl_cust_class`,                     `b`.`psgl_product`,                     `b`.`psgl_department`,                     `c`.`priority`,                     ROW_NUMBER() OVER(PARTITION BY `b`.`contract_reference`, `b`.`fermat_table_name` ORDER BY `c`.`priority`) `rnk`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_psgl` `b`                     left join `sgmisitstg`.`stg_bcrs_scb_wb_amt_cat_priority` `c`                                         on `b`.`fermat_table_name` = `c`.`table_name`                      and `b`.`amount_category_dw_sorsa` = `c`.`amount_category_dw_sorsa`                     and `b`.`psgl_product` <> 'ZZZ'                     and `b`.`w_batch_id`='2021121322042700331'                      and `b`.`w_batch_id` = `c`.`w_batch_id`                                     ) `a`             left join             (                 SELECT DISTINCT                     `stg_bcrs_scb_wb_facility_links`.`contract_reference`,                     `stg_bcrs_scb_wb_facility_links`.`attribute_1` AS `orig_cont_ref`                 FROM                     `sgmisitstg`.`stg_bcrs_scb_wb_facility_links`                 WHERE                     `stg_bcrs_scb_wb_facility_links`.`attribute_1` IS NOT NULL and `stg_bcrs_scb_wb_facility_links`.`w_batch_id`='2021121322042700331'             ) `split_ref`         on             `a`.`contract_reference` = `split_ref`.`orig_cont_ref`             where   `a`.`rnk` = 1     ) `psgl` ON `t`.`contract_reference` = `psgl`.`contract_reference`               AND `t`.`sec_table_name` = `psgl`.`fermat_table_name`                                                 LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_mpdt_mru_map`.`mru_desc`,             `stg_bcrs_scb_wb_mpdt_mru_map`.`mpdt_code`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_mpdt_mru_map` where `stg_bcrs_scb_wb_mpdt_mru_map`.`w_batch_id`='2021121322042700331'     ) `mru_bus` ON `mru_bus`.`mpdt_code` = `t`.`management_product`                        LEFT JOIN `sgmisitstg`.`stg_bcrs_fdw_netting_agreement` `net` ON `net`.`agreement_reference` = `t`.`netting_agreement_reference`     and `net`.`w_batch_id`='2021121322042700331'          LEFT JOIN (         SELECT             `stg_bcrs_scb_wb_fac_sub_limits`.`id`,             `stg_bcrs_scb_wb_fac_sub_limits`.`contract_reference`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_attribute`,             `stg_bcrs_scb_wb_fac_sub_limits`.`limit_amount`         FROM             `sgmisitstg`.`stg_bcrs_scb_wb_fac_sub_limits` where `stg_bcrs_scb_wb_fac_sub_limits`.`w_batch_id`='2021121322042700331'     ) `sub` ON `t`.`id` = `sub`.`id`          LEFT JOIN (         SELECT             `stg_bcrs_facility`.`contract_reference`,             `stg_bcrs_facility`.`book_code`,             `stg_bcrs_facility`.`currency`         FROM             `sgmisitstg`.`stg_bcrs_facility` where `stg_bcrs_facility`.`w_batch_id`='2021121322042700331'     ) `fac_curr` ON `sub`.`contract_reference` = `fac_curr`.`contract_reference`       LEFT JOIN (         SELECT             `stg_bcrs_deal_book`.`booking_company`,             `stg_bcrs_deal_book`.`book_code`         FROM             `sgmisitstg`.`stg_bcrs_deal_book` where `stg_bcrs_deal_book`.`w_batch_id`='2021121322042700331'     ) `dealbook` ON `dealbook`.`book_code` = `fac_curr`.`book_code`          LEFT JOIN (         SELECT             `stg_bcrs_mkt_fx_input`.`ccy_code`,             `stg_bcrs_mkt_fx_input`.`rate` `exch_rate`,             `stg_bcrs_mkt_fx_input`.`booking_company_code`         FROM             `sgmisitstg`.`stg_bcrs_mkt_fx_input`         WHERE             `stg_bcrs_mkt_fx_input`.`fx_input_set` = 'GRP_PE_ACTUAL' and `stg_bcrs_mkt_fx_input`.`w_batch_id`='2021121322042700331'     ) `fac_curr_exch` ON `fac_curr_exch`.`ccy_code` = `fac_curr`.`currency`                        AND `fac_curr_exch`.`booking_company_code` = `dealbook`.`booking_company`                               LEFT JOIN (         SELECT             `stg_bcrs_t_cva`.`contract_reference`,             count(`stg_bcrs_t_cva`.`contract_reference`) as `count_contract_ref`,             SUM(nvl(`stg_bcrs_t_cva`.`cva_rwa`,0) ) `cva_rwa`         FROM             `sgmisitstg`.`stg_bcrs_t_cva` where `stg_bcrs_t_cva`.`w_batch_id`='2021121322042700331'         GROUP BY             `stg_bcrs_t_cva`.`contract_reference`     ) `tcva` ON `tcva`.`contract_reference` = `t`.`contract_reference`              LEFT JOIN `sgmisitstg`.`stg_bcrs_scb_mru_business_idntfr_map` `bus_ind`      ON `bus_ind`.`business_identifier` = `t`.`business_identifier` and `bus_ind`.`w_batch_id`='2021121322042700331'      where `t`.`w_batch_id` = '2021121322042700331'       and `t`.`w_snapshot_dt` = '2021-08-31'     and `t`.`w_datasource_id` = 'BCRS_ND'     and `t`.`w_country_cd`='SG'      and IF(`t`.`import_source`='PSGLS-WBDS',false, IF(instr(`t`.`import_source`,'WB')>0,true,false))
CREATE VIEW `temp_src_query_2112140903430080579` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`, case when `comb`.`booking_loc_id`='SG' OR   IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`) in ('SG','UNMAPPED') OR   `lmt_ref`.`edm_limit_booking_loc` ='SG' then 'SG' else 'OTHERS' end AS `SECURITY_CTRY`, case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`) `ccr_eq_cntry`,  `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-08-31' AND `exp_f`.`w_datasource_id` = 'BCRS_ND' AND `exp_f`.`w_country_cd` =  'SG' AND `exp_f`.`w_workspace` = 'WS36'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-08-31' AND `lmt_f`.`w_datasource_id` = 'BCRS_ND' AND `lmt_f`.`w_country_cd` =  'SG'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-08-31' AND `col_f`.`w_datasource_id` = 'BCRS_ND' AND `col_f`.`w_country_cd` =  'SG' AND `col_f`.`w_workspace` = split('WS36','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-08-31' AND `lmt_ref`.`w_datasource_id` = 'BCRS_ND' AND `lmt_ref`.`w_country_cd` =  'SG'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-08-31' AND `col_ref`.`w_datasource_id` = 'BCRS_ND' AND `col_ref`.`w_country_cd` =  'SG' AND `col_ref`.`w_workspace` = split('WS36','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-08-31' AND `obl`.`w_datasource_id`='BCRS_ND' AND `obl`.`w_country_cd`='SG'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-08-31' AND `gua`.`w_datasource_id`='BCRS_ND' AND `obl`.`w_country_cd`='SG'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-08-31' AND `client`.`w_datasource_id`='BCRS_ND' AND `client`.`w_country_cd`='SG'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-08-31' AND `limit_cl`.`w_datasource_id` = 'BCRS_ND'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-08-31' AND `coll_owner`.`w_datasource_id` = 'BCRS_ND'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-08-31' AND `br`.`w_datasource_id` = 'BCRS_ND'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_ND'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_ND'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-08-31' and `exc_rate_usd`.`w_datasource_id`='BCRS_ND' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_ND' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_ND' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='SG'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-08-31'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-08-31'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021121322042700331'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-08-31' AND `comb`.`w_datasource_id` = 'BCRS_ND' AND `comb`.`w_country_cd` =  'SG' AND `comb`.`w_workspace`='WS36'     AND (`comb`.`booking_loc_id`='SG' OR  IF(nvl(`ccr`.`country_code`,'')=='',    IF(nvl(`exp_f`.`ccr_new`,'')=='',     IF(nvl(`client`.`client_domicile_loc_id`,'')=='',      IF(nvl(`client`.`coi_loc_id`,'')=='',       IF(`exp_f`.`security_seg` in ('RT','PB'),'SG','UNMAPPED'),      `client`.`coi_loc_id`) ,     `client`.`client_domicile_loc_id`) ,    `exp_f`.`ccr_new`),   `ccr`.`country_code`)  IN ('SG') OR    `lmt_ref`.`edm_limit_booking_loc` ='SG')
CREATE VIEW `temp_src_query_2112141923370011646` AS Select DISTINCT `a`.`client_le_wid` `CLIENT_LE_WID`, `a`.`client_le_id` `CLIENT_LE_ID`, `ent`.`entity_desc` `CLIENT_LE_NAME`, `ent`.`country_code` `CLIENT_LE_DOMICILE_LOC_ID`, `ent`.`attribute_8` `CLIENT_LE_SUBSEGMENT_ID`, `cr`.`long_term_rating` `CLIENT_LE_LATEST_CRG_ID`, `e`.`mother_code` `CLIENT_GROUP_ID`  FROM `sgmisit`.`SGMI_CLIENT_D` `A` LEFT JOIN (SELECT `stg_bcrs_entity`.`partition_key`, `stg_bcrs_entity`.`entity_code`, `stg_bcrs_entity`.`entity_desc`, `stg_bcrs_entity`.`group_code`, `stg_bcrs_entity`.`country_code`, `stg_bcrs_entity`.`et_code_user`, `stg_bcrs_entity`.`swaps_netting_ind`, `stg_bcrs_entity`.`swaps_margin_call_ind`, `stg_bcrs_entity`.`repos_margin_call_ind`, `stg_bcrs_entity`.`flag_trigger_before`, `stg_bcrs_entity`.`flag_trigger_after`, `stg_bcrs_entity`.`attribute_1`, `stg_bcrs_entity`.`attribute_2`, `stg_bcrs_entity`.`attribute_3`, `stg_bcrs_entity`.`attribute_4`, `stg_bcrs_entity`.`amount_1`, `stg_bcrs_entity`.`amount_2`, `stg_bcrs_entity`.`country_of_residence`, `stg_bcrs_entity`.`branch_subsidiary`, `stg_bcrs_entity`.`sebc_not_qualifying`, `stg_bcrs_entity`.`long_name`, `stg_bcrs_entity`.`street_1`, `stg_bcrs_entity`.`street_2`, `stg_bcrs_entity`.`zip_code`, `stg_bcrs_entity`.`state`, `stg_bcrs_entity`.`city`, `stg_bcrs_entity`.`risk_area`, `stg_bcrs_entity`.`risk_sub_area`, `stg_bcrs_entity`.`status`, `stg_bcrs_entity`.`identifier_1`, `stg_bcrs_entity`.`economic_sector`, `stg_bcrs_entity`.`admin_profile_id`, `stg_bcrs_entity`.`birth_date`, `stg_bcrs_entity`.`cad_type`, `stg_bcrs_entity`.`industry_sector`, `stg_bcrs_entity`.`review_date`, `stg_bcrs_entity`.`incorporation_country`, `stg_bcrs_entity`.`outlook_rating`, `stg_bcrs_entity`.`internet_address`, `stg_bcrs_entity`.`email_address`, `stg_bcrs_entity`.`bankscope_code`, `stg_bcrs_entity`.`cad_parameter`, `stg_bcrs_entity`.`lt_internal_rating`, `stg_bcrs_entity`.`total_annual_sales`, `stg_bcrs_entity`.`total_assets`, `stg_bcrs_entity`.`total_currency`, `stg_bcrs_entity`.`is_lombard`, `stg_bcrs_entity`.`default_flag`, `stg_bcrs_entity`.`internal_rating_bsc`, `stg_bcrs_entity`.`entity_gl_criteria`, `stg_bcrs_entity`.`specialized_lending`, `stg_bcrs_entity`.`entity_code_2`, `stg_bcrs_entity`.`lt_internal_rating_date`, `stg_bcrs_entity`.`total_sales_date`, `stg_bcrs_entity`.`total_assets_date`, `stg_bcrs_entity`.`continuous_pd`, `stg_bcrs_entity`.`rating_method`, `stg_bcrs_entity`.`claims_by_other_banks`, `stg_bcrs_entity`.`attribute_5`, `stg_bcrs_entity`.`attribute_6`, `stg_bcrs_entity`.`attribute_7`, `stg_bcrs_entity`.`attribute_8`, `stg_bcrs_entity`.`attribute_9`, `stg_bcrs_entity`.`managed_as_retail`, `stg_bcrs_entity`.`import_source`, `stg_bcrs_entity`.`long_desc`, `stg_bcrs_entity`.`suficient_info_on_default`, `stg_bcrs_entity`.`avoid_reclassification`, `stg_bcrs_entity`.`impairment_status`, `stg_bcrs_entity`.`business_type`, `stg_bcrs_entity`.`client_ranking`, `stg_bcrs_entity`.`relationship_start_date`, `stg_bcrs_entity`.`staging_source`, `stg_bcrs_entity`.`origination_country`, `stg_bcrs_entity`.`entity_type`, `stg_bcrs_entity`.`connected_cpty`, `stg_bcrs_entity`.`annual_salary`, `stg_bcrs_entity`.`financials_available`, `stg_bcrs_entity`.`degree_monitoring`, `stg_bcrs_entity`.`nb_of_employees`, `stg_bcrs_entity`.`attribute_10`, `stg_bcrs_entity`.`attribute_11`, `stg_bcrs_entity`.`attribute_12`, `stg_bcrs_entity`.`attribute_13`, `stg_bcrs_entity`.`attribute_14`, `stg_bcrs_entity`.`attribute_15`, `stg_bcrs_entity`.`attribute_16`, `stg_bcrs_entity`.`attribute_17`, `stg_bcrs_entity`.`attribute_18`, `stg_bcrs_entity`.`attribute_19`, `stg_bcrs_entity`.`amount_1_ccy`, `stg_bcrs_entity`.`amount_2_ccy`, `stg_bcrs_entity`.`solvency_ratio`, `stg_bcrs_entity`.`flag_subject_to_sii`, `stg_bcrs_entity`.`flag_meet_mcr`, `stg_bcrs_entity`.`unregulated_fi`, `stg_bcrs_entity`.`flag_subject_to_similar_sii`, `stg_bcrs_entity`.`flag_regulatory_cr_met`, `stg_bcrs_entity`.`flag_sii_scr_authorized`, `stg_bcrs_entity`.`written_premium`, `stg_bcrs_entity`.`underwriting_performance`, `stg_bcrs_entity`.`investment_performance`, `stg_bcrs_entity`.`total_performance`, `stg_bcrs_entity`.`assessment_for_scr_grp_method`, `stg_bcrs_entity`.`internal_model`, `stg_bcrs_entity`.`internal_model_approval`, `stg_bcrs_entity`.`internal_model_change_approval`, `stg_bcrs_entity`.`capital_add_on_decision`, `stg_bcrs_entity`.`capital_add_on_reason`, `stg_bcrs_entity`.`established_relationship`, `stg_bcrs_entity`.`lgd`, `stg_bcrs_entity`.`default_date`, `stg_bcrs_entity`.`forbearance_measures`, `stg_bcrs_entity`.`probation_period_flag`, `stg_bcrs_entity`.`forbearance_date`, `stg_bcrs_entity`.`portfolio_financial_system`, `stg_bcrs_entity`.`w_snapshot_dt`, `stg_bcrs_entity`.`w_datasource_id`, `stg_bcrs_entity`.`w_country_cd`, `stg_bcrs_entity`.`w_batch_id` FROM `sgmisitstg`.`STG_BCRS_ENTITY` WHERE `stg_bcrs_entity`.`w_batch_id` = '2021112512205200371') `ENT` ON `ent`.`entity_code`=`a`.`client_le_id`   LEFT JOIN (SELECT `stg_bcrs_entity_links`.`child_code`, Max(`stg_bcrs_entity_links`.`mother_code`) `MOTHER_CODE` from `sgmisitstg`.`STG_BCRS_ENTITY_LINKS` WHERE `stg_bcrs_entity_links`.`link_type`='CR' AND `stg_bcrs_entity_links`.`w_batch_id` = '2021112512205200371' GROUP BY `stg_bcrs_entity_links`.`child_code`) `E`  ON `A`.`CLIENT_LE_ID`= `e`.`child_code`     LEFT JOIN (SELECT `stg_bcrs_issuer_credit_ratings`.`entity_code`,`stg_bcrs_issuer_credit_ratings`.`long_term_rating` FROM `sgmisitstg`.`STG_BCRS_ISSUER_CREDIT_RATINGS` WHERE `stg_bcrs_issuer_credit_ratings`.`agency_code`='INTERNAL' AND `stg_bcrs_issuer_credit_ratings`.`w_batch_id` ='2021112513321900794') `CR` ON `cr`.`entity_code`= `A`.`CLIENT_LE_ID`  WHERE `a`.`client_le_id` IS NOT NULL and `a`.`w_snapshot_dt` = '2021-08-31' AND `a`.`w_country_cd`='ALL' AND `a`.`w_datasource_id`='BCRS_RC'
CREATE VIEW `temp_src_query_2112150902360050111` AS select   `comb`.`contract_ref_no`  ,  `comb`.`limit_ref_no`  ,  `comb`.`collateral_ref_no` , `comb`.`exposure_id`  ,  `comb`.`limit_id` ,  `comb`.`collateral_id` ,  `comb`.`client_wid`,   `comb`.`book_wid` ,  `comb`.`booking_loc_id` ,  `comb`.`management_product_id` , `comb`.`transaction_type`, `exp_f`.`adjustment_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ADJUSTMENT_AMOUNT`,  `exp_f`.`booking_entity_wid` as `Booking_Entity`, `be`.`reporting_currency`  as  `Reporting_Currency`, `be`.`company_reg_no`  as `Company_Reg_No`, `be`.`branch_subsidiary_flag` as `branch_subsidiary_flag`, `be`.`booking_loc_id` as `Booking_Location`, `exp_f`.`amortized_cost`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST`, `exp_f`.`amortized_cost_no_ias`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `AMORTIZED_COST_NO_IAS`, `exp_f`.`arm_description` AS `ARM_DESCRIPTION`, `exp_f`.`asset_class_category_new` AS `ASSET_CLASS_CATEGORY_NEW`, `exp_f`.`asset_class_category_original` AS `ASSET_CLASS_CATEGORY_ORIGINAL`, `exp_f`.`asset_class_new` AS `ASSET_CLASS_NEW`, `exp_f`.`asset_class_original` AS `ASSET_CLASS_ORIGINAL`, `exp_f`.`balance_category` AS `BALANCE_CATEGORY`, `exp_f`.`bis_entity_type_new` AS `BIS_ENTITY_TYPE_NEW`, `exp_f`.`bis_entity_type_original` AS `BIS_ENTITY_TYPE_ORIGINAL`, `exp_f`.`bis_industry_sector_new` AS `BIS_INDUSTRY_SECTOR_NEW`, `exp_f`.`bis_industry_sector_original` AS `BIS_INDUSTRY_SECTOR_ORIGINAL`, `exp_f`.`bis_past_due` AS `BIS_PAST_DUE`, `exp_f`.`bis_past_due_original` AS `BIS_PAST_DUE_ORIGINAL`, `exp_f`.`bis_performing_status` AS `BIS_PERFORMING_STATUS`, `exp_f`.`bis_prod_category` AS `BIS_PRODUCT_CATEGORY`, `exp_f`.`bis_risk_area_new` AS `BIS_RISK_AREA_NEW`, `exp_f`.`bis_risk_area_original` AS `BIS_RISK_AREA_ORIGINAL`, `exp_f`.`business` AS `BUSINESS`, `exp_f`.`business_identifier` AS `BUSINESS_IDENTIFIER`, `exp_f`.`ccf`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CCF`, `exp_f`.`ccr_new` AS `CCR_NEW`, `exp_f`.`ccr_original` AS `CCR_ORIGINAL`, `exp_f`.`cf_indicator` AS `CF_INDICATOR`, `exp_f`.`committed_used_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Committed_Used_Amount`, `exp_f`.`committed_indicator` AS `COMMITTED_INDICATOR`, `exp_f`.`company_cd` AS `COMPANY_CODE`, `exp_f`.`company_type` AS `COMPANY_TYPE`, `exp_f`.`cost_center_cd` AS `COST_CENTER_CODE`, `exp_f`.`cost_center_description` AS `COST_CENTER_DESCRIPTION`, `exp_f`.`counterparty_new_attribute_1` AS `COUNTERPARTY_NEW_ATTRIBUTE_1`, `exp_f`.`counterparty_new_attribute_2` AS `COUNTERPARTY_NEW_ATTRIBUTE_2`, `exp_f`.`counterparty_new_attribute_3` AS `COUNTERPARTY_NEW_ATTRIBUTE_3`, `exp_f`.`counterparty_new_attribute_4` AS `COUNTERPARTY_NEW_ATTRIBUTE_4`, `exp_f`.`counterparty_new_attribute_7` AS `COUNTERPARTY_NEW_ATTRIBUTE_7`, `exp_f`.`counterparty_new_attribute_8` AS `COUNTERPARTY_NEW_ATTRIBUTE_8`, `exp_f`.`counterparty_new_attribute_9` AS `COUNTERPARTY_NEW_ATTRIBUTE_9`, `exp_f`.`counterparty_new_desc` AS `COUNTERPARTY_NEW_DESC`, `exp_f`.`counterparty_type_new` AS `COUNTERPARTY_TYPE_NEW`, `exp_f`.`counterparty_type_original` AS `COUNTERPARTY_TYPE_ORIGINAL`, `exp_f`.`crm_method` AS `CRM_METHOD`, `exp_f`.`days_after_contractual_date`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `DAYS_AFTER_CONTRACTUAL_DATE`, `exp_f`.`delivery_type` AS `DELIVERY_TYPE`, `exp_f`.`ead_formula`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_FORMULA`, `exp_f`.`ead_method` AS `EAD_METHOD`, `exp_f`.`ead_original`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_ORIGINAL`, `exp_f`.`ead_pro` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO`, `exp_f`.`ead_pro_discount` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_DISCOUNT`, `exp_f`.`crm_currency` AS `CRM_Currency`, `exp_f`.`crm_location` AS `CRM_Location`, `exp_f`.`crm_residual_maturity`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `CRM_Residual_Maturity`, `exp_f`.`imc_1` AS `IMC_1`, `exp_f`.`txn_limit_amount`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Limit_Amount_TXNRWA`, `exp_f`.`limit_attribute` AS `Limit_Attribute_TXNRWA`, `exp_f`.`rw_expo`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RW_EXPO`, `exp_f`.`sub_limit_fac_ref_no` AS `Sub_Limit_FAC_Reference`, `exp_f`.`txn_rw_new`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Transaction_RW_New`, `exp_f`.`ead_pro_gen`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_GEN`, `exp_f`.`ead_pro_write_off` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EAD_PRO_WRITE_OFF`, `exp_f`.`ec_filter_type` AS `EC_FILTER_TYPE`, `exp_f`.`ec_w_filter_type` AS `EC_W_FILTER_TYPE`, `exp_f`.`el`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Economic_EL`, `exp_f`.`entity_type_category_new` AS `ENTITY_TYPE_CATEGORY_NEW`, `exp_f`.`entity_type_category_original` AS `ENTITY_TYPE_CATEGORY_ORIGINAL`, `exp_f`.`exposure_attribute_1` AS `EXPOSURE_ATTRIBUTE_1`, `exp_f`.`exposure_attribute_3` AS `EXPOSURE_ATTRIBUTE_3`, `exp_f`.`exposure_attribute_6` AS `EXPOSURE_ATTRIBUTE_6`, `exp_f`.`exposure_attribute_8` AS `EXPOSURE_ATTRIBUTE_8`, `exp_f`.`exposure_attribute_9` AS `EXPOSURE_ATTRIBUTE_9`, `exp_f`.`exposure_wo_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `EXPOSURE_WO_MTM`, `exp_f`.`f_collatral_type_name` AS `F_COLLATRAL_TYPE_NAME`, `exp_f`.`f_standard_prod_name` AS `F_STANDARD_PRODUCT_NAME`, `exp_f`.`filter_type` AS `FILTER_TYPE`, `exp_f`.`flag_adjustment` AS `FLAG_ADJUSTMENT`, `exp_f`.`fsa004_asset_class` AS `FSA004_ASSET_CLASS`, `exp_f`.`fsa_exclusion_type` AS `FSA_EXCLUSION_TYPE`, `exp_f`.`funding_ccy` AS `FUNDING_CCY`, `exp_f`.`guarantee_bis_product` AS `GUARANTEE_BIS_PRODUCT`, `exp_f`.`guarantor_bis_entity_type` AS `GUARANTOR_BIS_ENTITY_TYPE`, `exp_f`.`hcr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HCR`, `exp_f`.`he`   AS `HE`, `exp_f`.`hfx`   AS `HFX`, `exp_f`.`holding_company_ind` AS `HOLDING_COMPANY_IND`, `exp_f`.`hr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `HR`, `exp_f`.`id` AS `ID`, `exp_f`.`iip`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `IIP`, `exp_f`.`incorporation_ccy_new` AS `INCORPORATION_CCY_NEW`, `exp_f`.`incorporation_ccy_original` AS `INCORPORATION_CCY_ORIGINAL`, `exp_f`.`inter_company` AS `INTER_COMPANY`, `exp_f`.`lgd_pre_floor_new`   AS `LGD_PRE_FLOOR_NEW`, `exp_f`.`lgd_pre_floor_original`   AS `LGD_PRE_FLOOR_ORIGINAL`, `exp_f`.`lgd_range` AS `LGD_RANGE`, `exp_f`.`linked_unlinked_ind` AS `LINKED_UNLINKED_IND`, `exp_f`.`long_short` AS `LONG_SHORT`, `exp_f`.`mm`   AS `MM`, `exp_f`.`mru_identifier` AS `MRU_IDENTIFIER`, `exp_f`.`netting_class` AS `NETTING_CLASS`, `exp_f`.`non_borrowing` AS `NON_BORROWING`, `exp_f`.`non_gam_ind` AS `NON_GAM_IND`, `exp_f`.`obligor_grade_inf_new`   AS `OBLIGOR_GRADE_INF_NEW`, `exp_f`.`obligor_grade_new` AS `OBLIGOR_GRADE_NEW`, `exp_f`.`obligor_grade_original` AS `OBLIGOR_GRADE_ORIGINAL`, `exp_f`.`obligor_grade_sup_new`   AS `OBLIGOR_GRADE_SUP_NEW`, `exp_f`.`original_cost` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `ORIGINAL_COST`, `exp_f`.`original_maturity`   AS `ORIGINAL_MATURITY`, `exp_f`.`performing_status` AS `PERFORMING_STATUS`, `exp_f`.`previous_rating_cd` AS `PREVIOUS_RATING_CODE`, `exp_f`.`prr`  *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `PRR`, `exp_f`.`psgl_account` AS `PSGL_Account`, `exp_f`.`psgl_cust_class` AS `PSGL_CUST_CLASS`, `exp_f`.`psgl_department` AS `PSGL_Dept_ID`, `exp_f`.`psgl_operating_unit` AS `PSGL_OPERATING_UNIT`, `exp_f`.`psgl_product` AS `PSGL_Product`, `exp_f`.`rating_cd` AS `RATING_CODE`, `exp_f`.`risk_bucket` AS `RISK_BUCKET`, `exp_f`.`risk_bucket_original` AS `RISK_BUCKET_ORIGINAL`, `exp_f`.`risk_country` AS `RISK_COUNTRY`, `exp_f`.`risk_country_new` AS `RISK_COUNTRY_NEW`, `exp_f`.`risk_country_original` AS `RISK_COUNTRY_ORIGINAL`, `exp_f`.`risk_type` AS `RISK_TYPE`, `exp_f`.`rw_new`   AS `RW_NEW`, `exp_f`.`rw_original`  AS `RW_ORIGINAL`, `exp_f`.`rw_scaling_factor`  AS `RW_SCALING_FACTOR`, `exp_f`.`rwa_pre_cap` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `RWA_PRE_CAP`, `exp_f`.`rwa_scaling_factor`  AS `RWA_SCALING_FACTOR`, `exp_f`.`secu_bank_role` AS `SECU_BANK_ROLE`, `exp_f`.`secu_company_weight`   AS `SECU_COMPANY_WEIGHT`, `exp_f`.`secu_ea_controlled` AS `SECU_EA_CONTROLLED`, `exp_f`.`secu_mode` AS `SECU_MODE`, `exp_f`.`securitization_n`  AS `SECURITIZATION_N`, `exp_f`.`securitization_ref_no` AS `SECURITIZATION_REFERENCE`, `exp_f`.`securitized` AS `SECURITIZED`, `exp_f`.`segment_original` AS `SEGMENT_ORIGINAL`, `exp_f`.`seniority_new` AS `SENIORITY_NEW`, `exp_f`.`standard_rw_new`  AS `STANDARD_RW_NEW`, `exp_f`.`standard_rw_original`  AS `STANDARD_RW_ORIGINAL`, `exp_f`.`stress_testing_scenario_id` AS `STRESS_TESTING_SCENARIO_ID`, `exp_f`.`sub_method_new` AS `SUB_METHOD_NEW`, `exp_f`.`sub_method_original` AS `SUB_METHOD_ORIGINAL`, `exp_f`.`sub_reference` AS `SUB_REFERENCE`, `exp_f`.`nominal_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOMINAL`, `exp_f`.`notional_tcdr` *  nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TCDR_NOTIONAL`, `exp_f`.`rc_tcdr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `TCDR_RC`, `exp_f`.`tier1_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER1_DEDUCTION`, `exp_f`.`tier2_deduction` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TIER2_DEDUCTION`, `exp_f`.`total_annual_assets` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_ASSETS`, `exp_f`.`tp_portfolio_name` AS `TP_PORTFOLIO_NAME`, `exp_f`.`trading_book_type` AS `TRADING_BOOK_TYPE`, `exp_f`.`tranche_collateral_type` AS `TRANCHE_COLLATERAL_TYPE`, `exp_f`.`tranche_guarantee_type` AS `TRANCHE_GUARANTEE_TYPE`, `exp_f`.`tranche_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `TRANCHE_LGD`, `exp_f`.`uncommited` AS `UNCOMMITED`, `exp_f`.`und_pool_ref` AS `UND_POOL_REF`, `exp_f`.`unmapped_ind` AS `UNMAPPED_IND`, `exp_f`.`waterfall_seniority` AS `WATERFALL_SENIORITY`, `exp_f`.`wt_k_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_K_MATURITY`, `exp_f`.`wt_pd_new` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)    AS `WT_PD_NEW`, `exp_f`.`wt_pd_original` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `WT_PD_ORIGINAL`, `exp_f`.`ais_id` AS `AIS_ID`, `exp_f`.`arm_cd` AS `ARM_CODE`, `exp_f`.`beel`    AS `BEEL`,  `exp_f`.`bs_type` AS `BS_TYPE`, `exp_f`.`ccy_cd` AS `CCY_CODE`, `exp_f`.`cec` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CEC`, `exp_f`.`committed_available_amunt` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_AVAILABLE_AMUNT`, `exp_f`.`committed_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `COMMITTED_OS`, `exp_f`.`contract_type` AS `CONTRACT_TYPE`, `contp`.`ct_desc_user` as `contract_desc`, `exp_f`.`country_name` AS `COUNTRY_NAME`, `exp_f`.`crc`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `CRC`, `exp_f`.`csa_flg` AS `CSA_FLG`, `exp_f`.`ead_pre_ccf` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRE_CCF`, (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) * (`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)) AS `EAD_SQUARE`, `exp_f`.`effective_matirity`    AS `EFFECTIVE_MATIRITY`, `exp_f`.`exposure` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EXPOSURE`, `exp_f`.`exposure_attribute_7` AS `EXPOSURE_ATTRIBUTE_7`, `exp_f`.`f_business_sub_segment_name` AS `F_BUSINESS_SUB_SEGMENT_NAME`, `exp_f`.`f_original_scorecard_name` AS `F_ORIGINAL_SCORECARD_NAME`, `exp_f`.`facility_ref_no` AS `FACILITY_REFERENCE`, `exp_f`.`fair_value` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `FAIR_VALUE`, `exp_f`.`family` AS `FAMILY`, `exp_f`.`final_pd`    AS `FINAL_PD`, `exp_f`.`hc`    AS `HC`, `exp_f`.`headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM`, `exp_f`.`headroom_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_EAD`, `exp_f`.`headroom_rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `HEADROOM_RWA`, `exp_f`.`import_source` AS `IMPORT_SOURCE`, `exp_f`.`isda_flg` AS `ISDA_FLG`, `exp_f`.`maturity_date` AS `MATURITY_DATE`, `exp_f`.`method_original` AS `METHOD_ORIGINAL`, `exp_f`.`method_new` AS `RWA_Method`,  `exp_f`.`negative_pledge_identifier` AS `NEGATIVE_PLEDGE_IDENTIFIER`, `exp_f`.`netted_ead_square` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `NETTED_EAD_SQUARE`, `exp_f`.`netting_flg` AS `NETTING_FLG`, `exp_f`.`org_pd`    AS `ORG_PD`, `exp_f`.`original_scorecard` AS `ORIGINAL_SCORECARD`, `exp_f`.`os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `OS`, `exp_f`.`past_due_int` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_INT`, `exp_f`.`past_due_ppal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PAST_DUE_PPAL`, `exp_f`.`pd_new`    AS `PD_NEW`, `exp_f`.`pd_original`    AS `PD_ORIGINAL`, `exp_f`.`product_gl_criteria` AS `PRODUCT_GL_CRITERIA`, `exp_f`.`proxy_el` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `PROXY_EL`, `exp_f`.`rgc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RGC`, `exp_f`.`rwa_after_scale` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_AFTER_SCALE`, `exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA_PRE_CRM`, `exp_f`.`seniority_original` AS `SENIORITY_ORIGINAL`, `exp_f`.`start_date` AS `START_DATE`, `exp_f`.`table_name` AS `TABLE_NAME`, `exp_f`.`tenor_buckets` AS `TENOR_BUCKET`, `exp_f`.`total_annual_sales` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `TOTAL_ANNUAL_SALES`, `exp_f`.`uncommitted_os` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `UNCOMMITTED_OS`, `exp_f`.`used_amount_facility` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `USED_AMOUNT_FACILITY`, `exp_f`.`value_date` AS `EXPOSURE_VALUE_DATE`, `exp_f`.`wt_crg` AS `Wt_CRG_Final`, `exp_f`.`xrc` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `XRC`, `exp_f`.`original_crg` AS `ORIGINAL_CRG`, `exp_f`.`contract_ref_no` AS `Contract_Reference`, `exp_f`.`nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Nominal`, `exp_f`.`net_nominal` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_Nominal`, `exp_f`.`outstanding`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Outstanding`, `exp_f`.`accrued_interest` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Accrued_Interest`, `exp_f`.`notional` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Notional`,  `exp_f`.`replacement_cost` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Replacement_Cost`, `exp_f`.`net_mtm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Net_MTM`, `exp_f`.`add_on` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `add_on`, `exp_f`.`wt_residual_maturity` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Residual_Maturity`, `exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Final_PD`, `exp_f`.`wt_mat_eff` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Regulatory_Maturity`, `exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD`, `exp_f`.`ead_prr` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_PRR`, `exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Covered_EAD`, `exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `EAD_netting`, `exp_f`.`netted_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Netted_EAD`, `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Guaranteed_EAD`, `exp_f`.`unsecured_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Unsecured_EAD`, `exp_f`.`lgd`    AS `LGD`, `exp_f`.`wt_lgd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_LGD`, `exp_f`.`cpty_group` as `COUNTERPARTY_GROUP`, `exp_f`.`cpty_group_original` as `COUNTERPARTY_GROUP_ORIGINAL`, `exp_f`.`attribute_6` as `Facility_Attribute_6`, `exp_f`.`wtpdnm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   as `Wt_Nominal_Pdnew`, `exp_f`.`wt_org_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `Wt_Original_PD`, `exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `RWA`, `exp_f`.`cva_rwa_addon` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)   AS `CVA_RWA_add_on`, `exp_f`.`residual_maturity`    AS `Residual_Maturity`, `exp_f`.`k_maturity`    AS `Regulatory_Maturity`, `exp_f`.`maturity_range` AS `Maturity_Range`, `exp_f`.`external_rating` AS `External_Rating_of_Repo_Security`, `exp_f`.`lt_rat_agency_cd` AS `Repo_Security_Rating_Agency`, `exp_f`.`sov_indicator` AS `Sovereign_Indicator`,  NVL(`mgmt_prod`.`node7_cd`, 'UNMP') AS `l7_mgt_prod_code`, NVL(`mgmt_prod`.`node7_desc`, 'Unmapped') AS `l7_mgt_prod_desc`, NVL(`mgmt_prod`.`node6_cd`, 'UNMP') AS `l6_mgt_prod_subfamily_code`, NVL(`mgmt_prod`.`node6_desc`, 'Unmapped') AS `l6_mgt_prod_subfamily_desc`, NVL(`mgmt_prod`.`node5_cd`, 'UNMP') AS `l5_mgt_prod_family_code`, NVL(`mgmt_prod`.`node5_desc`, 'Unmapped') AS `l5_mgt_prod_family_desc`, NVL(`mgmt_prod`.`node4_cd`, 'UNMP') AS `l4_mgt_prod_subseg_code`, NVL(`mgmt_prod`.`node4_desc`, 'Unmapped') AS `l4_mgt_prod_subseg_desc`, NVL(`mgmt_prod`.`node3_cd`, 'UNMP') AS `l3_mgt_prod_seg_code`, NVL(`mgmt_prod`.`node3_desc`, 'Unmapped') AS `l3_mgt_prod_seg_desc`, NVL(`mgmt_prod`.`node2_cd`, 'UNMP') AS `l2_mgt_prod_subarea_code`, NVL(`mgmt_prod`.`node2_desc`, 'Unmapped') AS `l2_mgt_prod_subarea_desc`, NVL(`mgmt_prod`.`node1_cd`, 'UNMP') AS `l1_mgt_prod_area_code`, NVL(`mgmt_prod`.`node1_desc`, 'Unmapped') AS `l1_mgt_prod_area_desc`, NVL(`mgmt_prod`.`node0_cd`, 'UNMP') AS `l0_mgt_prod_cat_code`, NVL(`mgmt_prod`.`node0_desc`, 'Unmapped') AS `l0_mgt_prod_cat_desc`, NVL(`mgmt_prod`.`mru_group_cd`, 'UNMP') AS `mgt_prod_grouping_code`, NVL(`mgmt_prod`.`mru_group_desc`, 'Unmapped') AS `mgt_prod_grouping`, `mgmt_prod`.`product_xsell_mapping` AS `product_xsell_mapping`, `mgmt_prod`.`x_sell_mapping_desc` AS `x_sell_mapping_desc`, `standard_product`.`collateral_type` AS `Collateral_Type`, `exp_f`.`netting_agreement_ref_no` AS `NETTING_AGREEMENT_REFERENCE`, `exp_f`.`cva_ccr_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_ccr_rwa`           , `exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cva_rwa`             , `exp_f`.`ead_pro_cva`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ead_pro_cva`        , `exp_f`.`lgd_dollar`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `lgd_dollar`           , `exp_f`.`outstanding_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `outstanding_dollar`    , `exp_f`.`rwa_add_on`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_add_on`         , null AS  `From_Currency`, null AS  `Exchange_Rate`, null AS  `To_Currency`, null AS  `Exchange_Rate_Date`, `cash_flow`.`cash_flow_se_1_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_el_1_Month`, `cash_flow`.`cash_flow_se_2_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_2_Month`, `cash_flow`.`cash_flow_se_3_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_3_Month`, `cash_flow`.`cash_flow_se_4_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_4_Month`, `cash_flow`.`cash_flow_se_5_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_5_Month`, `cash_flow`.`cash_flow_se_6_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_6_Month`, `cash_flow`.`cash_flow_se_7_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_7_Month`, `cash_flow`.`cash_flow_se_8_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_8_Month`, `cash_flow`.`cash_flow_se_9_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_9_Month`, `cash_flow`.`cash_flow_se_10_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_10_Month`, `cash_flow`.`cash_flow_se_11_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_11_Month`, `cash_flow`.`cash_flow_se_12_month`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_el_12_Month`, `cash_flow`.`cash_flow_s_1_year`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  AS `Cash_Flow_l_1_Year`, `cash_flow`.`cash_flow_ge_1_year`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) AS `Cash_Flow_eg_1_Year`, CASE WHEN `comb`.`w_workspace` LIKE '%ADJ%' THEN 'Y' ELSE 'N' END `Adjusted`, `lmt_ref`.`bcrs_limit_id_trim`, `lmt_ref`.`limit_type`,   `lmt_ref`.`edm_limit_advised`, `lmt_ref`.`bcrs_book_cd`, `lmt_ref`.`bcrs_maturity_dt`, `lmt_ref`.`bcrs_lgd` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_lgd`, `lmt_f`.`bcrs_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount`, `lmt_f`.`bcrs_amount_derived` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_amount_derived`, `lmt_f`.`bcrs_avail_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_avail_amount`, `lmt_f`.`bcrs_used_amount` * nvl(`bcrs_limit_exc_rate`.`exchange_rate_for_conv`,1) as `bcrs_used_amount`,  `lmt_ref`.`edm_limit_tenor`, `lmt_ref`.`edm_limit_tenor_basis`, `lmt_ref`.`edm_limit_booking_loc`,  `lmt_f`.`edm_approved_limit_amount` * nvl(`edm_limit_exc_rate`.`exchange_rate_for_conv`,1) as `edm_approved_limit_amount`, `edm_limit_exc_rate`.`exchange_rate_for_conv` `edm_limit_exch_rate`, `lmt_ref`.`edm_approved_limit_currency`, `lmt_ref`.`edm_limit_shared_ind`, `lmt_ref`.`edm_limit_committed`,  `lmt_ref`.`edm_limit_secured`, `lmt_ref`.`edm_limit_expiry_dt`, `lmt_ref`.`edm_limit_revolving_flag`, `lmt_ref`.`edm_group_id`, `lmt_ref`.`edm_limit_prd_desc`, `lmt_ref`.`edm_limit_balance_type`, `lmt_ref`.`edm_limit_category_cd`, `lmt_ref`.`edm_limit_cat`, `col_ref`.`crm_import_source`, `col_f`.`cmv`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `cmv`, `col_f`.`fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `fsv`, `col_f`.`attribute_6`, `col_f`.`crm_ineligible_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_cmv_loss` , `col_f`.`crm_ineligible_fsv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_ineligible_fsv_loss` , `col_f`.`no_link_crm_expo_cmv_loss` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_cmv_loss`             , `col_f`.`no_link_crm_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `no_link_crm_expo_fsv_loss`            , `col_f`.`crm_for_securitized_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_securitized_expo_loss`        , `col_f`.`crm_for_secu_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_secu_expo_fsv_loss`           , `col_f`.`crm_for_slotting_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_for_slotting_expo_loss`          , `col_f`.`crm_for_slotting_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_slotting_expo_fsv_loss`       , `col_f`.`crm_repo_issuer_grp_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `crm_repo_issuer_grp_loss`          , `col_f`.`crm_repo_issuer_grp_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_repo_issuer_grp_fsv_loss`         , `col_f`.`crm_residual_value_risk_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_residual_value_risk_loss`          , `col_f`.`crm_resi_value_risk_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_resi_value_risk_fsv_loss`          , `col_f`.`crm_for_market_risk_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_market_risk_expo_loss`        , `col_f`.`crm_for_mark_expo_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_for_mark_expo_fsv_loss`           , `col_f`.`crm_noncash_recv_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_loss`            , `col_f`.`crm_noncash_recv_expo_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_noncash_recv_expo_fsv_loss`         , `col_f`.`crm_no_expo_remaining_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_no_expo_remaining_loss`            , `col_f`.`crm_no_expo_remaining_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `crm_no_expo_remaining_fsv_loss`       , `col_f`.`crm_reason_unknown_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `crm_reason_unknown_loss`               , `col_f`.`crm_reason_unknown_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `crm_reason_unknown_fsv_loss`            , `col_f`.`assigned_cmv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `assigned_cmv_amount`                 , `col_f`.`assigned_fsv_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `assigned_fsv_amount`                  , `col_f`.`over_collateralized_cmv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_cmv_loss`          , `col_f`.`over_collateralized_fsv_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_fsv_loss`          , `col_f`.`subtotal_allocated_cmv`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_cmv`              , `col_f`.`subtotal_allocated_fsv`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `subtotal_allocated_fsv`                , `col_f`.`collateral_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `collateral_haircut_loss`              , `col_f`.`ccy_haircut_fsv_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `ccy_haircut_fsv_loss`                 , `col_f`.`maturity_mismatch_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `maturity_mismatch_loss`             ,   `col_f`.`no_link_guar_expo_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `no_link_guar_expo_loss`               , `col_f`.`guar_badly_rated_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as     `guar_badly_rated_loss`              , `col_f`.`guar_ineligible_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `guar_ineligible_loss`               , `col_f`.`guar_excluded_loss`    * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `guar_excluded_loss`                , `col_f`.`guar_for_securitized_expo_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `guar_for_securitized_expo_loss`        , `col_f`.`reason_unknown_guar_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as    `reason_unknown_guar_loss`           , `col_f`.`assigned_guar_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `assigned_guar_amount`                  , `col_f`.`over_collateralized_guar_loss`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `over_collateralized_guar_loss`         , `col_f`.`ccy_haircut_loss`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as   `ccy_haircut_loss`                    , `col_ref`.`collateral_category`, `col_ref`.`w_current_record_flag`, `ccr`.`country_code` as `CCR`, `limit_bl`.`country_code` as `Limit_Booking_Location`, `bca`.`bca_ref_no` as `BCA_REFERENCE_NO`, `bca`.`bca_approval_dt` AS `BCA_Approval_DT`, NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`) as `standard_product_code`, `standard_prod`.`standard_product_description` as `standard_product`, `standard_prod`.`limit_category_code` as `LIMIT_CATEGORY`, `standard_prod`.`balance_type`, `standard_prod`.`standard_product_group_code`, `standard_prod`.`standard_product_group_code_description`, `osc`.`crg_org_g3_code` as `crg_org_g3_code_orginal`,  `osc`.`crg_org_g3_desc` as `crg_org_g3_desc_orginal`, `osc`.`crg_org_g4_code` as `crg_org_g4_code_orginal`, `osc`.`crg_org_g4_desc` as `crg_org_g4_desc_orginal` , `osc`.`crg_org_g5_code` as `crg_org_g5_code_orginal`, `osc`.`crg_org_g5_desc` as `crg_org_g5_desc_orginal`, `osc`.`rank_crg` as `rank_crg_orginal`, `fsc`.`crg_org_g3_code` as `crg_org_g3_code_final`,  `fsc`.`crg_org_g3_desc` as `crg_org_g3_desc_final`, `fsc`.`crg_org_g4_code` as `crg_org_g4_code_final`, `fsc`.`crg_org_g4_desc` as `crg_org_g4_desc_final`, `fsc`.`crg_org_g5_code` as `crg_org_g5_code_final`, `fsc`.`crg_org_g5_desc` as `crg_org_g5_desc_final`, `fsc`.`rank_crg` as `rank_crg_final`, `gsc`.`org_scrd_g2_code` as `org_scrd_g2_code_group`, `gsc`.`org_scrd_g3_code` as `org_scrd_g3_code_group`, Case when `jr`.`country_cd` IS NOT NULL then 'Yes' else 'No' end AS `Approved_Jurisdictions`, `ro`.`core_map`, `lmt_ref`.`edm_outer_limit_id`, `rmi_limit_static`.`approved_lgd`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `approved_lgd`, `exp_f`.`derivative_ind`, `exp_f`.`transfer_risk`, `exp_f`.`tr_addon_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_el`, `exp_f`.`tr_addon_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_addon_rwa`, `exp_f`.`tr_gua_ctry`, `exp_f`.`tr_pre_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_el`, `exp_f`.`tr_pre_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_pre_rwa`, `exp_f`.`avg_prefunded_contribution`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `avg_prefunded_contribution`, `exp_f`.`broker_id` as `exposure_broker_id`, `exp_f`.`client_trade`, `exp_f`.`dfccp`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfccp`, `exp_f`.`dfi`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `dfi`, `exp_f`.`kccp`, `exp_f`.`margin_period`, `exp_f`.`netting_agreement_ref_no`, `exp_f`.`no_clear_mem_n`, `exp_f`.`scb_clearing_mem`, `exp_f`.`segregated`, `exp_f`.`tot_pre_fund_con`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tot_pre_fund_con`, `exp_f`.`uci`, `exp_f`.`sme_product_type`,  case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `SECURITY_CTRY`,  case when `comb`.`book_wid` like '%CC%' or `comb`.`book_wid` like '%CI%' then 'CICC'      WHEN `comb`.`book_wid` like '%RT%' then 'RT'  WHEN `comb`.`book_wid` like '%PB%' then 'PB'  WHEN `comb`.`book_wid` like '%OB%' then 'OB'  else 'OTHERS'  end  AS `SECURITY_SEG`, `col_tg`.`collateral_code` AS `col_tg_code`, `col_tg`.`collateral_desc` AS `col_tg_desc`, `col_tg`.`collateral_type` AS `col_tg_type`, `col_tg`.`collateral_sec_sub_type` AS `col_tg_sec_sub_type`,  `col_f`.`crr`   as `CRR`, `col_f`.`crm_nominal`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `CRM_NOMINAL`, `exp_f`.`accrued_interest_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `accrued_interest_dollar`,  `rmi_limit_static`.`approver_name`, `exp_f`.`bca_review_date`, `exp_f`.`beta`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `beta`,  `exp_f`.`collateral_contract_type`, `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `collateral_assigned_amount`,  `exp_f`.`clearing_house_cd`, `exp_f`.`tr_el`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `tr_el`,  `exp_f`.`unsecured_lgd_dollar`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `unsecured_lgd_dollar`, `exp_f`.`bca_approval_date`, `exp_f`.`collateral_issuer`, `exp_f`.`collateral_perfection_status`, `exp_f`.`collateral_valuation_date`, `exp_f`.`committed_headroom` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `COMMITTED_HEADROOM`, `exp_f`.`facility_availability_end_date`, `exp_f`.`facility_utilization_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `FACILITY_UTILIZATION_AMOUNT`, `exp_f`.`governing_law`, `exp_f`.`ltv`,  `exp_f`.`on_off_balance_sheet_flag`, `exp_f`.`third_party_cp_flag`, `exp_f`.`unconditionnaly_cancelable`, CASE WHEN `lmt_ref`.`edm_limit_booking_loc` <> `lmt_ref`.`bca_originating_country` then 'Yes' Else 'No' END `OBL_FLG`, `book`.`book_cd_name`,  `lmt_ref`.`bcrs_currency` `bcrs_currency`,  nvl(`edm_limit_exc_rate`.`exchange_rate`,1)   `exch_rate_edm_limit_sgd` ,  nvl(`bcrs_limit_exc_rate`.`exchange_rate`,1)  `exch_rate_bcrs_limit_sgd` ,  nvl(`exc_rate_usd`.`exchange_rate`,1)   `exch_rate_usd` ,  `exp_f`.`counterparty_new_wid`,  `lmt_ref`.`bcrs_non_gam_ind`, `lmt_ref`.`bcrs_holdco_ind`, `lmt_ref`.`bcrs_import_source`,  `exp_f`.`accrued_fees`, `exp_f`.`add_on_dollar` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `add_on_dollar`, `exp_f`.`adj_flag`, `exp_f`.`adjusted_limit_amount` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `adjusted_limit_amount`, `exp_f`.`arm_cd`, `exp_f`.`bi`, `exp_f`.`bii_calculation_method`, `exp_f`.`bis_prod`, `exp_f`.`bis_prod_category`, `exp_f`.`bis_risk_sub_area_new`, `exp_f`.`bis_risk_sub_area_original`,  `exp_f`.`booking_entity_id`, `exp_f`.`business_line_cd`, `exp_f`.`business_sub_segment`, `exp_f`.`business_unit`, `exp_f`.`capital_item`, `exp_f`.`ccp_dfund_method`, `exp_f`.`ccp_name`, `exp_f`.`ccr_ctry`, case when `comb`.`booking_loc_id`='SG' then 'SG' when `comb`.`booking_loc_id` = 'MY'  then 'MY' when `comb`.`booking_loc_id` = 'VN'  then 'VN' when `comb`.`booking_loc_id` = 'TH'  then 'TH' else 'OTHERS' end AS `ccr_eq_cntry`, `exp_f`.`cem_imm_ind`, `exp_f`.`child_id` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as `child_id`, `exp_f`.`coll_issuer_bis_entity_type`, `exp_f`.`collateral_bis_prod`, `exp_f`.`collateral_prod_category`, `exp_f`.`collateral_adjusted_flag`, `exp_f`.`committed_amount`, `exp_f`.`committed_used_amt_temp`,  `exp_f`.`correct_orig_crg`, `exp_f`.`cost_center_cd`, `exp_f`.`counterparty_new`,     `exp_f`.`counterparty_new_attribute_5`, `exp_f`.`counterparty_new_attribute_6`, `exp_f`.`counterparty_original_wid`, `exp_f`.`counterparty_original`,      `exp_f`.`cpty_new_sebc_not_qualifying`, `exp_f`.`cpty_orig_sebc_not_qualifying`, `exp_f`.`credit_substitute`, `exp_f`.`currency`, `exp_f`.`cva_index_part`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `cva_index_part`, `exp_f`.`cva_rwa_addon`, `exp_f`.`deal_status`, `exp_f`.`book_cd`, `exp_f`.`df_cm`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `df_cm`, `exp_f`.`dlrfin_cd`, `exp_f`.`ead_scalar`, `exp_f`.`effective_epe` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `effective_epe`, `exp_f`.`el_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_cpty`, `exp_f`.`el_net_saves`, `exp_f`.`el_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_saves`, `exp_f`.`el_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `el_total`, `exp_f`.`equity_floor_applied`, `exp_f`.`equity_preferential_treatment`, `exp_f`.`equity_scaling_factor`, `exp_f`.`exchange_rate`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `exposure_exchange_rate`, `exp_f`.`exemption_maturity_floor`, `exp_f`.`exposure_attribute_2`, `exp_f`.`exposure_attribute_4`, `exp_f`.`exposure_attribute_5`, `exp_f`.`exposure_attribute_7d`,    `exp_f`.`fde_alternative_method`, `exp_f`.`final_crg`, `exp_f`.`floor1`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `floor1`, `exp_f`.`floor2`, `exp_f`.`gaap_cd`, `exp_f`.`grand_fathering_applied`, `exp_f`.`guarantee_sub_ref_no`, `exp_f`.`guarantee_ead_flag`, `exp_f`.`guarantee_method`, `exp_f`.`guarantee_ref_no`, `exp_f`.`guarantor`,  `exp_f`.`incorp_country`, `exp_f`.`internal_maturity_class`, `exp_f`.`k_function_used`,  `exp_f`.`kccp_calc`, `exp_f`.`legislated_program_applied`, `exp_f`.`lgd_grade`, `exp_f`.`lgd_grade_agency`, `exp_f`.`lgd_grade_inf`, `exp_f`.`lgd_grade_rank`, `exp_f`.`lgd_grade_sup`, `exp_f`.`lgd_mitigation`, `exp_f`.`lgd_tcdr`,  `exp_f`.`lmt_eff_dt`, `exp_f`.`look_through_treatment`, `exp_f`.`lt_rat_agency_cd`, `exp_f`.`ltv_current`, `exp_f`.`management_location_cd`,  NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_wid`, NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AS `management_prod_id`,  `exp_f`.`maturity_eff`, `exp_f`.`maturity_limit_flag`,  `exp_f`.`mi`, `exp_f`.`mi_hedge`, `exp_f`.`mortgage_alternative`, `exp_f`.`mtm`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `mtm`, `exp_f`.`nbv_currency`, `exp_f`.`nbv_value`, `exp_f`.`netted_nominal`, `exp_f`.`nominal_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `nominal_tcdr`, `exp_f`.`non_contractual_parental_supt`, `exp_f`.`non_financial_scorecard`, `exp_f`.`non_material_equity`, `exp_f`.`notional_2`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_2`, `exp_f`.`notional_2ccy`, `exp_f`.`notional_tcdr`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `notional_tcdr`, `exp_f`.`decimal_of_obligor`, `exp_f`.`obligor_grade_inf_original`, `exp_f`.`obligor_grade_rank_new`, `exp_f`.`obligor_grade_rank_original`, `exp_f`.`obligor_grade_sup_original`, `exp_f`.`occ_sub_segment`, `exp_f`.`original_limit_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `original_limit_amount`, `exp_f`.`out_limit_product`, `exp_f`.`overdue_days`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `overdue_days`, `exp_f`.`parent_id`, `exp_f`.`pce_flag`, `exp_f`.`pd_midpoint`, `exp_f`.`pd_pre_floor_new`, `exp_f`.`pd_pre_floor_original`, `exp_f`.`pool_cd`, `exp_f`.`premium_current`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `premium_current`,  `exp_f`.`prod_cat_info`, `exp_f`.`product_gl_criteria_2`, `exp_f`.`proxy_lgd`, `exp_f`.`psgl_cd`, `exp_f`.`psgl_department`, `exp_f`.`qualifying_ccp`, `exp_f`.`qualifying_transaction`,  `exp_f`.`rc`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rc`,  `exp_f`.`rwa_before_scale`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_before_scale`, `exp_f`.`rwa_cpty`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_cpty`, `exp_f`.`rwa_net_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_net_saves`, `exp_f`.`rwa_pre_floor_equity`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_pre_floor_equity`, `exp_f`.`rwa_saves`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_saves`, `exp_f`.`rwa_total`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `rwa_total`, `exp_f`.`second_loss_treatment`, `exp_f`.`secu_issue_date`, `exp_f`.`secu_loss_position`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_loss_position`, `exp_f`.`secu_retail_line_fg`, `exp_f`.`secu_spread_trapping_ratio`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secu_spread_trapping_ratio`, `exp_f`.`secu_uncommited_retail_fg`, `exp_f`.`secured_lgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `secured_lgd`, `exp_f`.`securitization_ref_no`, `exp_f`.`security_positions_ref`, `exp_f`.`settlement_price`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `settlement_price`, `exp_f`.`sov_indicator`, `exp_f`.`sovereign_risk_bucket_new`, `exp_f`.`sovereign_risk_bucket_ori`, `exp_f`.`standard_prod_wid`, `exp_f`.`standard_prod_cd`, `exp_f`.`std_rw_override_indicator`, `exp_f`.`strategy`, `exp_f`.`sub_limit_fac_ref_no`, `exp_f`.`supervisor_cd`, `exp_f`.`supfin_cd`, `exp_f`.`tbs_cd`, `exp_f`.`total_facility_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_facility_amount`, `exp_f`.`total_initital_margin`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `total_initital_margin`, `exp_f`.`tp_sys_scr_id`, `exp_f`.`trade_date`, `exp_f`.`trading_ind`,   `exp_f`.`uncommitted_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_amount`, `exp_f`.`uncommitted_available_amunt`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_available_amunt`, `exp_f`.`uncommitted_headroom`, `exp_f`.`uncommitted_used_amount`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `uncommitted_used_amount`,  `exp_f`.`wi`,    `exp_f`.`wtpdlgd`   * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) as  `wtpdlgd`,  `exp_f`.`zero_haircut_for_repo`, `exp_f`.`zero_rw_for_equity`, `exp_f`.`zone_a_new`, `exp_f`.`zone_a_original`, null as `crg_crg_org_g5_code`  , null as `crg_crg_org_g4_code`  , null as `crg_crg_org_g3_code`  , null as `crg_crg_org_g5_desc`  , null as `crg_crg_org_g4_desc`  , null as `crg_crg_org_g3_desc`  , null as `crg_total`  , null  as `crg_rank_crg`  , `standard_product`.`standard_prod_desc` as `standard_prod_desc`, null as `nd_rate`,   `exp_f`.`collateral_unique_id` AS `collateral_unique_id`, `exp_f`.`derived_limit_id` AS `derived_limit_id`, `exp_f`.`w_snapshot_dt` AS `reporting_month`, `exp_f`.`w_datasource_id` AS `datasource`, `exp_f`.`w_workspace` AS `workspace`,   `obl`.`client_id` AS `obligor_id`, `obl`.`client_name` AS `obligor_name`, `obl`.`client_le_id` AS `obligor_le_id`, `obl`.`client_le_wid` AS `obligor_le_wid`, `obl`.`client_domicile_loc_id` AS `obligor_domicile_loc_id`, `obl`.`coi_loc_id` AS `obligor_coi_loc_id`, `obl`.`client_group_id` AS `obligor_group_id`, `obl`.`client_le_name` AS `obligor_le_name`, `obl`.`client_le_domicile_loc_id` AS `obligor_le_domicile_loc_id`, `obl`.`client_le_subsegment_id` AS `obligor_le_subsegment_id`, `obl`.`le_coi_loc_id` AS `obligor_le_coi_loc_id`, `obl`.`client_le_group_id` AS `obligor_le_group_id`, `obl`.`client_group_name` AS `obligor_group_name`, `obl`.`client_group_domicile_loc` AS `obligor_group_domicile_loc`, `obl`.`client_group_segment_id` AS `obligor_group_segment_id`, `obl`.`client_group_category` AS `obligor_group_category`, `obl`.`client_subsegment` AS `obligor_subsegment`, `obl`.`client_segment_id` AS `obligor_segment_id`, `obl`.`client_segment` AS `obligor_segment`, `obl`.`segment_sub_category_id` AS `obligor_segment_sub_category_id`, `obl`.`segment_category_id` AS `obligor_segment_category_id`, `obl`.`client_coi_country` AS `obligor_coi_country`, `obl`.`client_coi_region_code` AS `obligor_coi_region_code`, `obl`.`client_coi_region` AS `obligor_coi_region`, `obl`.`client_dom_country` AS `obligor_dom_country`, `obl`.`client_dom_region_code` AS `obligor_dom_region_code`, `obl`.`client_dom_region` AS `obligor_dom_region`, `obl`.`client_le_coi_country` AS `obligor_le_coi_country`, `obl`.`client_le_coi_region_code` AS `obligor_le_coi_region_code`, `obl`.`client_le_coi_region` AS `obligor_le_coi_region`, `obl`.`client_le_dom_country` AS `obligor_le_dom_country`, `obl`.`client_le_dom_region_code` AS `obligor_le_dom_region_code`, `obl`.`client_le_dom_region` AS `obligor_le_dom_region`, `obl`.`client_group_dom_country` AS `obligor_group_dom_country`, `obl`.`client_group_dom_region_code` AS `obligor_group_dom_region_code`, `obl`.`client_group_dom_region` AS `obligor_group_dom_region`, `obl`.`industry_group_id` AS `obligor_industry_group_id`, `obl`.`industry_group` AS `obligor_industry_group`, `obl`.`isic` AS `obligor_isic`, `obl`.`isic_desc` AS `obligor_isic_desc`, `obl`.`client_crg` AS `obligor_crg`, `obl`.`client_crg_num` AS `obligor_crg_num`, `obl`.`client_crg_range` AS `obligor_crg_range`, `obl`.`client_crg_book_type` AS `obligor_crg_book_type`, `obl`.`client_le_crg` AS `obligor_le_crg`, `obl`.`client_le_crg_num` AS `obligor_le_crg_num`, `obl`.`client_le_crg_range` AS `obligor_le_crg_range`, `obl`.`client_le_crg_book_type` AS `obligor_le_crg_book_type`,  `gua`.`client_id` AS `guarantor_id`, `gua`.`client_name` AS `guarantor_name`, `gua`.`client_le_id` AS `guarantor_le_id`, `gua`.`client_le_wid` AS `guarantor_le_wid`, `gua`.`client_domicile_loc_id` AS `guarantor_domicile_loc_id`, `gua`.`coi_loc_id` AS `guarantor_coi_loc_id`, `gua`.`client_group_id` AS `guarantor_group_id`, `gua`.`client_le_name` AS `guarantor_le_name`, `gua`.`client_le_domicile_loc_id` AS `guarantor_le_domicile_loc_id`, `gua`.`client_le_subsegment_id` AS `guarantor_le_subsegment_id`, `gua`.`le_coi_loc_id` AS `guarantor_le_coi_loc_id`, `gua`.`client_le_group_id` AS `guarantor_le_group_id`, `gua`.`client_group_name` AS `guarantor_group_name`, `gua`.`client_group_domicile_loc` AS `guarantor_group_domicile_loc`, `gua`.`client_group_segment_id` AS `guarantor_group_segment_id`, `gua`.`client_group_category` AS `guarantor_group_category`, `gua`.`client_subsegment` AS `guarantor_subsegment`, `gua`.`client_segment_id` AS `guarantor_segment_id`, `gua`.`client_segment` AS `guarantor_segment`, `gua`.`segment_sub_category_id` AS `guarantor_segment_sub_category_id`, `gua`.`segment_category_id` AS `guarantor_segment_category_id`, `gua`.`client_coi_country` AS `guarantor_coi_country`, `gua`.`client_coi_region_code` AS `guarantor_coi_region_code`, `gua`.`client_coi_region` AS `guarantor_coi_region`, `gua`.`client_dom_country` AS `guarantor_dom_country`, `gua`.`client_dom_region_code` AS `guarantor_dom_region_code`, `gua`.`client_dom_region` AS `guarantor_dom_region`, `gua`.`client_le_coi_country` AS `guarantor_le_coi_country`, `gua`.`client_le_coi_region_code` AS `guarantor_le_coi_region_code`, `gua`.`client_le_coi_region` AS `guarantor_le_coi_region`, `gua`.`client_le_dom_country` AS `guarantor_le_dom_country`, `gua`.`client_le_dom_region_code` AS `guarantor_le_dom_region_code`, `gua`.`client_le_dom_region` AS `guarantor_le_dom_region`, `gua`.`client_group_dom_country` AS `guarantor_group_dom_country`, `gua`.`client_group_dom_region_code` AS `guarantor_group_dom_region_code`, `gua`.`client_group_dom_region` AS `guarantor_group_dom_region`, `gua`.`industry_group_id` AS `guarantor_industry_group_id`, `gua`.`industry_group` AS `guarantor_industry_group`, `gua`.`isic` AS `guarantor_isic`, `gua`.`isic_desc` AS `guarantor_isic_desc`, `gua`.`client_crg` AS `guarantor_crg`, `gua`.`client_crg_num` AS `guarantor_crg_num`, `gua`.`client_crg_range` AS `guarantor_crg_range`, `gua`.`client_crg_book_type` AS `guarantor_crg_book_type`, `gua`.`client_le_crg` AS `guarantor_le_crg`, `gua`.`client_le_crg_num` AS `guarantor_le_crg_num`, `gua`.`client_le_crg_range` AS `guarantor_le_crg_range`, `gua`.`client_le_crg_book_type` AS `guarantor_le_crg_book_type`,  `client`.`client_id` AS `client_id`, `client`.`client_name` AS `client_name`, `client`.`client_le_id` AS `client_le_id`, `client`.`client_le_wid` AS `client_le_wid`, `client`.`client_domicile_loc_id` AS `client_domicile_loc_id`, `client`.`coi_loc_id` AS `client_coi_loc_id`, `client`.`client_group_id` AS `client_group_id`, `client`.`obligor_flag` AS `obligor_flag`, `client`.`guarantor_flag` AS `guarantor_flag`, `client`.`collateral_flag` AS `collateral_flag`, `client`.`issuer_flag` AS `issuer_flag`, `client`.`client_le_name` AS `client_le_name`, `client`.`client_le_domicile_loc_id` AS `client_le_domicile_loc_id`, `client`.`client_le_subsegment_id` AS `client_le_subsegment_id`, `client`.`le_coi_loc_id` AS `client_le_coi_loc_id`, `client`.`client_le_group_id` AS `client_le_group_id`, `client`.`client_group_name` AS `client_group_name`, `client`.`client_group_domicile_loc` AS `client_group_domicile_loc`, `client`.`client_group_segment_id` AS `client_group_segment_id`, `client`.`client_group_category` AS `client_group_category`, `client`.`client_subsegment` AS `client_subsegment`, `client`.`client_segment_id` AS `client_segment_id`, `client`.`client_segment` AS `client_segment`, `client`.`segment_sub_category_id` AS `client_segment_sub_category_id`, `client`.`segment_category_id` AS `client_segment_category_id`, `client`.`client_coi_country` AS `client_coi_country`, `client`.`client_coi_region_code` AS `client_coi_region_code`, `client`.`client_coi_region` AS `client_coi_region`, `client`.`client_dom_country` AS `client_dom_country`, `client`.`client_dom_region_code` AS `client_dom_region_code`, `client`.`client_dom_region` AS `client_dom_region`, `client`.`client_le_coi_country` AS `client_le_coi_country`, `client`.`client_le_coi_region_code` AS `client_le_coi_region_code`, `client`.`client_le_coi_region` AS `client_le_coi_region`, `client`.`client_le_dom_country` AS `client_le_dom_country`, `client`.`client_le_dom_region_code` AS `client_le_dom_region_code`, `client`.`client_le_dom_region` AS `client_le_dom_region`, `client`.`client_group_dom_country` AS `client_group_dom_country`, `client`.`client_group_dom_region_code` AS `client_group_dom_region_code`, `client`.`client_group_dom_region` AS `client_group_dom_region`, `client`.`industry_group_id` AS `client_industry_group_id`, `client`.`industry_group` AS `client_industry_group`, `client`.`isic` AS `client_isic`, `client`.`isic_desc` AS `client_isic_desc`, `client`.`client_crg` AS `client_crg`, `client`.`client_crg_num` AS `client_crg_num`, `client`.`client_crg_range` AS `client_crg_range`, `client`.`client_crg_book_type` AS `client_crg_book_type`, `client`.`client_le_crg` AS `client_le_crg`, `client`.`client_le_crg_num` AS `client_le_crg_num`, `client`.`client_le_crg_range` AS `client_le_crg_range`, `client`.`client_le_crg_book_type` AS `client_le_crg_book_type`,  `limit_cl`.`client_id` AS `lmt_cl_id`, `limit_cl`.`client_name` AS `lmt_cl_name`, `limit_cl`.`client_le_id` AS `lmt_cl_le_id`, `limit_cl`.`client_le_wid` AS `lmt_cl_le_wid`, `limit_cl`.`client_domicile_loc_id` AS `lmt_cl_domicile_loc_id`, `limit_cl`.`coi_loc_id` AS `lmt_cl_coi_loc_id`, `limit_cl`.`client_group_id` AS `lmt_cl_group_id`, `limit_cl`.`client_le_name` AS `lmt_cl_le_name`, `limit_cl`.`client_le_domicile_loc_id` AS `lmt_cl_le_domicile_loc_id`, `limit_cl`.`client_le_subsegment_id` AS `lmt_cl_le_subsegment_id`, `limit_cl`.`le_coi_loc_id` AS `lmt_cl_le_coi_loc_id`, `limit_cl`.`client_le_group_id` AS `lmt_cl_le_group_id`, `limit_cl`.`client_group_name` AS `lmt_cl_group_name`, `limit_cl`.`client_group_domicile_loc` AS `lmt_cl_group_domicile_loc`, `limit_cl`.`client_group_segment_id` AS `lmt_cl_group_segment_id`, `limit_cl`.`client_group_category` AS `lmt_cl_group_category`, `limit_cl`.`client_subsegment` AS `lmt_cl_subsegment`, `limit_cl`.`client_segment_id` AS `lmt_cl_segment_id`, `limit_cl`.`client_segment` AS `lmt_cl_segment`, `limit_cl`.`segment_sub_category_id` AS `lmt_cl_segment_sub_category_id`, `limit_cl`.`segment_category_id` AS `lmt_cl_segment_category_id`, `limit_cl`.`client_coi_country` AS `lmt_cl_coi_country`, `limit_cl`.`client_coi_region_code` AS `lmt_cl_coi_region_code`, `limit_cl`.`client_coi_region` AS `lmt_cl_coi_region`, `limit_cl`.`client_dom_country` AS `lmt_cl_dom_country`, `limit_cl`.`client_dom_region_code` AS `lmt_cl_dom_region_code`, `limit_cl`.`client_dom_region` AS `lmt_cl_dom_region`, `limit_cl`.`client_le_coi_country` AS `lmt_cl_le_coi_country`, `limit_cl`.`client_le_coi_region_code` AS `lmt_cl_le_coi_region_code`, `limit_cl`.`client_le_coi_region` AS `lmt_cl_le_coi_region`, `limit_cl`.`client_le_dom_country` AS `lmt_cl_le_dom_country`, `limit_cl`.`client_le_dom_region_code` AS `lmt_cl_le_dom_region_code`, `limit_cl`.`client_le_dom_region` AS `lmt_cl_le_dom_region`, `limit_cl`.`client_group_dom_country` AS `lmt_cl_group_dom_country`, `limit_cl`.`client_group_dom_region_code` AS `lmt_cl_group_dom_region_code`, `limit_cl`.`client_group_dom_region` AS `lmt_cl_group_dom_region`, `limit_cl`.`industry_group_id` AS `lmt_cl_industry_group_id`, `limit_cl`.`industry_group` AS `lmt_cl_industry_group`, `limit_cl`.`isic` AS `lmt_cl_isic`, `limit_cl`.`isic_desc` AS `lmt_cl_isic_desc`, `limit_cl`.`client_crg` AS `lmt_cl_crg`, `limit_cl`.`client_crg_num` AS `lmt_cl_crg_num`, `limit_cl`.`client_crg_range` AS `lmt_cl_crg_range`, `limit_cl`.`client_crg_book_type` AS `lmt_cl_crg_book_type`, `limit_cl`.`client_le_crg` AS `lmt_cl_le_crg`, `limit_cl`.`client_le_crg_num` AS `lmt_cl_le_crg_num`, `limit_cl`.`client_le_crg_range` AS `lmt_cl_le_crg_range`, `limit_cl`.`client_le_crg_book_type` AS `lmt_cl_le_crg_book_type`,  `coll_owner`.`client_id` AS `coll_owner_id`, `coll_owner`.`client_name` AS `coll_owner_name`, `coll_owner`.`client_le_id` AS `coll_owner_le_id`, `coll_owner`.`client_le_wid` AS `coll_owner_le_wid`, `coll_owner`.`client_domicile_loc_id` AS `coll_owner_domicile_loc_id`, `coll_owner`.`coi_loc_id` AS `coll_owner_coi_loc_id`, `coll_owner`.`client_group_id` AS `coll_owner_group_id`, `coll_owner`.`client_le_name` AS `coll_owner_le_name`, `coll_owner`.`client_le_domicile_loc_id` AS `coll_owner_le_domicile_loc_id`, `coll_owner`.`client_le_subsegment_id` AS `coll_owner_le_subsegment_id`, `coll_owner`.`le_coi_loc_id` AS `coll_owner_le_coi_loc_id`, `coll_owner`.`client_le_group_id` AS `coll_owner_le_group_id`, `coll_owner`.`client_group_name` AS `coll_owner_group_name`, `coll_owner`.`client_group_domicile_loc` AS `coll_owner_group_domicile_loc`, `coll_owner`.`client_group_segment_id` AS `coll_owner_group_segment_id`, `coll_owner`.`client_group_category` AS `coll_owner_group_category`, `coll_owner`.`client_subsegment` AS `coll_owner_subsegment`, `coll_owner`.`client_segment_id` AS `coll_owner_segment_id`, `coll_owner`.`client_segment` AS `coll_owner_segment`, `coll_owner`.`segment_sub_category_id` AS `coll_owner_segment_sub_category_id`, `coll_owner`.`segment_category_id` AS `coll_owner_segment_category_id`, `coll_owner`.`client_coi_country` AS `coll_owner_coi_country`, `coll_owner`.`client_coi_region_code` AS `coll_owner_coi_region_code`, `coll_owner`.`client_coi_region` AS `coll_owner_coi_region`, `coll_owner`.`client_dom_country` AS `coll_owner_dom_country`, `coll_owner`.`client_dom_region_code` AS `coll_owner_dom_region_code`, `coll_owner`.`client_dom_region` AS `coll_owner_dom_region`, `coll_owner`.`client_le_coi_country` AS `coll_owner_le_coi_country`, `coll_owner`.`client_le_coi_region_code` AS `coll_owner_le_coi_region_code`, `coll_owner`.`client_le_coi_region` AS `coll_owner_le_coi_region`, `coll_owner`.`client_le_dom_country` AS `coll_owner_le_dom_country`, `coll_owner`.`client_le_dom_region_code` AS `coll_owner_le_dom_region_code`, `coll_owner`.`client_le_dom_region` AS `coll_owner_le_dom_region`, `coll_owner`.`client_group_dom_country` AS `coll_owner_group_dom_country`, `coll_owner`.`client_group_dom_region_code` AS `coll_owner_group_dom_region_code`, `coll_owner`.`client_group_dom_region` AS `coll_owner_group_dom_region`, `coll_owner`.`industry_group_id` AS `coll_owner_industry_group_id`, `coll_owner`.`industry_group` AS `coll_owner_industry_group`, `coll_owner`.`isic` AS `coll_owner_isic`, `coll_owner`.`isic_desc` AS `coll_owner_isic_desc`, `coll_owner`.`client_crg` AS `coll_owner_crg`, `coll_owner`.`client_crg_num` AS `coll_owner_crg_num`, `coll_owner`.`client_crg_range` AS `coll_owner_crg_range`, `coll_owner`.`client_crg_book_type` AS `coll_owner_crg_book_type`, `coll_owner`.`client_le_crg` AS `coll_owner_le_crg`, `coll_owner`.`client_le_crg_num` AS `coll_owner_le_crg_num`, `coll_owner`.`client_le_crg_range` AS `coll_owner_le_crg_range`, `coll_owner`.`client_le_crg_book_type` AS `coll_owner_le_crg_book_type`,  `br`.`client_id` AS `broker_id`, `br`.`client_name` AS `broker_name`, `br`.`client_le_id` AS `broker_le_id`, `br`.`client_le_wid` AS `broker_le_wid`, `br`.`client_domicile_loc_id` AS `broker_domicile_loc_id`, `br`.`coi_loc_id` AS `broker_coi_loc_id`, `br`.`client_group_id` AS `broker_group_id`, `br`.`client_le_name` AS `broker_le_name`, `br`.`client_le_domicile_loc_id` AS `broker_le_domicile_loc_id`, `br`.`client_le_subsegment_id` AS `broker_le_subsegment_id`, `br`.`le_coi_loc_id` AS `broker_le_coi_loc_id`, `br`.`client_le_group_id` AS `broker_le_group_id`, `br`.`client_group_name` AS `broker_group_name`, `br`.`client_group_domicile_loc` AS `broker_group_domicile_loc`, `br`.`client_group_segment_id` AS `broker_group_segment_id`, `br`.`client_group_category` AS `broker_group_category`, `br`.`client_subsegment` AS `broker_subsegment`, `br`.`client_segment_id` AS `broker_segment_id`, `br`.`client_segment` AS `broker_segment`, `br`.`segment_sub_category_id` AS `broker_segment_sub_category_id`, `br`.`segment_category_id` AS `broker_segment_category_id`, `br`.`client_coi_country` AS `broker_coi_country`, `br`.`client_coi_region_code` AS `broker_coi_region_code`, `br`.`client_coi_region` AS `broker_coi_region`, `br`.`client_dom_country` AS `broker_dom_country`, `br`.`client_dom_region_code` AS `broker_dom_region_code`, `br`.`client_dom_region` AS `broker_dom_region`, `br`.`client_le_coi_country` AS `broker_le_coi_country`, `br`.`client_le_coi_region_code` AS `broker_le_coi_region_code`, `br`.`client_le_coi_region` AS `broker_le_coi_region`, `br`.`client_le_dom_country` AS `broker_le_dom_country`, `br`.`client_le_dom_region_code` AS `broker_le_dom_region_code`, `br`.`client_le_dom_region` AS `broker_le_dom_region`, `br`.`client_group_dom_country` AS `broker_group_dom_country`, `br`.`client_group_dom_region_code` AS `broker_group_dom_region_code`, `br`.`client_group_dom_region` AS `broker_group_dom_region`, `br`.`industry_group_id` AS `broker_industry_group_id`, `br`.`industry_group` AS `broker_industry_group`, `br`.`isic` AS `broker_isic`, `br`.`isic_desc` AS `broker_isic_desc`, `br`.`client_crg` AS `broker_crg`, `br`.`client_crg_num` AS `broker_crg_num`, `br`.`client_crg_range` AS `broker_crg_range`, `br`.`client_crg_book_type` AS `broker_crg_book_type`, `br`.`client_le_crg` AS `broker_le_crg`, `br`.`client_le_crg_num` AS `broker_le_crg_num`, `br`.`client_le_crg_range` AS `broker_le_crg_range`, `br`.`client_le_crg_book_type` AS `broker_le_crg_book_type`,  `limit_cl`.`client_wid` as `limit_cl_client_wid`, `coll_owner`.`client_wid` as `coll_owner_client_wid`,  `obl`.`attribute1` AS `obligor_scorecard_type`, `gua`.`attribute1` AS `guarantor_scorecard_type`, `client`.`attribute1` AS `client_scorecard_type`, `limit_cl`.`attribute1` AS `limit_cl_scorecard_type`, `coll_owner`.`attribute1` AS `coll_owner_scorecard_type`, `br`.`attribute1` AS `broker_scorecard_type`, `be`.`booking_entity`  as `booking_entity_name`,   `obl`.`risk_value` `obligor_risk_value`, `obl`.`pe_code` `obligor_pe_code`, `obl`.`pe_name` `obligor_pe_name`, `obl`.`pe_date` `obligor_pe_date`, `obl`.`lsp_ifrs_value` `obligor_lsp_ifrs_value`, `obl`.`lsp_ifrs_number` `obligor_lsp_ifrs_number`, `obl`.`lsp_ifrs_description` `obligor_lsp_ifrs_description`, `obl`.`credit_status_code` `obligor_credit_status_code`, `obl`.`credit_status_description` `obligor_credit_status_description`, `obl`.`credit_status_eff_date` `obligor_credit_status_eff_date`, `obl`.`gam_id` `obligor_GAM_ID`, `obl`.`gam_booking_entity_code` `obligor_GAM_BOOKING_ENTITY_CODE`, `obl`.`gam_country_code` `obligor_GAM_COUNTRY_CODE`, `obl`.`gam_name` `obligor_GAM_NAME`, `obl`.`gam_country` `obligor_GAM_COUNTRY`,   `lmt_ref`.`governing_law` `limit_governing_law`, `lmt_ref`.`cms_bfl_issued_date` `limit_cms_bfl_issued_date`,  `fam`.`fam_id`, `fam`.`fam_name`, `fam`.`fam_country_code`, `fam`.`fam_booking_entity_code`, `famdom`.`country_desc` `gam_country`,    `oblfam`.`fam_id` AS `obligor_fam_id`, `oblfam`.`fam_name` AS `obligor_fam_name`, `oblfam`.`fam_country_code` AS `obligor_fam_country_code`, `oblfam`.`fam_booking_entity_code` AS `obligor_fam_booking_entity_code`, `guafam`.`fam_id` AS `guarantor_fam_id`, `guafam`.`fam_name` AS `guarantor_fam_name`, `guafam`.`fam_country_code` AS `guarantor_fam_country_code`, `guafam`.`fam_booking_entity_code` AS `guarantor_fam_booking_entity_code`, `lmtfam`.`fam_id` AS `limit_fam_id`, `lmtfam`.`fam_name` AS `limit_fam_name`, `lmtfam`.`fam_country_code` AS `limit_fam_country_code`, `lmtfam`.`fam_booking_entity_code` AS `limit_fam_booking_entity_code`,   `obl`.`gsam_new_indicator`, `obl`.`gsam_indicator`, `obl`.`exit_to_gsam`,  `client`.`branch_subsidiary` `branch_subsidiary`, `client`.`country_of_residence` `country_of_residence`, `client`.`default_date` `default_date`, `client`.`default_flag` `default_flag`, `client`.`entity_code_2` `entity_code_2`, `client`.`client_et_cd_user` `client_et_cd_user`, `client`.`industry_sector` `industry_sector`, `client`.`relationship_start_date` `relationship_start_date`, `client`.`specialized_lending` `specialized_lending`, `client`.`client_latest_crg_id` `client_latest_crg_id`,  CASE WHEN `obl`.`attribute1`='Sovereign' then `obl`.`client_crg` else `obl`.`client_le_crg` end as `Obligor_LE_CRG_Creditmate`,  NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) `C_RWA`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' OR `exp_f`.`tranche_guarantee_type` = 'GUARANTEED' then NVL(`exp_f`.`rwa_pre_crm` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) - NVL((NVL(`exp_f`.`rwa` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`cva_rwa`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)),0) END AS `RWA_Savings`,  CASE WHEN `exp_f`.`tranche_collateral_type` = 'COLLATERALIZED' THEN NVL(`exp_f`.`ead_netting` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) + NVL(`exp_f`.`covered_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0)   WHEN `exp_f`.`tranche_collateral_type` = 'NOT COLLATERALIZED' and `exp_f`.`tranche_guarantee_type` = 'GUARANTEED'  then `exp_f`.`gurantee_ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1)  else 0 END AS `Secured_EAD`,  CASE WHEN `exp_f`.`method_new` = 'ADV' or `exp_f`.`method_new` = 'FOU' then  NVL(`exp_f`.`wt_final_pd` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) * NVL(`exp_f`.`ead` * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1),0) else 0 END AS `WT_Final_PD_dollar`,  CASE WHEN `gua`.`attribute1` = 'Sovereign'   then `gua`.`client_crg`  else `gua`.`client_le_crg` end AS `Guarantor_LE_CRG_Creditmate`,  CASE WHEN `limit_cl`.`attribute1` = 'Sovereign'   then `limit_cl`.`client_crg` else `limit_cl`.`client_le_crg` end as `Limit_Client_LE_CRG_Creditmate`,  CASE WHEN INSTR(`comb`.`book_wid`, '_CI_')>0 THEN 'CI'   WHEN INSTR(`comb`.`book_wid`,'_CC_')>0 THEN 'CC'   WHEN INSTR(`comb`.`book_wid`,'_PB_')>0 THEN 'PvB'   WHEN INSTR(`comb`.`book_wid`,'_OB_')>0 THEN 'OT'   WHEN INSTR(`comb`.`book_wid`,'_RT_')>0 THEN 'RL' ELSE `comb`.`book_wid` END AS `Business_Segment`,  `exp_f`.`collateral_assigned_amount`  * nvl(`exc_rate_usd`.`exchange_rate_for_conv`,1) * (1-`exp_f`.`hc`) `FSV_Before_Haircut`,  CASE WHEN NVL(`comb`.`limit_ref_no`,'0') <> '0' then 'Y' else 'N' end as `Linked_Unlinked_Ind_Derived`,  CASE WHEN `comb`.`book_wid` is not null then substr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1),0,instr(substr(`comb`.`book_wid`,instr(`comb`.`book_wid`,'_')+1,length(`comb`.`book_wid`)), '_')-1)  else null end as `Client_Segment_Category_ID_Book_code_derived`,  CASE WHEN `col_tg`.`collateral_code` LIKE 'CF%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'MS%' THEN 'Securities' WHEN `col_tg`.`collateral_code` LIKE 'PT%' THEN 'Property' WHEN `col_tg`.`collateral_code` LIKE 'GMGMKTREP%' THEN 'Repo' WHEN `col_tg`.`collateral_code` LIKE 'AB%' THEN 'Asset Backed' WHEN `col_tg`.`collateral_code` LIKE 'CS%' OR `col_tg`.`collateral_code` LIKE 'SD%' OR `col_tg`.`collateral_code` LIKE 'FRP%'  THEN 'Cash' WHEN `col_tg`.`collateral_code` is null or TRIM(`col_tg`.`collateral_code`)='' then NULL ELSE 'Other' END AS `collateral_type_group`,  `lmt_ref`.`llp_holdco_cd_val`, `lmt_ref`.`llp_non_gam_cd_val`,  `col_ref`.`new_collateral_flag` `crm_new_collateral_flag`,  `bca`.`bca_review_dt`, `bca`.`bca_extended_review_dt`  from `sgmisit`.`SGMI_ALL_TXN_F` `comb`   left join `sgmisit`.`sgmi_exposure_f` `exp_f` on `comb`.`exposure_id` = `exp_f`.`ais_id`           AND IF(nvl(`exp_f`.`counterparty_new_wid`,'')=='',`exp_f`.`counterparty_original_wid`,`exp_f`.`counterparty_new_wid`)   = `comb`.`client_wid`    and `exp_f`.`w_snapshot_dt`= '2021-08-31' AND `exp_f`.`w_datasource_id` = 'BCRS_RC' AND `exp_f`.`w_country_cd` =  'ALL' AND `exp_f`.`w_workspace` = 'WS43'           left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_f` on `comb`.`limit_id` = `lmt_f`.`limit_id`                    AND `lmt_f`.`client_wid`  = `comb`.`client_wid`      and `lmt_f`.`w_snapshot_dt`= '2021-08-31' AND `lmt_f`.`w_datasource_id` = 'BCRS_RC' AND `lmt_f`.`w_country_cd` =  'ALL'           left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_f` on `comb`.`collateral_id` = `col_f`.`crm_contract_ref_no`                         and `col_f`.`w_snapshot_dt`= '2021-08-31' AND `col_f`.`w_datasource_id` = 'BCRS_RC' AND `col_f`.`w_country_cd` =  'ALL' AND `col_f`.`w_workspace` = split('WS43','_ADJ')[0]          left join `sgmisit`.`SGMI_CLIENT_LIMIT_F` `lmt_ref` on `comb`.`limit_ref_no` = `lmt_ref`.`limit_id`       and `lmt_ref`.`w_snapshot_dt`= '2021-08-31' AND `lmt_ref`.`w_datasource_id` = 'BCRS_RC' AND `lmt_ref`.`w_country_cd` =  'ALL'          left join `sgmisit`.`sgmi_crm_contract_ref_f` `col_ref` on `comb`.`collateral_ref_no` = `col_ref`.`crm_contract_ref_no`        and `col_ref`.`w_snapshot_dt`= '2021-08-31' AND `col_ref`.`w_datasource_id` = 'BCRS_RC' AND `col_ref`.`w_country_cd` =  'ALL' AND `col_ref`.`w_workspace` = split('WS43','_ADJ')[0]           LEFT JOIN `sgmisit`.`SGMI_CLIENT_BCA_D` `BCA` ON `bca`.`bca_ref_no`  = `lmt_ref`.`edm_bca_ref_no` AND `lmt_ref`.`w_snapshot_dt` = `bca`.`w_snapshot_dt` AND `lmt_ref`.`limit_id` = `bca`.`limit_id`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `CCR`  ON `ccr`.`country_code` = `bca`.`ccr`     LEFT JOIN `sgmisit`.`SGMI_VIEW_COUNTRY_DATA_EXP_DAT` `LIMIT_BL`  ON `lmt_ref`.`edm_limit_booking_loc` = `limit_bl`.`country_code`  LEFT JOIN `sgmisit`.`sgmi_standard_prod_code_dat` `STANDARD_PROD` ON `standard_prod`.`standard_product_code` = NVL(NVL(`lmt_ref`.`edm_limit_prd_code` , `lmt_ref`.`product_cd`),`exp_f`.`standard_prod_wid`)     LEFT JOIN `sgmisit`.`SGMI_PRODUCT_D` `STANDARD_PRODUCT` ON `standard_product`.`standard_prod_wid` = `exp_f`.`standard_prod_wid`                  AND `exp_f`.`w_datasource_id` = `standard_product`.`w_datasource_id`                AND `exp_f`.`w_country_cd` = `standard_product`.`w_country_cd`     LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `OBL` ON `obl`.`client_wid`=`exp_f`.`counterparty_original_wid` AND `obl`.`w_snapshot_dt`='2021-08-31' AND `obl`.`w_datasource_id`='BCRS_RC' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `GUA` ON `gua`.`client_wid`=`exp_f`.`counterparty_new_wid` AND `exp_f`.`tranche_guarantee_type`='GUARANTEED' AND `gua`.`w_snapshot_dt`='2021-08-31' AND `gua`.`w_datasource_id`='BCRS_RC' AND `obl`.`w_country_cd`='ALL'  LEFT JOIN `sgmisit`.`sgmi_client_d_dn` `CLIENT` ON `client`.`client_wid`=`comb`.`client_wid` AND `client`.`w_snapshot_dt`='2021-08-31' AND `client`.`w_datasource_id`='BCRS_RC' AND `client`.`w_country_cd`='ALL'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `limit_cl` on `limit_cl`.`client_wid`  = `lmt_ref`.`client_wid` and `limit_cl`.`w_snapshot_dt`= '2021-08-31' AND `limit_cl`.`w_datasource_id` = 'BCRS_RC'    left join `sgmisit`.`SGMI_CLIENT_D_DN` `coll_owner` on   `coll_owner`.`client_wid`  = `col_ref`.`client_id` and `coll_owner`.`w_snapshot_dt`= '2021-08-31' AND `coll_owner`.`w_datasource_id` = 'BCRS_RC'  left join `sgmisit`.`SGMI_CLIENT_D_DN` `BR` on  `br`.`client_wid`  = `exp_f`.`broker_id`  and `br`.`w_snapshot_dt`= '2021-08-31' AND `br`.`w_datasource_id` = 'BCRS_RC'    LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `OSC` ON `osc`.`crg_org_g6_code`=`exp_f`.`original_crg`  LEFT JOIN `sgmisit`.`sgmi_crg_org_d_dat` `FSC` ON `fsc`.`crg_org_g6_code`=`exp_f`.`final_crg`  LEFT JOIN `sgmisit`.`sgmi_org_scrd_d_dat` `GSC` ON `gsc`.`org_scrd_g3_code` =`exp_f`.`f_original_scorecard_name`   LEFT JOIN `sgmisit`.`sgmi_jurisdiction_and_reg_dat` `JR` ON `client`.`client_domicile_loc_id`=`jr`.`country_cd`  LEFT JOIN `sgmisit`.`sgmi_risk_organisation_dat` `RO` ON `CLIENT`.`client_domicile_loc_id`=`ro`.`ccr_cntry`  LEFT JOIN `sgmisit`.`sgmi_collat_type_grouping_dat` `COL_TG` ON `col_tg`.`collateral_code`=`col_ref`.`crm_contract_type`  LEFT JOIN `sgmisit`.`sgmi_book_cd_d` `BOOK` ON `book`.`book_wid`=`comb`.`book_wid` AND `book`.`w_datasource_id` = 'BCRS_RC'     LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `BCRS_LIMIT_EXC_RATE` on `lmt_ref`.`bcrs_currency`=`bcrs_limit_exc_rate`.`currency_id` and   `bcrs_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `bcrs_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `bcrs_limit_exc_rate`.`w_datasource_id`='BCRS_RC'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EDM_LIMIT_EXC_RATE` on `lmt_ref`.`edm_approved_limit_currency`=`edm_limit_exc_rate`.`currency_id` and   `edm_limit_exc_rate`.`exch_rate_type`='exch_rate_limit' and `edm_limit_exc_rate`.`w_snapshot_dt`='2021-08-31' and `edm_limit_exc_rate`.`w_datasource_id`='BCRS_RC'   LEFT JOIN `sgmisit`.`sgmi_exch_rate_all` `EXC_RATE_USD` on `exc_rate_usd`.`exch_rate_type`='exch_rate_usd' and `exc_rate_usd`.`w_snapshot_dt`='2021-08-31' and `exc_rate_usd`.`w_datasource_id`='BCRS_RC' and (case when `comb`.`transaction_type` = 'COLLATERAL' then (case when 'BCRS_RC' = 'BCRS_PRA' then 'USD' else 'SGD' end) else `exp_f`.`ccy_cd` end) = `exc_rate_usd`.`currency_id`   LEFT JOIN `sgmisit`.`SGMI_BOOKING_ENTITY_D` `BE` ON `book`.`booking_entity_wid` = `be`.`booking_entity_wid`               AND `be`.`w_datasource_id` = `book`.`w_datasource_id` AND `be`.`w_country_cd` = `book`.`w_country_cd`       LEFT JOIN `sgmisit`.`SGMI_MANAGEMENT_PROD_D` `MGMT_PROD` ON `mgmt_prod`.`management_prod_wid` = NVL(case when `exp_f`.`management_prod_wid` ='' or `exp_f`.`management_prod_wid` IS NULL or `exp_f`.`management_prod_wid` ='UNMP' or `exp_f`.`management_prod_wid`='UNMAPPED'  then  'P1390' else  `exp_f`.`management_prod_wid` end,'P1390') AND `exp_f`.`w_snapshot_dt` = `mgmt_prod`.`w_snapshot_dt`                   AND `exp_f`.`w_datasource_id` = `mgmt_prod`.`w_datasource_id`                 AND `exp_f`.`w_country_cd` = `mgmt_prod`.`w_country_cd`           LEFT JOIN (       select `sgmi_fdw_cash_flow_f`.`contract_ref_no`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`,         sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 1 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as  `cash_flow_se_1_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 2 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_2_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 3 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_3_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 4 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_4_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 5 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_5_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 6 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_6_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 7 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_7_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 8 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_8_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 9 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_9_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 10 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_10_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 11 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_11_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) <= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_se_12_month` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) < 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `cash_flow_s_1_year` ,  sum(case when cast(months_between(`sgmi_fdw_cash_flow_f`.`cash_flow_dt`, `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`) as double) >= 12 then `sgmi_fdw_cash_flow_f`.`cash_flow_amount` end) as `Cash_Flow_ge_1_Year`         from  `sgmisit`.`SGMI_FDW_CASH_FLOW_F` where `sgmi_fdw_cash_flow_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_fdw_cash_flow_f`.`w_datasource_id`='BCRS_RC' and `sgmi_fdw_cash_flow_f`.`w_country_cd`='ALL'        group by `sgmi_fdw_cash_flow_f`.`contract_ref_no`,`sgmi_fdw_cash_flow_f`.`w_snapshot_dt` , `sgmi_fdw_cash_flow_f`.`w_datasource_id`, `sgmi_fdw_cash_flow_f`.`w_country_cd`     ) `CASH_FLOW` ON `exp_f`.`contract_ref_no` = `cash_flow`.`contract_ref_no`    LEFT JOIN `sgmisit`.`sgmi_fam_rel` `FAM` ON `fam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `fam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `fam`.`w_snapshot_dt`='2021-08-31'    LEFT JOIN `sgmisit`.`sgmi_country_loc_dat` `famdom`  ON `fam`.`fam_country_code`=`famdom`.`country_code`   LEFT JOIN `sgmisit`.`sgmi_fam_rel` `OBLFAM` ON `oblfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `oblfam`.`client_id`=`exp_f`.`counterparty_original_wid`   AND `oblfam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `GUAFAM` ON `guafam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `guafam`.`client_id`=`exp_f`.`counterparty_new_wid`   AND `guafam`.`w_snapshot_dt`='2021-08-31' LEFT JOIN `sgmisit`.`sgmi_fam_rel` `LMTFAM` ON `lmtfam`.`fam_booking_entity_code`=`book`.`booking_entity_wid` and `lmtfam`.`client_id`=`lmt_ref`.`client_wid`   AND `lmtfam`.`w_snapshot_dt`='2021-08-31'   LEFT JOIN `sgmisitstg`.`stg_bcrs_contract_types` `contp` ON `exp_f`.`w_snapshot_dt` = `contp`.`w_snapshot_dt`                                                               AND nvl(`contp`.`ct_code_user`,'UNM') = nvl(`exp_f`.`contract_type`,'UNM')              AND `contp`.`w_batch_id` = '2021112512205200371'    LEFT JOIN (select `a`.`limit_id`, `a`.`client_code`, `a`.`approver_name`, `a`.`bca_approval_date`, `a`.`bca_review_date`, `a`.`approved_lgd`, `a`.`w_created_dt`, `a`.`w_job_instance_id`, `a`.`w_snapshot_dt`, `a`.`w_datasource_id`, `a`.`w_country_cd`, `a`.`rn` from ( select `sgmi_limit_static_f`.`limit_id`, `sgmi_limit_static_f`.`client_code`, `sgmi_limit_static_f`.`approver_name`, `sgmi_limit_static_f`.`bca_approval_date`, `sgmi_limit_static_f`.`bca_review_date`, `sgmi_limit_static_f`.`approved_lgd`, `sgmi_limit_static_f`.`w_created_dt`, `sgmi_limit_static_f`.`w_job_instance_id`, `sgmi_limit_static_f`.`w_snapshot_dt`, `sgmi_limit_static_f`.`w_datasource_id`, `sgmi_limit_static_f`.`w_country_cd`, row_number() over (partition by `sgmi_limit_static_f`.`limit_id`) `rn` from `sgmisit`.`SGMI_LIMIT_STATIC_F` where `sgmi_limit_static_f`.`w_snapshot_dt`='2021-08-31' and `sgmi_limit_static_f`.`w_datasource_id`='RMI' ) `a` where `a`.`rn`=1) `RMI_LIMIT_STATIC` on `rmi_limit_static`.`limit_id`=`comb`.`limit_ref_no`       where  `comb`.`w_snapshot_dt`= '2021-08-31' AND `comb`.`w_datasource_id` = 'BCRS_RC' AND `comb`.`w_country_cd` =  'ALL' AND `comb`.`w_workspace`='WS43'
CREATE VIEW `temp_src_query_2201101552410041168` AS select          case when length(`esr`.`entity_code`) > 11 THEN null                 when length(`esr`.`entity_code`) = 8 and INSTR(`esr`.`entity_code`, '-') = 0 THEN `esr`.`entity_code`                 when length(`esr`.`entity_code`) <= 11 and INSTR(`esr`.`entity_code`, '-') = 9 THEN SUBSTR(`esr`.`entity_code`,1,8)                 when length(`esr`.`entity_code`) <= 11 and INSTR(`esr`.`entity_code`, '-') != 9 THEN null  END  `client_le_wid`         , case when length(`esr`.`entity_code`) > 11 THEN null                 when length(`esr`.`entity_code`) = 8 and INSTR(`esr`.`entity_code`, '-') = 0 THEN `esr`.`entity_code`                 when length(`esr`.`entity_code`) <= 11 and INSTR(`esr`.`entity_code`, '-') = 9 THEN SUBSTR(`esr`.`entity_code`,1,8)                 when length(`esr`.`entity_code`) <= 11 and INSTR(`esr`.`entity_code`, '-') != 9 THEN null  END  `client_le_id`                         , case when length(`esr`.`entity_code`) > 11 THEN `esr`.`entity_code`                 when length(`esr`.`entity_code`) = 8 then null                 when length(`esr`.`entity_code`) <= 11 and INSTR(`esr`.`entity_code`, '-') = 9 THEN `esr`.`entity_code`                 when length(`esr`.`entity_code`) <= 11 and INSTR(`esr`.`entity_code`, '-') = 0 THEN `esr`.`entity_code`                  END  `client_wid`         , case when length(`esr`.`entity_code`) > 11 THEN `esr`.`entity_code`                 when length(`esr`.`entity_code`) = 8 then null                 when length(`esr`.`entity_code`) <= 11 and INSTR(`esr`.`entity_code`, '-') = 9 THEN `esr`.`entity_code`                 when length(`esr`.`entity_code`) <= 11 and INSTR(`esr`.`entity_code`, '-') = 0 THEN `esr`.`entity_code`                   END  `client_id`                 , `esr`.`original_entity_class` `original_entity_class`         , `esr`.`actual_entity_class` `actual_entity_class`         , `esr`.`entity_group` `entity_group`         , `esr`.`group_annual_sales` `group_annual_sales`         , `esr`.`actual_risk_bucket` `actual_risk_bucket`         , `esr`.`risk_area` `risk_area`         , `esr`.`residence_area` `residence_area`         , `esr`.`incorporation_area` `incorporation_area`         , `esr`.`economic_sector` `economic_sector`         , `esr`.`industry_sector` `industry_sector`         , `esr`.`inter_company` `inter_company`         , `esr`.`group_assets` `group_assets`         , `esr`.`group_entity_type` `group_entity_type`         , `esr`.`entity_code_2` `entity_code_2`         , `esr`.`eligibility_risk_bucket` `eligibility_risk_bucket`         , `esr`.`actual_risk_bucket_local_ccy` `actual_risk_bucket_local_ccy`         , `esr`.`eligibility_bucket_local_ccy` `eligibility_bucket_local_ccy`         , `esr`.`internal_rating_local_ccy` `internal_rating_local_ccy`         , `esr`.`flag_consolidation` `flag_consolidation`         , `esr`.`actual_risk_bucket_st` `actual_risk_bucket_st`         , `esr`.`consolidation_percentage` `consolidation_percentage`         , `esr`.`sov_risk_bucket` `sov_risk_bucket`         , `esr`.`sov_risk_bucket_local_ccy` `sov_risk_bucket_local_ccy`         , `esr`.`zone_a` `zone_a`         , `esr`.`specific_risk_bucket_code` `specific_risk_bucket_code`         , `esr`.`entity_refresh` `entity_refresh`         , `esr`.`use_sov_risk_bucket` `use_sov_risk_bucket`         , `esr`.`rating_code` `rating_code`         , `esr`.`rating_agency` `rating_agency`         , `esr`.`rating_code_local_ccy` `rating_code_local_ccy`         , `esr`.`rating_agency_local_ccy` `rating_agency_local_ccy`         , `esr`.`consolidated` `consolidated`         , `esr`.`recognized_exchange` `recognized_exchange`         , `esr`.`managed_as_retail` `managed_as_retail`         , `esr`.`attribute_1` `attribute_1`         , `esr`.`attribute_2` `attribute_2`         , `esr`.`attribute_3` `attribute_3`         , `esr`.`attribute_4` `attribute_4`         , `esr`.`attribute_5` `attribute_5`         , `esr`.`attribute_6` `attribute_6`         , `esr`.`attribute_7` `attribute_7`         , `esr`.`attribute_8` `attribute_8`         , `esr`.`attribute_9` `attribute_9`         , `esr`.`specialized_lending` `specialized_lending`         , `esr`.`avoid_reclassification` `avoid_reclassification`         , `esr`.`continuous_pd` `continuous_pd`         , `esr`.`suficient_info_on_default` `suficient_info_on_default`         , `esr`.`et_code_user` `et_code_user`         , `esr`.`country_code` `country_code`         , `esr`.`default_flag` `default_flag`         , `esr`.`total_sales_date` `total_sales_date`         , `esr`.`total_sales_date` `total_assets_date`         , `esr`.`issue_seniority` `issue_seniority`         , `esr`.`issue_seniority_local_ccy` `issue_seniority_local_ccy`         , `esr`.`issue_reference` `issue_reference`         , `esr`.`issue_reference_local_ccy` `issue_reference_local_ccy`         , `esr`.`amount_1` `amount_1`         , `esr`.`amount_2` `amount_2`         , `esr`.`state` `state`         , `esr`.`risk_sub_area` `risk_sub_area`         , `esr`.`birth_date` `birth_date`         , `esr`.`total_currency` `total_currency`         , `esr`.`entity_gl_criteria` `entity_gl_criteria`         , `esr`.`outlook_rating` `outlook_rating`         , `esr`.`description` `description`         , `esr`.`external_code` `external_code`         , `esr`.`rating_method` `rating_method`         , `esr`.`rating_code_st` `rating_code_st`         , `esr`.`rating_agency_st` `rating_agency_st`         , `esr`.`has_security_listed_on_re` `has_security_listed_on_re`         , `esr`.`entity_type` `entity_type`         , `esr`.`actual_entity_type_category` `actual_entity_type_category`         , `esr`.`bis_risk_area` `bis_risk_area`         , `esr`.`bis_risk_sub_area` `bis_risk_sub_area`         , `esr`.`bis_industry_sector` `bis_industry_sector`         , `esr`.`review_date` `review_date`         , `esr`.`status` `status`         , `esr`.`int_rat_agency_code` `int_rat_agency_code`         , `esr`.`entity_group_desc` `entity_group_desc`         , `esr`.`entity_group_incorp_country` `entity_group_incorp_country`         , `esr`.`connected_cpty` `connected_cpty`         , `esr`.`elg_risk_bucket_int` `elg_risk_bucket_int`         , `esr`.`risk_bucket_guarantor` `risk_bucket_guarantor`         , `esr`.`sebc_not_qualifying` `sebc_not_qualifying`         , `esr`.`qualifying_issue_status` `qualifying_issue_status`         , `esr`.`sov_risk_bucket_st` `sov_risk_bucket_st`         , `esr`.`industry_sector_level` `industry_sector_level`         , `esr`.`annual_salary` `annual_salary`         , `esr`.`internal_rating_date` `internal_rating_date`         , `esr`.`financials_available` `financials_available`         , `esr`.`lt_risk_bucket` `lt_risk_bucket`         , `esr`.`lt_local_risk_bucket` `lt_local_risk_bucket`         , `esr`.`st_risk_bucket` `st_risk_bucket`         , `esr`.`elg_lt_int_local_risk_bucket` `elg_lt_int_local_risk_bucket`         , `esr`.`st_rw` `st_rw`         , `esr`.`worst_issue_st_risk_bucket` `worst_issue_st_risk_bucket`         , `esr`.`worst_issue_st_rw` `worst_issue_st_rw`         , `esr`.`exist_issue_st_rw_150_pct` `exist_issue_st_rw_150_pct`         , `esr`.`exist_issue_st_rw_50_pct` `exist_issue_st_rw_50_pct`         , `esr`.`low_quality_issue_lt_rb` `low_quality_issue_lt_rb`         , `esr`.`hq_issue_sen_lt_loc_rb` `hq_issue_sen_lt_loc_rb`         , `esr`.`hq_issue_sen_lt_rb` `hq_issue_sen_lt_rb`         , `esr`.`hq_issue_sub_lt_loc_rb` `hq_issue_sub_lt_loc_rb`         , `esr`.`hq_issue_sub_lt_rb` `hq_issue_sub_lt_rb`         , `esr`.`sov_entity_code` `sov_entity_code`         , `esr`.`sov_exist_issue_st_rw_150_pct` `sov_exist_issue_st_rw_150_pct`         , `esr`.`sov_exist_issue_st_rw_50_pct` `sov_exist_issue_st_rw_50_pct`         , `esr`.`sov_low_quality_issue_lt_rb` `sov_low_quality_issue_lt_rb`         , `esr`.`sov_hq_issue_sen_lt_loc_rb` `sov_hq_issue_sen_lt_loc_rb`         , `esr`.`sov_hq_issue_sen_lt_rb` `sov_hq_issue_sen_lt_rb`         , `esr`.`sov_hq_issue_sub_lt_loc_rb` `sov_hq_issue_sub_lt_loc_rb`         , `esr`.`sov_hq_issue_sub_lt_rb` `sov_hq_issue_sub_lt_rb`         , `esr`.`branch_subsidiary` `branch_subsidiary`         , `esr`.`scenario_id` `scenario_id`         , `esr`.`audit_esr` `audit_esr`         , `esr`.`flag_adjustment` `flag_adjustment`         , `esr`.`int_rating_changed` `int_rating_changed`         , `esr`.`lt_rating_changed` `lt_rating_changed`         , `esr`.`st_rating_changed` `st_rating_changed`         , `esr`.`sov_st_rating_changed` `sov_st_rating_changed`         , `esr`.`sov_lt_rating_changed` `sov_lt_rating_changed`         , `esr`.`sov_int_rating_changed` `sov_int_rating_changed`         , `esr`.`lt_lccy_rating_changed` `lt_lccy_rating_changed`         , `esr`.`sov_lt_lccy_rating_changed` `sov_lt_lccy_rating_changed`         , `esr`.`guar_bucket_changed` `guar_bucket_changed`         , `esr`.`nb_of_employees` `nb_of_employees`         , `esr`.`low_quality_issue_loc_lt_rb` `low_quality_issue_loc_lt_rb`         , `esr`.`attribute_10` `attribute_10`         , `esr`.`attribute_11` `attribute_11`         , `esr`.`attribute_12` `attribute_12`         , `esr`.`attribute_13` `attribute_13`         , `esr`.`attribute_14` `attribute_14`         , `esr`.`attribute_15` `attribute_15`         , `esr`.`attribute_16` `attribute_16`         , `esr`.`attribute_17` `attribute_17`         , `esr`.`attribute_18` `attribute_18`         , `esr`.`attribute_19` `attribute_19`         , `esr`.`int_rating_agency_local_ccy` `int_rating_agency_local_ccy`         , `esr`.`guar_lt_rating_code` `guar_lt_rating_code`         , `esr`.`guar_lt_rating_agency` `guar_lt_rating_agency`         , `esr`.`elg_lt_rating_code` `elg_lt_rating_code`         , `esr`.`elg_lt_rating_agency` `elg_lt_rating_agency`         , `esr`.`elg_lt_rating_code_local_ccy` `elg_lt_rating_code_local_ccy`         , `esr`.`elg_lt_rating_agency_local_ccy` `elg_lt_rating_agency_local_ccy`         , `esr`.`elg_lt_int_rating_code` `elg_lt_int_rating_code`         , `esr`.`elg_lt_int_rating_agency` `elg_lt_int_rating_agency`         , `esr`.`elg_lt_int_rat_code_local_ccy` `elg_lt_int_rat_code_local_ccy`         , `esr`.`elg_lt_int_rat_agenc_local_ccy` `elg_lt_int_rat_agenc_local_ccy`         , `esr`.`specific_rating_code` `specific_rating_code`         , `esr`.`specific_rating_agency` `specific_rating_agency`         , `esr`.`sov_lt_rating_agency` `sov_lt_rating_agency`         , `esr`.`sov_lt_rating_code` `sov_lt_rating_code`         , `esr`.`sov_st_rating_agency` `sov_st_rating_agency`         , `esr`.`sov_st_rating_code` `sov_st_rating_code`         , `esr`.`sov_rat_agency_local_ccy` `sov_rat_agency_local_ccy`         , `esr`.`sov_rat_code_local_ccy` `sov_rat_code_local_ccy`         , `esr`.`lq_issue_lt_rat_code` `lq_issue_lt_rat_code`         , `esr`.`lq_issue_lt_rat_agcy` `lq_issue_lt_rat_agcy`         , `esr`.`hq_issue_sen_lt_loc_rat_code` `hq_issue_sen_lt_loc_rat_code`         , `esr`.`hq_issue_sen_lt_loc_rat_agency` `hq_issue_sen_lt_loc_rat_agency`         , `esr`.`hq_issue_sen_lt_rat_code` `hq_issue_sen_lt_rat_code`         , `esr`.`hq_issue_sen_lt_rat_agcy_code` `hq_issue_sen_lt_rat_agcy_code`         , `esr`.`hq_issue_sub_lt_loc_rat_code` `hq_issue_sub_lt_loc_rat_code`         , `esr`.`hq_issue_sub_lt_loc_rat_agcy` `hq_issue_sub_lt_loc_rat_agcy`         , `esr`.`hq_issue_sub_lt_rating_code` `hq_issue_sub_lt_rating_code`         , `esr`.`hq_issue_sub_lt_rat_agcy_code` `hq_issue_sub_lt_rat_agcy_code`         , `esr`.`lq_issue_lt_loc_rat_code` `lq_issue_lt_loc_rat_code`         , `esr`.`lq_issue_lt_loc_rat_agcy` `lq_issue_lt_loc_rat_agcy`         , `esr`.`sov_lq_issue_lt_rat_code` `sov_lq_issue_lt_rat_code`         , `esr`.`sov_lq_issue_lt_rat_agcy` `sov_lq_issue_lt_rat_agcy`         , `esr`.`sov_hq_i_sen_lt_loc_rat_code` `sov_hq_i_sen_lt_loc_rat_code`         , `esr`.`sov_hq_i_sen_lt_loc_rat_agcy` `sov_hq_i_sen_lt_loc_rat_agcy`         , `esr`.`sov_hq_issue_sen_lt_rat_code` `sov_hq_issue_sen_lt_rat_code`         , `esr`.`sov_hq_issue_sen_lt_rat_agcy` `sov_hq_issue_sen_lt_rat_agcy`         , `esr`.`sov_hq_i_sub_lt_loc_rat_code` `sov_hq_i_sub_lt_loc_rat_code`         , `esr`.`sov_hq_i_sub_lt_loc_rat_agcy` `sov_hq_i_sub_lt_loc_rat_agcy`         , `esr`.`sov_hq_issue_sub_lt_rat_code` `sov_hq_issue_sub_lt_rat_code`         , `esr`.`sov_hq_issue_sub_lt_rat_agcy` `sov_hq_issue_sub_lt_rat_agcy`         , `esr`.`lq_issue_st_rating_code` `lq_issue_st_rating_code`         , `esr`.`lq_issue_st_rating_agency` `lq_issue_st_rating_agency`         , `esr`.`fi_type` `fi_type`         , `esr`.`default_date` `default_date`         , `esr`.`portfolio_financial_system` `portfolio_financial_system` from `sgmisitstg`.`stg_bcrs_esr` `esr` where `esr`.`w_batch_id` = '2022011013503600666'
